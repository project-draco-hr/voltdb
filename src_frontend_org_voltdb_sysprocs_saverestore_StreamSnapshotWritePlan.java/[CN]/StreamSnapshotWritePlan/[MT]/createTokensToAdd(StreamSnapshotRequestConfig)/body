{
  ImmutableMap.Builder<Long,Integer> tokenBuilder=ImmutableMap.builder();
  for (  StreamSnapshotRequestConfig.Stream stream : config.streams) {
    if (stream.partition != null && stream.ranges != null) {
      for (      long token : stream.ranges.keySet()) {
        tokenBuilder.put(token,stream.partition);
      }
    }
  }
  return tokenBuilder.build();
}
