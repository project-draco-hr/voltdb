{
  HashRangeExpression predicate=null;
  if (!config.partitionsToAdd.isEmpty()) {
    Map<Long,Long> ranges=new TreeMap<Long,Long>();
    for (    Entry<Integer,SortedMap<Long,Long>> entry : config.partitionsToAdd.entrySet()) {
      int partition=entry.getKey();
      SortedMap<Long,Long> pRanges=entry.getValue();
      if (SNAP_LOG.isTraceEnabled()) {
        SNAP_LOG.trace("Partition " + partition + " has ranges "+ pRanges);
      }
      ranges.putAll(pRanges);
    }
    predicate=new HashRangeExpression();
    predicate.setRanges(ranges);
    predicate.setHashColumnIndex(table.getPartitioncolumn().getIndex());
  }
  return predicate;
}
