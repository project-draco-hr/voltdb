{
  CountDownLatch waitLatch=new CountDownLatch(m_lastPartitionTable - m_firstPartitionTable + 1);
  for (int i=m_firstPartitionTable; i <= m_lastPartitionTable; i++) {
    VoltBulkLoaderRow drainRow=new VoltBulkLoaderRow(this);
    drainRow.new DrainNotificationCallBack(waitLatch);
    m_partitionTable[i].drainTableQueue(drainRow);
  }
  waitLatch.await();
  assert(m_loaderBatchedRowCnt.get() == 0 && m_loaderQueuedRowCnt.get() == 0);
  CountDownLatch batchFailureQueueLatch=new CountDownLatch(1);
  VoltBulkLoaderRow drainRow=new VoltBulkLoaderRow(this);
  drainRow.new DrainNotificationCallBack(batchFailureQueueLatch);
  m_failedQueue.add(drainRow);
  batchFailureQueueLatch.await();
  assert(m_failedBatchQueuedRowCnt.get() == 0 && m_failedBatchSentRowCnt.get() == 0);
}
