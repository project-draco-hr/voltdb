{
  for (int i=m_firstPartitionTable; i <= m_lastPartitionTable; i++) {
    try {
      m_partitionTable[i].flushAllTableQueues().get();
    }
 catch (    ExecutionException e) {
      loaderLog.error("Failed to drain all buffers, some tuples may not be inserted yet.",e);
    }
  }
  while (m_loaderBatchedRowCnt.get() != 0) {
    m_clientImpl.drain();
    Thread.yield();
  }
  assert(m_loaderBatchedRowCnt.get() == 0 && m_loaderQueuedRowCnt.get() == 0);
}
