{
  CompiledPlan retval=new CompiledPlan();
  AbstractPlanNode root=new UnionPlanNode(unionType);
  for (  CompiledPlan selectPlan : selectPlans) {
    root.addAndLinkChild(selectPlan.rootPlanGraph);
  }
  SendPlanNode sendNode=new SendPlanNode();
  sendNode.addAndLinkChild(root);
  sendNode.generateOutputSchema(m_catalogDb);
  retval.rootPlanGraph=sendNode;
  retval.readOnly=true;
  assert(nextStmt != null);
  addParameters(retval,nextStmt);
  retval.fullWhereClause=nextStmt.where;
  retval.fullWinnerPlan=retval.rootPlanGraph;
  retval.rootPlanGraph.generateOutputSchema(m_catalogDb);
  retval.setPartitioningKey(m_partitioning.effectivePartitioningValue());
  return retval;
}
