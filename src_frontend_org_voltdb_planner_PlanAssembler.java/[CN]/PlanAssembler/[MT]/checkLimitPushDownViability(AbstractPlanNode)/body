{
  AbstractPlanNode receiveNode=root;
  while (!(receiveNode instanceof ReceivePlanNode)) {
    if (!(receiveNode instanceof OrderByPlanNode) && !(receiveNode instanceof ProjectionPlanNode) && !(receiveNode instanceof AggregatePlanNode)) {
      return null;
    }
    if (receiveNode instanceof OrderByPlanNode) {
      for (      ParsedSelectStmt.ParsedColInfo col : m_parsedSelect.orderByColumns()) {
        AbstractExpression rootExpr=col.expression;
        ArrayList<AbstractExpression> tves=rootExpr.findBaseTVEs();
        for (        AbstractExpression tve : tves) {
          if (((TupleValueExpression)tve).hasAggregate() && !m_parsedSelect.hasPartitionColumnInGroupby()) {
            return null;
          }
        }
      }
    }
    if (receiveNode instanceof AggregatePlanNode && receiveNode.getParentCount() > 0) {
      AbstractPlanNode parent=receiveNode.getParent(0);
      if (parent instanceof OrderByPlanNode == false && !(parent instanceof ProjectionPlanNode && parent.getParentCount() > 0 && parent.getParent(0) instanceof OrderByPlanNode)) {
        return null;
      }
    }
    if (receiveNode.getChildCount() == 0) {
      return null;
    }
    assert(receiveNode.getChildCount() == 1);
    receiveNode=receiveNode.getChild(0);
  }
  return receiveNode.getChild(0);
}
