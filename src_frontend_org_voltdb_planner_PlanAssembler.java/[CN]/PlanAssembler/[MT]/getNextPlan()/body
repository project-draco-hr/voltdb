{
  CompiledPlan retval;
  AbstractParsedStmt nextStmt=null;
  if (m_parsedUnion != null) {
    nextStmt=m_parsedUnion;
    retval=getNextUnionPlan();
  }
 else   if (m_parsedSelect != null) {
    nextStmt=m_parsedSelect;
    retval=getNextSelectPlan();
  }
 else {
    retval=new CompiledPlan();
    retval.readOnly=false;
    if (m_parsedInsert != null) {
      nextStmt=m_parsedInsert;
      retval.rootPlanGraph=getNextInsertPlan();
    }
 else     if (m_parsedUpdate != null) {
      nextStmt=m_parsedUpdate;
      retval.rootPlanGraph=getNextUpdatePlan();
    }
 else     if (m_parsedDelete != null) {
      nextStmt=m_parsedDelete;
      retval.rootPlanGraph=getNextDeletePlan();
    }
 else {
      throw new RuntimeException("setupForNewPlans not called or not successfull.");
    }
    assert(nextStmt.m_tableList.size() == 1);
    if (nextStmt.m_tableList.get(0).getIsreplicated()) {
      retval.replicatedTableDML=true;
    }
    retval.statementGuaranteesDeterminism(false,true);
  }
  if (retval == null || retval.rootPlanGraph == null) {
    return null;
  }
  assert(nextStmt != null);
  retval.parameters=nextStmt.getParameters();
  return retval;
}
