{
  setupForNewPlans(parsedStmt);
  ParsedResultAccumulator subQueryResult=getBestCostPlanForSubQueries(parsedStmt);
  if (subQueryResult != null && subQueryResult.m_compiledPlan == null) {
    return null;
  }
  CompiledPlan rawplan=null;
  while (true) {
    rawplan=getNextPlan();
    if (rawplan == null)     break;
    m_planSelector.considerCandidatePlan(rawplan);
  }
  CompiledPlan retval=m_planSelector.m_bestPlan;
  if (subQueryResult != null && retval != null) {
    subQueryResult=setCommonPartitioning(m_partitioning,subQueryResult);
    boolean contentIsDeterministic=subQueryResult.m_contentIsDeterministic && retval.isContentDeterministic();
    boolean orderIsDeterministic=subQueryResult.m_orderIsDeterministic && retval.isOrderDeterministic();
    retval.statementGuaranteesDeterminism(contentIsDeterministic,orderIsDeterministic);
    retval.rootPlanGraph=connectChildrenBestPlans(retval.rootPlanGraph);
  }
  return retval;
}
