{
  assert(m_parsedSelect != null);
  if (!m_parsedSelect.hasOrderByColumns()) {
    return root;
  }
  SortDirectionType sortDirection=SortDirectionType.INVALID;
  if (root.getPlanNodeType() == PlanNodeType.INDEXSCAN) {
    sortDirection=((IndexScanPlanNode)root).getSortDirection();
    if (sortDirection != SortDirectionType.INVALID) {
      return root;
    }
  }
  if (root instanceof AbstractJoinPlanNode) {
    sortDirection=((AbstractJoinPlanNode)root).getSortDirection();
    if (sortDirection != SortDirectionType.INVALID) {
      return root;
    }
  }
  OrderByPlanNode orderByNode=new OrderByPlanNode();
  for (  ParsedSelectStmt.ParsedColInfo col : m_parsedSelect.orderColumns) {
    orderByNode.addSort(col.expression,col.ascending ? SortDirectionType.ASC : SortDirectionType.DESC);
  }
  orderByNode.addAndLinkChild(root);
  return orderByNode;
}
