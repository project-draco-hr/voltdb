{
  assert(m_parsedSelect != null);
  SortDirectionType sortDirection=SortDirectionType.INVALID;
  AbstractPlanNode nonAggPlan=root;
  if (nonAggPlan.getPlanNodeType() == PlanNodeType.AGGREGATE) {
    nonAggPlan=nonAggPlan.getChild(0);
  }
  if (nonAggPlan instanceof IndexScanPlanNode) {
    sortDirection=((IndexScanPlanNode)nonAggPlan).getSortDirection();
  }
 else   if (nonAggPlan instanceof AbstractJoinPlanNode) {
    sortDirection=((AbstractJoinPlanNode)nonAggPlan).getSortDirection();
  }
  if (sortDirection != SortDirectionType.INVALID) {
    return root;
  }
  OrderByPlanNode orderByNode=new OrderByPlanNode();
  for (  ParsedColInfo col : m_parsedSelect.m_orderColumns) {
    orderByNode.addSort(col.expression,col.ascending ? SortDirectionType.ASC : SortDirectionType.DESC);
  }
  orderByNode.addAndLinkChild(root);
  return orderByNode;
}
