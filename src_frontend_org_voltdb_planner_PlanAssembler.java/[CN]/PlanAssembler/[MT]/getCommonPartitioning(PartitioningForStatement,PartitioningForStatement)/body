{
  if (commonPartitioning == null) {
    return partitioning;
  }
  AbstractExpression statementPartitionExpression=partitioning.singlePartitioningExpression();
  if (commonPartitioning.requiresTwoFragments()) {
    if (partitioning.requiresTwoFragments() || statementPartitionExpression != null) {
      throw new PlanningErrorException("Statements are too complex in set operation or sub-query using multiple partitioned tables.");
    }
    return commonPartitioning;
  }
  AbstractExpression commonPartitionExpression=commonPartitioning.singlePartitioningExpression();
  if (commonPartitionExpression == null) {
    return partitioning;
  }
  if (partitioning.requiresTwoFragments()) {
    throw new PlanningErrorException("Statements are too complex in set operation or sub-query using multiple partitioned tables.");
  }
  if (statementPartitionExpression == null) {
    return commonPartitioning;
  }
  if (!commonPartitionExpression.equals(statementPartitionExpression)) {
    throw new PlanningErrorException("Statements use conflicting partitioned table filters in set operation or sub-query.");
  }
  return commonPartitioning;
}
