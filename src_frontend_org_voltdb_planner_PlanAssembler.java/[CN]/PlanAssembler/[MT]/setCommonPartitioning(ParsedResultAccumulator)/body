{
  assert(parsedResult != null);
  assert(parsedResult.m_currentPartitioning != null);
  if (parsedResult.m_commonPartitioning == null) {
    parsedResult.m_commonPartitioning=parsedResult.m_currentPartitioning;
    return parsedResult;
  }
  AbstractExpression statementPartitionExpression=parsedResult.m_currentPartitioning.singlePartitioningExpression();
  if (parsedResult.m_commonPartitioning.requiresTwoFragments()) {
    if (parsedResult.m_currentPartitioning.requiresTwoFragments() || statementPartitionExpression != null) {
      throw new PlanningErrorException("Statements are too complex in set operation using multiple partitioned tables.");
    }
    return parsedResult;
  }
  AbstractExpression commonPartitionExpression=parsedResult.m_commonPartitioning.singlePartitioningExpression();
  if (commonPartitionExpression == null) {
    parsedResult.m_commonPartitioning=parsedResult.m_currentPartitioning;
    return parsedResult;
  }
  if (parsedResult.m_currentPartitioning.requiresTwoFragments()) {
    throw new PlanningErrorException("Statements are too complex in set operation using multiple partitioned tables.");
  }
  if (statementPartitionExpression == null) {
    return parsedResult;
  }
  if (!commonPartitionExpression.equals(statementPartitionExpression)) {
    throw new PlanningErrorException("Statements use conflicting partitioned table filters in set operation or sub-query.");
  }
  return parsedResult;
}
