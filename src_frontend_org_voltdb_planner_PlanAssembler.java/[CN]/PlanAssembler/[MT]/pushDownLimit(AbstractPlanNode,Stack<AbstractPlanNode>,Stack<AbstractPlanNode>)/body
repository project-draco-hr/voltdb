{
  AbstractPlanNode receiveNode=checkPushDownViability(root);
  AbstractPlanNode distributedPlan=root;
  if (!coordNodes.isEmpty() && receiveNode != null) {
    distributedPlan=receiveNode.getChild(0).getChild(0);
    distributedPlan.clearParents();
    receiveNode.getChild(0).clearChildren();
  }
  if (!coordNodes.isEmpty() && receiveNode != null) {
    if ((distributedPlan.getPlanNodeType() != PlanNodeType.INDEXSCAN || ((IndexScanPlanNode)distributedPlan).getSortDirection() == SortDirectionType.INVALID) && m_parsedSelect.orderColumns.size() > 0) {
      distNodes.push(createOrderBy());
    }
  }
  while (!distNodes.isEmpty()) {
    AbstractPlanNode distributedNode=distNodes.pop();
    distributedNode.addAndLinkChild(distributedPlan);
    distributedPlan=distributedNode;
  }
  if (!coordNodes.isEmpty() && receiveNode != null) {
    receiveNode.getChild(0).addAndLinkChild(distributedPlan);
    while (!coordNodes.isEmpty()) {
      AbstractPlanNode coordNode=coordNodes.pop();
      coordNode.addAndLinkChild(root);
      root=coordNode;
    }
  }
 else {
    root=distributedPlan;
  }
  root.generateOutputSchema(m_catalogDb);
  return root;
}
