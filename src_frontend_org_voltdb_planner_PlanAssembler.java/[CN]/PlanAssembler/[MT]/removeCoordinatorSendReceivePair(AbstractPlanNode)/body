{
  assert(root != null);
  AbstractPlanNode current=root;
  while (!(current instanceof ReceivePlanNode)) {
    if (current.getChildCount() == 1) {
      current=current.getChild(0);
    }
 else {
      return root;
    }
  }
  assert(current.getChildCount() == 1);
  AbstractPlanNode child=current.getChild(0);
  assert(child instanceof SendPlanNode);
  assert(child.getChildCount() == 1);
  child=child.getChild(0);
  if (child instanceof ProjectionPlanNode) {
    assert(child.getChildCount() == 1);
    child=child.getChild(0);
  }
  child.clearParents();
  if (current == root) {
    return child;
  }
 else {
    assert(current.getParentCount() == 1);
    AbstractPlanNode parent=current.getParent(0);
    parent.unlinkChild(current);
    parent.addAndLinkChild(child);
  }
  return root;
}
