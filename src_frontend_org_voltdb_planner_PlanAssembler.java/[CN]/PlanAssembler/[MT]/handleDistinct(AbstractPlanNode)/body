{
  if (m_parsedSelect.hasDistinct()) {
    if (m_parsedSelect.m_displayColumns.size() > 1) {
      throw new PlanningErrorException("Multiple DISTINCT columns currently unsupported");
    }
    AbstractExpression distinctExpr=null;
    for (    ParsedSelectStmt.ParsedColInfo col : m_parsedSelect.m_displayColumns) {
      if (col.expression instanceof TupleValueExpression) {
        assert(distinctExpr == null);
        distinctExpr=col.expression;
      }
 else {
        throw new PlanningErrorException("DISTINCT of an expression currently unsupported");
      }
    }
    assert(distinctExpr != null);
    root=addDistinctNodes(root,distinctExpr);
    root=addProjection(root);
  }
  return root;
}
