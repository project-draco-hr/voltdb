{
  if (m_parsedSelect.distinct) {
    AbstractExpression distinctExpr=null;
    AbstractExpression nextExpr=null;
    for (    ParsedSelectStmt.ParsedColInfo col : m_parsedSelect.displayColumns) {
      if (col.expression instanceof TupleValueExpression) {
        if (distinctExpr == null) {
          distinctExpr=col.expression;
          nextExpr=distinctExpr;
        }
 else {
          nextExpr.setRight(col.expression);
          nextExpr=nextExpr.getRight();
        }
      }
 else {
        throw new PlanningErrorException("DISTINCT of an expression currently unsupported");
      }
    }
    root=addDistinctNodes(root,distinctExpr);
    root=addProjection(root);
  }
  return root;
}
