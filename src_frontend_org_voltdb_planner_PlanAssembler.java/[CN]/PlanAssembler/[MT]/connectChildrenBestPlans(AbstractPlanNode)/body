{
  if (parentPlan instanceof AbstractScanPlanNode) {
    AbstractScanPlanNode scanNode=(AbstractScanPlanNode)parentPlan;
    if (scanNode.isSubQuery()) {
      String tableAlias=scanNode.getTargetTableAlias();
      assert(subAssembler.m_parsedStmt.tableAliasIndexMap.containsKey(tableAlias));
      int tableIdx=subAssembler.m_parsedStmt.tableAliasIndexMap.get(tableAlias);
      StmtTableScan tableCache=subAssembler.m_parsedStmt.stmtCache.get(tableIdx);
      assert(tableCache.m_tableDerived != null);
      AbstractPlanNode subQueryRoot=tableCache.m_tableDerived.getBetsCostPlan().rootPlanGraph;
      subQueryRoot.disconnectParents();
      scanNode.addAndLinkChild(subQueryRoot);
    }
  }
 else {
    for (int i=0; i < parentPlan.getChildCount(); ++i) {
      connectChildrenBestPlans(parentPlan.getChild(i));
    }
  }
  return parentPlan;
}
