{
  parsedResult.m_currentPartitioning=(PartitioningForStatement)m_partitioning.clone();
  PlanSelector selector=(PlanSelector)m_planSelector.clone();
  selector.m_planId=parsedResult.m_planId;
  PlanAssembler assembler=new PlanAssembler(m_catalogCluster,m_catalogDb,parsedResult.m_currentPartitioning,selector);
  parsedResult.m_compiledPlan=assembler.getBestCostPlan(parsedStmt,false);
  if (parsedResult.m_compiledPlan == null) {
    if (m_recentErrorMsg == null) {
      m_recentErrorMsg="Unable to plan for statement. Error unknown.";
    }
    return;
  }
  parsedResult.m_orderIsDeterministic=parsedResult.m_orderIsDeterministic && parsedResult.m_compiledPlan.isOrderDeterministic();
  parsedResult.m_planId=selector.m_planId;
}
