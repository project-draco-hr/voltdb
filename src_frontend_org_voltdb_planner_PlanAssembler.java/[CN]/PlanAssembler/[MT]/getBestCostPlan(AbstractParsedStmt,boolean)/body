{
  setupForNewPlans(parsedStmt);
  CompiledPlan rawplan=null;
  while (true) {
    try {
      rawplan=getNextPlan(isTopPlan);
    }
 catch (    PlanningErrorException e) {
      m_recentErrorMsg=e.getMessage();
      return null;
    }
    if (rawplan == null)     break;
    m_planSelector.considerCandidatePlan(rawplan);
  }
  if (isTopPlan && m_planSelector.m_bestPlan != null) {
    m_planSelector.finalizeOutput(m_planSelector.m_bestFilename,m_planSelector.m_stats);
  }
  return m_planSelector.m_bestPlan;
}
