{
  m_snapshotTableTasks=new ArrayDeque<SnapshotTableTask>(tasks);
  m_snapshotTargets=new ArrayList<SnapshotDataTarget>();
  for (  final SnapshotTableTask task : tasks) {
    if (!task.m_isReplicated) {
      assert(task != null);
      assert(m_snapshotTargets != null);
      m_snapshotTargets.add(task.m_target);
    }
    if (!ee.activateCopyOnWrite(task.m_tableId)) {
      hostLog.error("Attempted to activate copy on write mode for table " + task.m_name + " and failed");
      hostLog.error(task);
      VoltDB.crashVoltDB();
    }
  }
}
