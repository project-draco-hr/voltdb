{
  JSONObject stateInfoMap;
  if (jsonObj.has("drTupleStreamStateInfo")) {
    stateInfoMap=jsonObj.getJSONObject("drTupleStreamStateInfo");
  }
 else {
    stateInfoMap=new JSONObject();
    jsonObj.put("drTupleStreamStateInfo",stateInfoMap);
  }
  for (  Map.Entry<Integer,DRLogSegmentId> e : drTupleStreamInfo.entrySet()) {
    final String partitionId=e.getKey().toString();
    final DRLogSegmentId partitionStateInfo=e.getValue();
    JSONObject existingStateInfo=stateInfoMap.optJSONObject(partitionId);
    if (existingStateInfo == null || partitionStateInfo.drId > existingStateInfo.getLong("sequenceNumber")) {
      JSONObject stateInfo=new JSONObject();
      stateInfo.put("sequenceNumber",partitionStateInfo.drId);
      stateInfo.put("spUniqueId",partitionStateInfo.spUniqueId);
      stateInfo.put("mpUniqueId",partitionStateInfo.mpUniqueId);
      stateInfoMap.put(partitionId,stateInfo);
    }
  }
}
