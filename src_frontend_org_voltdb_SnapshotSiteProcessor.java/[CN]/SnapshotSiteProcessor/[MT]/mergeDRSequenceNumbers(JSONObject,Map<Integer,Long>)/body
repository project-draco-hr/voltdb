{
  JSONObject sequenceNumberMap;
  if (jsonObj.has("drSequenceNumbers")) {
    sequenceNumberMap=jsonObj.getJSONObject("drSequenceNumbers");
  }
 else {
    sequenceNumberMap=new JSONObject();
    jsonObj.put("drSequenceNumbers",sequenceNumberMap);
  }
  for (  Map.Entry<Integer,Long> e : drSequenceNumbers.entrySet()) {
    final String partitionId=e.getKey().toString();
    final Long partitionSequenceNumber=e.getValue();
    long existingSequenceNumber=sequenceNumberMap.optLong(partitionId,Long.MIN_VALUE);
    sequenceNumberMap.put(partitionId,Math.max(existingSequenceNumber,partitionSequenceNumber));
  }
}
