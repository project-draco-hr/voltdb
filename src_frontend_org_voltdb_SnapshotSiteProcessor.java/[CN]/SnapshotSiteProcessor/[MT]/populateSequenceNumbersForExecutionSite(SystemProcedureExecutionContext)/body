{
  Database database=context.getDatabase();
  for (  Table t : database.getTables()) {
    if (!CatalogUtil.isTableExportOnly(database,t))     continue;
    Map<Integer,Pair<Long,Long>> sequenceNumbers=m_exportSequenceNumbers.get(t.getTypeName());
    if (sequenceNumbers == null) {
      sequenceNumbers=new HashMap<Integer,Pair<Long,Long>>();
      m_exportSequenceNumbers.put(t.getTypeName(),sequenceNumbers);
    }
    long[] ackOffSetAndSequenceNumber=context.getSiteProcedureConnection().getUSOForExportTable(t.getSignature());
    sequenceNumbers.put(context.getPartitionId(),Pair.of(ackOffSetAndSequenceNumber[0],ackOffSetAndSequenceNumber[1]));
  }
  Pair<Long,Long> drSequenceNumbers=context.getSiteProcedureConnection().getDRSequenceNumbers();
  m_drSequenceNumbers.put(context.getPartitionId(),drSequenceNumbers.getFirst());
  if (drSequenceNumbers.getSecond() != null) {
    m_drSequenceNumbers.put(MpInitiator.MP_INIT_PID,drSequenceNumbers.getSecond());
  }
}
