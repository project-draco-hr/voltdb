{
  JSONObject stateInfoMap;
  if (jsonObj.has("drTupleStreamStateInfo")) {
    stateInfoMap=jsonObj.getJSONObject("drTupleStreamStateInfo");
  }
 else {
    stateInfoMap=new JSONObject();
    jsonObj.put("drTupleStreamStateInfo",stateInfoMap);
  }
  for (  Map.Entry<Integer,Pair<Long,Long>> e : drTupleStreamInfo.entrySet()) {
    final String partitionId=e.getKey().toString();
    final Pair<Long,Long> partitionStateInfo=e.getValue();
    JSONObject existingStateInfo=stateInfoMap.optJSONObject(partitionId);
    if (existingStateInfo == null || partitionStateInfo.getFirst() > existingStateInfo.getLong("sequenceNumber")) {
      JSONObject stateInfo=new JSONObject();
      stateInfo.put("sequenceNumber",partitionStateInfo.getFirst());
      stateInfo.put("uniqueId",partitionStateInfo.getSecond());
      stateInfoMap.put(partitionId,stateInfo);
    }
  }
}
