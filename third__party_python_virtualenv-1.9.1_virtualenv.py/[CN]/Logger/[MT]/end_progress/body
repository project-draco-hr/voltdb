def end_progress(self, msg='done.'):
    assert self.in_progress, 'Tried to end_progress without start_progress'
    if self.stdout_level_matches(self.NOTIFY):
        if (not self.in_progress_hanging):
            sys.stdout.write(((('...' + self.in_progress) + msg) + '\n'))
            sys.stdout.flush()
        else:
            sys.stdout.write((msg + '\n'))
            sys.stdout.flush()
    self.in_progress = None
    self.in_progress_hanging = False
