{
  if (!m_partitionDetectionEnabled) {
    return PPDPolicyDecision.NodeFailure;
  }
  if (newFailedSiteIds == null || newFailedSiteIds.size() == 0) {
    return PPDPolicyDecision.NodeFailure;
  }
  final HashSet<Integer> failedHosts=new HashSet<Integer>();
  for (  Long siteId : newFailedSiteIds) {
    failedHosts.add(SiteTracker.getHostForSite(siteId));
  }
  final int prevSurvivorCnt=tracker.getAllHosts().size() + failedHosts.size();
  int blessedHostId=Integer.MAX_VALUE;
  boolean blessedHostIdInFailedSet=true;
  for (  Integer hostId : failedHosts) {
    if (hostId < blessedHostId) {
      blessedHostId=hostId;
    }
  }
  for (  Integer hostId : tracker.getAllHosts()) {
    if (hostId < blessedHostId) {
      blessedHostId=hostId;
      blessedHostIdInFailedSet=false;
    }
  }
  if (failedHosts.size() * 2 == prevSurvivorCnt) {
    if (blessedHostIdInFailedSet) {
      hostLog.info("Partition detection triggered for 50/50 cluster failure. " + "This survivor set is shutting down.");
      m_partitionDetectionTriggered=true;
      return PPDPolicyDecision.PartitionDetection;
    }
 else {
      hostLog.info("Partition detected for 50/50 failure. " + "This survivor set is continuing execution.");
      return PPDPolicyDecision.NodeFailure;
    }
  }
  if (failedHosts.size() * 2 > prevSurvivorCnt) {
    hostLog.info("Partition detection triggered. " + "This minority survivor set is shutting down.");
    m_partitionDetectionTriggered=true;
    return PPDPolicyDecision.PartitionDetection;
  }
  return PPDPolicyDecision.NodeFailure;
}
