{
  if (!m_partitionDetectionEnabled) {
    return PPDPolicyDecision.NodeFailure;
  }
  if (newFailedSiteIds == null || newFailedSiteIds.size() == 0) {
    return PPDPolicyDecision.NodeFailure;
  }
  final SiteTracker tracker=VoltDB.instance().getCatalogContext().siteTracker;
  final HashSet<Integer> failedHosts=new HashSet<Integer>();
  for (  Integer siteId : newFailedSiteIds) {
    failedHosts.add(tracker.getHostForSite(siteId));
  }
  final int prevSurvivorCnt=tracker.getAllLiveHosts().size() + failedHosts.size();
  int blessedHostId=Integer.MAX_VALUE;
  boolean blessedHostIdInFailedSet=true;
  for (  Integer hostId : failedHosts) {
    if (hostId < blessedHostId) {
      blessedHostId=hostId;
    }
  }
  for (  Integer hostId : tracker.getAllLiveHosts()) {
    if (hostId < blessedHostId) {
      blessedHostId=hostId;
      blessedHostIdInFailedSet=false;
    }
  }
  if (failedHosts.size() * 2 == prevSurvivorCnt) {
    if (blessedHostIdInFailedSet) {
      m_partitionDetectionTriggered=true;
      return PPDPolicyDecision.PartitionDetection;
    }
 else {
      return PPDPolicyDecision.NodeFailure;
    }
  }
  if (failedHosts.size() * 2 > prevSurvivorCnt) {
    m_partitionDetectionTriggered=true;
    return PPDPolicyDecision.PartitionDetection;
  }
  return PPDPolicyDecision.NodeFailure;
}
