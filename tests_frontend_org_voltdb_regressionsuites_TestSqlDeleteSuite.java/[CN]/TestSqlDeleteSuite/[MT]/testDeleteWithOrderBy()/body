{
  if (isHSQL()) {
    return;
  }
  Client client=getClient();
  String[] stmtTemplates={"DELETE FROM %s ORDER BY NUM ASC LIMIT 1","DELETE FROM %s ORDER BY NUM DESC LIMIT 2","DELETE FROM %s ORDER BY NUM LIMIT 3"};
  long[][] expectedResults={new long[]{1,2,3,4,5,6,7,8,9},new long[]{1,2,3,4,5,6,7},new long[]{4,5,6,7}};
  insertRows(client,"P3",10);
  insertRows(client,"R3",10);
  VoltTable vt;
  for (int i=0; i < stmtTemplates.length; ++i) {
    String replStmt=String.format(stmtTemplates[i],"R3");
    int len=replStmt.length();
    long expectedRows=Long.valueOf(replStmt.substring(len - 1,len));
    vt=client.callProcedure("@AdHoc",replStmt).getResults()[0];
    validateTableOfScalarLongs(vt,new long[]{expectedRows});
    vt=client.callProcedure("@AdHoc","SELECT NUM FROM R3 ORDER BY NUM ASC").getResults()[0];
    validateTableOfScalarLongs(vt,expectedResults[i]);
    String partStmt=String.format(stmtTemplates[i],"P3");
    verifyStmtFails(client,partStmt,"Only single-partition DELETE statements " + "may contain ORDER BY with LIMIT and/or OFFSET clauses.");
  }
}
