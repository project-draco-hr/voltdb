{
  if (isHSQL()) {
    return;
  }
  Client client=getClient();
  VoltTable vt;
  for (  String table : Arrays.asList("P3","R3")) {
    insertMoreRows(client,table,10,3);
    String stmt="DELETE FROM " + table + " WHERE ID = 0 ORDER BY NUM ASC LIMIT 1";
    vt=client.callProcedure("@AdHoc",stmt).getResults()[0];
    validateTableOfScalarLongs(vt,new long[]{1});
    vt=client.callProcedure("@AdHoc","select num from " + table + " where id = 0 order by num asc").getResults()[0];
    validateTableOfScalarLongs(vt,new long[]{1,2});
    vt=client.callProcedure("@AdHoc","select count(*) from " + table).getResults()[0];
    validateTableOfScalarLongs(vt,new long[]{29});
    stmt="DELETE FROM " + table + " WHERE DESC LIKE 'de%' AND ID = 10 ORDER BY NUM DESC LIMIT 2";
    vt=client.callProcedure("@AdHoc",stmt).getResults()[0];
    validateTableOfScalarLongs(vt,new long[]{2});
    vt=client.callProcedure("@AdHoc","select num from " + table + " where id = 10 order by num asc").getResults()[0];
    validateTableOfScalarLongs(vt,new long[]{10});
    vt=client.callProcedure("@AdHoc","select count(*) from " + table).getResults()[0];
    validateTableOfScalarLongs(vt,new long[]{27});
    stmt="DELETE FROM " + table + " WHERE ID = 20 ORDER BY NUM LIMIT 10 OFFSET 2";
    vt=client.callProcedure("@AdHoc",stmt).getResults()[0];
    validateTableOfScalarLongs(vt,new long[]{1});
    vt=client.callProcedure("@AdHoc","select num from " + table + " where id = 20 order by num asc").getResults()[0];
    validateTableOfScalarLongs(vt,new long[]{20,21});
    vt=client.callProcedure("@AdHoc","select count(*) from " + table).getResults()[0];
    validateTableOfScalarLongs(vt,new long[]{26});
    stmt="DELETE FROM " + table + " WHERE ID = 30 ORDER BY NUM LIMIT 1 OFFSET 1";
    vt=client.callProcedure("@AdHoc",stmt).getResults()[0];
    validateTableOfScalarLongs(vt,new long[]{1});
    vt=client.callProcedure("@AdHoc","select num from " + table + " where id = 30 order by num asc").getResults()[0];
    validateTableOfScalarLongs(vt,new long[]{30,32});
    vt=client.callProcedure("@AdHoc","select count(*) from " + table).getResults()[0];
    validateTableOfScalarLongs(vt,new long[]{25});
  }
}
