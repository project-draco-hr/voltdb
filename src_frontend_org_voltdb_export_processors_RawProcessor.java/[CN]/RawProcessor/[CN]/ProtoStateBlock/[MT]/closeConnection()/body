{
  m_state=RawProcessor.CLOSED;
  List<ListenableFuture<?>> tasks=new ArrayList<ListenableFuture<?>>();
  for (  ExportDataSource ds : m_sourcesArray) {
    ExportProtoMessage m=new ExportProtoMessage(ds.getGeneration(),ds.getPartitionId(),ds.getSignature()).close();
    tasks.add(ds.exportAction(new ExportInternalMessage(this,m)));
  }
  try {
    Futures.allAsList(tasks).get();
  }
 catch (  Exception e) {
    m_logger.error("Error inside ExportDataSource on close",e);
  }
}
