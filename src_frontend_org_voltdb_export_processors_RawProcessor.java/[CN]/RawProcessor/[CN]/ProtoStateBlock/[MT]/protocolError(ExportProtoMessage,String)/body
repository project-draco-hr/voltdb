{
  if (m_logger != null) {
    m_logger.error("Closing Export connection with error: " + string);
  }
  final ExportProtoMessage r=new ExportProtoMessage(m.getGeneration(),m.getPartitionId(),m.getSignature());
  r.error();
  m_c.writeStream().enqueue(new DeferredSerialization(){
    @Override public BBContainer serialize(    DBBPool p) throws IOException {
      FastSerializer fs=new FastSerializer(p,r.serializableBytes() + 4);
      r.writeToFastSerializer(fs);
      return fs.getBBContainer();
    }
    @Override public void cancel(){
    }
  }
);
  closeConnection();
}
