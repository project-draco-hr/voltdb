{
  final DummyConnection c=new DummyConnection();
  initiator.createTransaction(42,"test",work,true,true,new int[]{LOCAL_SITE},1,c,32,0);
  assertTrue(mqueue.lastEquals(LOCAL_SITE,0));
  final InitiateTask request=(InitiateTask)mqueue.popLastMessage();
  assertEquals(LOCAL_SITE,request.getInitiatorSiteId());
  assertEquals(work.getProcName(),request.getStoredProcedureName());
  assertTrue(request.isSinglePartition());
  mqueue.deliver(new InitiateResponse(request));
  final ClientResponse response=c.writeStream.response;
  assertNotNull(response);
  final Iterator<Object> i=initiator.m_stats.getStatsRowKeyIterator();
  assertNotNull(i);
  assertTrue(i.hasNext());
  final Object rowKey=i.next();
  assertFalse(i.hasNext());
  assertNotNull(rowKey);
  assertTrue(rowKey instanceof String);
  assertTrue(((String)rowKey).equals("foo$42"));
  final Object statsRows[][]=initiator.m_stats.getStatsRows();
  assertNotNull(statsRows);
  assertEquals(1,statsRows.length);
  assertNotNull(statsRows[0]);
  assertEquals(statsRows[0][1],new Integer(LOCAL_SITE));
  assertEquals(statsRows[0][2],new Integer(42));
  assertEquals(statsRows[0][3],"foo");
  assertEquals(statsRows[0][4],new Integer(1));
}
