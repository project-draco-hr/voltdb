{
  int size=1 + 4 + procName.length()+ 8;
  if (type == ProcedureInvocationType.REPLICATED) {
    size+=8 + 8;
  }
  if (serializedParams != null) {
    size+=serializedParams.remaining();
  }
 else   if (params != null) {
    ParameterSet pset=getParams();
    assert(pset != null);
    int serializedSize=pset.getSerializedSize();
    if ((pset.toArray().length > 0) && (serializedSize <= 2)) {
      throw new IllegalStateException(String.format("Parameter set for invocation " + "%s doesn't have the proper size (currently = %s)",getProcName(),serializedSize));
    }
    size+=pset.getSerializedSize();
  }
  return size;
}
