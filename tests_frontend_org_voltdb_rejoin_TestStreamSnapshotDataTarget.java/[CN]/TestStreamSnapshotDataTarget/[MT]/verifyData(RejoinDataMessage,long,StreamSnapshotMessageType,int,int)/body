{
  assertEquals(targetId,msg.getTargetId());
  ByteBuffer data=ByteBuffer.wrap(CompressionService.decompressBytes(msg.getData()));
  assertEquals(type.ordinal(),data.get(StreamSnapshotBase.typeOffset));
  if (type != StreamSnapshotMessageType.END && type != StreamSnapshotMessageType.FAILURE) {
    assertEquals(tableId,data.getInt(StreamSnapshotBase.tableIdOffset));
    if (type == StreamSnapshotMessageType.DATA) {
      assertEquals(blockIndex,data.getInt(StreamSnapshotBase.blockIndexOffset));
    }
  }
}
