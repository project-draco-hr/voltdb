{
  assertEquals(targetId,msg.getTargetId());
  ByteBuffer data=ByteBuffer.wrap(CompressionService.decompressBytes(msg.getData()));
  assertEquals(type.ordinal(),data.get(StreamSnapshotBase.typeOffset));
  assertEquals(blockIndex,data.getInt(StreamSnapshotBase.blockIndexOffset));
  if (type == StreamSnapshotMessageType.SCHEMA || type == StreamSnapshotMessageType.DATA) {
    assertEquals(tableId,data.getInt(StreamSnapshotBase.tableIdOffset));
  }
}
