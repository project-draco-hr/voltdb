{
  String errorMessage="Every derived table must have its own alias.";
  failToCompile("select C FROM (SELECT C FROM R1)  ",errorMessage);
  String errorJoinMsg="Join of multiple partitioned tables has insufficient join criteria.";
  failToCompile("select A, C FROM (SELECT A FROM P1) T1, (SELECT C FROM P2) T2 WHERE T1.A = T2.C ",errorJoinMsg);
  failToCompile("select D1, D2 FROM (SELECT A, D D1 FROM P1 ) T1, (SELECT A, D D2 FROM P2 ) T2 WHERE T1.A = T2.A",errorJoinMsg);
  failToCompile("select D1, P2.D FROM (SELECT A, D D1 FROM P1 WHERE A=1) T1, P2 WHERE T1.A = P2.A AND P2.A = 1",errorJoinMsg);
  failToCompile("select D1, D2 FROM (SELECT A, D D1 FROM P1 WHERE A=2) T1, (SELECT A, D D2 FROM P2 WHERE A=2) T2",errorJoinMsg);
  failToCompile("select D1, D2 FROM " + "(SELECT A, D D1 FROM P1) T1, (SELECT A, D D2 FROM P2) T2 WHERE T1.A = 1 AND T2.A = 2",errorJoinMsg);
  String tmpErrorMsg="Subqueries on partitioned data are only supported in single partition stored procedures.";
  failToCompile("select * from p2, (select * from (SELECT A, D D1 FROM P1) T1) T2 where p2.D= T2.D1",tmpErrorMsg);
  failToCompile("select * from p2, (select * from (SELECT A, D D1 FROM P1 WHERE A=2) T1) T2 where p2.D = T2.D1",tmpErrorMsg);
  failToCompile("select A FROM (SELECT A FROM P1) T1",tmpErrorMsg);
  failToCompile("select A FROM (SELECT R1.A FROM R1, P1 where R1.A=P1.A) T1",tmpErrorMsg);
}
