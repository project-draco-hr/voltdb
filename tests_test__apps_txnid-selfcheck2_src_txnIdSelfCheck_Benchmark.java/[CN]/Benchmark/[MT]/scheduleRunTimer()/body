{
  runTimer=new Timer("Run Timer",true);
  TimerTask runEndTask=new TimerTask(){
    @Override public void run(){
      log.info(HORIZONTAL_RULE);
      log.info("Benchmark Complete");
      int exitcode=0;
      int lpcc=partBiglt.getPercentLoadComplete();
      if (!partBiglt.isAlive() && lpcc < 100) {
        exitcode=reportDeadThread(partBiglt," yet only " + Integer.toString(lpcc) + "% rows have been loaded");
      }
 else       log.info(partBiglt + " was at " + lpcc+ "% of rows loaded");
      lpcc=replBiglt.getPercentLoadComplete();
      if (!replBiglt.isAlive() && lpcc < 100) {
        exitcode=reportDeadThread(replBiglt," yet only " + Integer.toString(lpcc) + "% rows have been loaded");
      }
 else       log.info(replBiglt + " was at " + lpcc+ "% of rows loaded");
      if (!partTrunclt.isAlive())       exitcode=reportDeadThread(partTrunclt);
      if (!replTrunclt.isAlive())       exitcode=reportDeadThread(replTrunclt);
      if (!readThread.isAlive())       exitcode=reportDeadThread(readThread);
      if (!config.disableadhoc && !adHocMayhemThread.isAlive())       exitcode=reportDeadThread(adHocMayhemThread);
      if (!idpt.isAlive())       exitcode=reportDeadThread(idpt);
      for (      ClientThread ct : clientThreads) {
        if (!ct.isAlive()) {
          exitcode=reportDeadThread(ct);
        }
      }
      timer.cancel();
      checkpointTimer.cancel();
      long count=txnCount.get();
      log.info("Client thread transaction count: " + count + "\n");
      if (exitcode > 0 && txnCount.get() == 0) {
        System.err.println("Shutting down, but found that no work was done.");
        exitcode=2;
      }
      System.exit(exitcode);
    }
  }
;
  runTimer.schedule(runEndTask,config.duration * 1000);
}
