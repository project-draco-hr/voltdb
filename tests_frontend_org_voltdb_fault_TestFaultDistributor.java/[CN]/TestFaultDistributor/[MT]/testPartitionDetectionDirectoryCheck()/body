{
  MockVoltDB voltdb=m_voltdb;
  FaultDistributor dut=new FaultDistributor(voltdb,true);
  voltdb.setFaultDistributor(dut);
  VoltDB.replaceVoltDBInstanceForTest(voltdb);
  SnapshotSchedule schedule=new SnapshotSchedule();
  File badpath=new File("/tmp/doesnotexists");
  badpath.delete();
  schedule.setPath(badpath.getCanonicalPath());
  schedule.setPrefix("foo");
  assertFalse(dut.testPartitionDetectionDirectory(schedule));
  assertTrue(badpath.createNewFile());
  assertFalse(dut.testPartitionDetectionDirectory(schedule));
  assertTrue(badpath.delete());
  assertTrue(badpath.mkdir());
  badpath.setWritable(false);
  badpath.setExecutable(false);
  badpath.setReadable(false);
  assertFalse(dut.testPartitionDetectionDirectory(schedule));
  badpath.setWritable(true);
  badpath.setExecutable(true);
  badpath.setReadable(true);
  assertTrue(dut.testPartitionDetectionDirectory(schedule));
}
