{
  MockVoltDB voltdb=new MockVoltDB();
  voltdb.addHost(0);
  voltdb.addHost(1);
  FaultDistributor dut=new FaultDistributor(voltdb,true);
  MockFaultHandler nodeFaultHdlr=new MockFaultHandler(FaultType.NODE_FAILURE);
  MockFaultHandler clusterPartHdlr=new MockFaultHandler(FaultType.CLUSTER_PARTITION);
  dut.registerFaultHandler(FaultType.NODE_FAILURE,nodeFaultHdlr,1);
  dut.registerFaultHandler(FaultType.CLUSTER_PARTITION,clusterPartHdlr,2);
  dut.reportFault(new NodeFailureFault(0,"hostname"));
  clusterPartHdlr.m_handledFaults.acquire();
  assertTrue(clusterPartHdlr.m_gotFault);
  assertFalse(nodeFaultHdlr.m_handledFaults.tryAcquire());
  ClusterPartitionFault cpf=new ClusterPartitionFault(new NodeFailureFault(0,"ignored"));
  dut.reportFaultCleared(cpf);
  clusterPartHdlr.m_clearedFaults.acquire();
  assertFalse(nodeFaultHdlr.m_clearedFaults.tryAcquire());
}
