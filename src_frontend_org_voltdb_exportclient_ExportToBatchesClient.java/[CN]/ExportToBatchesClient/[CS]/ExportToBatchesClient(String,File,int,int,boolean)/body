{
  super(useAdminPorts);
  m_nonce=nonce;
  m_outDir=outdir;
  m_tableDecoders=new HashMap<Long,HashMap<String,ExportToBatchDecoder>>();
  m_period=period;
  m_firstfield=firstfield;
  assert(m_current == null);
  m_current=new ExportBatch(outdir.getPath(),m_nonce,new Date());
  TimerTask rotateTask=new TimerTask(){
    @Override public void run(){
      roll(new Date());
    }
  }
;
  m_timer.scheduleAtFixedRate(rotateTask,1000 * 60 * m_period,1000 * 60 * m_period);
}
