{
  try {
    if (m_writer != null) {
      m_writer.flush();
      m_writer.close();
      m_writer=null;
    }
  }
 catch (  Exception e) {
    m_logger.error(e.getMessage());
    throw new RuntimeException();
  }
 finally {
    if (m_batch != null)     m_batch.decref(this);
  }
  HashMap<String,ExportToBatchDecoder> decoders=m_tableDecoders.get(m_generation);
  decoders.remove(m_tableName);
  if (decoders.isEmpty()) {
    m_tableDecoders.remove(m_generation);
  }
}
