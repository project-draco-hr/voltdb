{
  m_batch=getCurrentBatchAndAddref(this);
  if (m_batch == null) {
    m_logger.error("NULL batch object found.");
    throw new RuntimeException("NULL batch object found.");
  }
  m_writer=m_batch.getWriter(m_filename);
  if (m_writer == null) {
    m_logger.error("NULL writer object from batch.");
    throw new RuntimeException("NULL writer object from batch.");
  }
  String schemaPath=m_tableName + "-" + String.valueOf(m_generation)+ "-schema.json";
  m_batch.writeSchema(schemaPath,m_schemaString);
}
