{
  if (isReadOnly())   throw new IllegalStateException(__READONLY);
  if (index < 0)   throw new IllegalArgumentException("index<0: " + index + "<0");
  if (index + length > capacity()) {
    length=capacity() - index;
    if (length < 0)     throw new IllegalArgumentException("index>capacity(): " + index + ">"+ capacity());
  }
  try {
    _buf.position(index);
    int space=_buf.remaining();
    if (length > space)     length=space;
    if (length > 0)     _buf.put(b,offset,length);
    return length;
  }
  finally {
    _buf.position(0);
  }
}
