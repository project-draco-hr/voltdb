{
  boolean validVoter=false;
  boolean validContestant=false;
  int returnValue=0;
  voltQueueSQL(checkContestant,contestantNumber);
  voltQueueSQL(checkVoter,phoneNumber);
  VoltTable resultsCheck[]=voltExecuteSQL();
  if (resultsCheck[0].getRowCount() > 0) {
    validContestant=true;
    if (resultsCheck[1].getRowCount() == 0) {
      validVoter=true;
    }
 else     if (resultsCheck[1].fetchRow(0).getLong(0) < maxVotesPerPhoneNumber) {
      validVoter=true;
    }
  }
  if (validContestant && validVoter) {
    voltQueueSQL(insertVote,phoneNumber,contestantNumber);
    VoltTable results2[]=voltExecuteSQL();
    returnValue=0;
  }
 else   if (!validContestant) {
    returnValue=1;
  }
 else {
    returnValue=2;
  }
  VoltTable vtLoad=new VoltTable(new VoltTable.ColumnInfo("return_value",VoltType.INTEGER),new VoltTable.ColumnInfo("called_time_milliseconds",VoltType.BIGINT));
  Object row[]=new Object[2];
  row[0]=returnValue;
  row[1]=called_time_milliseconds;
  vtLoad.addRow(row);
  final VoltTable[] vtReturn={vtLoad};
  return vtReturn;
}
