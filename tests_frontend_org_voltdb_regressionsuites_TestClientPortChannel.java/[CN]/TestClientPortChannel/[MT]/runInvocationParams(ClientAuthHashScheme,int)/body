{
  PortConnector channel=new PortConnector("localhost",port);
  channel.connect();
  if (scheme == ClientAuthHashScheme.HASH_SHA1)   login(channel);
 else   loginSha2(channel);
  final byte ERROR_CODE=(byte)-2;
  byte i1[]=VAR2.clone();
  verifyInvocation(i1,channel,ERROR_CODE);
  byte i2[]=VAR2.clone();
  updateShortBytes(i2,Short.MAX_VALUE);
  verifyInvocation(i2,channel,ERROR_CODE);
  updateShortBytes(i2,(short)-1);
  verifyInvocation(i2,channel,ERROR_CODE);
  updateShortBytes(i2,(short)4);
  verifyInvocation(i2,channel,ERROR_CODE);
  updateShortBytes(i2,(short)9);
  verifyInvocation(i2,channel,ERROR_CODE);
  byte i3[]={0,0,0,0,8,'A','.','i','n','s','e','r','t',0,0,0,0,0,0,0,0,0,0,9};
  updateShortBytes(i3,(short)1);
  verifyInvocation(i3,channel,ERROR_CODE);
  byte i4[]={0,0,0,0,8,'A','.','i','n','s','e','r','t',0,0,0,0,0,0,0,0,0,0,9,0,0,0,0};
  updateShortBytes(i4,(short)1);
  updateIntBytes(i4,8,24);
  verifyInvocation(i4,channel,ERROR_CODE);
  byte i5[]={0,0,0,0,8,'A','.','i','n','s','e','r','t',0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,'v','o','l','t','d','b'};
  updateShortBytes(i5,(short)1);
  updateIntBytes(i5,6,24);
  verifyInvocation(i5,channel,(byte)1);
  byte i6[]={0,0,0,0,8,'A','.','i','n','s','e','r','t',0,0,0,0,0,0,0,0,0,0,-99};
  updateShortBytes(i6,(short)1);
  verifyInvocation(i6,channel,ERROR_CODE);
  byte i61[]={0,0,0,0,8,'A','.','i','n','s','e','r','t',0,0,0,0,0,0,0,0,0,0,-99,70};
  updateShortBytes(i61,(short)1);
  verifyInvocation(i61,channel,ERROR_CODE);
  byte i62[]={0,0,0,0,8,'A','.','i','n','s','e','r','t',0,0,0,0,0,0,0,0,0,0,-99,-99};
  updateShortBytes(i62,(short)1);
  verifyInvocation(i62,channel,ERROR_CODE);
  byte i63[]={0,0,0,0,8,'A','.','i','n','s','e','r','t',0,0,0,0,0,0,0,0,0,0,-99,9};
  updateShortBytes(i63,(short)1);
  verifyInvocation(i63,channel,ERROR_CODE);
  byte i631[]={0,0,0,0,8,'A','.','i','n','s','e','r','t',0,0,0,0,0,0,0,0,0,0,-99,9,0,0,0,0};
  updateShortBytes(i631,(short)1);
  updateIntBytes(i631,Integer.MAX_VALUE,i631.length - 4);
  verifyInvocation(i631,channel,ERROR_CODE);
  byte i64[]={0,0,0,0,8,'A','.','i','n','s','e','r','t',0,0,0,0,0,0,0,0,0,0,-99,6};
  updateShortBytes(i64,(short)1);
  verifyInvocation(i64,channel,ERROR_CODE);
  byte i65[]={0,0,0,0,8,'A','.','i','n','s','e','r','t',0,0,0,0,0,0,0,0,0,0,-99,6,'A'};
  updateShortBytes(i65,(short)1);
  verifyInvocation(i65,channel,ERROR_CODE);
  byte i7[]={0,0,0,0,8,'A','.','i','n','s','e','r','t',0,0,0,0,0,0,0,0,0,0,70};
  updateShortBytes(i7,(short)1);
  verifyInvocation(i7,channel,ERROR_CODE);
  byte i71[]={0,0,0,0,8,'A','.','i','n','s','e','r','t',0,0,0,0,0,0,0,0,0,0,26};
  updateShortBytes(i71,(short)1);
  verifyInvocation(i71,channel,ERROR_CODE);
  System.out.println("Testing good Ping invocation Again");
  byte pingr[]=VAR1.clone();
  verifyInvocation(pingr,channel,(byte)1);
  verifyInvocation(i5,channel,(byte)1);
  channel.close();
}
