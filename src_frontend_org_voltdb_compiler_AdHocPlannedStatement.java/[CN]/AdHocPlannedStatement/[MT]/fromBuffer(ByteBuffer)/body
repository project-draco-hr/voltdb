{
  CorePlan core=CorePlan.fromBuffer(buf);
  short sqlLength=buf.getShort();
  if (sqlLength < 0) {
    throw new RuntimeException("AdHoc SQL text exceeds the length limitation " + Short.MAX_VALUE);
  }
  byte[] sql=new byte[sqlLength];
  buf.get(sql);
  ParameterSet parameterSet=ParameterSet.fromByteBuffer(buf);
  return new AdHocPlannedStatement(sql,core,parameterSet,null);
}
