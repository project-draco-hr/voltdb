{
  byte[] sql=new byte[buf.getShort()];
  buf.get(sql);
  byte[] aggregatorFragment=new byte[buf.getInt()];
  buf.get(aggregatorFragment);
  byte[] collectorFragment=null;
  int cflen=buf.getInt();
  if (cflen >= 0) {
    collectorFragment=new byte[cflen];
    buf.get(collectorFragment);
  }
  boolean isReplicatedTableDML=buf.get() == 1;
  boolean isNonDeterministic=buf.get() == 1;
  boolean isReadOnly=buf.get() == 1;
  int catalogVersion=buf.getInt();
  short paramCount=buf.getShort();
  VoltType[] paramTypes=new VoltType[paramCount];
  for (int i=0; i < paramCount; ++i) {
    paramTypes[i]=VoltType.get(buf.get());
  }
  ParameterSet parameterSet=new ParameterSet();
  FastDeserializer fds=new FastDeserializer(buf);
  parameterSet.readExternal(fds);
  return new AdHocPlannedStatement(sql,aggregatorFragment,collectorFragment,isReplicatedTableDML,isNonDeterministic,isReadOnly,paramTypes,parameterSet,catalogVersion);
}
