{
  TxnEgo sphandle=TxnEgo.makeZero(0);
  UniqueIdGenerator uig=new UniqueIdGenerator(0,0);
  UniqueIdGenerator buig=new UniqueIdGenerator(0,0);
  sphandle=sphandle.makeNext();
  RandomMsgGenerator msgGen=new RandomMsgGenerator();
  RepairLog dut=new RepairLog();
  long binaryLogUniqueId=Long.MIN_VALUE;
  for (int i=0; i < 4000; i++) {
    TransactionInfoBaseMessage msg=msgGen.generateRandomMessageInStream();
    msg.setSpHandleAndSpUniqueId(sphandle.getTxnId(),uig.getNextUniqueId());
    binaryLogUniqueId=Math.max(binaryLogUniqueId,setBinaryLogUniqueId(msg,buig));
    sphandle=sphandle.makeNext();
    if (!msg.isReadOnly() || msg instanceof CompleteTransactionMessage) {
      dut.deliver(msg);
    }
  }
  List<Iv2RepairLogResponseMessage> stuff=dut.contents(1l,false);
  validateRepairLog(stuff,binaryLogUniqueId);
  stuff=dut.contents(1l,true);
  validateRepairLog(stuff,binaryLogUniqueId);
}
