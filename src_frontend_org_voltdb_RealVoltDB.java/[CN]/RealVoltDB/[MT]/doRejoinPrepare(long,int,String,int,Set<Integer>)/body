{
  if (currentTxnId == lastNodeRejoinPrepare_txnId) {
    return null;
  }
 else   if (currentTxnId < lastNodeRejoinPrepare_txnId) {
    throw new RuntimeException("Trying to rejoin (prepare) with an old transaction.");
  }
  byte[] catalogBytes=null;
  try {
    catalogBytes=m_catalogContext.getCatalogJarBytes();
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  InetSocketAddress addr=new InetSocketAddress(rejoiningHostname,portToConnect);
  String ipAddr=addr.getAddress().toString();
  consoleLog.info("Rejoining node with host id: " + rejoinHostId + ", hostname: "+ ipAddr+ " at txnid: "+ currentTxnId);
  lastNodeRejoinPrepare_txnId=currentTxnId;
  HostMessenger messenger=getHostMessenger();
  try {
    messenger.rejoinForeignHostPrepare(rejoinHostId,addr,0,m_catalogContext.deploymentCRC,liveHosts,m_commandLog.getFaultSequenceNumber(),m_catalogContext.catalogVersion,m_catalogContext.m_transactionId,catalogBytes);
    return null;
  }
 catch (  Exception e) {
    return e.getMessage() == null ? e.getClass().getName() : e.getMessage();
  }
}
