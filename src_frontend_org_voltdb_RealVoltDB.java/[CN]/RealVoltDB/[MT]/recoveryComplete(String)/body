{
  assert(m_rejoinDataPending == false);
  if (m_rejoining) {
    if (requestId.equals(m_rejoinTruncationReqId)) {
      String actionName=m_joining ? "join" : "rejoin";
      consoleLog.info(String.format("Node %s completed",actionName));
      m_rejoinTruncationReqId=null;
      m_rejoining=false;
    }
 else {
      try {
        final ZooKeeper zk=m_messenger.getZK();
        if (m_rejoinTruncationReqId == null) {
          m_rejoinTruncationReqId=java.util.UUID.randomUUID().toString();
        }
        zk.create(VoltZK.request_truncation_snapshot,m_rejoinTruncationReqId.getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
      }
 catch (      KeeperException.NodeExistsException e) {
      }
catch (      Exception e) {
        VoltDB.crashLocalVoltDB("Unable to retry post-rejoin truncation snapshot request.",true,e);
      }
    }
  }
}
