{
  if (!m_executionSitesRecovered || !m_agreementSiteRecovered) {
    return;
  }
  try {
    m_testBlockRecoveryCompletion.acquire();
  }
 catch (  InterruptedException e) {
  }
  final long delta=((m_executionSiteRecoveryFinish - m_recoveryStartTime) / 1000);
  final long megabytes=m_executionSiteRecoveryTransferred / (1024 * 1024);
  final double megabytesPerSecond=megabytes / ((m_executionSiteRecoveryFinish - m_recoveryStartTime) / 1000.0);
  for (  ClientInterface intf : getClientInterfaces()) {
    intf.mayActivateSnapshotDaemon();
  }
  hostLog.info("Node data recovery completed after " + delta + " seconds with "+ megabytes+ " megabytes transferred at a rate of "+ megabytesPerSecond+ " megabytes/sec");
  try {
    boolean logRecoveryCompleted=false;
    try {
      m_zk.create("/unfaulted_hosts",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    }
 catch (    KeeperException.NodeExistsException e) {
    }
    if (getCommandLog().getClass().getName().equals("org.voltdb.CommandLogImpl")) {
      try {
        m_zk.create("/request_truncation_snapshot",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
      }
 catch (      KeeperException.NodeExistsException e) {
      }
    }
 else {
      logRecoveryCompleted=true;
    }
    ByteBuffer txnIdBuffer=ByteBuffer.allocate(8);
    txnIdBuffer.putLong(TransactionIdManager.makeIdFromComponents(System.currentTimeMillis(),0,1));
    m_zk.create("/unfaulted_hosts/" + m_messenger.getHostId(),txnIdBuffer.array(),Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL);
    if (logRecoveryCompleted) {
      m_recovering=false;
      hostLog.info("Node recovery completed");
    }
  }
 catch (  Exception e) {
    hostLog.fatal("Unable to log host recovery completion to ZK",e);
    VoltDB.crashVoltDB();
  }
  hostLog.info("Logging host recovery completion to ZK");
}
