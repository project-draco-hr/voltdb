{
  ZooKeeper zk=m_messenger.getZK();
  while (true) {
    try {
      zk.create(VoltZK.rejoin_barrier,null,Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL);
      break;
    }
 catch (    KeeperException.NoNodeException e) {
      hostLog.info("Unable to create rejoin barrier, will retry in 5 seconds");
      try {
        Thread.sleep(1000);
      }
 catch (      InterruptedException e1) {
        throw new RuntimeException(e);
      }
    }
catch (    Exception e) {
      throw new RuntimeException(e);
    }
    new Thread("Rejoin watchdog"){
      @Override public void run(){
        try {
          if (!rejoinCompleted.await(1,TimeUnit.MINUTES)) {
            VoltDB.crashLocalVoltDB("Rejoin watchdog timed out rejoin after 60 seconds",false,null);
          }
        }
 catch (        InterruptedException e) {
          e.printStackTrace();
        }
      }
    }
.start();
  }
}
