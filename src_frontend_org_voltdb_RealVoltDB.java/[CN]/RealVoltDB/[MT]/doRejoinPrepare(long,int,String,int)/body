{
  if (currentTxnId == lastNodeRejoinPrepare_txnId) {
    return null;
  }
 else   if (currentTxnId < lastNodeRejoinPrepare_txnId) {
    throw new RuntimeException("Trying to rejoin (prepare) with an old transaction.");
  }
  System.out.printf("Rejoining node with host id: %s at txnid: %d\n",0,currentTxnId);
  lastNodeRejoinPrepare_txnId=currentTxnId;
  HostMessenger messenger=getHostMessenger();
  InetSocketAddress addr=new InetSocketAddress(rejoiningHostname,portToConnect);
  try {
    messenger.rejoinForeignHostPrepare(rejoinHostId,addr);
    return null;
  }
 catch (  Exception e) {
    e.printStackTrace();
    return e.getMessage();
  }
}
