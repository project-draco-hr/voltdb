{
  if (currentTxnId == lastNodeRejoinPrepare_txnId) {
    return null;
  }
 else   if (currentTxnId < lastNodeRejoinPrepare_txnId) {
    throw new RuntimeException("Trying to rejoin (prepare) with an old transaction.");
  }
  System.out.printf("Rejoining node with host id: %d at txnid: %d\n",rejoinHostId,currentTxnId);
  lastNodeRejoinPrepare_txnId=currentTxnId;
  HostMessenger messenger=getHostMessenger();
  InetSocketAddress addr=new InetSocketAddress(rejoiningHostname,portToConnect);
  try {
    messenger.rejoinForeignHostPrepare(rejoinHostId,addr,m_catalogContext.catalogCRC,liveHosts,m_catalogContext.catalogVersion);
    return null;
  }
 catch (  Exception e) {
    return e.getMessage() == null ? e.getClass().getName() : e.getMessage();
  }
}
