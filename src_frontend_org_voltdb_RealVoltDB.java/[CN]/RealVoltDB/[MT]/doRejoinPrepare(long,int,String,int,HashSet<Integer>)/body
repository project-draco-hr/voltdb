{
  if (currentTxnId == lastNodeRejoinPrepare_txnId) {
    return null;
  }
 else   if (currentTxnId < lastNodeRejoinPrepare_txnId) {
    throw new RuntimeException("Trying to rejoin (prepare) with an old transaction.");
  }
  recoveryLog.info("Rejoining node with host id: " + rejoinHostId + " at txnid: "+ currentTxnId);
  lastNodeRejoinPrepare_txnId=currentTxnId;
  HostMessenger messenger=getHostMessenger();
  InetSocketAddress addr=new InetSocketAddress(rejoiningHostname,portToConnect);
  try {
    messenger.rejoinForeignHostPrepare(rejoinHostId,addr,m_catalogContext.catalogCRC,m_catalogContext.deploymentCRC,liveHosts,m_catalogContext.catalogVersion,m_catalogContext.m_transactionId);
    return null;
  }
 catch (  Exception e) {
    return e.getMessage() == null ? e.getClass().getName() : e.getMessage();
  }
}
