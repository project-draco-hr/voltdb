{
synchronized (m_catalogUpdateLock) {
    if (currentTxnId == lastCatalogUpdate_txnId) {
      return;
    }
 else     if (currentTxnId < lastCatalogUpdate_txnId) {
      throw new RuntimeException("Trying to update main catalog context with an old transaction.");
    }
 else     if (m_catalogContext.catalog.getCatalogVersion() != expectedCatalogVersion) {
      throw new RuntimeException("Trying to update main catalog context with diff " + "commands generated for an out-of date catalog. Expected catalog version: " + expectedCatalogVersion + " does not match actual version: "+ m_catalogContext.catalog.getCatalogVersion());
    }
    lastCatalogUpdate_txnId=currentTxnId;
    m_catalogContext=m_catalogContext.update(newCatalogURL,diffCommands);
    ELTManager.instance().updateCatalog(m_catalogContext);
    for (    ClientInterface ci : m_clientInterfaces)     ci.notifyOfCatalogUpdate();
  }
}
