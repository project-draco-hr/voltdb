{
  m_logger.info("Num data sources is " + elConnection.dataSources.size());
  m_logger.info("Processing data sources for connection " + elConnection);
  for (  AdvertisedDataSource source : elConnection.dataSources) {
    ExportDataSink sink=null;
    String table_signature=source.signature;
    int part_id=source.partitionId;
    HashMap<String,HashMap<Integer,ExportDataSink>> gen_map=m_sinks.get(source.m_generation);
    if (gen_map == null) {
      gen_map=new HashMap<String,HashMap<Integer,ExportDataSink>>();
      m_sinks.put(source.m_generation,gen_map);
    }
    HashMap<Integer,ExportDataSink> part_map=gen_map.get(table_signature);
    if (part_map == null) {
      part_map=new HashMap<Integer,ExportDataSink>();
      gen_map.put(table_signature,part_map);
    }
    if (!part_map.containsKey(part_id)) {
      m_logger.info("Creating decoder for generation " + source.m_generation + " table: "+ source.tableName+ ", table ID, "+ source.signature+ " part ID: "+ source.partitionId);
      ExportDecoderBase decoder=constructExportDecoder(source);
      sink=new ExportDataSink(source.m_generation,source.partitionId,source.signature,source.tableName,decoder);
      part_map.put(part_id,sink);
    }
 else {
    }
    sink=part_map.get(part_id);
    m_logger.info("Providing connection " + elConnection.name + " for table id "+ source.signature+ " to sink "+ sink);
    sink.addExportConnection(elConnection.name,source.systemStartTimestamp);
  }
}
