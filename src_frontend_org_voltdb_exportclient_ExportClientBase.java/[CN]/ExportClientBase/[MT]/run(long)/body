{
  long pollTimeMS=0;
  long now=System.currentTimeMillis();
  while ((System.currentTimeMillis() - now) < timeout) {
    int offeredMsgs=0;
    try {
      offeredMsgs=work();
    }
 catch (    IOException e) {
      e.printStackTrace();
    }
    pollTimeMS=getNextPollDuration(pollTimeMS,offeredMsgs == 0);
    if (pollTimeMS > 0) {
      try {
        Thread.sleep(pollTimeMS);
      }
 catch (      InterruptedException e) {
      }
    }
  }
}
