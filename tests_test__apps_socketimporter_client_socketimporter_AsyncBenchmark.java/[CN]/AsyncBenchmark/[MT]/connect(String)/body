{
  System.out.println("Connecting to Socket Streaming Interface...");
  String[] serverArray=servers.split(",");
  final CountDownLatch connections=new CountDownLatch(serverArray.length);
  for (  final String server : serverArray) {
    new Thread(new Runnable(){
      @Override public void run(){
        int port=7001;
        HostAndPort hap=HostAndPort.fromString(server);
        if (hap.hasPort()) {
          port=hap.getPort();
        }
        OutputStream writer=connectToOneServerWithRetry(hap.getHostText(),port);
        haplist.put(hap,writer);
        connections.countDown();
      }
    }
).start();
  }
  connections.await();
}
