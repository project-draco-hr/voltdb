def close(self):
    if self.output_zip:
        try:
            self.output_zip.writestr(Global.manifest_path, '\n'.join(self.manifest))
        except (IOError, OSError) as e:
            self._abort(('Failed to write %s.' % Global.manifest_path), e)
        self.output_zip.close()
