{
  rejoinLog.trace("Starting ack receiver thread");
  try {
    while (!m_closed.get()) {
      rejoinLog.trace("Blocking on receiving mailbox");
      VoltMessage msg=m_mb.recvBlocking(5000);
      if (msg == null)       continue;
      assert(msg instanceof RejoinDataAckMessage);
      RejoinDataAckMessage ackMsg=(RejoinDataAckMessage)msg;
      final int blockIndex=ackMsg.getBlockIndex();
      if (m_rejoinDeathTestMode && (m_snapshotProcessorId == 1)) {
        continue;
      }
      receiveAck(blockIndex);
    }
  }
 catch (  Exception e) {
    if (m_closed.get()) {
      return;
    }
    m_lastAckReceiverException=e;
    rejoinLog.error("Error reading a message from a recovery stream",e);
  }
 finally {
    rejoinLog.trace("Ack receiver thread exiting");
  }
}
