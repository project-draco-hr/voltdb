{
  if (m_closed.get()) {
    return;
  }
  long bytesWritten=m_sender.m_bytesSent.get(m_targetId).get();
  rejoinLog.info(String.format("While sending rejoin data to site %s, %d bytes have been sent in the past %s seconds.",CoreUtils.hsIdToString(m_destHSId),bytesWritten - m_bytesWrittenSinceConstruction,WATCHDOG_PERIOS_S));
  long now=System.currentTimeMillis();
  for (  Entry<Integer,SendWork> e : m_outstandingWork.entrySet()) {
    SendWork work=e.getValue();
    if ((now - work.m_ts) > m_writeTimeout) {
      IOException exception=new IOException(String.format("A snapshot write task failed after a timeout (currently %d seconds outstanding). " + "Node rejoin may need to be retried",(now - work.m_ts) / 1000));
      rejoinLog.error(exception.getMessage());
      m_writeFailed.compareAndSet(null,exception);
      break;
    }
  }
  if (m_writeFailed.get() != null) {
    clearOutstanding();
  }
  VoltDB.instance().scheduleWork(new Watchdog(bytesWritten,m_writeTimeout),WATCHDOG_PERIOS_S,-1,TimeUnit.SECONDS);
}
