{
  if (m_closed.get()) {
    return;
  }
  long now=System.currentTimeMillis();
  for (  Entry<Integer,SendWork> e : m_outstandingWork.entrySet()) {
    SendWork work=e.getValue();
    if ((now - work.m_ts) > WRITE_TIMEOUT_MS) {
      rejoinLog.warn(String.format("A snapshot write task failed after a timeout (currently %d seconds outstanding).",(now - work.m_ts) / 1000));
      m_writeFailed.set(true);
    }
  }
  if (m_writeFailed.get()) {
    clearOutstanding();
  }
  VoltDB.instance().scheduleWork(new Watchdog(),WATCHDOG_PERIOS_S,-1,TimeUnit.SECONDS);
}
