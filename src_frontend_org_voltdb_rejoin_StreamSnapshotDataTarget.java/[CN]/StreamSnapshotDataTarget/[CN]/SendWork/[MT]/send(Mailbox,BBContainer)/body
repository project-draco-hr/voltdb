{
  if (message.b.isDirect()) {
    byte[] data=CompressionService.compressBuffer(message.b);
    RejoinDataMessage msg=new RejoinDataMessage(m_targetId,data);
    mb.send(m_destHSId,msg);
    if (rejoinLog.isTraceEnabled()) {
      rejoinLog.trace("Sending direct buffer");
    }
    return data.length;
  }
 else {
    byte compressedBytes[]=CompressionService.compressBytes(message.b.array(),message.b.position(),message.b.remaining());
    RejoinDataMessage msg=new RejoinDataMessage(m_targetId,compressedBytes);
    mb.send(m_destHSId,msg);
    if (rejoinLog.isTraceEnabled()) {
      rejoinLog.trace("Sending heap buffer");
    }
    return compressedBytes.length;
  }
}
