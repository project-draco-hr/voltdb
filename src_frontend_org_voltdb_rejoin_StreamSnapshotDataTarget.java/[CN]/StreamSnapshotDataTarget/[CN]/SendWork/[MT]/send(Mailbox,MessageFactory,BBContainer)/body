{
  if (message.b().isDirect()) {
    byte[] data=CompressionService.compressBuffer(message.b());
    mb.send(m_destHSId,msgFactory.makeDataMessage(m_targetId,data));
    if (rejoinLog.isTraceEnabled()) {
      rejoinLog.trace("Sending direct buffer");
    }
    return data.length;
  }
 else {
    byte compressedBytes[]=CompressionService.compressBytes(message.b().array(),message.b().position(),message.b().remaining());
    mb.send(m_destHSId,msgFactory.makeDataMessage(m_targetId,compressedBytes));
    if (rejoinLog.isTraceEnabled()) {
      rejoinLog.trace("Sending heap buffer");
    }
    return compressedBytes.length;
  }
}
