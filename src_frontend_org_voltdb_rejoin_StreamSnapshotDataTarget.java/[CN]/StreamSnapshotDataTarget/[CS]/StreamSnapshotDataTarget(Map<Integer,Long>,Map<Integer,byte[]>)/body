{
  super();
  long hsId=streamMap.values().iterator().next();
  m_schemas=schemas;
  m_destHSId=hsId;
  m_mb=VoltDB.instance().getHostMessenger().createMailbox();
  m_snapshotProcessorId=m_totalSnapshotTargetCount.getAndIncrement();
  rejoinLog.info(String.format("Initializing snapshot stream processor " + "for source site id: %s, and with processorid: %d",CoreUtils.hsIdToString(hsId),m_snapshotProcessorId));
  m_in=new AckReceiver();
  m_in.setDaemon(true);
  m_in.start();
  m_out=new SnapshotSender();
  m_out.setDaemon(true);
  m_out.start();
  VoltDB.instance().scheduleWork(new Watchdog(m_bytesSent.get()),WATCHDOG_PERIOS_S,-1,TimeUnit.SECONDS);
}
