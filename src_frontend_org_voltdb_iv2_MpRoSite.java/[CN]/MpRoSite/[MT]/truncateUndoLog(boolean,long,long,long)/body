{
  if (rollback) {
    m_ee.undoUndoToken(beginUndoToken);
  }
 else {
    assert(latestUndoToken != MpRoSite.kInvalidUndoToken);
    assert(latestUndoToken >= beginUndoToken);
    if (latestUndoToken > beginUndoToken) {
      m_ee.releaseUndoToken(latestUndoToken);
    }
    m_lastCommittedTxnId=txnId;
    if (TxnEgo.getPartitionId(m_lastCommittedSpHandle) != TxnEgo.getPartitionId(spHandle)) {
      VoltDB.crashLocalVoltDB("Mismatch SpHandle partitiond id " + TxnEgo.getPartitionId(m_lastCommittedSpHandle) + ", "+ TxnEgo.getPartitionId(spHandle),true,null);
    }
    m_lastCommittedSpHandle=spHandle;
  }
}
