{
  m_logger.info("Starting EL Client socket to: " + serverAddr);
  byte hashedPassword[]=ConnectionUtil.getHashedPassword(m_password);
  Object[] cxndata=ConnectionUtil.getAuthenticatedExportConnection(serverAddr,m_username,hashedPassword);
  m_socket=(SocketChannel)cxndata[0];
  m_socket.socket().setTcpNoDelay(true);
  m_logger.info("Opened socket from " + m_socket.socket().getLocalSocketAddress() + " to "+ m_socket.socket().getRemoteSocketAddress());
  if (m_state == CLOSED) {
    open();
    m_state=CONNECTING;
  }
  while (m_state == CONNECTING) {
    ExportProtoMessage m=nextMessage();
    if (m != null) {
      if (m.isOpenResponse()) {
        Pair<ArrayList<AdvertisedDataSource>,ArrayList<String>> advertisement;
        advertisement=m.getAdvertisedDataSourcesAndNodes();
        dataSources.addAll(advertisement.getFirst());
        hosts.addAll(advertisement.getSecond());
        m_state=CONNECTED;
      }
 else       if (m.isError()) {
        throw new IOException("Open response was an error message");
      }
    }
  }
}
