{
  voltQueueSQL(getCIDData,cid);
  VoltTable data=voltExecuteSQL()[0];
  final long txnid=getTransactionId();
  final long ts=getTransactionTime().getTime();
  long prevtxnid=0;
  long prevrid=0;
  long cnt=0;
  final long cidallhash=MiscUtils.cheesyBufferCheckSum(data.getBuffer());
  int rowCount=data.getRowCount();
  if (rowCount != 0) {
    VoltTableRow row=data.fetchRow(0);
    cnt=row.getLong("cnt") + 1;
    prevtxnid=row.getLong("prevtxnid");
    prevrid=row.getLong("rid");
  }
  data.resetRowPosition();
  long prevCnt=0;
  while (data.advanceRow()) {
    long cntValue=data.getLong("cnt");
    if ((prevCnt > 0) && ((prevCnt - 1) != cntValue)) {
      throw new VoltAbortException(getClass().getName() + " cnt values are not consecutive" + " for cid "+ cid);
    }
    prevCnt=cntValue;
  }
  if (prevrid >= rid) {
    throw new VoltAbortException(getClass().getName() + " previous rid " + prevrid+ " larger than current rid "+ rid+ " for cid "+ cid);
  }
  voltQueueSQL(insert,txnid,prevtxnid,ts,cid,cidallhash,rid,cnt,new byte[0]);
  voltQueueSQL(cleanUp,cid,cnt - 10);
  voltQueueSQL(getCIDData,cid);
  return voltExecuteSQL();
}
