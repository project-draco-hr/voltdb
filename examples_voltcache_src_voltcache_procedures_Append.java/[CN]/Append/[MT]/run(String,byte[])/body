{
  final int now=Shared.init(this,key);
  voltQueueSQL(check,key,now);
  VoltTable checkResult=voltExecuteSQL()[0];
  if (checkResult.getRowCount() == 0)   return VoltCacheResult.NOT_STORED;
  ByteArrayOutputStream stream=new ByteArrayOutputStream();
  try {
    byte[] old=checkResult.fetchRow(0).getVarbinary(1);
    stream.write(old,0,old.length);
    stream.write(value,0,value.length);
    voltQueueSQL(update,stream.toByteArray(),key);
    voltExecuteSQL(true);
    return VoltCacheResult.STORED;
  }
 catch (  Exception x) {
    throw new VoltAbortException(x);
  }
 finally {
    try {
      stream.close();
    }
 catch (    Exception cx) {
    }
  }
}
