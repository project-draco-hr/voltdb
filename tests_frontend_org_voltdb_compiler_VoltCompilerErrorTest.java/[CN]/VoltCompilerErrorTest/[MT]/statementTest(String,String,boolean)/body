{
  String simpleSchema="create table blah (" + "ival bigint default 0 not null, " + "sval varchar(255) not null"+ ");"+ "create table indexed_blah ("+ "ival bigint default 0 not null, "+ "sval varchar(255) not null, "+ "PRIMARY KEY(ival)"+ ");";
  VoltProjectBuilder builder=new VoltProjectBuilder();
  ByteArrayOutputStream capturer=new ByteArrayOutputStream();
  PrintStream capturing=new PrintStream(capturer);
  builder.setCompilerDebugPrintStream(capturing);
  builder.addLiteralSchema(simpleSchema);
  builder.addStmtProcedure(feature,statement);
  boolean success=builder.compile(Configuration.getPathToCatalogForTest("errors.jar"));
  assertEquals(expectError,!success);
  String captured=capturer.toString("UTF-8");
  String[] lines=captured.split("\n");
  assertEquals(expectError,foundLineMatching(lines,".*[Ee]rror.*" + feature + ".*"));
}
