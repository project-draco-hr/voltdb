{
  m_transactionId=transactionId;
  m_timestamp=timestamp;
  assert(catalog != null);
  if (catalog == null)   throw new RuntimeException("Can't create CatalogContext with null catalog.");
  long tempCRC=0;
  if (catalogBytes != null) {
    try {
      m_jarfile=new InMemoryJarfile(catalogBytes);
      tempCRC=m_jarfile.getCRC();
    }
 catch (    Exception e) {
      throw new RuntimeException(e);
    }
    catalogCRC=tempCRC;
  }
 else {
    m_jarfile=null;
    catalogCRC=prevCRC;
  }
  this.catalog=catalog;
  cluster=catalog.getClusters().get("cluster");
  database=cluster.getDatabases().get("database");
  procedures=database.getProcedures();
  tables=database.getTables();
  authSystem=new AuthSystem(database,cluster.getSecurityenabled());
  this.deploymentCRC=deploymentCRC;
  m_jdbc=new JdbcDatabaseMetaDataGenerator(catalog);
  m_ptool=new PlannerTool(cluster,database,version);
  catalogVersion=version;
}
