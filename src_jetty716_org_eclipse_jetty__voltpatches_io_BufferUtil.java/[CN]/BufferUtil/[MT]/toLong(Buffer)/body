{
  long val=0;
  boolean started=false;
  boolean minus=false;
  for (int i=buffer.getIndex(); i < buffer.putIndex(); i++) {
    byte b=buffer.peek(i);
    if (b <= SPACE) {
      if (started)       break;
    }
 else     if (b >= '0' && b <= '9') {
      val=val * 10L + (b - '0');
      started=true;
    }
 else     if (b == MINUS && !started) {
      minus=true;
    }
 else     break;
  }
  if (started)   return minus ? (-val) : val;
  throw new NumberFormatException(buffer.toString());
}
