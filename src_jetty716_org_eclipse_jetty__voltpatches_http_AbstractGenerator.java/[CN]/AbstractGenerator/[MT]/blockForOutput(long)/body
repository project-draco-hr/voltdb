{
  if (_endp.isBlocking()) {
    try {
      flushBuffer();
    }
 catch (    IOException e) {
      _endp.close();
      throw e;
    }
  }
 else {
    if (!_endp.blockWritable(maxIdleTime)) {
      _endp.close();
      throw new EofException("timeout");
    }
    flushBuffer();
  }
}
