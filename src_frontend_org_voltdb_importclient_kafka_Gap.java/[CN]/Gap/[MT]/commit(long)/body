{
  if (offset <= s && offset > c) {
    int ggap=(int)Math.min(lag.length,offset - c);
    if (ggap == lag.length) {
      c=offset - lag.length + 1;
      lag[idx(c)]=c;
    }
    lag[idx(offset)]=offset;
    while (ggap > 0 && lag[idx(c)] + 1 == lag[idx(c + 1)]) {
      ++c;
    }
  }
  return c;
}
