{
  GroupInfo gi[]=new GroupInfo[2];
  gi[0]=new GroupInfo("group1",true,true);
  gi[1]=new GroupInfo("group2",true,true);
  UserInfo ui[]=new UserInfo[2];
  ui[0]=new UserInfo("user1",true,true,"password",new String[]{"group1"});
  ui[1]=new UserInfo("user2",true,true,"password",new String[]{"group2"});
  String original=compileWithGroups(gi,ui,"base",BASEPROCS);
  Catalog catOriginal=catalogForJar(original);
  ui[0]=new UserInfo("user1",true,true,"password",new String[]{"group2"});
  ui[1]=new UserInfo("user2",true,true,"password",new String[]{"group1"});
  String updated=compileWithGroups(gi,ui,"base",BASEPROCS);
  Catalog catUpdated=catalogForJar(updated);
  String updatedSerialized=catUpdated.serialize();
  CatalogDiffEngine diff=new CatalogDiffEngine(catOriginal,catUpdated);
  catOriginal.execute(diff.commands());
  assertTrue(diff.supported());
  String updatedOriginalSerialized=catOriginal.serialize();
  assertEquals(updatedOriginalSerialized,updatedSerialized);
}
