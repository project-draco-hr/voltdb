{
  if (prependDelimiter)   writer.append(m_csvDelimiter);
  if (s.matches(m_csvEscapeMatch)) {
    writer.append("\"");
    for (int ii=0; ii < s.length(); ii++) {
      char c=s.charAt(ii);
switch (c) {
case '"':
        writer.append("\"\"");
      break;
default :
    writer.append(c);
  break;
}
}
writer.append("\"");
}
 else {
writer.append(s);
}
}
