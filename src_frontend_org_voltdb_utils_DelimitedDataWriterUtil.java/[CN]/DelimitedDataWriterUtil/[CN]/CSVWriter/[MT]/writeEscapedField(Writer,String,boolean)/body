{
  if (prependDelimiter)   writer.write(m_csvDelimiter);
  if (s.matches(m_csvEscapeMatch)) {
    writer.write("\"");
    for (int ii=0; ii < s.length(); ii++) {
      char c=s.charAt(ii);
switch (c) {
case '"':
        writer.write("\"\"");
      break;
default :
    writer.write(c);
  break;
}
}
writer.write("\"");
}
 else {
writer.write(s);
}
}
