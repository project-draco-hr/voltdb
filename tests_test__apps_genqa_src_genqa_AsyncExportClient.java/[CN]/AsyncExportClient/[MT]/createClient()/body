{
  StatusListener statusListener=new StatusListener();
  ClientConfig clientConfig=new ClientConfig("","",statusListener);
  if (config.autoTune) {
    clientConfig.enableAutoTune();
    clientConfig.setAutoTuneTargetInternalLatency(config.latencyTarget);
  }
 else {
    clientConfig.setMaxTransactionsPerSecond(config.rateLimit);
  }
  Client client=ClientFactory.createClient(clientConfig);
  clientRef.set(client);
  periodicStatsContext=client.createStatsContext();
  fullStatsContext=client.createStatsContext();
  return client;
}
