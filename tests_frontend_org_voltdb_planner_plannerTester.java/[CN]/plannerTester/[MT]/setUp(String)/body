{
  m_partitionColumns.clear();
  m_baselinePath=(m_fixedBaselinePath != null) ? m_fixedBaselinePath : (config + "/baseline/");
  m_ddlFilePath=null;
  m_stmts.clear();
  BufferedReader reader=new BufferedReader(new FileReader(config + "/config"));
  String line=null;
  while ((line=reader.readLine()) != null) {
    if (line.startsWith("#")) {
      continue;
    }
 else     if (line.equalsIgnoreCase("DDL:")) {
      if ((line=reader.readLine()) == null) {
        break;
      }
      m_ddlFilePath=new File(line).getCanonicalPath();
    }
 else     if (line.equalsIgnoreCase("SQL:")) {
      boolean atEof=false;
      while (true) {
        if ((line=reader.readLine()) == null) {
          atEof=true;
          break;
        }
        if (line.startsWith("#")) {
          continue;
        }
        if (line.length() <= 6) {
          break;
        }
        m_stmts.add(line);
      }
      if (atEof) {
        break;
      }
    }
 else     if (line.equalsIgnoreCase("Partition Columns:")) {
      if ((line=reader.readLine()) == null) {
        break;
      }
      String[] cols=line.split(",");
      for (      String col : cols) {
        int index=col.indexOf(".");
        if (index == -1) {
          System.err.println("Config file syntax error : Partition Columns should be in comma-separated table.column format.");
        }
        m_partitionColumns.put(col.substring(0,index).toLowerCase(),col.substring(index + 1).toLowerCase());
      }
    }
 else     if (!line.trim().equals("")) {
      System.err.println("Config file syntax error : ignoring line: " + line);
    }
  }
  boolean success=true;
  if (m_ddlFilePath == null) {
    System.err.println("ERROR: syntax error : config file '" + config + "/config' has no 'DDL:' section");
    success=false;
  }
  if (m_stmts.isEmpty()) {
    System.err.println("ERROR: syntax error : config file '" + config + "/config' has no 'SQL:' section or SQL statements");
    success=false;
  }
  try {
    if (success) {
      setUpSchema(config);
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    return false;
  }
  return success;
}
