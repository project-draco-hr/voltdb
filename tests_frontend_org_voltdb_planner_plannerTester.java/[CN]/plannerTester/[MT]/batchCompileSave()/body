{
  int size=m_stmts.size();
  for (int i=0; i < size; i++) {
    List<AbstractPlanNode> pnList=compile(m_stmts.get(i),0,false);
    AbstractPlanNode pn=pnList.get(0);
    if (pnList.size() == 2) {
      assert(pnList.get(1) instanceof SendPlanNode);
      if (!pn.reattachFragment((SendPlanNode)pnList.get(1))) {
        System.err.println("Receive plan node not found while reattachFragment.");
      }
    }
    writePlanToFile(pn,m_savePlanPath,m_testName + ".plan" + i,m_stmts.get(i));
  }
  System.out.println("Plan files generated at: " + m_savePlanPath);
}
