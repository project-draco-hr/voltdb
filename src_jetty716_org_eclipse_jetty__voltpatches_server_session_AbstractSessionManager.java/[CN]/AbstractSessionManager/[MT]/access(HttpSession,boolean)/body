{
  long now=System.currentTimeMillis();
  Session s=((SessionIf)session).getSession();
  s.access(now);
  if (isUsingCookies() && (s.isIdChanged() || (getMaxCookieAge() > 0 && getRefreshCookieAge() > 0 && ((now - s.getCookieSetTime()) / 1000 > getRefreshCookieAge())))) {
    HttpCookie cookie=getSessionCookie(session,_context == null ? "/" : (_context.getContextPath()),secure);
    s.cookieSet();
    s.setIdChanged(false);
    return cookie;
  }
  return null;
}
