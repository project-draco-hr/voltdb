{
  boolean removed=false;
synchronized (this) {
    if (getSession(session.getClusterId()) != null) {
      removed=true;
      removeSession(session.getClusterId());
    }
  }
  if (removed) {
    _sessionsStats.decrement();
    _sessionTimeStats.set(round((System.currentTimeMillis() - session.getCreationTime()) / 1000.0));
    _sessionIdManager.removeSession(session);
    if (invalidate)     _sessionIdManager.invalidateAll(session.getClusterId());
    if (invalidate && _sessionListeners != null) {
      HttpSessionEvent event=new HttpSessionEvent(session);
      for (int i=LazyList.size(_sessionListeners); i-- > 0; )       ((HttpSessionListener)LazyList.get(_sessionListeners,i)).sessionDestroyed(event);
    }
    if (!invalidate) {
      session.willPassivate();
    }
  }
}
