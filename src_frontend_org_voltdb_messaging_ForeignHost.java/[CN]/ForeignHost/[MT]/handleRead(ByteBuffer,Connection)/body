{
  int recvDests[]=null;
  int mailboxId=in.getInt();
  if (mailboxId == READY_SIGNAL) {
    int readyHost=in.getInt();
    byte hostnameBytes[]=new byte[in.remaining()];
    in.get(hostnameBytes);
    m_remoteHostname=new String(hostnameBytes);
    m_hostMessenger.hostIsReady(readyHost);
    return;
  }
  if (mailboxId == CATALOG_SIGNAL) {
    byte catalogBytes[]=new byte[in.remaining()];
    in.get(catalogBytes);
    VoltDB.instance().writeNetworkCatalogToTmp(catalogBytes);
    return;
  }
  if (mailboxId == POISON_SIGNAL) {
    byte messageBytes[]=new byte[in.remaining()];
    in.get(messageBytes);
    try {
      String msg=new String(messageBytes,"UTF-8");
      msg=String.format("Fatal error from id,hostname(%d,%s): %s",m_hostId,hostname(),msg);
      VoltDB.crashLocalVoltDB(msg,false,null);
    }
 catch (    UnsupportedEncodingException e) {
      VoltDB.crashLocalVoltDB("Should never get here",false,e);
    }
    return;
  }
  m_lastMessageMillis=EstTime.currentTimeMillis();
  assert(mailboxId > -1);
  int destCount=in.getInt();
  assert(destCount > 0 && destCount < 1024);
  recvDests=new int[destCount];
  for (int i=0; i < destCount; i++) {
    recvDests[i]=in.getInt();
  }
  int datalen=in.limit() - in.position();
  assert(in.limit() != datalen + VoltMessage.HEADER_SIZE);
  ByteBuffer raw=ByteBuffer.allocate(datalen + VoltMessage.HEADER_SIZE);
  raw.position(VoltMessage.HEADER_SIZE);
  raw.put(in);
  raw.position(VoltMessage.HEADER_SIZE);
  VoltMessage message=VoltMessage.createMessageFromBuffer(raw,true);
  for (int i=0; i < destCount; i++) {
    deliverMessage(recvDests[i],mailboxId,message);
  }
  if (message instanceof FailureSiteUpdateMessage) {
    int failed_host_id=VoltDB.instance().getCatalogContext().siteTracker.getHostForSite(((FailureSiteUpdateMessage)message).m_failedSiteIds.iterator().next());
    VoltDB.instance().getFaultDistributor().reportFault(new NodeFailureFault(failed_host_id,VoltDB.instance().getCatalogContext().siteTracker.getNonExecSitesForHost(failed_host_id),m_hostMessenger.getHostnameForHostID(failed_host_id)));
  }
}
