{
  Set<Integer> execSites=tracker.getExecutionSiteIds();
  for (  int siteId : execSites) {
    Site s=tracker.getSiteForId(siteId);
    if (!s.getIsup())     continue;
    Partition p=s.getPartition();
    assert(p != null);
    int partitionId=Integer.parseInt(p.getTypeName());
    SiteState ss=new SiteState();
    ss.siteId=siteId;
    ss.newestConfirmedTxnId=DtxnConstants.DUMMY_LAST_SEEN_TXN_ID;
    assert(m_stateBySite.get(siteId) == null);
    m_stateBySite.put(siteId,ss);
    PartitionState ps=m_stateByPartition.get(partitionId);
    if (ps == null) {
      ps=new PartitionState();
      ps.partitionId=partitionId;
      ps.newestConfirmedTxnId=DtxnConstants.DUMMY_LAST_SEEN_TXN_ID;
      m_stateByPartition.put(partitionId,ps);
    }
    assert(ps.partitionId == partitionId);
    for (    SiteState state : ps.sites) {
      assert(state != null);
      assert(state.siteId != ss.siteId);
    }
    ps.sites.add(ss);
    ss.partition=ps;
  }
}
