{
  m_siteId=siteId;
  Set<Integer> execSites=tracker.getExecutionSiteIds();
  for (  int id : execSites) {
    Site s=tracker.getSiteForId(id);
    Partition p=s.getPartition();
    assert(p != null);
    int partitionId=Integer.parseInt(p.getTypeName());
    m_stateToPartitionMap.put(id,partitionId);
    if (!s.getIsup())     continue;
    SiteState ss=new SiteState();
    ss.siteId=id;
    ss.newestConfirmedTxnId=DtxnConstants.DUMMY_LAST_SEEN_TXN_ID;
    ss.lastSentTxnId=DtxnConstants.DUMMY_LAST_SEEN_TXN_ID;
    assert(m_stateBySite.get(id) == null);
    m_stateBySite.put(id,ss);
    PartitionState ps=m_stateByPartition.get(partitionId);
    if (ps == null) {
      ps=new PartitionState();
      ps.partitionId=partitionId;
      ps.newestConfirmedTxnId=DtxnConstants.DUMMY_LAST_SEEN_TXN_ID;
      m_stateByPartition.put(partitionId,ps);
    }
    assert(ps.partitionId == partitionId);
    for (    SiteState state : ps.sites) {
      assert(state != null);
      assert(state.siteId != ss.siteId);
    }
    ps.sites.add(ss);
    ss.partition=ps;
  }
}
