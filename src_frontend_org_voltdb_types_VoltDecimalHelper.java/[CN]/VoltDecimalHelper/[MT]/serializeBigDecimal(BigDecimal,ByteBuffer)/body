{
  if (bd == null) {
    serializeNull(buf);
    return;
  }
  final int scale=bd.scale();
  final int precision=bd.precision();
  if (scale > 12) {
    throw new RuntimeException("Scale of " + bd + " is "+ scale+ " and the max is 12");
  }
  final int precisionMinusScale=precision - scale;
  if (precisionMinusScale > 26) {
    throw new RuntimeException("Precision of " + bd + " to the left of the decimal point is "+ precisionMinusScale+ " and the max is 26");
  }
  final int scaleFactor=kDefaultScale - bd.scale();
  BigInteger unscaledBI=bd.unscaledValue().multiply(scaleFactors[scaleFactor]);
  boolean isNegative=false;
  if (unscaledBI.signum() < 0) {
    isNegative=true;
    unscaledBI=unscaledBI.negate();
  }
  final byte unscaledValue[]=unscaledBI.toByteArray();
  if (unscaledValue.length > 16) {
    throw new RuntimeException("Precision of " + bd + " is >38 digits");
  }
  buf.put(expandToLength16(unscaledValue,isNegative));
}
