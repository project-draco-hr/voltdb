{
  assert(m_writer != null);
  assert(m_input != null);
  int location=0;
  int initLocation=0;
  boolean initLocationFound=false;
  while (!m_eof) {
    try {
      int data=m_input.read();
      if (data == -1) {
        m_eof=true;
      }
 else {
        if (!m_witnessedReady.get() && m_token[location] == data) {
          location++;
          if (location == m_token.length) {
synchronized (this) {
              m_witnessedReady.set(true);
              this.notifyAll();
            }
          }
        }
 else {
          location=0;
        }
        if (!initLocationFound && m_initToken[initLocation] == data) {
          initLocation++;
          if (initLocation == m_initToken.length) {
            initLocationFound=true;
            m_initTime=System.currentTimeMillis();
          }
        }
 else {
          initLocation=0;
        }
        m_writer.write(data);
        m_writer.flush();
      }
    }
 catch (    IOException ex) {
      m_eof=true;
    }
  }
synchronized (this) {
    notify();
  }
  try {
    m_writer.close();
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
}
