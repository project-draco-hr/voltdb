{
  StringBuilder sb=new StringBuilder();
  for (  Cluster cluster : catalog.getClusters()) {
    for (    Database db : cluster.getDatabases()) {
      for (      Group grp : db.getGroups()) {
        toSchema(sb,grp);
      }
      sb.append("\n");
      List<Table> viewList=new ArrayList<Table>();
      for (      Table table : db.getTables()) {
        Object annotation=table.getAnnotation();
        if (annotation != null && ((TableAnnotation)annotation).ddl != null && table.getMaterializer() != null) {
          viewList.add(table);
          continue;
        }
        toSchema(sb,table,null,CatalogUtil.isTableExportOnly(db,table));
      }
      for (      Table table : viewList) {
        String viewQuery=((TableAnnotation)table.getAnnotation()).ddl;
        toSchema(sb,table,viewQuery,CatalogUtil.isTableExportOnly(db,table));
      }
      sb.append("\n");
      for (      Procedure proc : db.getProcedures()) {
        toSchema(sb,proc);
      }
      sb.append("\n");
      toSchema(sb,classNames);
    }
  }
  return sb.toString();
}
