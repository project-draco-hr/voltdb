{
  if (invocation.getType() == ProcedureInvocationType.ORIGINAL) {
    if (!isOn) {
      return null;
    }
    if (invocation.procName.equals("@AdHoc") || invocation.procName.equals("@AdHocSpForTest")) {
      String sql=(String)invocation.getParams().toArray()[0];
      String initial=sql.trim().substring(0,1);
      isReadOnly="sS(".contains(initial);
    }
    if (isReadOnly) {
      return null;
    }
 else {
      return new ClientResponseImpl(ClientResponseImpl.UNEXPECTED_FAILURE,new VoltTable[0],"Write procedure " + invocation.procName + " is not allowed in replica cluster",invocation.clientHandle);
    }
  }
 else {
    if (!isOn) {
      return new ClientResponseImpl(ClientResponseImpl.UNEXPECTED_FAILURE,new VoltTable[0],"Master cluster rejected dragent transaction " + invocation.procName + ". A DR master cluster will not accept transactions from the dragent.",invocation.clientHandle);
    }
    if (isReadOnly) {
      return new ClientResponseImpl(ClientResponseImpl.UNEXPECTED_FAILURE,new VoltTable[0],"Read-only procedure " + invocation.procName + " was not replayed on replica cluster. "+ "Reads are not replicated across DR connections.",invocation.clientHandle);
    }
 else {
      return null;
    }
  }
}
