{
  if (invocation.getType() == ProcedureInvocationType.ORIGINAL) {
    if (!isOn) {
      return null;
    }
    if (invocation.procName.equals("@AdHoc")) {
      String sql=(String)invocation.getParams().toArray()[0];
      isReadOnly=sql.trim().toLowerCase().startsWith("select");
    }
    if (isReadOnly) {
      return null;
    }
 else {
      return new ClientResponseImpl(ClientResponseImpl.UNEXPECTED_FAILURE,new VoltTable[0],"Write procedure " + invocation.procName + " is not allowed in replica cluster",invocation.clientHandle);
    }
  }
 else {
    if (!isOn) {
      return new ClientResponseImpl(ClientResponseImpl.UNEXPECTED_FAILURE,new VoltTable[0],"Replicated procedure " + invocation.procName + " is dropped from cluster",invocation.clientHandle);
    }
    if (isReadOnly) {
      return new ClientResponseImpl(ClientResponseImpl.UNEXPECTED_FAILURE,new VoltTable[0],"Read replicated procedure " + invocation.procName + " is dropped from replica cluster",invocation.clientHandle);
    }
 else {
      return null;
    }
  }
}
