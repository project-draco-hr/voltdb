{
  if (!m_txnState.isReadOnly()) {
    if (m_txnState.getBeginUndoToken() == Site.kInvalidUndoToken) {
      m_txnState.setBeginUndoToken(siteConnection.getLatestUndoToken());
    }
  }
  if (m_fragmentMsg.isSysProcTask() && SysProcFragmentId.isSnapshotSaveFragment(m_fragmentMsg.getFragmentId(0)) && VoltDB.instance().rejoinDataPending()) {
    final FragmentResponseMessage response=new FragmentResponseMessage(m_fragmentMsg,m_initiator.getHSId());
    response.setRecovering(true);
    response.setStatus(FragmentResponseMessage.SUCCESS,null);
    m_initiator.deliver(response);
    return;
  }
  final FragmentResponseMessage response=processFragmentTask(siteConnection);
  response.m_sourceHSId=m_initiator.getHSId();
  m_initiator.deliver(response);
}
