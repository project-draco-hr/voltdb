{
  message.setTransactionId(txnIdSequence++);
  message.setTruncationTxnId(lastRespondedTxnId);
  int expectedResponses=replicas.length + 1;
  InFlightTxnState state=new InFlightTxnState(message,expectedResponses);
  pendingResponses.put(message.getTransactionId(),state);
  outstanding.offer(message);
}
