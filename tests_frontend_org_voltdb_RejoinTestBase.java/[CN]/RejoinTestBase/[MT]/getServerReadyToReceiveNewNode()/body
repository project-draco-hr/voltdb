{
  Context retval=new Context();
  VoltProjectBuilder builder=getBuilderForTest();
  boolean success=builder.compile(Configuration.getPathToCatalogForTest("rejoin.jar"),1,2,1,9998,false);
  assertTrue(success);
  MiscUtils.copyFile(builder.getPathToDeployment(),Configuration.getPathToCatalogForTest("rejoin.xml"));
  VoltDB.Configuration config=new VoltDB.Configuration();
  config.m_pathToCatalog=Configuration.getPathToCatalogForTest("rejoin.jar");
  config.m_pathToDeployment=Configuration.getPathToCatalogForTest("rejoin.xml");
  config.m_adminPort=9998;
  config.m_isRejoinTest=true;
  retval.localServer=new ServerThread(config);
  long deploymentCRC=CatalogUtil.getDeploymentCRC(builder.getPathToDeployment());
  InMemoryJarfile jarFile=new InMemoryJarfile(Configuration.getPathToCatalogForTest("rejoin.jar"));
  retval.catalogCRC=jarFile.getCRC();
  HostMessenger.Config config2=new HostMessenger.Config();
  config2.internalPort++;
  HostMessenger host2=new HostMessenger(config2);
  retval.localServer.start();
  host2.waitForGroupJoin(2);
  throw new UnsupportedOperationException("Need a bit of work to mock this up in the new world.");
}
