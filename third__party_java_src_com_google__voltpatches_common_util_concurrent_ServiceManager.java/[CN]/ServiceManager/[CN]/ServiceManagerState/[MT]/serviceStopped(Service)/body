{
  checkState(unstoppedServices > 0,"All services should have already stopped but %s just stopped.",service);
  unstoppedServices--;
  if (unstoppedServices == 0) {
    checkState(unstartedServices == 0,"All services are stopped but %d services haven't finished starting",unstartedServices);
    for (    final ListenerExecutorPair pair : listeners) {
      queuedListeners.add(new Runnable(){
        @Override public void run(){
          pair.listener.stopped();
        }
      }
,pair.executor);
    }
    listeners.clear();
  }
}
