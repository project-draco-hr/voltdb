{
  if (args.length != 1) {
    LOG.error("usage: [twitter dir]");
    System.exit(1);
  }
  String twitterDir=args[0];
  Configuration config=new Configuration();
  config.setInt("mapred.job.reuse.jvm.num.tasks",-1);
  ToolRunner.run(config,new HashtagCount(twitterDir + "/input",twitterDir + "/tmp"),args);
  ToolRunner.run(config,new HashtagSort(twitterDir + "/tmp",twitterDir + "/output"),args);
  FileSystem fs=FileSystem.get(URI.create("hdfs://localhost:9000" + twitterDir),config);
  fs.delete(new Path(twitterDir + "/tmp"),true);
  fs.close();
  return 0;
}
