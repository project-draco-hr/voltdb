{
  Job job=new Job(getConf(),"user-bucket");
  job.setJarByClass(Bucket.class);
  job.setMapperClass(Map.class);
  job.setCombinerClass(Reduce.class);
  job.setReducerClass(Reduce.class);
  FileInputFormat.addInputPaths(job,inputDir);
  FileOutputFormat.setOutputPath(job,new Path(outputDir));
  job.setInputFormatClass(TextInputFormat.class);
  job.setOutputFormatClass(TextOutputFormat.class);
  job.setMapOutputKeyClass(LongWritable.class);
  job.setMapOutputValueClass(Text.class);
  job.setOutputKeyClass(LongWritable.class);
  job.setOutputValueClass(IntWritable.class);
  return job.waitForCompletion(true) ? 0 : 1;
}
