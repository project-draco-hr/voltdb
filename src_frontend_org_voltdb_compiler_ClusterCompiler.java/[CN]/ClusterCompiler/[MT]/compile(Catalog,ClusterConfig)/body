{
  if (!clusterConfig.validate()) {
    throw new RuntimeException(clusterConfig.getErrorMsg());
  }
  int hostCount=clusterConfig.getHostCount();
  int partitionCount=clusterConfig.getPartitionCount();
  int sitesPerHost=clusterConfig.getSitesPerHost();
  Cluster cluster=catalog.getClusters().get("cluster");
  cluster.setLeaderaddress(clusterConfig.getLeaderAddress().trim());
  for (int i=0; i < hostCount; i++) {
    cluster.getHosts().add(String.valueOf(i));
  }
  for (int i=0; i < partitionCount; ++i) {
    cluster.getPartitions().add(String.valueOf(i));
  }
  int initiatorsPerHost=1;
  int partitionCounter=-1;
  int nextInitiatorId=1;
  for (int i=0; i < (sitesPerHost + initiatorsPerHost) * hostCount; i++) {
    int hostForSite=i / (sitesPerHost + initiatorsPerHost);
    Host host=cluster.getHosts().get(String.valueOf(hostForSite));
    int hostId=Integer.parseInt(host.getTypeName());
    int withinHostId=i % (sitesPerHost + initiatorsPerHost);
    int siteId=hostId * VoltDB.SITES_TO_HOST_DIVISOR + withinHostId;
    Site site=cluster.getSites().add(String.valueOf(siteId));
    if (withinHostId >= initiatorsPerHost) {
      site.setIsexec(true);
      site.setPartition(cluster.getPartitions().get(String.valueOf((++partitionCounter) % partitionCount)));
    }
 else {
      site.setInitiatorid(nextInitiatorId++);
      site.setIsexec(false);
    }
    site.setHost(host);
  }
}
