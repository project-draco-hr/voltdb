{
  if (query == null) {
    return null;
  }
  query=SingleLineComments.matcher(query).replaceAll("");
  query=EscapedSingleQuote.matcher(query).replaceAll("#(SQL_PARSER_ESCAPE_SINGLE_QUOTE)");
  Matcher stringFragmentMatcher=Extract.matcher(query);
  ArrayList<String> stringFragments=new ArrayList<String>();
  int i=0;
  while (stringFragmentMatcher.find()) {
    stringFragments.add(stringFragmentMatcher.group());
    query=stringFragmentMatcher.replaceFirst("#(SQL_PARSER_STRING_FRAGMENT#" + i + ")");
    stringFragmentMatcher=Extract.matcher(query);
    i++;
  }
  query=AutoSplitParameters.matcher(query).replaceAll(",");
  String[] sqlFragments=query.split("\\s*,+\\s*");
  ArrayList<String> queries=new ArrayList<String>();
  for (int j=0; j < sqlFragments.length; j++) {
    sqlFragments[j]=sqlFragments[j].trim();
    if (sqlFragments[j].length() != 0) {
      if (sqlFragments[j].indexOf("#(SQL_PARSER_STRING_FRAGMENT#") > -1) {
        for (int k=0; k < stringFragments.size(); k++) {
          sqlFragments[j]=sqlFragments[j].replace("#(SQL_PARSER_STRING_FRAGMENT#" + k + ")",stringFragments.get(k));
        }
      }
      sqlFragments[j]=sqlFragments[j].replace("#(SQL_PARSER_ESCAPE_SINGLE_QUOTE)","''");
      sqlFragments[j]=sqlFragments[j].trim();
      queries.add(sqlFragments[j]);
    }
  }
  return queries;
}
