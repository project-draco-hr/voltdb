{
  try {
    m_data.clear();
    m_data.putInt(Commands.ELTAction.m_id);
    m_data.putInt(mAckAction ? 1 : 0);
    m_data.putInt(mPollAction ? 1 : 0);
    m_data.putLong(mAckTxnId);
    m_data.putInt(mTableId);
    m_data.flip();
    m_connection.write();
    ByteBuffer data=null;
    ByteBuffer results=ByteBuffer.allocate(12);
    while (results.remaining() > 0)     m_connection.m_socketChannel.read(results);
    results.flip();
    long result_offset=results.getLong();
    int result_sz=results.getInt();
    data=ByteBuffer.allocate(result_sz + 4);
    data.putInt(result_sz);
    while (data.remaining() > 0)     m_connection.m_socketChannel.read(data);
    data.flip();
    ELTProtoMessage reply=null;
    if (mPollAction) {
      reply=new ELTProtoMessage(partitionId,mTableId);
      reply.pollResponse(result_offset,data);
    }
    return reply;
  }
 catch (  final IOException e) {
    throw new RuntimeException(e);
  }
}
