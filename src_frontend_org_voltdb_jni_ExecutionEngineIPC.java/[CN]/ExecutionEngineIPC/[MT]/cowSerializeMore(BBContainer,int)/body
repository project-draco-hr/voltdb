{
  int bytesReturned=-1;
  ByteBuffer view=c.b.duplicate();
  try {
    m_data.clear();
    m_data.putInt(Commands.COWSerializeMore.m_id);
    m_data.putInt(tableId);
    m_data.putInt(c.b.remaining());
    m_data.flip();
    m_connection.write();
    m_connection.readStatusByte();
    ByteBuffer lengthBuffer=ByteBuffer.allocate(4);
    while (lengthBuffer.hasRemaining()) {
      int read=m_connection.m_socketChannel.read(lengthBuffer);
      if (read == -1) {
        throw new EOFException();
      }
    }
    lengthBuffer.flip();
    final int length=lengthBuffer.getInt();
    bytesReturned=length;
    if (length == -1 || length == 0) {
      return length;
    }
    view.limit(view.position() + length);
    while (view.hasRemaining()) {
      m_connection.m_socketChannel.read(view);
    }
  }
 catch (  final IOException e) {
    System.out.println("Exception: " + e.getMessage());
    throw new RuntimeException(e);
  }
  return bytesReturned;
}
