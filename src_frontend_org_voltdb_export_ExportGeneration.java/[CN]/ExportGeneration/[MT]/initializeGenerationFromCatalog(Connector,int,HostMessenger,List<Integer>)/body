{
  Iterator<ConnectorTableInfo> tableInfoIt=conn.getTableinfo().iterator();
  Set<Integer> partitionsInUse=new HashSet<Integer>();
  while (tableInfoIt.hasNext()) {
    ConnectorTableInfo next=tableInfoIt.next();
    Table table=next.getTable();
    addDataSources(table,hostId,partitions);
    partitionsInUse.addAll(partitions);
  }
  createAndRegisterAckMailboxes(partitionsInUse,messenger);
}
