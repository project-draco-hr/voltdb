{
  SiteTracker siteTracker=VoltDB.instance().getSiteTracker();
  List<Long> sites=siteTracker.getSitesForHost(hostId);
  Set<Integer> partitions=new HashSet<Integer>();
  for (  Long site : sites) {
    Integer partition=siteTracker.getPartitionForSite(site);
    partitions.add(partition);
    try {
      HashMap<String,ExportDataSource> dataSourcesForPartition=m_dataSourcesByPartition.get(partition);
      if (dataSourcesForPartition == null) {
        dataSourcesForPartition=new HashMap<String,ExportDataSource>();
        m_dataSourcesByPartition.put(partition,dataSourcesForPartition);
      }
      ExportDataSource exportDataSource=new ExportDataSource(m_onSourceDrained,"database",table.getTypeName(),partition,site,table.getSignature(),m_timestamp,table.getColumns(),m_directory.getPath());
      m_numSources++;
      exportLog.info("Creating ExportDataSource for table " + table.getTypeName() + " signature "+ table.getSignature()+ " partition id "+ partition);
      dataSourcesForPartition.put(table.getSignature(),exportDataSource);
    }
 catch (    IOException e) {
      VoltDB.crashLocalVoltDB(e.getMessage(),true,e);
    }
  }
  return partitions;
}
