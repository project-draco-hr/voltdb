{
  Set<Integer> partitions=new HashSet<Integer>();
  Iterator<ConnectorTableInfo> tableInfoIt=conn.getTableinfo().iterator();
  while (tableInfoIt.hasNext()) {
    ConnectorTableInfo next=tableInfoIt.next();
    Table table=next.getTable();
    partitions.addAll(addDataSources(table,hostId));
  }
  createAndRegisterAckMailboxes(partitions,messenger);
}
