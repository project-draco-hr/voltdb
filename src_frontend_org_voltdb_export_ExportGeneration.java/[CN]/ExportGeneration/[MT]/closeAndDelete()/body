{
  List<ListenableFuture<?>> tasks=new ArrayList<ListenableFuture<?>>();
  for (  HashMap<String,ExportDataSource> map : m_dataSourcesByPartition.values()) {
    for (    ExportDataSource source : map.values()) {
      tasks.add(source.closeAndDelete());
    }
  }
  VoltFile.recursivelyDelete(m_directory);
  try {
    Futures.allAsList(tasks).get();
  }
 catch (  Exception e) {
    Throwables.propagateIfPossible(e,IOException.class);
  }
}
