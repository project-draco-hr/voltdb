{
  HashMap<Integer,Long> partitionToTxnId=new HashMap<Integer,Long>();
  for (  long tid : perPartitionTxnIds) {
    partitionToTxnId.put(TxnEgo.getPartitionId(tid),tid);
  }
  for (  HashMap<String,ExportDataSource> dataSources : m_dataSourcesByPartition.values()) {
    for (    ExportDataSource source : dataSources.values()) {
      if (VoltDB.instance().isIV2Enabled()) {
        Long truncationPoint=partitionToTxnId.get(source.getPartitionId());
        if (truncationPoint == null) {
          exportLog.error("Snapshot " + txnId + " does not include truncation point for partition "+ source.getPartitionId());
        }
 else {
          source.truncateExportToTxnId(truncationPoint);
        }
      }
 else {
        source.truncateExportToTxnId(txnId);
      }
    }
  }
}
