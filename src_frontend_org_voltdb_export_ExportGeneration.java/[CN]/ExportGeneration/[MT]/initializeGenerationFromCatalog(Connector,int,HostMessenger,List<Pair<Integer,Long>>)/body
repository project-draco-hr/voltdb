{
  Iterator<ConnectorTableInfo> tableInfoIt=conn.getTableinfo().iterator();
  Set<Integer> partitionsInUse=new HashSet<Integer>();
  while (tableInfoIt.hasNext()) {
    ConnectorTableInfo next=tableInfoIt.next();
    Table table=next.getTable();
    addDataSources(table,hostId,partitions);
    for (    Pair<Integer,Long> p : partitions) {
      partitionsInUse.add(p.getFirst());
    }
  }
  createAndRegisterAckMailboxes(partitionsInUse,messenger);
}
