{
  SSLServerSocketFactory factory=null;
  SSLServerSocket socket=null;
  try {
    factory=createFactory();
    socket=(SSLServerSocket)(host == null ? factory.createServerSocket(port,backlog) : factory.createServerSocket(port,backlog,InetAddress.getByName(host)));
    if (_wantClientAuth)     socket.setWantClientAuth(_wantClientAuth);
    if (_needClientAuth)     socket.setNeedClientAuth(_needClientAuth);
    if ((_excludeCipherSuites != null && _excludeCipherSuites.length > 0) || (_includeCipherSuites != null && _includeCipherSuites.length > 0)) {
      List<String> includedCSList;
      if (_includeCipherSuites != null) {
        includedCSList=Arrays.asList(_includeCipherSuites);
      }
 else {
        includedCSList=new ArrayList<String>();
      }
      List<String> excludedCSList;
      if (_excludeCipherSuites != null) {
        excludedCSList=Arrays.asList(_excludeCipherSuites);
      }
 else {
        excludedCSList=new ArrayList<String>();
      }
      String[] enabledCipherSuites=socket.getEnabledCipherSuites();
      List<String> enabledCSList=new ArrayList<String>(Arrays.asList(enabledCipherSuites));
      String[] supportedCipherSuites=socket.getSupportedCipherSuites();
      List<String> supportedCSList=Arrays.asList(supportedCipherSuites);
      for (      String cipherName : includedCSList) {
        if ((!enabledCSList.contains(cipherName)) && supportedCSList.contains(cipherName)) {
          enabledCSList.add(cipherName);
        }
      }
      for (      String cipherName : excludedCSList) {
        if (enabledCSList.contains(cipherName)) {
          enabledCSList.remove(cipherName);
        }
      }
      enabledCipherSuites=enabledCSList.toArray(new String[enabledCSList.size()]);
      socket.setEnabledCipherSuites(enabledCipherSuites);
    }
  }
 catch (  IOException e) {
    throw e;
  }
catch (  Exception e) {
    Log.warn(e.toString());
    Log.debug(e);
    throw new IOException("!JsseListener: " + e);
  }
  return socket;
}
