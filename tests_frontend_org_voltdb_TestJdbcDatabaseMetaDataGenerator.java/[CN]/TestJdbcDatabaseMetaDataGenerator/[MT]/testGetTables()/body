{
  String schema="create table Table1 (Column1 varchar(10), Column2 integer);" + "create table Table2 (Column1 integer);" + "create view View1 (Column1, num) as select Column1, count(*) from Table1 group by Column1;"+ "create table Export1 (Column1 integer);"+ "export table Export1;"+ "create procedure sample as select * from Table1;";
  VoltCompiler c=compileForDDLTest2(schema);
  System.out.println(c.getCatalog().serialize());
  JdbcDatabaseMetaDataGenerator dut=new JdbcDatabaseMetaDataGenerator(c.getCatalog(),new InMemoryJarfile(testout_jar));
  VoltTable tables=dut.getMetaData("tables");
  System.out.println(tables);
  assertEquals(10,tables.getColumnCount());
  assertEquals(4,tables.getRowCount());
  assertTrue(VoltTableTestHelpers.moveToMatchingRow(tables,"TABLE_NAME","Table1"));
  assertTrue(tables.get("TABLE_TYPE",VoltType.STRING).equals("TABLE"));
  assertTrue(VoltTableTestHelpers.moveToMatchingRow(tables,"TABLE_NAME","Table2"));
  assertTrue(tables.get("TABLE_TYPE",VoltType.STRING).equals("TABLE"));
  assertTrue(VoltTableTestHelpers.moveToMatchingRow(tables,"TABLE_NAME","View1"));
  assertTrue(tables.get("TABLE_TYPE",VoltType.STRING).equals("VIEW"));
  assertTrue(VoltTableTestHelpers.moveToMatchingRow(tables,"TABLE_NAME","Export1"));
  assertTrue(tables.get("TABLE_TYPE",VoltType.STRING).equals("EXPORT"));
  assertFalse(VoltTableTestHelpers.moveToMatchingRow(tables,"TABLE_NAME","NotATable"));
}
