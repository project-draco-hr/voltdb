{
  try {
    TimestampType ts=new TimestampType((System.currentTimeMillis() * 1000) + System.currentTimeMillis() % 1000);
    ColumnInfo[] columns=new ColumnInfo[]{new ColumnInfo("TINYINT",VoltType.TINYINT),new ColumnInfo("SMALLINT",VoltType.SMALLINT),new ColumnInfo("INTEGER",VoltType.INTEGER),new ColumnInfo("BIGINT",VoltType.BIGINT),new ColumnInfo("FLOAT",VoltType.FLOAT),new ColumnInfo("DECIMAL",VoltType.DECIMAL),new ColumnInfo("VARCHAR",VoltType.STRING),new ColumnInfo("VARBINARY",VoltType.VARBINARY),new ColumnInfo("TIMESTAMP",VoltType.TIMESTAMP)};
    ArrayList<VoltType> columnTypes=new ArrayList<VoltType>();
    for (    ColumnInfo ci : columns) {
      columnTypes.add(ci.type);
    }
    CSVReader reader=mock(CSVReader.class);
    String line[]={String.valueOf(1),String.valueOf(10),String.valueOf(100000),String.valueOf(100000000),String.valueOf(3.712),(new BigDecimal("718877.11888")).toString(),"test-varchar","test-varbinary",ts.toString()};
    stub(reader.readNext()).toReturn(line);
    ArrayList<String> colNames=new ArrayList<String>();
    colNames.add("TINYINT");
    colNames.add("SMALLINT");
    colNames.add("INTEGER");
    colNames.add("BIGINT");
    colNames.add("FLOAT");
    colNames.add("DECIMAL");
    colNames.add("VARCHAR");
    colNames.add("VARBINARY");
    colNames.add("TIMESTAMP");
    VoltTable tab=VoltTableUtil.toVoltTableFromCSV(reader,colNames,columnTypes);
    assertEquals(tab.getRowCount(),1);
    assert(tab.advanceRow());
    assertEquals(tab.getColumnCount(),9);
    assertEquals(tab.getLong(0),1);
    assertEquals(tab.getLong(1),10);
    assertEquals(tab.getLong(2),100000);
    assertEquals(tab.getLong(3),100000000);
    assertEquals(tab.getDouble(4),3.712,0);
    BigDecimal bd1=tab.getDecimalAsBigDecimal(5);
    assertTrue((bd1.compareTo(new BigDecimal("718877.11888"))) == 0);
    assertEquals(tab.getString(6),"test-varchar");
    assertTrue(Arrays.equals(tab.getVarbinary(7),("test-varbinary").getBytes()));
    assertEquals(tab.getTimestampAsTimestamp(8),ts);
  }
 catch (  IOException ex) {
    Logger.getLogger(TestVoltTableUtil.class.getName()).log(Level.SEVERE,null,ex);
  }
}
