{
  ReplayEntry found=m_replayEntries.get(inTxnId);
  if (in instanceof MultiPartitionParticipantMessage) {
    if (found == null) {
      ReplayEntry newEntry=new ReplayEntry();
      newEntry.m_sentinalTxnId=inTxnId;
      m_replayEntries.put(inTxnId,newEntry);
    }
 else {
      found.m_sentinalTxnId=inTxnId;
      assert(found.isReady());
    }
  }
 else   if (in instanceof FragmentTaskMessage) {
    if (inTxnId <= m_lastPolledFragmentTxnId) {
      return false;
    }
    if (m_eolReached) {
      return false;
    }
    FragmentTaskMessage ftm=(FragmentTaskMessage)in;
    if (found == null) {
      ReplayEntry newEntry=new ReplayEntry();
      newEntry.m_firstFragment=ftm;
      m_replayEntries.put(inTxnId,newEntry);
    }
 else     if (found.m_firstFragment == null) {
      found.m_firstFragment=ftm;
      assert(found.isReady());
    }
 else {
      found.addBlockedMessage(ftm);
    }
  }
 else   if (in instanceof CompleteTransactionMessage) {
    if (inTxnId <= m_lastPolledFragmentTxnId) {
      return false;
    }
    if (found != null) {
      found.addBlockedMessage(in);
    }
 else {
      return false;
    }
  }
 else {
    if (m_replayEntries.isEmpty() || !m_replayEntries.lastEntry().getValue().hasSentinel()) {
      return false;
    }
 else {
      m_replayEntries.lastEntry().getValue().addBlockedMessage(in);
    }
  }
  return true;
}
