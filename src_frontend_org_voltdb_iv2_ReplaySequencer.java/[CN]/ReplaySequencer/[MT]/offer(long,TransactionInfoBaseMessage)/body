{
  log.info("Replay Sequencer got: " + in.toString());
  ReplayEntry found=m_replayEntries.get(inTxnId);
  if (m_eolReached && found == null) {
    log.info("Replay Sequencer returning false");
    return false;
  }
  if (in instanceof MultiPartitionParticipantMessage) {
    if (found == null) {
      ReplayEntry newEntry=new ReplayEntry();
      newEntry.m_sentinalTxnId=inTxnId;
      m_replayEntries.put(inTxnId,newEntry);
    }
 else {
      found.m_sentinalTxnId=inTxnId;
      assert(found.isReady());
    }
  }
 else   if (in instanceof FragmentTaskMessage) {
    if (inTxnId <= m_lastPolledFragmentTxnId) {
      log.info("Replay Sequencer returning false 2");
      return false;
    }
    FragmentTaskMessage ftm=(FragmentTaskMessage)in;
    if (found == null) {
      ReplayEntry newEntry=new ReplayEntry();
      newEntry.m_firstFragment=ftm;
      m_replayEntries.put(inTxnId,newEntry);
    }
 else     if (found.m_firstFragment == null) {
      found.m_firstFragment=ftm;
      assert(found.isReady());
    }
 else {
      found.addBlockedMessage(ftm);
    }
  }
 else   if (in instanceof CompleteTransactionMessage) {
    if (inTxnId <= m_lastPolledFragmentTxnId) {
      log.info("Replay Sequencer returning false 3");
      return false;
    }
    if (found != null) {
      found.addBlockedMessage(in);
    }
 else {
      log.info("Replay Sequencer returning false 4");
      return false;
    }
  }
 else {
    if (m_replayEntries.isEmpty() || !m_replayEntries.lastEntry().getValue().hasSentinel()) {
      log.info("Replay Sequencer returning false 5");
      return false;
    }
 else {
      m_replayEntries.lastEntry().getValue().addBlockedMessage(in);
    }
  }
  log.info("Replay Sequencer returning true");
  return true;
}
