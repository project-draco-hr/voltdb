{
  Integer partForToken=tokens.get(token);
  if (partForToken != null && partForToken == partition) {
    Map.Entry<Long,Integer> predecessor=tokens.headMap(token).lastEntry();
    if (predecessor == null) {
      predecessor=tokens.lastEntry();
    }
    if (predecessor.getKey() != token) {
      return Pair.of(predecessor.getKey(),predecessor.getValue());
    }
 else {
      return null;
    }
  }
 else {
    return null;
  }
}
