{
  Preconditions.checkArgument(partitionCount > 0);
  Preconditions.checkArgument(tokensPerPartition > 0);
  Random r=new Random(0);
  ByteBuffer buf=ByteBuffer.allocate(4 + (partitionCount * tokensPerPartition * 12));
  buf.putInt(partitionCount * tokensPerPartition);
  Set<Long> checkSet=new HashSet<Long>();
  for (int ii=0; ii < partitionCount; ii++) {
    for (int zz=0; zz < tokensPerPartition; zz++) {
      while (true) {
        long candidateToken=MurmurHash3.hash3_x64_128(r.nextLong());
        if (!checkSet.add(candidateToken)) {
          continue;
        }
        buf.putLong(candidateToken);
        buf.putInt(ii);
        break;
      }
    }
  }
  return buf.array();
}
