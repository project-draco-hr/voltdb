{
  _host=false;
  _expect=false;
  _expect100Continue=false;
  _expect102Processing=false;
  _delayedHandling=false;
  _charset=null;
  if (_request.getTimeStamp() == 0)   _request.setTimeStamp(System.currentTimeMillis());
  _request.setMethod(method.toString());
  try {
    _head=false;
switch (HttpMethods.CACHE.getOrdinal(method)) {
case HttpMethods.CONNECT_ORDINAL:
      _uri.parseConnect(uri.array(),uri.getIndex(),uri.length());
    break;
case HttpMethods.HEAD_ORDINAL:
  _head=true;
default :
_uri.parse(uri.array(),uri.getIndex(),uri.length());
}
_request.setUri(_uri);
if (version == null) {
_request.setProtocol(HttpVersions.HTTP_0_9);
_version=HttpVersions.HTTP_0_9_ORDINAL;
}
 else {
version=HttpVersions.CACHE.get(version);
_version=HttpVersions.CACHE.getOrdinal(version);
if (_version <= 0) _version=HttpVersions.HTTP_1_0_ORDINAL;
_request.setProtocol(version.toString());
}
}
 catch (Exception e) {
Log.debug(e);
throw new HttpException(HttpStatus.BAD_REQUEST_400,null,e);
}
}
