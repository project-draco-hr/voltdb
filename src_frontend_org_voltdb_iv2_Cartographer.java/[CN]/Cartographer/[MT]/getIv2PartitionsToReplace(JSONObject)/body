{
  ClusterConfig clusterConfig=new ClusterConfig(topology);
  hostLog.info("Computing partitions to replace.  Total partitions: " + clusterConfig.getPartitionCount());
  Map<Integer,Integer> repsPerPart=new HashMap<Integer,Integer>();
  for (int i=0; i < clusterConfig.getPartitionCount(); i++) {
    repsPerPart.put(i,getReplicaCountForPartition(i));
  }
  List<Integer> partitions=computeReplacementPartitions(repsPerPart,clusterConfig.getReplicationFactor(),clusterConfig.getSitesPerHost(),clusterConfig.getPartitionCount());
  hostLog.info("IV2 Sites will replicate the following partitions: " + partitions);
  return partitions;
}
