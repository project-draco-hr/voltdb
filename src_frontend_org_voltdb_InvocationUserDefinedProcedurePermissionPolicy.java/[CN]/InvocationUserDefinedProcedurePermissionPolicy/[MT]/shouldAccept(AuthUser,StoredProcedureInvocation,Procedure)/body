{
  if (proc == null) {
    return PolicyResult.DENY;
  }
  if (proc.getSystemproc() || invocation.procName.startsWith("@AdHoc")) {
    return PolicyResult.NOT_APPLICABLE;
  }
  if (!user.hasUserDefinedProcedurePermission(proc)) {
    return PolicyResult.DENY;
  }
  return PolicyResult.ALLOW;
}
