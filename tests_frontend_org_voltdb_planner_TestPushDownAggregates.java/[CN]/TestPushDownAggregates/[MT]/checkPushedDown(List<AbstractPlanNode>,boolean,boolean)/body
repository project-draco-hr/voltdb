{
  assertTrue(pn.size() > 0);
  AbstractPlanNode p=pn.get(0).getChild(0);
  assertTrue(p instanceof HashAggregatePlanNode);
  if (isPushedDown) {
    assertTrue(p.toJSONString().contains("\"AGGREGATE_TYPE\":\"AGGREGATE_SUM\""));
  }
 else {
    assertTrue(p.toJSONString().contains("\"AGGREGATE_TYPE\":\"AGGREGATE_COUNT_STAR\""));
  }
  if (isMultiPart) {
    assertTrue(pn.size() == 2);
    p=pn.get(1).getChild(0);
  }
 else {
    p=p.getChild(0);
  }
  if (isPushedDown) {
    assertTrue(p instanceof HashAggregatePlanNode);
    assertTrue(p.toJSONString().contains("\"AGGREGATE_TYPE\":\"AGGREGATE_COUNT_STAR\""));
  }
 else {
    assertTrue(p instanceof AbstractScanPlanNode);
  }
}
