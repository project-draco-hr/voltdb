{
  Client client=getClient();
  VoltTable vt;
  String sql;
  sql="insert into R1 Values(1, 'MA', 2, 1.1);";
  vt=client.callProcedure("@AdHoc",sql).getResults()[0];
  sql="SELECT 0.1 + (1-0.1) * NUM FROM R1";
  vt=client.callProcedure("@AdHoc",sql).getResults()[0];
  assertTrue(vt.advanceRow());
  assertEquals(1.9,vt.getDecimalAsBigDecimal(0).doubleValue());
  sql="SELECT 0.1 + NUM * (1-0.1) FROM R1";
  vt=client.callProcedure("@AdHoc",sql).getResults()[0];
  assertTrue(vt.advanceRow());
  assertEquals(1.9,vt.getDecimalAsBigDecimal(0).doubleValue());
  sql="SELECT 0.1 + (1-0.1) * ratio FROM R1";
  vt=client.callProcedure("@AdHoc",sql).getResults()[0];
  assertTrue(vt.advanceRow());
  assertEquals(2.08,vt.getDouble(0));
  sql="SELECT 0.1 + ratio * (1-0.1) FROM R1";
  vt=client.callProcedure("@AdHoc",sql).getResults()[0];
  assertTrue(vt.advanceRow());
  assertEquals(2.08,vt.getDouble(0));
}
