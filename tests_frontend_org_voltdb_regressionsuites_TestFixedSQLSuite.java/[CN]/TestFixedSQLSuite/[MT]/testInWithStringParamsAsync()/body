{
  if (isHSQL())   return;
  Client client=getClient();
  insertForInParamsTests(client);
  String[] stringArgs={"7","8"};
  boolean b;
  SimpleCallback callback=new SimpleCallback();
  b=client.callProcedure(callback,"one_string_scalar_param",(Object)stringArgs);
  assertTrue(b);
  client.drain();
  assertEquals(ClientResponse.GRACEFUL_FAILURE,callback.getClientResponse().getStatus());
  assertTrue(callback.getClientResponse().getStatusString().contains("Array / Scalar parameter mismatch"));
  b=client.callProcedure(callback,"one_string_scalar_param",(Object[])stringArgs);
  assertTrue(b);
  client.drain();
  assertEquals(ClientResponse.GRACEFUL_FAILURE,callback.getClientResponse().getStatus());
  assertTrue(callback.getClientResponse().getStatusString().contains("EXPECTS 1 PARAMS, BUT RECEIVED 2"));
  b=client.callProcedure(callback,"one_string_list_param",(Object)stringArgs);
  assertTrue(b);
  client.drain();
  assertEquals(ClientResponse.SUCCESS,callback.getClientResponse().getStatus());
  VoltTable vt=callback.getClientResponse().getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{7,8});
  String adHocQueryWithListParam="select id from P1 where desc in ?";
  String adHocQueryWithScalarParam="select id from P1 where desc in (?)";
  b=client.callProcedure(callback,"one_string_scalar_param","dog","cat");
  assertTrue(b);
  client.drain();
  assertEquals(ClientResponse.GRACEFUL_FAILURE,callback.getClientResponse().getStatus());
  assertTrue(callback.getClientResponse().getStatusString().contains("EXPECTS 1 PARAMS, BUT RECEIVED 2"));
  b=client.callProcedure(callback,"@AdHoc",adHocQueryWithScalarParam,stringArgs);
  assertTrue(b);
  client.drain();
  assertEquals(ClientResponse.GRACEFUL_FAILURE,callback.getClientResponse().getStatus());
  assertTrue(callback.getClientResponse().getStatusString().contains("Array / Scalar parameter mismatch"));
  b=client.callProcedure(callback,"@AdHoc",adHocQueryWithListParam,stringArgs);
  assertTrue(b);
  client.drain();
  assertEquals(ClientResponse.GRACEFUL_FAILURE,callback.getClientResponse().getStatus());
  assertTrue(callback.getClientResponse().getStatusString().contains("Array / Scalar parameter mismatch"));
}
