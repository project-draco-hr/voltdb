{
  AbstractPlanNode pn=compile("select A, C FROM R2 JOIN R1 USING(A, C)");
  AbstractPlanNode n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  NestLoopPlanNode nlj=(NestLoopPlanNode)n;
  AbstractExpression pred=nlj.getJoinPredicate();
  assertNotNull(pred);
  assertEquals(ExpressionType.CONJUNCTION_AND,pred.getExpressionType());
  pn=compile("select R1.A, R2.A FROM R2 JOIN R1 on R1.A = R2.A and R1.C = R2.C");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  nlj=(NestLoopPlanNode)n;
  pred=nlj.getJoinPredicate();
  assertNotNull(pred);
  assertEquals(ExpressionType.CONJUNCTION_AND,pred.getExpressionType());
  pn=compile("select A FROM R2 JOIN R3 USING(A)");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopIndexPlanNode);
  NestLoopIndexPlanNode nlij=(NestLoopIndexPlanNode)n;
  assertEquals(IndexLookupType.EQ,((IndexScanPlanNode)nlij.getInlinePlanNode(PlanNodeType.INDEXSCAN)).getLookupType());
  pn=compile("select R3.A, R2.A FROM R2 JOIN R3 ON R3.A = R2.A");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopIndexPlanNode);
  nlij=(NestLoopIndexPlanNode)n;
  pred=((IndexScanPlanNode)nlij.getInlinePlanNode(PlanNodeType.INDEXSCAN)).getPredicate();
  assertEquals(IndexLookupType.EQ,((IndexScanPlanNode)nlij.getInlinePlanNode(PlanNodeType.INDEXSCAN)).getLookupType());
  pn=compile("select A, C FROM R3 JOIN R2 USING(A, C)");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopIndexPlanNode);
  nlij=(NestLoopIndexPlanNode)n;
  pred=((IndexScanPlanNode)nlij.getInlinePlanNode(PlanNodeType.INDEXSCAN)).getPredicate();
  assertNotNull(pred);
  assertEquals(ExpressionType.COMPARE_EQUAL,pred.getExpressionType());
  pn=compile("select R3.A, R2.A FROM R3 JOIN R2 ON R3.A = R2.A AND R3.C = R2.C");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopIndexPlanNode);
  nlij=(NestLoopIndexPlanNode)n;
  pred=((IndexScanPlanNode)nlij.getInlinePlanNode(PlanNodeType.INDEXSCAN)).getPredicate();
  assertNotNull(pred);
  assertEquals(ExpressionType.COMPARE_EQUAL,pred.getExpressionType());
}
