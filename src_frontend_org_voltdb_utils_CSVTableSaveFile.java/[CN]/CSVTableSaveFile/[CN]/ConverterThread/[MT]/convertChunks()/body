{
  while (!Thread.interrupted() && m_saveFile.hasMoreChunks()) {
    if (m_availableBytes.get() > m_maxAvailableBytes) {
      Thread.sleep(5);
      continue;
    }
    BBContainer c=m_saveFile.getNextChunk();
    if (c == null) {
      return;
    }
    try {
      final VoltTable vt=PrivateVoltTableFactory.createVoltTableFromBuffer(c.b,true);
      byte csvBytes[]=VoltTableUtil.toCSV(vt,m_delimiter,null);
      m_availableBytes.addAndGet(csvBytes.length);
      m_available.offer(csvBytes);
    }
  finally {
      c.discard();
    }
  }
}
