{
  long count=0;
  while (true) {
    long skipped=in.skip(Math.min(in.available(),Integer.MAX_VALUE));
    if (skipped <= 0) {
      if (in.read() == -1) {
        return count;
      }
 else       if (count == 0 && in.available() == 0) {
        throw new IOException();
      }
      count++;
    }
 else {
      count+=skipped;
    }
  }
}
