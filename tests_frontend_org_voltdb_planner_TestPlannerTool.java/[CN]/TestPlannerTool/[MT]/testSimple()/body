{
  TPCCProjectBuilder builder=new TPCCProjectBuilder();
  builder.addAllDefaults();
  final File jar=new File("tpcc-oop.jar");
  jar.deleteOnExit();
  builder.compile("tpcc-oop.jar");
  byte[] bytes=CatalogUtil.toBytes(new File("tpcc-oop.jar"));
  String serializedCatalog=CatalogUtil.loadCatalogFromJar(bytes,null);
  Catalog catalog=new Catalog();
  catalog.execute(serializedCatalog);
  CatalogContext context=new CatalogContext(0,catalog,bytes,0,0,0);
  m_pt=new PlannerTool(context.cluster,context.database);
  PlannerTool.Result result=null;
  result=m_pt.planSql("select * from warehouse;",false,true,false);
  System.out.println(result);
  try {
    result=m_pt.planSql("select * from WAREHOUSE, DISTRICT, CUSTOMER, CUSTOMER_NAME, HISTORY, STOCK, ORDERS, NEW_ORDER, ORDER_LINE where " + "WAREHOUSE.W_ID = DISTRICT.D_W_ID and " + "WAREHOUSE.W_ID = CUSTOMER.C_W_ID and "+ "WAREHOUSE.W_ID = CUSTOMER_NAME.C_W_ID and "+ "WAREHOUSE.W_ID = HISTORY.H_W_ID and "+ "WAREHOUSE.W_ID = STOCK.S_W_ID and "+ "WAREHOUSE.W_ID = ORDERS.O_W_ID and "+ "WAREHOUSE.W_ID = NEW_ORDER.NO_W_ID and "+ "WAREHOUSE.W_ID = ORDER_LINE.OL_W_ID and "+ "WAREHOUSE.W_ID = 0",false,true,false);
    fail();
  }
 catch (  Exception e) {
  }
  try {
    result=m_pt.planSql("select * from CUSTOMER, STOCK, ORDERS, ORDER_LINE, NEW_ORDER where " + "CUSTOMER.C_W_ID = CUSTOMER.C_W_ID and " + "CUSTOMER.C_W_ID = STOCK.S_W_ID and "+ "CUSTOMER.C_W_ID = ORDERS.O_W_ID and "+ "CUSTOMER.C_W_ID = ORDER_LINE.OL_W_ID and "+ "CUSTOMER.C_W_ID = NEW_ORDER.NO_W_ID and "+ "CUSTOMER.C_W_ID = 0",true,true,false);
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail();
  }
  try {
    result=m_pt.planSql("ryan likes the yankees",false,true,false);
    fail();
  }
 catch (  Exception e) {
  }
  try {
    Thread.sleep(500);
  }
 catch (  InterruptedException e1) {
    e1.printStackTrace();
  }
  try {
    result=m_pt.planSql("ryan likes the yankees",false,true,false);
    fail();
  }
 catch (  Exception e) {
  }
  result=m_pt.planSql("select * from warehouse;",false,true,false);
  System.out.println(result);
  String plan=new String(result.getOnePlan(),VoltDB.UTF8ENCODING);
  System.out.println(plan);
  PlanNodeTree pnt=new PlanNodeTree();
  try {
    JSONObject jobj=new JSONObject(plan);
    JSONArray jarray=jobj.getJSONArray("PLAN_NODES");
    pnt.loadFromJSONArray(jarray,null);
    String str=pnt.getRootPlanNode().toExplainPlanString();
    System.out.println(str);
  }
 catch (  JSONException e) {
    e.printStackTrace();
  }
}
