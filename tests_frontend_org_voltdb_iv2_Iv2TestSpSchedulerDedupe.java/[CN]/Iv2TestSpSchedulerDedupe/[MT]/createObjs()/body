{
  mbox=mock(Mailbox.class);
  when(mbox.getHSId()).thenReturn(dut_hsid);
  iv2masters=mock(MapCache.class);
  snapMonitor=mock(SnapshotCompletionMonitor.class);
  HashMap<String,JSONObject> fakecache=new HashMap<String,JSONObject>();
  fakecache.put("0",new JSONObject("{hsid:0}"));
  when(iv2masters.pointInTimeCache()).thenReturn(ImmutableMap.copyOf(fakecache));
  dut=new SpScheduler(0,getSiteTaskerQueue(),snapMonitor);
  dut.setMailbox(mbox);
  dut.setCommandLog(mock(CommandLog.class));
}
