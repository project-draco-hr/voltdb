{
  CatalogBuilder builder=new CatalogBuilder();
  VoltTable t2=null;
  String currentName=t1 == null ? "B" : TableHelper.getTableName(t1);
  String newName=currentName;
  if (newTable) {
    newName=currentName.equals("A") ? "B" : "A";
    t2=TableHelper.getTotallyRandomTable(newName,rand);
  }
 else {
    t2=TableHelper.mutateTable(t1,false,rand);
  }
  System.out.printf("New Schema:\n%s\n",TableHelper.ddlForTable(t2));
  builder.addLiteralSchema(TableHelper.ddlForTable(t2));
  if (newName.equalsIgnoreCase("A")) {
    int pkeyIndex=TableHelper.getBigintPrimaryKeyIndexIfExists(t2);
    builder.addPartitionInfo(newName,t2.getColumnName(pkeyIndex));
  }
  byte[] catalogData=builder.compileToBytes();
  assert(catalogData != null);
  long count=tupleCount(t1);
  long start=System.nanoTime();
  if (newTable) {
    System.out.println("Starting catalog update to swap tables.");
  }
 else {
    System.out.println("Starting catalog update to change schema.");
  }
  ClientResponse cr=client.callProcedure("@UpdateApplicationCatalog",catalogData,deploymentString);
  assert(cr.getStatus() == ClientResponse.SUCCESS);
  long end=System.nanoTime();
  double seconds=(end - start) / 1000000000.0;
  if (newTable) {
    System.out.printf("Completed catalog update that swapped tables in %.4f seconds\n",seconds);
  }
 else {
    System.out.printf("Completed catalog update of %d tuples in %.4f seconds (%d tuples/sec)\n",count,seconds,(long)(count / seconds));
  }
  System.out.println("Sleeping for 5s");
  Thread.sleep(5000);
  return t2;
}
