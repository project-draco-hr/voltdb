{
  startTime=System.currentTimeMillis();
class watchDog extends Thread {
    @Override public void run(){
      if (config.duration == 0)       return;
      try {
        Thread.sleep(config.duration * 1000);
      }
 catch (      Exception e) {
      }
      SchemaChangeUtility.die(true,"Duration limit reached, terminating run");
    }
  }
  ;
  watchDog th=new watchDog();
  th.setDaemon(true);
  th.start();
  ClientConfig clientConfig=new ClientConfig("","",new StatusListener());
  clientConfig.setMaxOutstandingTxns(512);
  client=ClientFactory.createClient(clientConfig);
  connect(config.servers);
  topo=getClusterTopology();
  CatalogChangeTestDriver testDriver=new CatalogChangeTestDriver();
  testDriver.addProcedureClasses(client,VerifySchemaChangedA.class,VerifySchemaChangedB.class);
  testDriver.catalogChange(true);
  while (true) {
    testDriver.loadTable();
    for (int j=0; j < 3; j++) {
      CatalogChangeTestDriver.SampleResults sampleResults=testDriver.sampleRows();
      boolean isNewTable=(j == 0) && (rand.nextInt(5) == 0);
      testDriver.catalogChange(isNewTable);
      if (!isNewTable && (sampleResults.table != null)) {
        String err=testDriver.checkSample(sampleResults);
        if (err != null) {
          SchemaChangeUtility.die(false,err);
        }
      }
    }
  }
}
