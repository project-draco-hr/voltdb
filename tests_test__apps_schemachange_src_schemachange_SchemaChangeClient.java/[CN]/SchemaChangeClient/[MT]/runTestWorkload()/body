{
  ClientConfig clientConfig=new ClientConfig("","",new StatusListener());
  client=ClientFactory.createClient(clientConfig);
  connect(config.servers);
  topo=getCluterTopology();
  VoltTable t=null;
  while (t == null) {
    t=catalogChange(null,true);
  }
  startTime=System.currentTimeMillis();
  while (config.duration == 0 || (System.currentTimeMillis() - startTime < (config.duration * 1000))) {
    loadTable(t);
    for (int j=0; j < 3; j++) {
      String tableName=TableHelper.getTableName(t);
      VoltTable preT=sample(t);
      VoltTable newT=null;
      boolean isNewTable=(j == 0) && (rand.nextInt(5) == 0);
      while (newT == null) {
        newT=catalogChange(t,isNewTable);
      }
      t=newT;
      if (TableHelper.getTableName(t).equals(tableName)) {
        VoltTable guessT=t.clone(4096 * 1024);
        TableHelper.migrateTable(preT,guessT);
        VoltTable postT=sample(t);
        postT.resetRowPosition();
        preT.resetRowPosition();
        StringBuilder sb=new StringBuilder();
        if (!TableHelper.deepEqualsWithErrorMsg(postT,guessT,sb)) {
          System.err.println(_F(sb.toString()));
          assert(false);
        }
      }
    }
  }
  client.close();
}
