{
  try {
    final InetAddress addr=InetAddress.getLocalHost();
    return addr;
  }
 catch (  UnknownHostException e) {
    try {
      Enumeration<NetworkInterface> interfaces=NetworkInterface.getNetworkInterfaces();
      if (interfaces == null) {
        return null;
      }
      NetworkInterface intf=interfaces.nextElement();
      Enumeration<InetAddress> addresses=intf.getInetAddresses();
      while (addresses.hasMoreElements()) {
        InetAddress address=addresses.nextElement();
        if (address instanceof Inet4Address) {
          return address;
        }
      }
      interfaces=NetworkInterface.getNetworkInterfaces();
      while (addresses.hasMoreElements()) {
        return addresses.nextElement();
      }
      return null;
    }
 catch (    SocketException e1) {
      return null;
    }
  }
}
