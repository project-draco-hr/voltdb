{
  if (password == null)   return null;
  MessageDigest md=null;
  try {
    md=MessageDigest.getInstance(ClientAuthHashScheme.getDigestScheme(scheme));
  }
 catch (  NoSuchAlgorithmException e) {
    e.printStackTrace();
    System.exit(-1);
  }
  byte hashedPassword[]=null;
  try {
    hashedPassword=md.digest(password.getBytes("UTF-8"));
  }
 catch (  UnsupportedEncodingException e) {
    throw new RuntimeException("JVM doesn't support UTF-8. Please use a supported JVM",e);
  }
  return hashedPassword;
}
