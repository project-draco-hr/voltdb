{
  long timeFiveMinutesAgoMillis=called_time_milliseconds - (1000l * 60l * 5l);
  VoltTable vtMoved=new VoltTable(new VoltTable.ColumnInfo("column1",VoltType.BIGINT),new VoltTable.ColumnInfo("column2",VoltType.BIGINT),new VoltTable.ColumnInfo("column3",VoltType.BIGINT),new VoltTable.ColumnInfo("column4",VoltType.BIGINT),new VoltTable.ColumnInfo("checktime",VoltType.BIGINT));
  Object rowMoved[]=new Object[5];
  voltQueueSQL(getUnArchived,timeFiveMinutesAgoMillis,numMoves);
  VoltTable results1[]=voltExecuteSQL();
  int rowCount=results1[0].getRowCount();
  int sqlStatements=0;
  if (rowCount > 0) {
    for (int ii=0; ii < rowCount; ii++) {
      VoltTableRow row=results1[0].fetchRow(ii);
      long column1=row.getLong(0);
      long column2=row.getLong(1);
      long column3=row.getLong(2);
      long column4=row.getLong(3);
      long checktime=row.getLong(4);
      voltQueueSQL(insertArchived,column1,column2,column3,column4,checktime);
      voltQueueSQL(deleteUnArchived,column1,column2,column3,column4,checktime);
      sqlStatements+=2;
      if (sqlStatements > 900) {
        voltExecuteSQL();
        sqlStatements=0;
      }
      rowMoved[0]=column1;
      rowMoved[1]=column2;
      rowMoved[2]=column3;
      rowMoved[3]=column4;
      rowMoved[4]=checktime;
      vtMoved.addRow(rowMoved);
    }
    if (sqlStatements > 0) {
      voltExecuteSQL(true);
    }
  }
  VoltTable vtMetric=new VoltTable(new VoltTable.ColumnInfo("called_time_milliseconds",VoltType.BIGINT));
  Object rowMetric[]=new Object[1];
  rowMetric[0]=called_time_milliseconds;
  vtMetric.addRow(rowMetric);
  final VoltTable[] vtReturn={vtMoved,vtMetric};
  return vtReturn;
}
