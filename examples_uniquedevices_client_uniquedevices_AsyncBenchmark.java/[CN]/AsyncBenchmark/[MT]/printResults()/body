{
  ClientStats stats=fullStatsContext.fetch().getStats();
  System.out.println("\n" + HORIZONTAL_RULE + " Unique Device ID Couting Results\n"+ HORIZONTAL_RULE);
  System.out.printf("A total of %,9d device ids were processed and %d failed (%.2f percent).\n\n",totalVotes.get(),failedVotes.get(),failedVotes.get() * 100.0 / acceptedVotes.get());
  long counts[]=new long[config.appcount];
  double errors[]=new double[config.appcount];
  int nonZeroCount=0;
  double errorSum=0;
  for (int appId=0; appId < config.appcount; appId++) {
    ClientResponse cr=client.callProcedure("GetCardEstForApp",appId);
    long estimate=cr.getResults()[0].asScalarLong();
    long count=generator.expectedCountForApp(appId);
    if (estimate == count) {
      nonZeroCount++;
    }
    double percentError=Math.abs(estimate - count) * 100.0 / count;
    errorSum+=percentError;
    counts[appId]=count;
    errors[appId]=percentError;
  }
  Arrays.sort(errors);
  double maxError=errors[config.appcount - 1];
  double medianError=errors[config.appcount / 2];
  double meanError=errorSum / config.appcount;
  System.out.printf("The maximum error percetange was: %.2f.\n",maxError);
  System.out.printf("The median error percetange was: %.2f.\n",medianError);
  System.out.printf("The mean error percetange was: %.2f.\n",meanError);
  System.out.printf("The number of apps with perfect estimates was %d or %.2f%%.\n",nonZeroCount,nonZeroCount * 100.0 / config.appcount);
  System.out.println("\n" + HORIZONTAL_RULE + " Client Workload Statistics\n"+ HORIZONTAL_RULE);
  System.out.printf("Average throughput:            %,9d txns/sec\n",stats.getTxnThroughput());
  if (this.config.latencyreport) {
    System.out.printf("Average latency:               %,9.2f ms\n",stats.getAverageLatency());
    System.out.printf("10th percentile latency:       %,9.2f ms\n",stats.kPercentileLatencyAsDouble(.1));
    System.out.printf("25th percentile latency:       %,9.2f ms\n",stats.kPercentileLatencyAsDouble(.25));
    System.out.printf("50th percentile latency:       %,9.2f ms\n",stats.kPercentileLatencyAsDouble(.5));
    System.out.printf("75th percentile latency:       %,9.2f ms\n",stats.kPercentileLatencyAsDouble(.75));
    System.out.printf("90th percentile latency:       %,9.2f ms\n",stats.kPercentileLatencyAsDouble(.9));
    System.out.printf("95th percentile latency:       %,9.2f ms\n",stats.kPercentileLatencyAsDouble(.95));
    System.out.printf("99th percentile latency:       %,9.2f ms\n",stats.kPercentileLatencyAsDouble(.99));
    System.out.printf("99.5th percentile latency:     %,9.2f ms\n",stats.kPercentileLatencyAsDouble(.995));
    System.out.printf("99.9th percentile latency:     %,9.2f ms\n",stats.kPercentileLatencyAsDouble(.999));
    System.out.println("\n" + HORIZONTAL_RULE + " System Server Statistics\n"+ HORIZONTAL_RULE);
    System.out.printf("Reported Internal Avg Latency: %,9.2f ms\n",stats.getAverageInternalLatency());
    System.out.println("\n" + HORIZONTAL_RULE + " Latency Histogram\n"+ HORIZONTAL_RULE);
    System.out.println(stats.latencyHistoReport());
  }
  System.out.println();
  client.writeSummaryCSV(stats,config.statsfile);
}
