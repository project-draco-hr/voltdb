{
  final ByteBuffer retval=ByteBuffer.allocateDirect(capacity);
  bytesAllocatedGlobally.getAndAdd(capacity);
  return new BBContainer(retval,DBBPool.getBufferAddress(retval)){
    @Override public void discard(){
      try {
        DirectMemoryUtils.destroyDirectByteBuffer(retval);
        bytesAllocatedGlobally.getAndAdd(-capacity);
      }
 catch (      Throwable e) {
        VoltDB.crashLocalVoltDB("Failed to deallocate direct byte buffer",false,e);
      }
    }
  }
;
}
