{
  if (_closed)   throw new IOException("CLOSED");
  int flushed=0;
  if (header != null && header.length() > 0)   flushed=flush(header);
  if (header == null || header.length() == 0) {
    if (buffer != null && buffer.length() > 0)     flushed+=flush(buffer);
    if (buffer == null || buffer.length() == 0) {
      if (trailer != null && trailer.length() > 0) {
        flushed+=flush(trailer);
      }
    }
  }
  return flushed;
}
