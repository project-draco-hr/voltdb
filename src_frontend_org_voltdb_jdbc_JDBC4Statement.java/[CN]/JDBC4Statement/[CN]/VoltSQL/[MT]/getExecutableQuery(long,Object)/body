{
  if (params.length != this.parameterCount)   throw SQLError.get(SQLError.ILLEGAL_ARGUMENT);
  if (this.type == TYPE_EXEC)   return new VoltSQL(this.sql,this.parameterCount,this.type,params,this.timeout);
 else   if (this.parameterCount == 0)   return new VoltSQL(this.sql,0,this.type,this.timeout);
 else {
    StringBuilder query=new StringBuilder();
    for (int i=0; i < params.length; i++) {
      query.append(this.sql[i]);
      if (params[i] == null)       query.append("null");
 else       if (params[i].getClass().equals(Byte.class))       query.append(((Byte)params[i]).byteValue());
 else       if (params[i].getClass().equals(Short.class))       query.append(((Short)params[i]).shortValue());
 else       if (params[i].getClass().equals(Integer.class))       query.append(((Integer)params[i]).intValue());
 else       if (params[i].getClass().equals(Long.class))       query.append(((Long)params[i]).longValue());
 else       if (params[i].getClass().equals(Double.class))       query.append(((Double)params[i]).doubleValue());
 else       if (params[i] == VoltType.NULL_TIMESTAMP)       query.append("null");
 else       if (params[i].getClass().equals(Timestamp.class)) {
        Timestamp timestamp=(Timestamp)params[i];
        if (timestamp.toString().length() < 26)         timestamp.setNanos(timestamp.getNanos() + 1);
        query.append("'" + timestamp.toString().substring(0,26) + "'");
      }
 else       if (params[i] == VoltType.NULL_DECIMAL)       query.append("null");
 else       if (params[i].getClass().equals(BigDecimal.class))       query.append("'" + ((BigDecimal)params[i]).toPlainString() + "'");
 else       if (params[i] == VoltType.NULL_STRING_OR_VARBINARY)       query.append("null");
 else       if (params[i].getClass().equals(String.class)) {
        if (((String)params[i]).indexOf("\r") > -1 || ((String)params[i]).indexOf("\n") > -1)         throw SQLError.get(SQLError.QUERY_PARSING_ERROR);
        query.append("'" + SingleQuote.matcher((String)params[i]).replaceAll("''") + "'");
      }
 else       throw SQLError.get(SQLError.ILLEGAL_ARGUMENT);
    }
    if (this.sql.length > this.parameterCount)     query.append(this.sql[this.sql.length - 1]);
    return new VoltSQL(new String[]{query.toString()},0,this.type,timeout);
  }
}
