{
  long wrote=0;
  while (buf.hasRemaining()) {
    wrote+=m_socket.write(buf);
  }
  return wrote;
}
