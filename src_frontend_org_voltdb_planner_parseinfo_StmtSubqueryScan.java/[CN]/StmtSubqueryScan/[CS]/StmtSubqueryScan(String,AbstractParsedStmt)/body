{
  super(tableAlias);
  m_subquery=subquery;
  AbstractParsedStmt columnBase=subquery;
  while (columnBase instanceof ParsedUnionStmt) {
    assert(!((ParsedUnionStmt)columnBase).m_children.isEmpty());
    columnBase=((ParsedUnionStmt)columnBase).m_children.get(0);
  }
  assert(columnBase instanceof ParsedSelectStmt);
  int i=0;
  for (  ParsedColInfo col : ((ParsedSelectStmt)columnBase).displayColumns()) {
    String colAlias=col.alias == null ? col.columnName : col.alias;
    SchemaColumn scol=new SchemaColumn(col.tableName,col.tableAlias,col.columnName,col.alias,col.expression);
    m_schemaList.add(scol);
    m_columnIndexMap.put(colAlias,i);
    i++;
  }
}
