{
  System.out.println("STARTING test Repeat");
  Client client=getClient();
  ClientResponse cr;
  VoltTable result;
  cr=client.callProcedure("P1.insert",1,"foo",1,1.0,new Timestamp(1000000000000L));
  assertEquals(ClientResponse.SUCCESS,cr.getStatus());
  cr=client.callProcedure("REPEAT",0,1);
  assertEquals(ClientResponse.SUCCESS,cr.getStatus());
  result=cr.getResults()[0];
  assertEquals(1,result.getRowCount());
  assertTrue(result.advanceRow());
  assertEquals("",result.getString(1));
  cr=client.callProcedure("REPEAT",1,1);
  assertEquals(ClientResponse.SUCCESS,cr.getStatus());
  result=cr.getResults()[0];
  assertEquals(1,result.getRowCount());
  assertTrue(result.advanceRow());
  assertEquals("foo",result.getString(1));
  cr=client.callProcedure("REPEAT",3,1);
  assertEquals(ClientResponse.SUCCESS,cr.getStatus());
  result=cr.getResults()[0];
  assertEquals(1,result.getRowCount());
  assertTrue(result.advanceRow());
  assertEquals("foofoofoo",result.getString(1));
  boolean sawException=false;
  try {
    cr=client.callProcedure("REPEAT",1000000,1);
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    result=cr.getResults()[0];
    assertTrue("Exception expected here.",false);
  }
 catch (  ProcCallException ex) {
    sawException=true;
  }
  assertTrue("SQLException expected for oversize REPEAT function",sawException);
}
