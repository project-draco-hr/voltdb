{
  System.out.println("STARTING testCurrentTimestamp");
  Client client=getClient();
  ClientResponse cr=null;
  VoltTable vt=null;
  Date before=null;
  Date after=null;
  before=new Date();
  cr=client.callProcedure("@AdHoc","Insert into R_TIME (ID) VALUES(1);");
  after=new Date();
  assertEquals(ClientResponse.SUCCESS,cr.getStatus());
  vt=client.callProcedure("@AdHoc","SELECT C1, T1, T2, T3 FROM R_TIME WHERE ID = 1;").getResults()[0];
  assertTrue(vt.advanceRow());
  assertEquals(2,vt.getLong(0));
  assertTrue(after.getTime() * 1000 >= vt.getTimestampAsLong(2));
  assertTrue(before.getTime() * 1000 <= vt.getTimestampAsLong(2));
  assertEquals(vt.getTimestampAsLong(2),vt.getTimestampAsLong(3));
  before=new Date();
  vt=client.callProcedure("@AdHoc","SELECT NOW, CURRENT_TIMESTAMP FROM R_TIME;").getResults()[0];
  after=new Date();
  assertTrue(vt.advanceRow());
  assertTrue(after.getTime() * 1000 >= vt.getTimestampAsLong(0));
  assertTrue(before.getTime() * 1000 <= vt.getTimestampAsLong(0));
  assertEquals(vt.getTimestampAsLong(0),vt.getTimestampAsLong(1));
}
