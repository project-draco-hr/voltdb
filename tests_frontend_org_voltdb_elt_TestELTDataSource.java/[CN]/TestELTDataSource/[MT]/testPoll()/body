{
  MockHostMessenger hm=new MockHostMessenger();
  MockVoltDB mockvolt=new MockVoltDB();
  mockvolt.setHostMessenger(hm);
  mockvolt.addHost(10);
  mockvolt.addPartition(20);
  mockvolt.addSite(30,10,20,true);
  VoltDB.replaceVoltDBInstanceForTest(mockvolt);
  ELTProtoMessage m=new ELTProtoMessage(1,3);
  RawProcessor.ELTInternalMessage pair=new RawProcessor.ELTInternalMessage(null,m);
  ELTDataSource s=new ELTDataSource("database","table",1,2,3);
  s.poll(pair);
  assertEquals(2,hm.siteId);
  assertEquals(0,hm.mailboxId);
  assertTrue(hm.msg instanceof RawProcessor.ELTInternalMessage);
  assertEquals(pair,hm.msg);
}
