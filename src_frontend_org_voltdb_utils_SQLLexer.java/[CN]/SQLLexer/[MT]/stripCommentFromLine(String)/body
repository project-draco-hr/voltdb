{
  boolean inQuote=false;
  char quoteChar=' ';
  boolean lastCharWasDash=false;
  int commentStart=ddlLine.length();
  for (int i=commentStart - 1; i >= 0; i--) {
    char c=ddlLine.charAt(i);
    if (inQuote) {
      if (quoteChar == c) {
        inQuote=false;
      }
    }
 else {
      if (c == '-') {
        if (lastCharWasDash) {
          commentStart=i;
        }
 else {
          lastCharWasDash=true;
        }
      }
 else {
        lastCharWasDash=false;
        if (c == '\"' || c == '\'') {
          inQuote=true;
          quoteChar=c;
        }
      }
    }
  }
  return ddlLine.substring(0,commentStart);
}
