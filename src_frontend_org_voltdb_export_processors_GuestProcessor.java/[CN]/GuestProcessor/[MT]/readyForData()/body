{
  Preconditions.checkState(m_client != null,"processor was not configured with setProcessorConfig()");
  for (  HashMap<String,ExportDataSource> sources : m_generation.m_dataSourcesByPartition.values()) {
    for (    final ExportDataSource source : sources.values()) {
      source.setOnMastership(new Runnable(){
        @Override public void run(){
          m_logger.info("Beginning export processing for export source " + source.getTableName() + " partition "+ source.getPartitionId()+ " generation "+ source.getGeneration());
          ArrayList<VoltType> types=new ArrayList<VoltType>();
          for (          int type : source.m_columnTypes) {
            types.add(VoltType.get((byte)type));
          }
          AdvertisedDataSource ads=new AdvertisedDataSource(source.getPartitionId(),source.getSignature(),source.getTableName(),System.currentTimeMillis(),source.getGeneration(),source.m_columnNames,types,new ArrayList<Integer>(source.m_columnLengths));
          ExportClientDecoderBase edb=m_client.constructExportDecoder(ads);
          m_decoders.add(Pair.of(edb,ads));
          final ListenableFuture<BBContainer> fut=source.poll();
          constructListener(source,fut,edb,ads);
        }
      }
);
    }
  }
}
