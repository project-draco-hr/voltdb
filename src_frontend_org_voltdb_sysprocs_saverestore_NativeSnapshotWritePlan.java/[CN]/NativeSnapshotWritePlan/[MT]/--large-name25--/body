{
  final List<Table> tables=SnapshotUtil.getTablesToSave(context.getDatabase());
  InstanceId instId=VoltDB.instance().getHostMessenger().getInstanceId();
  long clusterCreateTime=VoltDB.instance().getClusterCreateTime();
  Runnable completionTask=SnapshotUtil.writeSnapshotDigest(txnId,context.getCatalogCRC(),file_path,file_nonce,tables,context.getHostId(),exportSequenceNumbers,drTupleStreamInfo,partitionTransactionIds,remoteDCLastIds,instId,timestamp,clusterCreateTime,newPartitionCount);
  if (completionTask != null) {
    SnapshotSiteProcessor.m_tasksOnSnapshotCompletion.offer(completionTask);
  }
  if (hashinatorData != null) {
    completionTask=SnapshotUtil.writeHashinatorConfig(instId,file_path,file_nonce,context.getHostId(),hashinatorData);
    if (completionTask != null) {
      SnapshotSiteProcessor.m_tasksOnSnapshotCompletion.offer(completionTask);
    }
  }
  completionTask=SnapshotUtil.writeSnapshotCatalog(file_path,file_nonce);
  if (completionTask != null) {
    SnapshotSiteProcessor.m_tasksOnSnapshotCompletion.offer(completionTask);
  }
  completionTask=SnapshotUtil.writeSnapshotCompletion(file_path,file_nonce,context.getHostId(),SNAP_LOG);
  if (completionTask != null) {
    SnapshotSiteProcessor.m_tasksOnSnapshotCompletion.offer(completionTask);
  }
}
