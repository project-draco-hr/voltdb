{
  final List<Table> tables=SnapshotUtil.getTablesToSave(context.getDatabase());
  Runnable completionTask=SnapshotUtil.writeSnapshotDigest(txnId,context.getCatalogCRC(),file_path,file_nonce,tables,context.getHostId(),exportSequenceNumbers,partitionTransactionIds,VoltDB.instance().getHostMessenger().getInstanceId(),timestamp);
  if (completionTask != null) {
    SnapshotSiteProcessor.m_tasksOnSnapshotCompletion.offer(completionTask);
  }
  completionTask=SnapshotUtil.writeSnapshotCatalog(file_path,file_nonce);
  if (completionTask != null) {
    SnapshotSiteProcessor.m_tasksOnSnapshotCompletion.offer(completionTask);
  }
}
