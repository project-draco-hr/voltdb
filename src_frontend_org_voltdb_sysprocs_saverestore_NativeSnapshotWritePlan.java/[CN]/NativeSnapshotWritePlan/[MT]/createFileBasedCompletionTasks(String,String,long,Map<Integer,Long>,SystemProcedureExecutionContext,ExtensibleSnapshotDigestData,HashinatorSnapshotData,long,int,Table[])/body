{
  InstanceId instId=VoltDB.instance().getHostMessenger().getInstanceId();
  CatalogContext catContext=context.getCatalogContext();
  Runnable completionTask=SnapshotUtil.writeSnapshotDigest(txnId,catContext.getCatalogCRC(),file_path,file_nonce,Arrays.asList(tables),context.getHostId(),partitionTransactionIds,extraSnapshotData,instId,timestamp,newPartitionCount,catContext.cluster.getDrclusterid());
  if (completionTask != null) {
    SnapshotSiteProcessor.m_tasksOnSnapshotCompletion.offer(completionTask);
  }
  if (hashinatorData != null) {
    completionTask=SnapshotUtil.writeHashinatorConfig(instId,file_path,file_nonce,context.getHostId(),hashinatorData);
    if (completionTask != null) {
      SnapshotSiteProcessor.m_tasksOnSnapshotCompletion.offer(completionTask);
    }
  }
  completionTask=SnapshotUtil.writeSnapshotCatalog(file_path,file_nonce);
  if (completionTask != null) {
    SnapshotSiteProcessor.m_tasksOnSnapshotCompletion.offer(completionTask);
  }
  completionTask=SnapshotUtil.writeSnapshotCompletion(file_path,file_nonce,context.getHostId(),SNAP_LOG);
  if (completionTask != null) {
    SnapshotSiteProcessor.m_tasksOnSnapshotCompletion.offer(completionTask);
  }
}
