{
  try {
    List<HashTag> hashTags=new LinkedList<HashTag>();
    int partitions=getPartitions();
    for (int partition=0; partition < partitions; partition++) {
      VoltTable[] tables=client.callProcedure(Select.class.getSimpleName(),partition,System.currentTimeMillis() * 1000L - maxAgeMicros,limit).getResults();
      if (tables.length == 0) {
        continue;
      }
      VoltTable table=tables[0];
      VoltTableRow row=table.fetchRow(0);
      int rowCount=table.getRowCount();
      for (int i=0; i < rowCount; i++) {
        hashTags.add(new HashTag(row.getString(0),(int)row.getLong(1)));
        row.advanceRow();
      }
    }
    Collections.sort(hashTags);
    while (hashTags.size() > limit) {
      hashTags.remove(limit);
    }
    return hashTags;
  }
 catch (  NoConnectionsException e) {
    e.printStackTrace();
    System.exit(-1);
  }
catch (  IOException e) {
    e.printStackTrace();
  }
catch (  ProcCallException e) {
    e.printStackTrace();
  }
  return null;
}
