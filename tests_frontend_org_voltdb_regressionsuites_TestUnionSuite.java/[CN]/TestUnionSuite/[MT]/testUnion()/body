{
  Client client=this.getClient();
  VoltTable vt;
  client.callProcedure("InsertA",0,1);
  client.callProcedure("InsertB",1,1);
  client.callProcedure("InsertB",2,1);
  client.callProcedure("InsertC",1,2);
  client.callProcedure("InsertC",2,3);
  client.callProcedure("InsertC",3,3);
  vt=client.callProcedure("@AdHoc","SELECT PKEY FROM A UNION SELECT I FROM B UNION SELECT I FROM C order by pkey;").getResults()[0];
  assertEquals(4,vt.getRowCount());
  validateTableOfScalarLongs(vt,new long[]{0,1,2,3});
  vt=client.callProcedure("@AdHoc","(SELECT PKEY FROM A UNION SELECT I FROM B) UNION SELECT I FROM C order by pkey;").getResults()[0];
  assertEquals(4,vt.getRowCount());
  validateTableOfScalarLongs(vt,new long[]{0,1,2,3});
  vt=client.callProcedure("@AdHoc","SELECT PKEY FROM A UNION (SELECT I FROM B UNION SELECT I FROM C) order by pkey;").getResults()[0];
  assertEquals(4,vt.getRowCount());
  validateTableOfScalarLongs(vt,new long[]{0,1,2,3});
  vt=client.callProcedure("@AdHoc","SELECT PKEY FROM A where PKEY = 0 UNION SELECT I FROM B where PKEY = 2 " + "UNION SELECT I FROM C WHERE I = 3 order by pkey;").getResults()[0];
  assertEquals(3,vt.getRowCount());
  validateTableOfScalarLongs(vt,new long[]{0,1,3});
  vt=client.callProcedure("@Explain","SELECT PKEY FROM A where PKEY = 0 UNION SELECT I FROM B " + "UNION SELECT I FROM C WHERE I = 3;").getResults()[0];
  String resultStr=vt.toString();
  assertTrue(resultStr.contains("(PKEY = ?0)"));
  assertTrue(resultStr.contains("(column#1 = ?1)"));
  vt=client.callProcedure("@AdHoc","SELECT PKEY FROM A where PKEY = 0 UNION SELECT I FROM B WHERE PKEY=? " + "UNION SELECT I FROM C WHERE PKEY = ? AND I = 3 order by pkey;",3,2).getResults()[0];
  assertEquals(2,vt.getRowCount());
  validateTableOfScalarLongs(vt,new long[]{0,3});
  String sql;
  client.callProcedure("@AdHoc","INSERT INTO RPT_P (client_id, config_id, cost) VALUES (140,1,1.0);");
  client.callProcedure("@AdHoc","INSERT INTO RPT_P (client_id, config_id, cost) VALUES (140,3,3.0);");
  client.callProcedure("@AdHoc","INSERT INTO rpt_copy_p (client_id, config_id, cost) VALUES (140,2,2.0);");
  client.callProcedure("@AdHoc","INSERT INTO rpt_copy_p (client_id, config_id, cost) VALUES (140,1,1.0);");
  sql="select client_id, config_id from RPT_P where client_id=140 " + " UNION " + "select client_id, config_id from rpt_copy_p where client_id=140 "+ " order by client_id, config_id;";
  vt=client.callProcedure("@AdHoc",sql).getResults()[0];
  assertEquals(3,vt.getRowCount());
  validateTableOfLongs(vt,new long[][]{{140,1},{140,2},{140,3}});
  sql="select client_id, config_id, sum(cost) as cost from RPT_P where client_id=140 group by client_id, config_id " + " UNION " + "select client_id, config_id, sum(cost) as cost from rpt_copy_p where client_id=140 group by client_id, config_id "+ " order by client_id, config_id;";
  vt=client.callProcedure("@AdHoc",sql).getResults()[0];
  assertEquals(3,vt.getRowCount());
  validateTableOfLongs(vt,new long[][]{{140,1,1},{140,2,2},{140,3,3}});
  vt=client.callProcedure("testunion_p",140,140).getResults()[0];
  assertEquals(3,vt.getRowCount());
  vt=client.callProcedure("testunion_p",10,10).getResults()[0];
  assertEquals(0,vt.getRowCount());
}
