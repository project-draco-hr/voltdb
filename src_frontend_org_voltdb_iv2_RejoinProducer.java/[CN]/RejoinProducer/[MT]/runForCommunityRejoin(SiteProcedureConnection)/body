{
  Pair<Integer,ByteBuffer> rejoinWork=firstWork.get();
  REJOINLOG.debug(m_whoami + " executing first snapshot transfer for community rejoin.");
  firstWork.set(null);
  while (rejoinWork != null) {
    restoreBlock(rejoinWork,siteConnection);
    try {
      rejoinWork=m_rejoinSiteProcessor.take();
    }
 catch (    InterruptedException e) {
      HOSTLOG.warn("RejoinProducer interrupted at take()");
      rejoinWork=null;
    }
  }
  REJOINLOG.debug(m_whoami + "Rejoin snapshot transfer is finished");
  m_rejoinSiteProcessor.close();
  try {
    REJOINLOG.debug(m_whoami + "waiting on snapshot completion monitor.");
    m_snapshotCompletionMonitorHappend.await();
    REJOINLOG.debug(m_whoami + "received snapshot completion monitor. Handing off to site.");
  }
 catch (  InterruptedException crashme) {
    VoltDB.crashLocalVoltDB("Interrupted awaiting snapshot completion.",true,crashme);
  }
  siteConnection.setRejoinComplete(m_replayCompleteAction);
}
