{
  Pair<Integer,ByteBuffer> rejoinWork=firstWork.get();
  firstWork.set(null);
  while (rejoinWork != null) {
    restoreBlock(rejoinWork,siteConnection);
    try {
      rejoinWork=m_rejoinSiteProcessor.take();
    }
 catch (    InterruptedException e) {
      hostLog.warn("RejoinProducer interrupted at take()");
      rejoinWork=null;
    }
  }
  m_recoveryLog.debug("Rejoin snapshot transfer is finished");
  m_rejoinSiteProcessor.close();
  siteConnection.setRejoinComplete();
  SnapshotSaveAPI.recoveringSiteCount.decrementAndGet();
}
