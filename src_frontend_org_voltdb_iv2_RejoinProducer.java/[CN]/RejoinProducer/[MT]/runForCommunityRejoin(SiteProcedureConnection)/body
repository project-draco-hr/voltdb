{
  RestoreWork rejoinWork=m_rejoinSiteProcessor.poll(m_snapshotBufferAllocator);
  if (rejoinWork == null && !m_rejoinSiteProcessor.isEOF()) {
    m_taskQueue.offer(this);
    return;
  }
  while (rejoinWork != null) {
    restoreBlock(rejoinWork,siteConnection);
    try {
      rejoinWork=m_rejoinSiteProcessor.take(m_snapshotBufferAllocator);
    }
 catch (    InterruptedException e) {
      REJOINLOG.warn("RejoinProducer interrupted at take()");
      rejoinWork=null;
    }
  }
  REJOINLOG.debug(m_whoami + "Rejoin snapshot transfer is finished");
  m_rejoinSiteProcessor.close();
  Preconditions.checkNotNull(m_streamSnapshotMb);
  VoltDB.instance().getHostMessenger().removeMailbox(m_streamSnapshotMb.getHSId());
  kickWatchdog(false);
  doFinishingTask(siteConnection);
}
