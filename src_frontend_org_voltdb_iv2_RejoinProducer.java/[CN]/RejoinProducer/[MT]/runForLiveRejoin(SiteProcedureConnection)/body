{
  Pair<Integer,ByteBuffer> rejoinWork=firstWork.get();
  if (rejoinWork != null) {
    REJOINLOG.debug(m_whoami + " executing first snapshot transfer for live rejoin.");
    firstWork.set(null);
  }
 else {
    rejoinWork=m_rejoinSiteProcessor.poll();
  }
  if (rejoinWork != null) {
    restoreBlock(rejoinWork,siteConnection);
  }
  if (m_rejoinSiteProcessor.isEOF() == false) {
    m_taskQueue.offer(this);
  }
 else {
    REJOINLOG.debug(m_whoami + "Rejoin snapshot transfer is finished");
    m_rejoinSiteProcessor.close();
    try {
      REJOINLOG.debug(m_whoami + "waiting on snapshot completion monitor.");
      m_replayActionAwait.await();
      REJOINLOG.debug(m_whoami + "received snapshot completion monitor. Handing off to site.");
    }
 catch (    InterruptedException crashme) {
      VoltDB.crashLocalVoltDB("Interrupted awaiting snapshot completion.",true,crashme);
    }
    siteConnection.setRejoinComplete(m_replayCompleteAction);
  }
}
