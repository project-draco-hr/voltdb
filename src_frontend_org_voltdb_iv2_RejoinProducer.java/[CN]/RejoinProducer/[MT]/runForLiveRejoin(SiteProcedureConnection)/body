{
  Pair<Integer,ByteBuffer> rejoinWork=firstWork.get();
  if (rejoinWork != null) {
    firstWork.set(null);
  }
 else {
    rejoinWork=m_rejoinSiteProcessor.poll();
  }
  if (rejoinWork != null) {
    restoreBlock(rejoinWork,siteConnection);
  }
  if (m_rejoinSiteProcessor.isEOF() == false) {
    m_recoveryLog.debug("Rejoin rescheduling for more work...");
    m_taskQueue.offer(this);
  }
 else {
    m_recoveryLog.debug("Rejoin snapshot transfer is finished");
    m_rejoinSiteProcessor.close();
    try {
      m_snapshotCompletionMonitorHappend.await();
    }
 catch (    InterruptedException crashme) {
      VoltDB.crashLocalVoltDB("Interrupted awaiting snapshot completion.",true,crashme);
    }
    siteConnection.setRejoinComplete(m_replayCompleteAction);
  }
}
