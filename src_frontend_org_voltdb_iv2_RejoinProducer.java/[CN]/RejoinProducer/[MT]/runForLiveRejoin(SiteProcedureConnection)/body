{
  Pair<Integer,ByteBuffer> rejoinWork=firstWork.get();
  if (rejoinWork != null) {
    firstWork.set(null);
  }
 else {
    rejoinWork=m_rejoinSiteProcessor.poll();
  }
  if (rejoinWork != null) {
    restoreBlock(rejoinWork,siteConnection);
  }
  if (m_rejoinSiteProcessor.isEOF() == false) {
    m_recoveryLog.debug("Rejoin rescheduling for more work...");
    m_taskQueue.offer(this);
  }
 else {
    m_recoveryLog.debug("Rejoin snapshot transfer is finished");
    m_rejoinSiteProcessor.close();
    siteConnection.setRejoinComplete();
  }
}
