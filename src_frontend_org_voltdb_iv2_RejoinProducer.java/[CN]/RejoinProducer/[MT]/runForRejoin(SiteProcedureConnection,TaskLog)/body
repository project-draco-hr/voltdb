{
  if (m_rejoinSiteProcessor != null) {
    RestoreWork rejoinWork=m_rejoinSiteProcessor.poll(m_snapshotBufferAllocator);
    if (rejoinWork != null) {
      restoreBlock(rejoinWork,siteConnection);
    }
    if (m_rejoinSiteProcessor.isEOF() == false) {
      m_taskQueue.offer(this);
    }
 else {
      REJOINLOG.debug(m_whoami + "Rejoin snapshot transfer is finished");
      m_rejoinSiteProcessor.close();
      if (m_streamSnapshotMb != null) {
        VoltDB.instance().getHostMessenger().removeMailbox(m_streamSnapshotMb.getHSId());
      }
      doFinishingTask(siteConnection);
    }
  }
 else {
    doFinishingTask(siteConnection);
    m_snapshotCompletionMonitor.set(null);
  }
}
