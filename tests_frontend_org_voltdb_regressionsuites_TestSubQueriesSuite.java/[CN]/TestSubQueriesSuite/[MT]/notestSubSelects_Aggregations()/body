{
  Client client=getClient();
  loadData(client);
  VoltTable vt;
  for (  String tb : procs) {
    client.callProcedure(tb,6,10,2,"2013-07-18 02:00:00.123457");
    client.callProcedure(tb,7,40,2,"2013-07-18 02:00:00.123457");
  }
  for (  String tb : tbs) {
    vt=client.callProcedure("@AdHoc","select * from ( SELECT dept, sum(wage) as sw, sum(wage)/count(wage) as avg_wage " + "from " + tb + " GROUP BY dept) T1 ORDER BY dept DESC;").getResults()[0];
    System.out.println(vt.toString());
    validateTableOfLongs(vt,new long[][]{{2,140,35},{1,60,20}});
    vt=client.callProcedure("@AdHoc","select wage, sum(id)+1, sum(id+1),  " + " sum(dept+3)/count(distinct dept) from " + tb + " GROUP BY wage ORDER BY wage ASC LIMIT 4 ;").getResults()[0];
    validateTableOfLongs(vt,new long[][]{{10,8,9,4},{20,3,3,4},{30,4,4,4},{40,12,13,10}});
    vt=client.callProcedure("@AdHoc"," select a4, sum(wage) " + " from (select wage, sum(id)+1 as a1, sum(id+1) as a2, sum(dept+3)/count(distinct dept) as a4 " + "       from " + tb + "       GROUP BY wage ORDER BY wage ASC LIMIT 4) T1"+ " Group by a4 order by a4;").getResults()[0];
    validateTableOfLongs(vt,new long[][]{{4,60},{10,40}});
  }
}
