{
  Client client=getClient();
  loadData(false);
  VoltTable vt;
  String sql;
  sql="select T1.ID, T1.DEPT FROM (SELECT ID, DEPT FROM P1) T1, P2 " + "where T1.ID = P2.DEPT order by T1.ID;";
  vt=client.callProcedure("@AdHoc",sql).getResults()[0];
  validateTableOfLongs(vt,new long[][]{{1,1},{1,1},{1,1},{2,1},{2,1}});
  sql="select T1.ID, T1.DEPT FROM (SELECT ID, DEPT FROM P1 where ID = 2) T1, P2 " + "where T1.ID = P2.DEPT order by T1.ID;";
  vt=client.callProcedure("@AdHoc",sql).getResults()[0];
  validateTableOfLongs(vt,new long[][]{{2,1},{2,1}});
  sql="select T1.ID, T1.DEPT " + "FROM (SELECT ID, DEPT FROM P1 where ID = 2) T1, " + "       (SELECT DEPT FROM P2 ) T2,  "+ "       (SELECT ID FROM P3 ) T3  "+ "where T1.ID = T2.DEPT and T2.DEPT = T3.ID order by T1.ID;";
  vt=client.callProcedure("@AdHoc",sql).getResults()[0];
  validateTableOfLongs(vt,new long[][]{{2,1},{2,1}});
  sql="select T1.ID, T1.DEPT " + "FROM (SELECT P1.ID, P1.DEPT FROM P1, P2 where P1.ID = P2.DEPT) T1, P2 " + "where T1.ID = P2.DEPT and P2.DEPT = 2 order by T1.ID;";
  vt=client.callProcedure("@AdHoc",sql).getResults()[0];
  validateTableOfLongs(vt,new long[][]{{2,1},{2,1},{2,1},{2,1}});
  sql="select T1.ID, T1.DEPT FROM (SELECT ID, DEPT FROM P1) T1 LEFT OUTER JOIN P2 " + "ON T1.ID = P2.DEPT order by T1.ID;";
  vt=client.callProcedure("@AdHoc",sql).getResults()[0];
  validateTableOfLongs(vt,new long[][]{{1,1},{1,1},{1,1},{2,1},{2,1},{3,1},{4,2},{5,2}});
  sql="select T1.ID, T1.DEPT FROM (SELECT ID, DEPT FROM P1) T1 LEFT OUTER JOIN P2 " + "ON T1.ID = P2.DEPT WHERE T1.ID = 3 order by T1.ID;";
  vt=client.callProcedure("@AdHoc",sql).getResults()[0];
  validateTableOfLongs(vt,new long[][]{{3,1}});
  sql="select T1.ID, T1.DEPT, P2.WAGE FROM (SELECT ID, DEPT FROM P1) T1 LEFT OUTER JOIN P2 " + "ON T1.ID = P2.DEPT AND P2.DEPT = 2 order by 1, 2, 3;";
  vt=client.callProcedure("@AdHoc",sql).getResults()[0];
  validateTableOfLongs(vt,new long[][]{{1,1,Long.MIN_VALUE},{2,1,40},{2,1,50},{3,1,Long.MIN_VALUE},{4,2,Long.MIN_VALUE},{5,2,Long.MIN_VALUE}});
}
