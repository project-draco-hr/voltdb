{
  Client client=getClient();
  loadData(client);
  VoltTable vt;
  for (  String tb : tbs) {
    vt=client.callProcedure("@AdHoc","select newid, id  " + "FROM (SELECT id, wage FROM R1) T1, (SELECT id as newid, dept FROM " + tb + " where dept > 1) T2 "+ "WHERE T1.id = T2.dept ORDER BY newid").getResults()[0];
    System.out.println(vt.toString());
    validateTableOfLongs(vt,new long[][]{{4,2},{5,2}});
    vt=client.callProcedure("@AdHoc","select id, wage, dept_count " + "FROM R1, (select dept, count(*) as dept_count " + "          from (select dept, id "+ "                from " + tb + " order by dept limit 5) T1 "+ "          group by dept) T2 "+ "WHERE R1.wage / T2.dept_count > 10 ORDER BY wage,dept_count").getResults()[0];
    validateTableOfLongs(vt,new long[][]{{3,30,2},{4,40,2},{4,40,3},{5,50,2},{5,50,3}});
    if (!isHSQL()) {
      vt=client.callProcedure("@AdHoc","select id, newid  " + "FROM (SELECT id, wage FROM R1) T1 " + "   LEFT OUTER JOIN "+ "   (SELECT id as newid, dept FROM " + tb + " where dept > 1) T2 "+ "   ON T1.id = T2.dept "+ "ORDER BY id, newid").getResults()[0];
      System.out.println(vt.toString());
      validateTableOfLongs(vt,new long[][]{{1,Long.MIN_VALUE},{2,4},{2,5},{3,Long.MIN_VALUE},{4,Long.MIN_VALUE},{5,Long.MIN_VALUE}});
    }
  }
}
