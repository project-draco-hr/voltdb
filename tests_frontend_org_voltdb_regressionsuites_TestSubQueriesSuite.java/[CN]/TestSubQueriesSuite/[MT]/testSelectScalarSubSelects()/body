{
  Client client=getClient();
  loadData(false);
  VoltTable vt;
  vt=client.callProcedure("@AdHoc","select R1.ID, R1.DEPT, (SELECT ID FROM R2 where ID = 2) FROM R1 where R1.ID < 3 order by R1.ID desc;").getResults()[0];
  System.out.println(vt.toString());
  validateTableOfLongs(vt,new long[][]{{2,1,2},{1,1,2}});
  vt=client.callProcedure("@AdHoc","select R1.ID, R1.DEPT, (SELECT ID FROM R2 where ID = ?) FROM R1 where R1.ID < 3 order by R1.ID desc;",2).getResults()[0];
  System.out.println(vt.toString());
  validateTableOfLongs(vt,new long[][]{{2,1,2},{1,1,2}});
  vt=client.callProcedure("@AdHoc","select R1.ID, R1.DEPT, (SELECT ID FROM R2 where R2.ID = R1.ID and R2.WAGE = 50) FROM R1 where R1.ID > 3 order by R1.ID desc;").getResults()[0];
  System.out.println(vt.toString());
  validateTableOfLongs(vt,new long[][]{{5l,2l,5l},{4l,2l,Long.MIN_VALUE}});
  vt=client.callProcedure("@AdHoc","select R1.DEPT, (SELECT ID FROM R2 where R2.ID = 1) FROM R1 where R1.DEPT = 2;").getResults()[0];
  System.out.println(vt.toString());
  validateTableOfLongs(vt,new long[][]{{2,1},{2,1}});
  try {
    vt=client.callProcedure("@AdHoc","select R1.ID, R1.DEPT, (SELECT ID FROM R2) FROM R1 where R1.ID > 3 order by R1.ID desc;").getResults()[0];
  }
 catch (  ProcCallException ex) {
    System.out.println(ex.getMessage());
    String errMsg=(isHSQL()) ? "cardinality violation" : "More than one row returned by a scalar/row subquery";
    assertTrue(ex.getMessage().contains(errMsg));
  }
}
