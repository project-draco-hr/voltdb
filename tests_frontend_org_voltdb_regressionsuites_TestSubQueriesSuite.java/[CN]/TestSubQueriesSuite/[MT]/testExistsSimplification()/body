{
  Client client=getClient();
  client.callProcedure("R1.insert",1,5,1,"2013-06-18 02:00:00.123457");
  client.callProcedure("R1.insert",2,10,1,"2013-07-18 10:40:01.123457");
  client.callProcedure("R1.insert",3,10,2,"2013-08-18 02:00:00.123457");
  VoltTable vt;
  client.callProcedure("R2.insert",1,5,1,"2013-06-18 02:00:00.123457");
  client.callProcedure("R2.insert",2,10,1,"2013-07-18 10:40:01.123457");
  client.callProcedure("R2.insert",3,10,2,"2013-08-18 02:00:00.123457");
  vt=client.callProcedure("@AdHoc","select R1.ID FROM R1 where exists( select ID from R2 offset ?)",4).getResults()[0];
  validateTableOfLongs(vt,new long[][]{});
  vt=client.callProcedure("@AdHoc","select R1.ID FROM R1 where exists( select ID from R2 offset ?)",1).getResults()[0];
  validateTableOfLongs(vt,new long[][]{{1},{2},{3}});
  vt=client.callProcedure("@AdHoc","select R1.ID from R1 where exists (select WAGE from R2 group by WAGE )").getResults()[0];
  validateTableOfLongs(vt,new long[][]{{1},{2},{3}});
  vt=client.callProcedure("@AdHoc","select R1.ID from R1 where exists (select WAGE from R2 group by WAGE offset 2)").getResults()[0];
  validateTableOfLongs(vt,new long[][]{});
  vt=client.callProcedure("@AdHoc","select R1.ID from R1 where exists (select ID, MAX(WAGE) from R2 group by ID)").getResults()[0];
  validateTableOfLongs(vt,new long[][]{{1},{2},{3}});
  vt=client.callProcedure("@AdHoc","select R1.ID from R1 where exists (select ID, MAX(WAGE) from R2 group by ID having MAX(WAGE) > 20)").getResults()[0];
  validateTableOfLongs(vt,new long[][]{});
  vt=client.callProcedure("@AdHoc","select R1.ID from R1 where exists (select ID, MAX(WAGE) from R2 group by ID having MAX(WAGE) > 9)").getResults()[0];
  validateTableOfLongs(vt,new long[][]{{1},{2},{3}});
  vt=client.callProcedure("@AdHoc","select R1.ID from R1 where exists (select ID, MAX(WAGE) from R2 group by ID having MAX(WAGE) > 9 offset 2)").getResults()[0];
  validateTableOfLongs(vt,new long[][]{});
}
