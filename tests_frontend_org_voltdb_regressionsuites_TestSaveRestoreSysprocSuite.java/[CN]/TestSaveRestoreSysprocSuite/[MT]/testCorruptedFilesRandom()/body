{
  System.out.println("Starting testCorruptedFilesRandom");
  int num_replicated_items=1000;
  int num_partitioned_items=126;
  java.util.Random r=new java.util.Random();
  final int iterations=isValgrind() ? 5 : 100;
  for (int ii=0; ii < iterations; ii++) {
    Client client=getClient();
    VoltTable repl_table=createReplicatedTable(num_replicated_items,0,null);
    VoltTable partition_table=createPartitionedTable(num_partitioned_items,0);
    loadTable(client,"REPLICATED_TESTER",repl_table);
    loadTable(client,"PARTITION_TESTER",partition_table);
    saveTables(client);
    validateSnapshot(true);
    releaseClient(client);
    m_config.shutDown();
    corruptTestFiles(r);
    validateSnapshot(false);
    m_config.startUp();
    client=getClient();
    VoltTable results[]=client.callProcedure("@SnapshotRestore",TMPDIR,TESTNONCE).getResults();
    assertNotNull(results);
    deleteTestFiles();
    releaseClient(client);
  }
}
