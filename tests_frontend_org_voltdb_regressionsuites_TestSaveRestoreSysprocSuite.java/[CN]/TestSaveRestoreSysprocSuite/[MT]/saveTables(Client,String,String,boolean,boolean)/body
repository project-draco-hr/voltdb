{
  VoltTable[] results=null;
  try {
    JSONObject jsObj=new JSONObject();
    try {
      jsObj.put("uripath",String.format("file://%s",dir));
      jsObj.put("nonce",nonce);
      jsObj.put("block",block);
      if (csv) {
        jsObj.put("format","csv");
      }
    }
 catch (    JSONException e) {
      fail("JSON exception" + e.getMessage());
    }
    results=client.callProcedure("@SnapshotSave",jsObj.toString()).getResults();
  }
 catch (  Exception ex) {
    ex.printStackTrace();
    fail("SnapshotSave exception: " + ex.getMessage());
  }
  return results;
}
