{
  System.out.println("Starting testCSVConversion");
  Client client=getClient();
  int num_replicated_items_per_chunk=100;
  int num_replicated_chunks=10;
  int num_partitioned_items_per_chunk=120;
  int num_partitioned_chunks=10;
  Set<String> expectedText=new TreeSet<String>();
  loadLargeReplicatedTable(client,"REPLICATED_TESTER",num_replicated_items_per_chunk,num_replicated_chunks,true,expectedText);
  loadLargePartitionedTable(client,"PARTITION_TESTER",num_partitioned_items_per_chunk,num_partitioned_chunks);
  client.callProcedure("@SnapshotSave",TMPDIR,TESTNONCE,(byte)1);
  validateSnapshot(true);
  generateAndValidateTextFile(new TreeSet<String>(expectedText),true);
  deleteTestFiles();
  client.callProcedure("@SnapshotSave","{ uripath:\"file://" + TMPDIR + "\", nonce:\""+ TESTNONCE+ "\", block:true, format:\"csv\" }");
  FileInputStream fis=new FileInputStream(TMPDIR + File.separator + TESTNONCE+ "-REPLICATED_TESTER"+ ".csv");
  validateTextFile(expectedText,true,fis);
}
