{
  long txnId=message.getTransactionId();
  if (txnId != lastSeenTxnId + 1) {
    throw new RuntimeException("Transaction missing, expecting transaction " + (lastSeenTxnId + 1) + ", but got "+ txnId);
  }
  lastSeenTxnId=message.getTransactionId();
  message.setInitiatorHSId(hsid);
  outstanding.offer(message);
  long truncationTxnId=message.getTruncationTxnId();
  if (truncationTxnId != -1) {
    truncate(truncationTxnId);
  }
}
