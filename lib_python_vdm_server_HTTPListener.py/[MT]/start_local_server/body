def start_local_server(deploymentcontents, primary=''):
    filename = os.path.join(PATH, 'deployment.xml')
    deploymentfile = open(filename, 'w')
    deploymentfile.write(deploymentcontents)
    deploymentfile.close()
    voltdb_dir = os.path.realpath(os.path.join(MODULE_PATH, '../../../..', 'bin'))
    voltdb_cmd = ['nohup', os.path.join(voltdb_dir, 'voltdb'), 'create', '-d', filename]
    if primary:
        voltdb_cmd = (voltdb_cmd + ['-H', primary])
    global OUTFILE_COUNTER
    OUTFILE_COUNTER = (OUTFILE_COUNTER + 1)
    outfilename = os.path.join(PATH, ('voltserver.output.%s.%u' % (OUTFILE_TIME, OUTFILE_COUNTER)))
    outfile = open(outfilename, 'w')
    voltserver = subprocess.Popen(voltdb_cmd, stdout=outfile, stderr=subprocess.STDOUT, preexec_fn=ignore_signals, close_fds=True)
    initialized = False
    rfile = open(outfilename, 'r')
    endtime = (time.time() + 2)
    while (((endtime - time.time()) > 0) and (voltserver.returncode is None) and (not initialized)):
        time.sleep(0.5)
        voltserver.poll()
        initialized = ('Server completed initialization' in rfile.readline())
    rfile.close()
    if (voltserver.returncode is None):
        return 0
    else:
        return 1
