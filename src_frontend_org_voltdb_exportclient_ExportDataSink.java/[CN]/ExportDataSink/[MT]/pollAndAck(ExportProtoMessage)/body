{
  m_logger.debug("Poller, table " + m_tableName + ": pollAndAck "+ prev.getAckOffset());
  ExportProtoMessage next=new ExportProtoMessage(partitionId,m_tableSignature);
  next.poll().ack(prev.getAckOffset());
  ExportProtoMessage ack=new ExportProtoMessage(partitionId,m_tableSignature);
  ack.ack(prev.getAckOffset());
  for (  String connectionName : m_txQueues.keySet()) {
    if (connectionName.equals(m_activeConnection)) {
      m_logger.debug("POLLANDACK: " + connectionName + ", offset: "+ prev.getAckOffset());
      m_txQueues.get(m_activeConnection).offer(next);
    }
 else {
      m_logger.debug("ACK: " + connectionName + ", offset: "+ prev.getAckOffset());
      m_txQueues.get(connectionName).offer(ack);
    }
  }
}
