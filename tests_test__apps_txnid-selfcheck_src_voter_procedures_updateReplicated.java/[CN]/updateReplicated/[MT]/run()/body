{
  voltQueueSQL(selectStmt);
  voltQueueSQL(deleteStmt,EXPECT_SCALAR_LONG);
  long txnId=this.getTransactionId();
  voltQueueSQL(insertStmt,EXPECT_SCALAR_MATCH(1),txnId);
  voltQueueSQL(selectStmt);
  VoltTable[] results=voltExecuteSQL(true);
  if (results[0].asScalarLong() >= txnId) {
    throw new VoltAbortException("updateReplicated executed out of order");
  }
  return results[results.length - 1];
}
