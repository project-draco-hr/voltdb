{
  AbstractParsedStmt retval=null;
  if (xmlSQL == null) {
    System.err.println("Unexpected error parsing hsql parsed stmt xml");
    throw new RuntimeException("Unexpected error parsing hsql parsed stmt xml");
  }
  if (xmlSQL.name.equalsIgnoreCase(INSERT_NODE_NAME)) {
    retval=new ParsedInsertStmt();
  }
 else   if (xmlSQL.name.equalsIgnoreCase(UPDATE_NODE_NAME)) {
    retval=new ParsedUpdateStmt();
  }
 else   if (xmlSQL.name.equalsIgnoreCase(DELETE_NODE_NAME)) {
    retval=new ParsedDeleteStmt();
  }
 else   if (xmlSQL.name.equalsIgnoreCase(SELECT_NODE_NAME)) {
    retval=new ParsedSelectStmt();
  }
 else   if (xmlSQL.name.equalsIgnoreCase(UNION_NODE_NAME)) {
    retval=new ParsedUnionStmt();
  }
 else {
    throw new RuntimeException("Unexpected Element: " + xmlSQL.name);
  }
  retval.parseTablesAndParams(xmlSQL,db);
  retval.parse(xmlSQL,db);
  retval.postParse(sql,db,joinOrder);
  return retval;
}
