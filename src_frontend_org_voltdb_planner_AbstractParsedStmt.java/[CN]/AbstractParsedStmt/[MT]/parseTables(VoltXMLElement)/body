{
  Set<Table> visited=new HashSet<Table>(tableList);
  int tableCount=0;
  for (  VoltXMLElement node : tablesNode.children) {
    if (node.name.equalsIgnoreCase("tablescan")) {
      String tableName=node.attributes.get("table");
      Table table=getTableFromDB(tableName);
      assert(table != null);
      if (visited.contains(table)) {
        throw new PlanningErrorException("VoltDB does not support self joins, consider using views instead");
      }
      parseTable(node);
      visited.add(table);
      ++tableCount;
      if (joinTree.m_hasOuterJoin && tableCount > 2) {
        throw new PlanningErrorException("VoltDB does not support outer joins with more than two tables involved");
      }
    }
  }
  joinTree.setReplicatedFlag();
}
