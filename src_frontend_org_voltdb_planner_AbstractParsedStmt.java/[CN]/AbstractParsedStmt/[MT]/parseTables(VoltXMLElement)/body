{
  Set<String> visited=new HashSet<String>();
  VoltXMLElement prevNode=null;
  boolean singleTableSelect=(tablesNode.children.size() == 1);
  for (  VoltXMLElement node : tablesNode.children) {
    if (node.name.equalsIgnoreCase("tablescan")) {
      String visitedTable=node.attributes.get("tablealias");
      if (visitedTable == null) {
        visitedTable=node.attributes.get("table");
      }
      assert(visitedTable != null);
      if (visited.contains(visitedTable)) {
        throw new PlanningErrorException("Not unique table/alias: " + visitedTable);
      }
      if (singleTableSelect) {
        parseTable(node,true);
      }
 else {
        parseTables(node,prevNode);
        prevNode=node;
      }
      visited.add(visitedTable);
    }
  }
}
