{
  String elementName=root.name.toLowerCase();
  AbstractExpression retval=null;
  if (elementName.equals("value")) {
    retval=parseValueExpression(root);
  }
 else   if (elementName.equals("vector")) {
    retval=parseVectorExpression(root);
  }
 else   if (elementName.equals("columnref")) {
    retval=parseColumnRefExpression(root);
  }
 else   if (elementName.equals("operation")) {
    retval=parseOperationExpression(root);
  }
 else   if (elementName.equals("aggregation")) {
    retval=parseAggregationExpression(root);
    if (aggregationList != null) {
      retval.resolveForDB(m_db);
      if (m_paramValues != null) {
        List<AbstractExpression> params=retval.findAllSubexpressionsOfClass(ParameterValueExpression.class);
        for (        AbstractExpression ae : params) {
          ParameterValueExpression pve=(ParameterValueExpression)ae;
          ConstantValueExpression cve=pve.getOriginalValue();
          if (cve != null) {
            cve.setValue(m_paramValues[pve.getParameterIndex()]);
          }
        }
      }
      ExpressionUtil.finalizeValueTypes(retval);
      aggregationList.add(retval);
    }
  }
 else   if (elementName.equals("simplecolumn")) {
    retval=parseSimpleColumnExpression(root);
  }
 else   if (elementName.equals("function")) {
    retval=parseFunctionExpression(root);
  }
 else   if (elementName.equals("asterisk")) {
    return null;
  }
 else {
    throw new PlanningErrorException("Unsupported expression node '" + elementName + "'");
  }
  return retval;
}
