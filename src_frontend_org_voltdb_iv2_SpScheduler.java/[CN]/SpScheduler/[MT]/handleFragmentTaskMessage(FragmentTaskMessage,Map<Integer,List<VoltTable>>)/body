{
  TransactionState txn=m_outstandingTxns.get(message.getTxnId());
  if (txn == null) {
    long localTxnId=m_txnId.incrementAndGet();
    txn=new ParticipantTransactionState(localTxnId,message);
    m_outstandingTxns.put(message.getTxnId(),txn);
  }
  if (message.isSysProcTask()) {
    final SysprocFragmentTask task=new SysprocFragmentTask(m_mailbox,(ParticipantTransactionState)txn,m_pendingTasks,message,inputDeps);
    m_pendingTasks.offer(task);
  }
 else {
    final FragmentTask task=new FragmentTask(m_mailbox,(ParticipantTransactionState)txn,m_pendingTasks,message,inputDeps);
    m_pendingTasks.offer(task);
  }
}
