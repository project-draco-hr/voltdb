{
  super(partitionId,taskQueue);
  m_pendingTasks=new TransactionTaskQueue(m_tasks,getCurrentTxnId());
  m_snapMonitor=snapMonitor;
  m_durabilityListener=new DurabilityListener(){
    @Override public void onDurability(    ArrayList<Object> durableThings){
synchronized (m_lock) {
        for (        Object o : durableThings) {
          m_pendingTasks.offer((TransactionTask)o);
          if (!((TransactionTask)o).getTransactionState().isSinglePartition()) {
            offerPendingMPTasks(((TransactionTask)o).getTxnId());
          }
        }
      }
    }
  }
;
  m_uniqueIdGenerator=new UniqueIdGenerator(partitionId,0);
}
