{
  for (int i=0; i <= totalTransactions; ++i) {
    boolean readOnly=true;
    long txnid=i + firstTxnId;
    long safe_txnid=txnid;
    int initiator=selectRandomInitiator(rand);
    int partition=i % PARTITION_COUNT;
    int coordinator=getSiteIdsForPartitionId(partition).get(0);
    int wheelOfDestiny=rand.nextInt(100);
    if (i == totalTransactions) {
      System.out.println("Queueing final heartbeat.");
      int offset=0;
      for (      int inid : getInitiatorIds()) {
        createHeartBeat(txnid + offset,txnid + offset,inid);
        ++offset;
      }
    }
 else     if (wheelOfDestiny < 80) {
      createSPInitiation(readOnly,txnid,safe_txnid,initiator,partition,coordinator);
    }
 else {
      createHeartBeat(txnid,safe_txnid,initiator);
    }
  }
}
