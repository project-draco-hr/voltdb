{
  if (first < 0)   return size - 1;
  if (last < 0 || last >= size)   return size - 1;
  return last;
}
