{
  Watcher watcher=createLeaderWatcher();
  List<String> children=zk.getChildren(dir,false);
  ZKUtil.sortSequentialNodes(children);
  String lowest=null;
  String previous=null;
  ListIterator<String> iter=children.listIterator();
  while (iter.hasNext()) {
    String child=ZKUtil.joinZKPath(dir,iter.next());
    if (lowest == null) {
      lowest=child;
      previous=child;
      continue;
    }
    if (child.equals(node)) {
      while (zk.exists(previous,watcher) == null) {
        if (previous.equals(lowest)) {
          lowest=child;
          break;
        }
 else {
          previous=iter.previous();
        }
      }
      break;
    }
    previous=child;
  }
  return lowest;
}
