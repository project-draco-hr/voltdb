{
  SynthesizedPlanFragment[] restore_plan=null;
  Set<Integer> execution_site_ids=VoltDB.instance().getCatalogContext().siteTracker.getExecutionSiteIds();
  Set<Integer> sites_missing_table=getSitesMissingTable(execution_site_ids);
  restore_plan=new SynthesizedPlanFragment[execution_site_ids.size() + 1];
  int restore_plan_index=0;
  for (  Integer site_id : m_sitesWithThisTable) {
    restore_plan[restore_plan_index]=constructLoadReplicatedTableFragment();
    restore_plan[restore_plan_index].siteId=site_id;
    ++restore_plan_index;
  }
  for (  Integer site_id : sites_missing_table) {
    int source_site_id=m_sitesWithThisTable.iterator().next();
    restore_plan[restore_plan_index]=constructDistributeReplicatedTableFragment(source_site_id,site_id);
    ++restore_plan_index;
  }
  assert(restore_plan_index == execution_site_ids.size());
  restore_plan[restore_plan_index]=constructLoadReplicatedTableAggregatorFragment();
  return restore_plan;
}
