{
  Preconditions.checkArgument(dirDN != null && !dirDN.trim().isEmpty() && !"/".equals(dirDN) && dirDN.startsWith("/"));
  StringBuilder dsb=new StringBuilder(128);
  ZKUtil.StringCallback lastCallback=null;
  try {
    for (    String dirPortion : dirDN.substring(1).split("/")) {
      lastCallback=new ZKUtil.StringCallback();
      dsb.append('/').append(dirPortion);
      zk.create(dsb.toString(),payload,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT,lastCallback,null);
    }
  }
 catch (  Throwable t) {
    Throwables.propagate(t);
  }
  return lastCallback;
}
