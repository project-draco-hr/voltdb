{
  if (!m_hasStartedWork) {
    m_site.beginNewTxn(this);
    m_hasStartedWork=true;
  }
  if (m_done) {
    return true;
  }
  while (!isBlocked()) {
    WorkUnit wu=m_readyWorkUnits.poll();
    if (wu.shouldResumeProcedure()) {
      assert(m_stackFrameDropWUs != null);
      m_stackFrameDropWUs.remove(wu);
      m_shouldResumeProcedure=true;
      m_previousStackFrameDropDependencies=wu.getDependencies();
      for (      WorkUnit sfd : m_stackFrameDropWUs) {
        sfd.m_stackCount--;
        if (sfd.allDependenciesSatisfied()) {
          m_readyWorkUnits.add(sfd);
        }
      }
      return m_done;
    }
    VoltMessage payload=wu.getPayload();
    if (payload instanceof InitiateTaskMessage) {
      initiateProcedure((InitiateTaskMessage)payload);
    }
 else     if (payload instanceof FragmentTaskMessage) {
      if (m_recovering && (wu.nonTransactional == false)) {
        processRecoveringFragmentWork((FragmentTaskMessage)payload,wu.getDependencies());
      }
 else {
        processFragmentWork((FragmentTaskMessage)payload,wu.getDependencies());
      }
    }
  }
  return m_done;
}
