{
  assert(dependencies != null);
  assert(dependencies.length > 0);
  WorkUnit w=new WorkUnit(m_site.getSiteTracker(),null,dependencies,m_hsId,m_nonCoordinatingSites,true,m_allowMismatchedResults);
  if (isFinal)   w.nonTransactional=true;
  for (  int depId : dependencies) {
    if (m_missingDependencies == null) {
      m_missingDependencies=new HashMap<Integer,WorkUnit>();
    }
    assert(!m_missingDependencies.containsKey(depId));
    m_missingDependencies.put(depId,w);
  }
  if (m_stackFrameDropWUs == null)   m_stackFrameDropWUs=new ArrayList<WorkUnit>();
  for (  WorkUnit sfd : m_stackFrameDropWUs)   sfd.m_stackCount++;
  m_stackFrameDropWUs.add(w);
  for (  WorkUnit wu : m_readyWorkUnits) {
    if (wu.shouldResumeProcedure()) {
      if (wu.m_stackCount > 0)       m_readyWorkUnits.remove(wu);
    }
  }
}
