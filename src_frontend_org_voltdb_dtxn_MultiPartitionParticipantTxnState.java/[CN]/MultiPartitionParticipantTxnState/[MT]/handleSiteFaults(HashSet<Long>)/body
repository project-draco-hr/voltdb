{
  if (m_nonCoordinatingSites != null) {
    ArrayDeque<Long> newlist=new ArrayDeque<Long>(m_nonCoordinatingSites.length);
    int removed=0;
    for (int i=0; i < m_nonCoordinatingSites.length; ++i) {
      if (!failedSites.contains(m_nonCoordinatingSites[i])) {
        newlist.addLast(m_nonCoordinatingSites[i]);
      }
 else {
        removed++;
      }
    }
    m_nonCoordinatingSites=new long[newlist.size()];
    for (int i=0; i < m_nonCoordinatingSites.length; ++i) {
      m_nonCoordinatingSites[i]=newlist.removeFirst();
    }
  }
  if (m_missingDependencies != null) {
    for (    WorkUnit wu : m_missingDependencies.values()) {
      for (      Long site_id : failedSites) {
        wu.removeSite(site_id);
      }
    }
  }
  if (m_outstandingAcks != null) {
    for (    Long site_id : failedSites) {
      m_outstandingAcks.remove(site_id);
    }
  }
}
