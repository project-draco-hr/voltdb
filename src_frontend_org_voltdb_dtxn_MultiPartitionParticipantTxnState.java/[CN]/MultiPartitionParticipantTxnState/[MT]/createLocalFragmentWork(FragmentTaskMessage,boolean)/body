{
  if (task.shouldUndo()) {
    if (m_missingDependencies != null) {
      m_missingDependencies.clear();
    }
    m_readyWorkUnits.clear();
    m_site.rollbackTransaction(isReadOnly);
    m_done=true;
    return;
  }
  if (task.getFragmentCount() > 0) {
    createLocalFragmentWorkDependencies(task,nonTransactional);
  }
  if ((!m_isCoordinator) && (task.isFinalTask())) {
    WorkUnit wu=new WorkUnit(m_site.getSiteTracker(),null,null,false);
    wu.commitEvenIfDirty=task.getFragmentCount() == 0;
    m_readyWorkUnits.add(wu);
  }
}
