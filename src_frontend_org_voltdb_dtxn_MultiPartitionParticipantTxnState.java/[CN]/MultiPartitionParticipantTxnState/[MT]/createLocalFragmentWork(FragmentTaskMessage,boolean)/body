{
  if (task.getFragmentCount() <= 0)   return;
  WorkUnit w=new WorkUnit(m_site.getSiteTracker(),task,task.getAllUnorderedInputDepIds(),m_hsId,m_nonCoordinatingSites,false,m_allowMismatchedResults);
  w.nonTransactional=nonTransactional;
  for (int i=0; i < task.getFragmentCount(); i++) {
    ArrayList<Integer> inputDepIds=task.getInputDepIds(i);
    if (inputDepIds == null)     continue;
    for (    int inputDepId : inputDepIds) {
      if (m_missingDependencies == null)       m_missingDependencies=new HashMap<Integer,WorkUnit>();
      assert(!m_missingDependencies.containsKey(inputDepId));
      m_missingDependencies.put(inputDepId,w);
    }
  }
  if (w.allDependenciesSatisfied())   m_readyWorkUnits.add(w);
}
