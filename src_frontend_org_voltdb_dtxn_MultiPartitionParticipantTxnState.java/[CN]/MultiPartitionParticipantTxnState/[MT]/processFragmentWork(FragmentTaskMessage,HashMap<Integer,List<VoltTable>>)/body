{
  assert(ftask.getFragmentCount() > 0);
  FragmentResponseMessage response=m_site.processFragmentTask(this,dependencies,ftask);
  if (response.getStatusCode() != FragmentResponseMessage.SUCCESS) {
    if (m_missingDependencies != null)     m_missingDependencies.clear();
    m_readyWorkUnits.clear();
    if (m_isCoordinator) {
      if (response.getException() != null) {
        throw response.getException();
      }
 else {
        throw new FragmentFailureException();
      }
    }
 else {
      m_needsRollback=true;
      m_done=true;
    }
  }
  if (m_isCoordinator && (response.getDestinationSiteId() == response.getExecutorSiteId())) {
    processFragmentResponseDependencies(response);
  }
 else {
    m_mbox.send(response.getDestinationSiteId(),response);
    if (!isCoordinator() && isReadOnly() && ftask.isFinalTask()) {
      m_done=true;
    }
  }
}
