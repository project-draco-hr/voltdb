{
  Deque<TransactionTask> deque=backlog;
  if (deque == null) {
    deque=new ArrayDeque<TransactionTask>();
  }
  if (m_multiPartPendingSentinelReceipt != null) {
    boolean mismatch=false;
    if (txnId == GENERIC_MP_SENTINEL) {
    }
 else     if (txnId != m_multiPartPendingSentinelReceipt.getTxnId()) {
      mismatch=true;
    }
    if (mismatch) {
      VoltDB.crashLocalVoltDB("Mismatch between replay sentinel txnid " + txnId + " and next mutli-part fragment id "+ m_multiPartPendingSentinelReceipt.getTxnId(),false,null);
    }
    TransactionTask ts=m_multiPartPendingSentinelReceipt;
    m_multiPartPendingSentinelReceipt=null;
    deque.addFirst(ts);
    m_multipartBacklog.put(txnId,deque);
    taskQueueOffer(ts);
  }
 else {
    if (!m_multipartBacklog.isEmpty() && m_multipartBacklog.firstKey() == txnId) {
      assert(txnId == GENERIC_MP_SENTINEL);
      m_drMPSentinelBacklog.offer(new ArrayDeque<TransactionTask>());
    }
 else {
      m_multipartBacklog.put(txnId,deque);
    }
  }
}
