{
  int offered=0;
  if (!m_backlog.isEmpty()) {
    if (m_backlog.getFirst().getTransactionState().isDone()) {
      m_backlog.removeFirst();
      while (!m_backlog.isEmpty()) {
        TransactionTask next=m_backlog.getFirst();
        m_taskQueue.offer(next);
        ++offered;
        if (next.getTransactionState().isSinglePartition()) {
          m_backlog.removeFirst();
        }
 else {
          break;
        }
      }
    }
  }
  return offered;
}
