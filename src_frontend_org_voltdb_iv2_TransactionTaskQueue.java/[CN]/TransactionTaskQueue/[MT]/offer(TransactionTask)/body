{
  Iv2Trace.logTransactionTaskQueueOffer(task);
  TransactionState txnState=task.getTransactionState();
  if (!txnState.isReadOnly()) {
    m_maxTaskedSpHandle=Math.max(m_maxTaskedSpHandle,txnState.m_spHandle);
    m_maxTaskedSpUniqueId=Math.max(m_maxTaskedSpUniqueId,txnState.m_spUniqueId);
  }
  boolean retval=false;
  if (!m_backlog.isEmpty()) {
    if (task.getTxnId() != m_backlog.getFirst().getTxnId()) {
      m_backlog.addLast(task);
      retval=true;
    }
 else {
      taskQueueOffer(task);
    }
  }
 else {
    if (!task.getTransactionState().isSinglePartition()) {
      m_backlog.addLast(task);
      retval=true;
    }
    taskQueueOffer(task);
  }
  return retval;
}
