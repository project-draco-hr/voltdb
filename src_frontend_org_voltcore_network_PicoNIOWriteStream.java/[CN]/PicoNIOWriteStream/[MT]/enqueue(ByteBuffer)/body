{
  assert(!buf.isDirect());
  if (buf.remaining() == 0) {
    throw new IllegalArgumentException("Attempted to queue a zero length buffer");
  }
  if (m_isShutdown)   return;
  m_queuedWrites.offer(new DeferredSerialization(){
    @Override public ByteBuffer[] serialize() throws IOException {
      return new ByteBuffer[]{buf};
    }
    @Override public void cancel(){
    }
  }
);
}
