{
  while (m_continue.get()) {
    try {
      if (m_hostAlive) {
        Thread.sleep(1000);
        m_cluster.shutDownSingleHost(m_currentHost);
        m_hostAlive=false;
        Thread.sleep(1000);
      }
 else {
        boolean success=m_cluster.recoverOne(m_currentHost,null,"localhost");
        m_tryKills++;
        if (success) {
          m_hostAlive=true;
          m_currentHost=(m_currentHost + 1) % m_cluster.getNodeCount();
          m_tryKills=0;
        }
        if (m_tryKills >= 6)         fail();
      }
    }
 catch (    InterruptedException e) {
      e.printStackTrace();
      fail();
    }
  }
}
