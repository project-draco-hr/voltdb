{
  SortAndSlice sortAndSlice=null;
  read();
  readThis(Tokens.OPENBRACKET);
  readThis(Tokens.CLOSEBRACKET);
  readThis(Tokens.OVER);
  readThis(Tokens.OPENBRACKET);
  List<Expression> partitionByList=new ArrayList<Expression>();
  if (token.tokenType == Tokens.PARTITION) {
    read();
    readThis(Tokens.BY);
    while (true) {
      Expression e=XreadValueExpression();
      partitionByList.add(e);
      if (token.tokenType == Tokens.COMMA) {
        read();
        continue;
      }
      break;
    }
  }
  if (token.tokenType != Tokens.ORDER) {
    throw unexpectedToken();
  }
  read();
  readThis(Tokens.BY);
  sortAndSlice=XreadOrderBy();
  readThis(Tokens.CLOSEBRACKET);
  ExpressionRank erank=new ExpressionRank(sortAndSlice,partitionByList,isPercent);
  return erank;
}
