{
  System.out.println("subtest1AdHocPlannerCache...");
  VoltTable vt;
  String sql;
  sql="SELECT ID FROM R1 sub1 order by ID;";
  validateTableOfScalarLongs(client,sql,new long[]{1,2,3});
  checkPlannerCache(client,CACHE_MISS2_ADD1);
  validateTableOfScalarLongs(client,sql,new long[]{1,2,3});
  checkPlannerCache(client,CACHE_HIT1);
  validateTableOfScalarLongs(client,sql,new long[]{1,2,3});
  checkPlannerCache(client,CACHE_HIT1);
  sql="SELECT ID FROM R1 sub1_C order by ID;";
  validateTableOfScalarLongs(client,sql,new long[]{1,2,3});
  checkPlannerCache(client,CACHE_MISS2_ADD1);
  sql="SELECT ID FROM R1 sub1 WHERE ID > 1 order by ID;";
  validateTableOfScalarLongs(client,sql,new long[]{2,3});
  checkPlannerCache(client,CACHE_MISS2_ADD1);
  validateTableOfScalarLongs(client,sql,new long[]{2,3});
  checkPlannerCache(client,CACHE_HIT1);
  sql="SELECT ID FROM R1 sub1 WHERE ID > 2 order by ID;";
  validateTableOfScalarLongs(client,sql,new long[]{3});
  checkPlannerCache(client,CACHE_HIT2_ADD1);
  sql="SELECT ID FROM R1 sub1 WHERE ID > ? ORDER BY ID;";
  vt=client.callProcedure("@AdHoc",sql,1).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{2,3});
  checkPlannerCache(client,CACHE_MISS2);
  vt=client.callProcedure("@AdHoc",sql,2).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{3});
  checkPlannerCache(client,CACHE_HIT2);
  vt=client.callProcedure("@AdHoc",sql,3).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{});
  checkPlannerCache(client,CACHE_HIT2);
  sql="SELECT ID FROM R1 sub1 WHERE num = 0 and ID > ? order by ID;";
  vt=client.callProcedure("@AdHoc",sql,0).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{1,2});
  checkPlannerCache(client,CACHE_MISS2);
  vt=client.callProcedure("@AdHoc",sql,1).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{2});
  checkPlannerCache(client,CACHE_HIT2);
  vt=client.callProcedure("@AdHoc",sql,3).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{});
  checkPlannerCache(client,CACHE_HIT2);
  sql="SELECT ID FROM R1 sub1 WHERE num = 1 and ID > ? order by ID;";
  vt=client.callProcedure("@AdHoc",sql,0).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{3});
  checkPlannerCache(client,CACHE_MISS2);
  vt=client.callProcedure("@AdHoc",sql,3).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{});
  checkPlannerCache(client,CACHE_HIT2);
  sql="SELECT ID FROM R1 sub1 WHERE num = ? and ID > ? order by ID;";
  vt=client.callProcedure("@AdHoc",sql,0,0).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{1,2});
  checkPlannerCache(client,CACHE_MISS2);
  vt=client.callProcedure("@AdHoc",sql,1,2).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{3});
  checkPlannerCache(client,CACHE_HIT2);
}
