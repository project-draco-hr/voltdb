{
  final String noConnections="<?xml version='1.0' encoding='UTF-8' standalone='no'?>" + "<deployment>" + "<cluster hostcount='3' kfactor='1' sitesperhost='2'/>"+ "    <dr name='test' id='0'>"+ "    </dr>"+ "</deployment>";
  final String multipleConnections="<?xml version='1.0' encoding='UTF-8' standalone='no'?>" + "<deployment>" + "<cluster hostcount='3' kfactor='1' sitesperhost='2'/>"+ "    <dr name='test' id='0'>"+ "        <connection source='master'/>"+ "        <connection source='imposter'/>"+ "    </dr>"+ "</deployment>";
  final String oneConnection="<?xml version='1.0' encoding='UTF-8' standalone='no'?>" + "<deployment>" + "<cluster hostcount='3' kfactor='1' sitesperhost='2'/>"+ "    <dr name='test' id='0'>"+ "        <connection source='master'/>"+ "    </dr>"+ "</deployment>";
  final String oneEnabledConnection="<?xml version='1.0' encoding='UTF-8' standalone='no'?>" + "<deployment>" + "<cluster hostcount='3' kfactor='1' sitesperhost='2'/>"+ "    <dr>"+ "        <connection source='master' enabled='true'/>"+ "    </dr>"+ "</deployment>";
  final String oneDisabledConnection="<?xml version='1.0' encoding='UTF-8' standalone='no'?>" + "<deployment>" + "<cluster hostcount='3' kfactor='1' sitesperhost='2'/>"+ "    <dr>"+ "        <connection source='master' enabled='false'/>"+ "    </dr>"+ "</deployment>";
  final File tmpNoParse=VoltProjectBuilder.writeStringToTempFile(noConnections);
  assertNull(CatalogUtil.getDeployment(new FileInputStream(tmpNoParse)));
  final File tmpInvalidMultiple=VoltProjectBuilder.writeStringToTempFile(multipleConnections);
  assertNull(CatalogUtil.getDeployment(new FileInputStream(tmpInvalidMultiple)));
  assertTrue(catalog.getClusters().get("cluster").getDrmasterhost().isEmpty());
  final File tmpDefault=VoltProjectBuilder.writeStringToTempFile(oneConnection);
  DeploymentType valid_deployment=CatalogUtil.getDeployment(new FileInputStream(tmpDefault));
  assertNotNull(valid_deployment);
  String msg=CatalogUtil.compileDeployment(catalog,valid_deployment,false);
  assertTrue("Deployment file failed to parse",msg == null);
  assertEquals("master",catalog.getClusters().get("cluster").getDrmasterhost());
  final File tmpEnabled=VoltProjectBuilder.writeStringToTempFile(oneEnabledConnection);
  DeploymentType valid_deployment_enabled=CatalogUtil.getDeployment(new FileInputStream(tmpEnabled));
  assertNotNull(valid_deployment_enabled);
  setUp();
  msg=CatalogUtil.compileDeployment(catalog,valid_deployment_enabled,false);
  assertTrue("Deployment file failed to parse",msg == null);
  assertEquals("master",catalog.getClusters().get("cluster").getDrmasterhost());
  final File tmpDisabled=VoltProjectBuilder.writeStringToTempFile(oneDisabledConnection);
  DeploymentType valid_deployment_disabled=CatalogUtil.getDeployment(new FileInputStream(tmpDisabled));
  assertNotNull(valid_deployment_disabled);
  setUp();
  msg=CatalogUtil.compileDeployment(catalog,valid_deployment_disabled,false);
  assertTrue("Deployment file failed to parse",msg == null);
  assertTrue(catalog.getClusters().get("cluster").getDrmasterhost().isEmpty());
}
