{
  Set<Integer> aggregate_deps=new HashSet<Integer>();
  for (  int dependency_id : plan[plan.length - 1].inputDepIds) {
    aggregate_deps.add(dependency_id);
  }
  Set<Integer> plan_deps=new HashSet<Integer>();
  for (int i=0; i < plan.length - 1; ++i) {
    int fragment_dep=-1;
    if (plan[i].fragmentId == SysProcFragmentId.PF_restoreLoadReplicatedTable) {
      fragment_dep=(Integer)plan[i].parameters.toArray()[1];
    }
 else     if (plan[i].fragmentId == SysProcFragmentId.PF_restoreDistributeReplicatedTable) {
      fragment_dep=(Integer)plan[i].parameters.toArray()[2];
    }
    plan_deps.add(fragment_dep);
  }
  assertTrue(aggregate_deps.equals(plan_deps));
}
