{
  if ((tableNamePattern != null && !tableNamePattern.equals("%")) || (types != null && types.length > tableTypes.length))   throw new SQLException(String.format("getTables('%s','%s','%s',%d) does not support pattern filtering",catalog,schemaPattern,tableNamePattern,types != null ? types.length : 0));
  checkClosed();
  this.sysCatalog.setString(1,"TABLES");
  JDBC4ResultSet res=(JDBC4ResultSet)this.sysCatalog.executeQuery();
  VoltTable vtable=res.getVoltTable().clone(0);
  List<String> typeStrings=null;
  if (types != null) {
    typeStrings=Arrays.asList(types);
  }
  while (res.next()) {
    if (typeStrings == null || typeStrings.contains(res.getString("TABLE_TYPE"))) {
      vtable.addRow(res.getRowData());
    }
  }
  return new JDBC4ResultSet(this.sysCatalog,vtable);
}
