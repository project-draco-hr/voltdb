{
  boolean savedGuard=PlanAssembler.HANDLE_WINDOWED_OPERATORS;
  PlanAssembler.HANDLE_WINDOWED_OPERATORS=true;
  try {
    String windowedQuery;
    windowedQuery="SELECT A+B, MOD(A, B), B, RANK() OVER (PARTITION BY A, C ORDER BY B DESC) AS ARANK FROM AAA;";
    validateWindowedFunctionPlan(windowedQuery,3,2);
    windowedQuery="SELECT RANK() OVER (PARTITION BY A, C ORDER BY B DESC) AS ARANK, A+B, MOD(A, B), B FROM AAA;";
    validateWindowedFunctionPlan(windowedQuery,3,2);
    windowedQuery="SELECT A+B, MOD(A, B), B, RANK() OVER (PARTITION BY A, B ORDER BY B DESC) AS ARANK FROM AAA;";
    validateWindowedFunctionPlan(windowedQuery,2,1);
    windowedQuery="SELECT A+B, MOD(A, B), B, RANK() OVER (PARTITION BY B, A ORDER BY B DESC ) AS ARANK FROM AAA;";
    validateWindowedFunctionPlan(windowedQuery,2,0);
  }
  finally {
    PlanAssembler.HANDLE_WINDOWED_OPERATORS=savedGuard;
  }
}
