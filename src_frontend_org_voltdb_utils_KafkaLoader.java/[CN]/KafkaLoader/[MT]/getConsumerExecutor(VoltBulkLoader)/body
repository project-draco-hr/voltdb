{
  String blist[]=config.brokers.split(",");
  for (  String hostString : blist) {
    String split[]=hostString.split(":");
    String host=split[0];
    String port=split[1];
    KafkaConsumerConnector conn=new KafkaConsumerConnector(host,port);
    m_consumers.add(conn);
  }
  for (  KafkaConsumerConnector rh : m_consumers) {
    rh.buildConfig(config.zookeeper);
  }
  ExecutorService executor=Executors.newFixedThreadPool(m_consumers.size() * 2);
  KafkaConsumer bconsumer;
  Map<String,Integer> topicCountMap=new HashMap<String,Integer>();
  topicCountMap.put(config.topic,new Integer(3));
  for (  KafkaConsumerConnector rh : m_consumers) {
    Map<String,List<KafkaStream<byte[],byte[]>>> consumerMap=rh.consumer.createMessageStreams(topicCountMap);
    List<KafkaStream<byte[],byte[]>> streams=consumerMap.get(config.topic);
    for (    final KafkaStream stream : streams) {
      bconsumer=new KafkaConsumer(stream,loader);
      executor.submit(bconsumer);
    }
  }
  return executor;
}
