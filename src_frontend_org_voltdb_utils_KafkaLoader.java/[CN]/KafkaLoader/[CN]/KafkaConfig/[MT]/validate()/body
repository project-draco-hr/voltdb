{
  if (batch < 0) {
    exitWithMessageAndUsage("batch size number must be >= 0");
  }
  if (flush <= 0) {
    exitWithMessageAndUsage("Periodic Flush Interval must be > 0");
  }
  if (table.length() <= 0) {
    exitWithMessageAndUsage("Table must be specified.");
  }
  if (topic.length() <= 0) {
    exitWithMessageAndUsage("Topic must be specified.");
  }
  if (zookeeper.length() <= 0) {
    exitWithMessageAndUsage("Kafka Zookeeper must be specified.");
  }
  if (port < 0) {
    exitWithMessageAndUsage("port number must be >= 0");
  }
  try {
    KafkaConfig.class.getClassLoader().loadClass("org.I0Itec.zkclient.IZkStateListener");
    KafkaConfig.class.getClassLoader().loadClass("org.apache.zookeeper.Watcher");
  }
 catch (  ClassNotFoundException cnfex) {
    System.out.println("Cannot find the Zookeeper libraries, zkclient-0.3.jar and zookeeper-3.3.4.jar.");
    System.out.println("Use the ZKLIB environment variable to specify the path to the Zookeeper jars files.");
    System.exit(1);
  }
}
