{
  ConsumerIterator<byte[],byte[]> it=m_stream.iterator();
  while (it.hasNext()) {
    MessageAndMetadata<byte[],byte[]> md=it.next();
    byte msg[]=md.message();
    long offset=md.offset();
    String smsg=new String(msg);
    try {
      if (!m_loader.insertRow(new CSVLineWithMetaData(smsg,offset),m_csvParser.parseLine(smsg))) {
        break;
      }
    }
 catch (    InterruptedException ex) {
      m_log.error("Consumer stopped",ex);
    }
catch (    IOException ex) {
      m_log.error("Consumer stopped",ex);
    }
  }
}
