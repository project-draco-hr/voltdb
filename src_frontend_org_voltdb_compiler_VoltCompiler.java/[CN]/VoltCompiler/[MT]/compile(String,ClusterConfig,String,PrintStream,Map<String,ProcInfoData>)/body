{
  m_hsql=null;
  m_projectFileURL=projectFileURL;
  m_jarOutputPath=jarOutputPath;
  m_outputStream=output;
  m_procInfoOverrides=procInfoOverrides;
  compilerLog.l7dlog(Level.INFO,LogKeys.compiler_VoltCompiler_LeaderAndHostCountAndSitesPerHost.name(),new Object[]{clusterConfig.getLeaderAddress(),clusterConfig.getHostCount(),clusterConfig.getSitesPerHost()},null);
  final Catalog catalog=compileCatalog(projectFileURL,clusterConfig);
  if (catalog == null)   return false;
  final String catalogCommands=catalog.serialize();
  final ExecutionEngine ee=new ExecutionEngineJNI(null,catalog.getRelativeIndex(),1,0,0,"");
  try {
    ee.loadCatalog(catalogCommands);
  }
 catch (  final EEException e) {
    addErr("Failed to load plan fragments in EE");
    return false;
  }
  byte[] catalogBytes=null;
  try {
    catalogBytes=catalogCommands.getBytes("UTF-8");
  }
 catch (  final UnsupportedEncodingException e1) {
    addErr("Can't encode the compiled catalog file correctly");
    return false;
  }
  try {
    m_jarBuilder.addEntry("catalog.txt",catalogBytes);
    m_jarBuilder.addEntry("project.xml",new File(projectFileURL));
    for (    final Entry<String,String> e : m_ddlFilePaths.entrySet())     m_jarBuilder.addEntry(e.getKey(),new File(e.getValue()));
    m_jarBuilder.writeJarToDisk(jarOutputPath);
  }
 catch (  final VoltCompilerException e) {
    return false;
  }
  assert(!hasErrors());
  if (hasErrors()) {
    return false;
  }
  return true;
}
