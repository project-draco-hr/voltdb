{
  String[] volt_servers=null;
  String user=null;
  String password=null;
  String nonce=null;
  Escaper escaper=null;
  File outdir=null;
  boolean discard=false;
  for (int ii=0; ii < args.length; ii++) {
    String arg=args[ii];
    if (arg.equals("--help")) {
      printHelpAndQuit(0);
    }
 else     if (arg.equals("--discard")) {
      discard=true;
    }
 else     if (arg.equals("--servers")) {
      if (args.length < ii + 1) {
        System.err.println("Error: Not enough args following --servers");
        printHelpAndQuit(-1);
      }
      volt_servers=args[ii + 1].split(",");
      ii++;
    }
 else     if (arg.equals("--type")) {
      if (args.length < ii + 1) {
        System.err.println("Error: Not enough args following --type");
        printHelpAndQuit(-1);
      }
      String type=args[ii + 1];
      if (type.equalsIgnoreCase("csv")) {
        escaper=new CSVEscaper();
      }
 else       if (type.equalsIgnoreCase("tsv")) {
        escaper=new TSVEscaper();
      }
 else {
        System.err.println("Error: --type must be one of CSV or TSV");
        printHelpAndQuit(-1);
      }
      ii++;
    }
 else     if (arg.equals("--outdir")) {
      if (args.length < ii + 1) {
        System.err.println("Error: Not enough args following --outdir");
        printHelpAndQuit(-1);
      }
      boolean invalidDir=false;
      outdir=new File(args[ii + 1]);
      if (!outdir.exists()) {
        System.err.println("Error: " + outdir.getPath() + " does not exist");
        invalidDir=true;
      }
      if (!outdir.canRead()) {
        System.err.println("Error: " + outdir.getPath() + " does not have read permission set");
        invalidDir=true;
      }
      if (!outdir.canExecute()) {
        System.err.println("Error: " + outdir.getPath() + " does not have execute permission set");
        invalidDir=true;
      }
      if (!outdir.canWrite()) {
        System.err.println("Error: " + outdir.getPath() + " does not have write permission set");
        invalidDir=true;
      }
      if (invalidDir) {
        System.exit(-1);
      }
      ii++;
    }
 else     if (arg.equals("--nonce")) {
      if (args.length < ii + 1) {
        System.err.println("Error: Not enough args following --nonce");
        printHelpAndQuit(-1);
      }
      nonce=args[ii + 1];
      ii++;
    }
 else     if (arg.equals("--user")) {
      if (args.length < ii + 1) {
        System.err.println("Error: Not enough args following --user");
        printHelpAndQuit(-1);
      }
      user=args[ii + 1];
      ii++;
    }
 else     if (arg.equals("--password")) {
      if (args.length < ii + 1) {
        System.err.println("Error: Not enough args following --password");
        printHelpAndQuit(-1);
      }
      password=args[ii + 1];
      ii++;
    }
  }
  if (volt_servers == null || volt_servers.length < 1) {
    System.err.println("ExportToFile: must provide at least one VoltDB server");
    printHelpAndQuit(-1);
  }
  if (user == null) {
    System.err.println("ExportToFile: must provide a username");
    printHelpAndQuit(-1);
  }
  if (password == null) {
    System.err.println("ExportToFile: must provide a password");
    printHelpAndQuit(-1);
  }
  if (escaper == null) {
    System.err.println("ExportToFile: must provide an output type");
    printHelpAndQuit(-1);
  }
  if (!discard) {
    if (nonce == null) {
      System.err.println("ExportToFile: must provide a filename nonce");
      printHelpAndQuit(-1);
    }
    if (outdir == null) {
      outdir=new File(".");
    }
  }
 else {
    outdir=null;
    nonce=null;
  }
  ExportToFileClient client=new ExportToFileClient(escaper,nonce,outdir);
  client.setVoltServers(volt_servers,null);
  try {
    client.connectToExportServers(user,password);
  }
 catch (  IOException e) {
    m_logger.fatal("Unable to connect to VoltDB servers for export");
    System.exit(-1);
  }
  client.run();
}
