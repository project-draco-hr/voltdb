{
  m_batchLock.writeLock().lock();
  final PeriodicExportContext previous=m_current;
  try {
    m_current=new PeriodicExportContext();
    m_logger.trace("Rolling batch.");
    for (    Map<String,ExportToFileDecoder> genDecoders : m_tableDecoders.values()) {
      for (      ExportToFileDecoder decoder : genDecoders.values()) {
        decoder.resetWriter();
      }
    }
  }
  finally {
    m_batchLock.writeLock().unlock();
  }
  previous.closeAllWriters();
}
