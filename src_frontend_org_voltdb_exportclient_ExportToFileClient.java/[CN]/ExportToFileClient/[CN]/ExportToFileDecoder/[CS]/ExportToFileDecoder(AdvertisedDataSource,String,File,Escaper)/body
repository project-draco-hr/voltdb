{
  super(source);
  m_escaper=escaper;
  String filename=null;
  if (outdir != null) {
    filename=nonce + "-" + source.tableName()+ "."+ escaper.getExtension();
    m_logger.info("Opening filename " + filename);
    m_outFile=new File(outdir.getPath() + File.separator + filename);
    boolean fail=false;
    try {
      if (!m_outFile.createNewFile()) {
        m_logger.error("Error: Failed to create output file " + m_outFile.getPath() + " for table "+ source.tableName()+ ": File already exists");
        fail=true;
      }
    }
 catch (    IOException e) {
      m_logger.error(e.getMessage());
      m_logger.error("Error: Failed to create output file " + m_outFile.getPath() + " for table "+ source.tableName());
      fail=true;
    }
    if (fail) {
      throw new RuntimeException();
    }
  }
 else {
    m_logger.error("--discard provided, data will be dumped to /dev/null");
    filename="/dev/null";
    m_outFile=new File("/dev/null");
  }
  try {
    m_fos=new FileOutputStream(m_outFile,true);
  }
 catch (  FileNotFoundException e) {
    String msg="Unable to open output file: " + filename;
    m_logger.fatal(msg);
    throw new RuntimeException(msg);
  }
}
