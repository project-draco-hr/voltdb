{
  super(source);
  m_escaper=escaper;
  m_Writer=null;
  m_firstfield=firstfield;
  m_sdf=new SimpleDateFormat("yyyy.MM.dd HH:mm:ss:SSS:");
  if (outdir != null) {
    String filename=null;
    try {
      filename=outdir.getPath() + File.separator + nonce+ "-"+ source.tableName()+ "."+ escaper.getExtension();
      m_logger.info("Opening filename " + filename);
      m_Writer=new BufferedWriter(new OutputStreamWriter(new FileOutputStream(filename),"UTF-8"),1048576);
      m_discard=false;
    }
 catch (    Exception e) {
      m_logger.error(e.getMessage());
      m_logger.error("Error: Failed to create output file: " + filename + " for table "+ source.tableName());
      throw new RuntimeException();
    }
  }
 else {
    m_logger.error("--discard provided, data will be dumped to /dev/null");
    m_discard=true;
  }
}
