{
  Calendar calendar=Calendar.getInstance();
  Date now=calendar.getTime();
  calendar.add(Calendar.MINUTE,-m_period);
  Date periodCheck=calendar.getTime();
  if ((m_lastWriterCreation != null) && m_lastWriterCreation.after(periodCheck)) {
    return;
  }
  String filename=m_prefix + m_dateformat.format(now) + m_extension;
  if (filename == m_currentFilename) {
    return;
  }
 else {
    if (m_writer != null) {
      try {
        m_writer.flush();
        m_writer.close();
      }
 catch (      Exception e) {
        m_logger.error(e.getMessage());
        throw new RuntimeException();
      }
    }
    m_currentFilename=filename;
    m_lastWriterCreation=now;
  }
  m_logger.info("Opening filename " + m_currentFilename);
  try {
    if (m_delimiter == '\t') {
      m_writer=CSVWriter.getStrictTSVWriter(new BufferedWriter(new OutputStreamWriter(new FileOutputStream(m_currentFilename,true),"UTF-8"),1048576));
    }
 else {
      m_writer=new CSVWriter(new BufferedWriter(new OutputStreamWriter(new FileOutputStream(m_currentFilename,true),"UTF-8"),1048576),m_delimiter);
    }
  }
 catch (  Exception e) {
    m_logger.error(e.getMessage());
    m_logger.error("Error: Failed to create output file: " + m_currentFilename);
    throw new RuntimeException();
  }
}
