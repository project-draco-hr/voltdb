{
  if (m_batched) {
synchronized (m_batchDirNamingLock) {
      File dirContainingFiles=null;
      do {
        start=new Date();
        dirContainingFiles=new VoltFile(getPathOfBatchDir(ACTIVE_PREFIX));
        if (dirContainingFiles.exists()) {
          try {
            Thread.sleep(1000);
          }
 catch (          InterruptedException e) {
            Throwables.propagate(e);
          }
        }
      }
 while (dirContainingFiles.exists());
      m_dirContainingFiles=dirContainingFiles;
    }
    m_logger.trace(String.format("Creating dir for batch at %s",m_dirContainingFiles.getPath()));
    m_dirContainingFiles.mkdirs();
    if (m_dirContainingFiles.exists() == false) {
      m_logger.error("Error: Unable to create batch directory at path: " + m_dirContainingFiles.getPath());
      throw new RuntimeException("Unable to create batch directory.");
    }
  }
 else {
    m_dirContainingFiles=m_outDir;
  }
}
