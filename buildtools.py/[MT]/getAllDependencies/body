def getAllDependencies(inputs, threads, retval={}):
    if (threads == 1):
        for (filename, cppflags, sysprefixes) in inputs:
            retval[filename] = getDependencies(filename, cppflags, sysprefixes)
    else:
        r2 = {}
        t1 = threading.Thread(None, getAllDependencies, 'checkdeps1', (inputs[:(len(inputs) / 2)], 1, retval))
        t2 = threading.Thread(None, getAllDependencies, 'checkdeps2', (inputs[(len(inputs) / 2):], 1, r2))
        t1.start()
        t2.start()
        t1.join()
        t2.join()
        retval.update(r2)
    return retval
