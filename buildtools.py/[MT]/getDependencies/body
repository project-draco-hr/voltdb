def getDependencies(filename, cppflags, sysprefixes):
    command = ('g++ %s -MM %s' % (cppflags, filename))
    pipe = Popen(args=command, shell=True, bufsize=(-1), stdout=PIPE, stderr=PIPE)
    out = pipe.stdout.readlines()
    out_err = pipe.stderr.readlines()
    retcode = pipe.wait()
    if (retcode != 0):
        print ('Error Determining Dependencies for: %s' % filename)
        print ''.join(out_err)
        sys.exit((-1))
    if (len(out) > 0):
        out = out[1:]
    out = ' '.join(out)
    out = out.split()
    out = [x.strip() for x in out]
    out = [x for x in out if (x != '\\')]
    out = [x for x in out if (not startsWithFromTuple(x, tuple(sysprefixes)))]
    return out
