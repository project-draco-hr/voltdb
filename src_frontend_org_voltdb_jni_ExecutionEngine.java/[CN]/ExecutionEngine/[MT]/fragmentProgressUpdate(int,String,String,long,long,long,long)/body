{
  ++m_callsFromEE;
  m_lastTuplesAccessed=tuplesProcessed;
  long currentTime=System.currentTimeMillis();
  if (m_startTime == 0) {
    m_startTime=m_lastMsgTime=currentTime;
    return LONG_OP_THRESHOLD;
  }
  if (currentTime <= (m_logDuration + m_lastMsgTime)) {
    return LONG_OP_THRESHOLD;
  }
  String msg=String.format("Procedure %s is taking a long time to execute -- at least " + "%.1f seconds spent accessing " + "%d tuples. Current plan fragment "+ "%s in call "+ "%d to voltExecuteSQL on site "+ "%s. Current temp table uses "+ "%d bytes memory, and the peak usage of memory for temp table is "+ "%d bytes.",m_currentProcedureName,(currentTime - m_startTime) / 1000.0,tuplesProcessed,planNodeName,m_currentBatchIndex,CoreUtils.hsIdToString(m_siteId),currMemoryInBytes,peakMemroyInBytes);
  log.info(msg);
  m_logDuration=(m_logDuration < 30000) ? (2 * m_logDuration) : 30000;
  m_lastMsgTime=currentTime;
  return LONG_OP_THRESHOLD;
}
