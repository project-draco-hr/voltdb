{
  ++m_callsFromEE;
  m_lastTuplesAccessed=tuplesProcessed;
  m_currMemoryInBytes=currMemoryInBytes;
  m_peakMemoryInBytes=peakMemoryInBytes;
  long currentTime=System.currentTimeMillis();
  if (m_startTime == 0) {
    m_startTime=m_lastMsgTime=currentTime;
    return LONG_OP_THRESHOLD;
  }
  long latency=currentTime - m_startTime;
  if (m_readOnly && TIME_OUT_MILLIS > 0 && latency > TIME_OUT_MILLIS) {
    String msg=getLongRunningQueriesMessage(latency,planNodeName,true);
    log.info(msg);
    return -1 * latency;
  }
  if (currentTime <= (m_logDuration + m_lastMsgTime)) {
    return LONG_OP_THRESHOLD;
  }
  String msg=getLongRunningQueriesMessage(latency,planNodeName,false);
  log.info(msg);
  m_logDuration=(m_logDuration < 30000) ? (2 * m_logDuration) : 30000;
  m_lastMsgTime=currentTime;
  return LONG_OP_THRESHOLD;
}
