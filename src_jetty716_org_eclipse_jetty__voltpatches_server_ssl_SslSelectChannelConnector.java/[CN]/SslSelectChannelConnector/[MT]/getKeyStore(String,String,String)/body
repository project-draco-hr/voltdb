{
  KeyStore keystore;
  InputStream keystoreInputStream=null;
  try {
    if (keystorePath != null)     keystoreInputStream=Resource.newResource(keystorePath).getInputStream();
    keystore=KeyStore.getInstance(keystoreType);
    keystore.load(keystoreInputStream,keystorePassword == null ? null : keystorePassword.toString().toCharArray());
    return keystore;
  }
  finally {
    if (keystoreInputStream != null)     keystoreInputStream.close();
  }
}
