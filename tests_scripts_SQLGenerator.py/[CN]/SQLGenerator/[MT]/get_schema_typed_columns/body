def get_schema_typed_columns(self, table, type_str, quota):
    if (type_str in self.TYPES):
        types = self.TYPES[type_str]
    else:
        types = None
    typed_columns = [(column[0], column[1]) for column in self.__schema.get_columns(table) if ((not types) or (column[1] in types))]
    while (len(typed_columns) > quota):
        i = random.randint(0, (len(typed_columns) - 1))
        del typed_columns[i:(i + 1)]
    return typed_columns
