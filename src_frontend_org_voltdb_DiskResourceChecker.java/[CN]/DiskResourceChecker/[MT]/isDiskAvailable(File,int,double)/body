{
  boolean canWrite=(s_testFileCheck == null) ? filePath.canWrite() : s_testFileCheck.canWrite(filePath);
  if (!canWrite) {
    m_logger.warn("Invalid or readonly file path " + filePath);
    return false;
  }
  long total=(s_testFileCheck == null) ? filePath.getTotalSpace() : s_testFileCheck.getTotalSpace(filePath);
  long usable=(s_testFileCheck == null) ? filePath.getUsableSpace() : s_testFileCheck.getUsableSpace(filePath);
  long calculatedThreshold=Math.round(sizeThreshold * 1073741824);
  if (percThreshold > 0) {
    calculatedThreshold=Math.round(total * percThreshold / 100.0);
  }
  long usedSpace=total - usable;
  if (m_logger.isDebugEnabled()) {
    m_logger.debug(String.format("File system for path %s has total space=%d and used space=%d. percentage-threshold=%d, size-threshold=%fGB, calculated-threshold=%d",filePath,total,usedSpace,percThreshold,sizeThreshold,calculatedThreshold));
  }
  if (usedSpace >= calculatedThreshold) {
    m_logger.warn(String.format("Disk space usage on %s is >= the threshold value of %s. Total space=%d, Used space=%d",filePath,(percThreshold > 0 ? percThreshold + "%" : sizeThreshold + "GB"),total,usedSpace));
    return false;
  }
 else {
    return true;
  }
}
