{
  assert(joinNode != null);
  if (joinNode.getNodeType() == JoinNode.NodeType.JOIN) {
    AbstractPlanNode outerScanPlan=getSelectSubPlanForJoinNode(joinNode.getLeftNode());
    if (outerScanPlan == null) {
      return null;
    }
    AbstractPlanNode innerScanPlan=getSelectSubPlanForJoinNode(joinNode.getRightNode());
    if (innerScanPlan == null) {
      return null;
    }
    return getSelectSubPlanForJoin(joinNode,outerScanPlan,innerScanPlan);
  }
  AbstractPlanNode scanNode=getAccessPlanForTable(joinNode.getTableAliasIndex(),joinNode.m_currentAccessPath);
  if (joinNode instanceof SubqueryLeafNode) {
    StmtSubqueryScan tableScan=((SubqueryLeafNode)joinNode).getSubqueryScan();
    CompiledPlan subQueryPlan=tableScan.getBestCostPlan();
    assert(subQueryPlan != null);
    assert(subQueryPlan.rootPlanGraph != null);
    subQueryPlan.rootPlanGraph.disconnectParents();
    scanNode.addAndLinkChild(subQueryPlan.rootPlanGraph);
  }
  return scanNode;
}
