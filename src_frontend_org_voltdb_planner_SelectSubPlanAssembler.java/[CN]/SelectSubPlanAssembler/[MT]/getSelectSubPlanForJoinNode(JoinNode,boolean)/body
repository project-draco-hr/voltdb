{
  assert(joinNode != null);
  if (joinNode.m_table != null) {
    AbstractPlanNode scanNode=getAccessPlanForTable(joinNode.m_table,joinNode.m_currentAccessPath);
    if (!isInnerNode && !joinNode.m_table.getIsreplicated() && !canDeferSendReceivePairForNode()) {
      scanNode=addSendReceivePair(scanNode);
    }
    return scanNode;
  }
 else {
    assert(joinNode.m_leftNode != null && joinNode.m_rightNode != null);
    AbstractPlanNode outerScanPlan=getSelectSubPlanForJoinNode(joinNode.m_leftNode,false);
    AbstractPlanNode innerScanPlan=getSelectSubPlanForJoinNode(joinNode.m_rightNode,true);
    AbstractPlanNode joinPlan=getSelectSubPlanForOuterAccessPathStep(joinNode,outerScanPlan,innerScanPlan);
    if (joinNode.m_rightNode.m_table != null && !joinNode.m_rightNode.m_table.getIsreplicated() && !canDeferSendReceivePairForNode()) {
      joinPlan=addSendReceivePair(joinPlan);
    }
    return joinPlan;
  }
}
