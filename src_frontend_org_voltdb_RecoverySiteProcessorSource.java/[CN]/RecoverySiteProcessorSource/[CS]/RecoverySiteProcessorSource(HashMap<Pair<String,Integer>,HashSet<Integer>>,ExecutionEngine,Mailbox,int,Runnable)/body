{
  m_mailbox=mailbox;
  m_engine=engine;
  m_siteId=siteId;
  for (  Map.Entry<Pair<String,Integer>,HashSet<Integer>> entry : tableToSites.entrySet()) {
    m_tablesToStream.add(new RecoveryTable(entry.getKey().getFirst(),entry.getKey().getSecond(),entry.getValue()));
    if (!m_engine.activateTableStream(entry.getKey().getSecond(),TableStreamType.RECOVERY)) {
      hostLog.error("Attempted to activate recovery stream for table " + entry.getKey().getFirst() + " and failed");
      VoltDB.crashVoltDB();
    }
  }
  m_onCompletion=onCompletion;
}
