{
  for (int ii=0; ii < m_numBuffers; ii++) {
    final BBContainer origin=org.voltdb.utils.DBBPool.allocateDirect(m_bufferLength);
    long bufferAddress=0;
    if (VoltDB.getLoadLibVOLTDB()) {
      bufferAddress=org.voltdb.utils.DBBPool.getBufferAddress(origin.b);
    }
    final BBContainer buffer=new BBContainer(origin.b,bufferAddress){
      /** 
 * This method is careful to check if recovery is complete and if it is,
 * return the buffer to the global pool via its origin rather then returning it to this
 * pool where it will be leaked.
 */
      @Override public void discard(){
synchronized (this) {
          if (m_recoveryComplete) {
            m_bufferToOriginMap.remove(this).discard();
            return;
          }
        }
        m_buffers.offer(this);
      }
    }
;
    m_bufferToOriginMap.put(buffer,origin);
    m_buffers.offer(buffer);
  }
}
