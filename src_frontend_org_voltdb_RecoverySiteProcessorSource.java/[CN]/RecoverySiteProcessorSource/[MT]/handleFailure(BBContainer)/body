{
  container.b.clear();
  while (!m_tablesToStream.isEmpty()) {
    ByteBuffer buffer=container.b;
    buffer.clear();
    buffer.position(messageTypeOffset);
    RecoveryTable table=m_tablesToStream.peek();
    List<BBContainer> output=new ArrayList<BBContainer>();
    output.add(container);
    int serialized=m_engine.tableStreamSerializeMore(table.m_tableId,TableStreamType.RECOVERY,output)[0];
    if (serialized <= 0) {
      VoltDB.crashLocalVoltDB("Error in recovery stream",false,null);
    }
 else {
      buffer.limit(buffer.position() + serialized);
    }
    RecoveryMessageType type=RecoveryMessageType.values()[buffer.get(messageTypeOffset)];
    if (type == RecoveryMessageType.Complete) {
      m_tablesToStream.clear();
    }
  }
}
