{
  SocketChannel sc=null;
  List<Exception> exceptions=new ArrayList<Exception>();
  for (  byte address[] : addresses) {
    try {
      InetAddress inetAddr=InetAddress.getByAddress(address);
      InetSocketAddress inetSockAddr=new InetSocketAddress(inetAddr,port);
      recoveryLog.debug("Attempting to create recovery connection to " + inetSockAddr);
      sc=SocketChannel.open(inetSockAddr);
      break;
    }
 catch (    Exception e) {
      recoveryLog.debug("Failed to create a recovery connection",e);
      exceptions.add(e);
    }
  }
  if (sc == null) {
    for (    Exception e : exceptions) {
      recoveryLog.fatal("Connection error",e);
    }
    throw new IOException("Unable to create recovery connection due to previously logged exceptions");
  }
  sc.configureBlocking(true);
  sc.socket().setTcpNoDelay(true);
  return sc;
}
