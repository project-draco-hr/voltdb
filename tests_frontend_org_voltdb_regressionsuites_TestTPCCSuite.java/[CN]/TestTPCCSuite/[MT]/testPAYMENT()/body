{
  Client client=getClient();
  final double initialYTD=15241.45;
  VoltTable district=client.callProcedure("InsertDistrict",D_ID,W_ID,"A District","Street Addy","meh","westerfield","BA","99999",.0825,initialYTD,21L)[0];
  assertEquals(1L,district.asScalarLong());
  VoltTable warehouse=client.callProcedure("InsertWarehouse",W_ID,"EZ Street WHouse","Headquarters","77 Mass. Ave.","Cambridge","AZ","12938",.1234,initialYTD)[0];
  assertEquals(1L,warehouse.asScalarLong());
  final double initialBalance=15.75;
  VoltTable customer1=client.callProcedure("InsertCustomer",C_ID,D_ID,W_ID,"I","Be","lastname","Place","Place2","BiggerPlace","AL","91083","(193) 099 - 9082",new TimestampType(),"BC",19298943.12,.13,initialBalance,initialYTD,0L,15L,"Some History")[0];
  assertEquals(1L,customer1.asScalarLong());
  VoltTable customer2=client.callProcedure("InsertCustomer",C_ID + 1,D_ID,W_ID,"We","R","Customer","Random Department","Place2","BiggerPlace","AL","13908","(913) 909 - 0928",new TimestampType(),"GC",19298943.12,.13,initialBalance,initialYTD,1L,15L,"Some History")[0];
  assertEquals(1L,customer2.asScalarLong());
  VoltTable customer3=client.callProcedure("InsertCustomer",C_ID + 2,D_ID,W_ID,"Who","Is","Customer","Receiving","450 Mass F.X.","BiggerPlace","CI","91083","(541) 931 - 0928",new TimestampType(),"GC",19899324.21,.13,initialBalance,initialYTD,2L,15L,"Some History")[0];
  assertEquals(1L,customer3.asScalarLong());
  VoltTable customer4=client.callProcedure("InsertCustomer",C_ID + 3,D_ID,W_ID,"ICanBe","","Customer","street","place","BiggerPlace","MA","91083","(913) 909 - 0928",new TimestampType(),"GC",19298943.12,.13,initialBalance,initialYTD,3L,15L,"Some History")[0];
  assertEquals(1L,customer4.asScalarLong());
  final double paymentAmount=500.25;
  VoltTable[] results=client.callProcedure("paymentByCustomerName",W_ID,D_ID,paymentAmount,W_ID,D_ID,"Customer".getBytes("UTF-8"),new TimestampType());
  assertEquals(3,results.length);
  assertEquals(C_ID + 1,results[2].fetchRow(0).getLong("c_id"));
  assertEquals("",results[2].fetchRow(0).getString("c_data"));
  VoltTable[] allTables=client.callProcedure("SelectAll");
  warehouse=allTables[TPCDataPrinter.nameMap.get("WAREHOUSE")];
  assertEquals(1,warehouse.getRowCount());
  assertEquals(initialYTD + paymentAmount,warehouse.fetchRow(0).getDouble("W_YTD"));
  district=allTables[TPCDataPrinter.nameMap.get("DISTRICT")];
  assertEquals(1,district.getRowCount());
  assertEquals(initialYTD + paymentAmount,district.fetchRow(0).getDouble("D_YTD"));
  customer1=allTables[TPCDataPrinter.nameMap.get("CUSTOMER")];
  assertEquals(4,customer1.getRowCount());
  assertEquals(C_ID + 1,customer1.fetchRow(1).getLong("C_ID"));
  assertEquals(initialBalance - paymentAmount,customer1.fetchRow(1).getDouble("C_BALANCE"));
  assertEquals(initialYTD + paymentAmount,customer1.fetchRow(1).getDouble("C_YTD_PAYMENT"));
  assertEquals(2,customer1.fetchRow(1).getLong("C_PAYMENT_CNT"));
  results=client.callProcedure("paymentByCustomerId",W_ID,D_ID,paymentAmount,W_ID,D_ID,C_ID,new TimestampType());
  assertEquals(3,results.length);
  assertEquals(C_ID,results[2].fetchRow(0).getLong("c_id"));
  String data=results[2].fetchRow(0).getString("c_data");
  assertTrue(data.startsWith(new Long(C_ID).toString()));
  allTables=client.callProcedure("SelectAll");
  warehouse=allTables[TPCDataPrinter.nameMap.get("WAREHOUSE")];
  assertEquals(1,warehouse.getRowCount());
  assertEquals(initialYTD + paymentAmount * 2,warehouse.fetchRow(0).getDouble("W_YTD"));
  district=allTables[TPCDataPrinter.nameMap.get("DISTRICT")];
  assertEquals(1,district.getRowCount());
  assertEquals(initialYTD + paymentAmount * 2,district.fetchRow(0).getDouble("D_YTD"));
  customer1=allTables[TPCDataPrinter.nameMap.get("CUSTOMER")];
  assertEquals(4,customer1.getRowCount());
  assertEquals(C_ID,customer1.fetchRow(0).getLong("C_ID"));
  assertEquals(initialBalance - paymentAmount,customer1.fetchRow(1).getDouble("C_BALANCE"));
  assertEquals(initialYTD + paymentAmount,customer1.fetchRow(1).getDouble("C_YTD_PAYMENT"));
  assertEquals(1,customer1.fetchRow(0).getLong("C_PAYMENT_CNT"));
}
