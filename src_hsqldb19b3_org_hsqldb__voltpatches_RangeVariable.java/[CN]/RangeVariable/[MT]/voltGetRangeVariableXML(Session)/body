{
  Index index;
  Index primaryIndex;
  int[] primaryKey;
  index=rangeIndex;
  primaryIndex=rangeTable.getPrimaryIndex();
  primaryKey=rangeTable.getPrimaryKey();
  if (rangeTable.tableType == TableBase.SYSTEM_SUBQUERY) {
    throw new HSQLParseException("VoltDB does not support subqueries, consider using views instead");
  }
  if (index == null)   index=primaryIndex;
  VoltXMLElement scan=new VoltXMLElement("tablescan");
  scan.attributes.put("table",rangeTable.getName().name);
  if (tableAlias != null && !rangeTable.getName().name.equals(tableAlias)) {
    scan.attributes.put("tablealias",tableAlias.name);
  }
  if (isLeftJoin && isRightJoin) {
    scan.attributes.put("jointype","full");
  }
 else   if (isLeftJoin) {
    scan.attributes.put("jointype","left");
  }
 else   if (isRightJoin) {
    scan.attributes.put("jointype","right");
  }
 else {
    scan.attributes.put("jointype","inner");
  }
  Expression cond=indexCondition;
  if (indexEndCondition != null) {
    if (cond != null) {
      cond=new ExpressionLogical(OpTypes.AND,cond,indexEndCondition);
    }
 else {
      cond=indexEndCondition;
    }
  }
  Expression joinConditions=null;
  Expression whereConditions=null;
  if (isJoinIndex) {
    joinConditions=cond;
  }
 else {
    whereConditions=cond;
  }
  if (nonIndexJoinCondition != null) {
    if (joinConditions != null) {
      joinConditions=new ExpressionLogical(OpTypes.AND,joinConditions,nonIndexJoinCondition);
    }
 else {
      joinConditions=nonIndexJoinCondition;
    }
  }
  if (joinConditions != null) {
    joinConditions=joinConditions.eliminateDuplicates(session);
    VoltXMLElement joinCond=new VoltXMLElement("joincond");
    joinCond.children.add(joinConditions.voltGetXML(session));
    scan.children.add(joinCond);
  }
  if (nonIndexWhereCondition != null) {
    if (whereConditions != null) {
      whereConditions=new ExpressionLogical(OpTypes.AND,whereConditions,nonIndexWhereCondition);
    }
 else {
      whereConditions=nonIndexWhereCondition;
    }
  }
  if (whereConditions != null) {
    whereConditions=whereConditions.eliminateDuplicates(session);
    VoltXMLElement whereCond=new VoltXMLElement("wherecond");
    whereCond.children.add(whereConditions.voltGetXML(session));
    scan.children.add(whereCond);
  }
  return scan;
}
