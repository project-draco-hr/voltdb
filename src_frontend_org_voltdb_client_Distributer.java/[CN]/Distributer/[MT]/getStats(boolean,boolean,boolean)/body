{
  final Long since=System.currentTimeMillis();
  Map<String,ArrayList<ClientStats>> stats=new TreeMap<String,ArrayList<ClientStats>>();
  for (  NodeConnection conn : m_connections) {
    ArrayList<ClientStats> connStats=conn.getStats(interval,rollupProcedures,since);
    for (    ClientStats cs : connStats) {
      ArrayList<ClientStats> procStats=stats.get(cs.name);
      if (procStats == null) {
        procStats=new ArrayList<ClientStats>();
        stats.put(cs.name,procStats);
      }
      procStats.add(cs);
    }
  }
  ArrayList<ClientStats> retval=new ArrayList<ClientStats>();
  for (  ArrayList<ClientStats> cslist : stats.values()) {
    if (rollupConnections) {
      ClientStats s=ClientStats.merge(cslist);
      retval.add(s);
    }
 else {
      retval.addAll(cslist);
    }
  }
  return retval.toArray(new ClientStats[0]);
}
