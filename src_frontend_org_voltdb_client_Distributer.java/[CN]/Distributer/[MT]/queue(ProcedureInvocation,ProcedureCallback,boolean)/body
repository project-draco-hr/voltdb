{
  NodeConnection cxn=null;
  boolean backpressure=true;
synchronized (this) {
    final int totalConnections=m_connections.size();
    if (totalConnections == 0) {
      throw new NoConnectionsException("No connections.");
    }
    for (int i=0; i < totalConnections; ++i) {
      cxn=m_connections.get(Math.abs(++m_nextConnection % totalConnections));
      if (!cxn.hadBackPressure() || ignoreBackpressure) {
        backpressure=false;
        break;
      }
    }
    if (backpressure) {
      cxn=null;
      for (      ClientStatusListenerExt s : m_listeners) {
        s.backpressure(true);
      }
    }
  }
  if (cxn != null) {
    ByteBuffer buf=ByteBuffer.allocate(4 + invocation.getSerializedSize());
    buf.putInt(buf.capacity() - 4);
    try {
      invocation.flattenToBuffer(buf);
      buf.flip();
    }
 catch (    Exception e) {
      throw new RuntimeException(e);
    }
    cxn.createWork(invocation.getHandle(),invocation.getProcName(),buf,cb);
  }
  return !backpressure;
}
