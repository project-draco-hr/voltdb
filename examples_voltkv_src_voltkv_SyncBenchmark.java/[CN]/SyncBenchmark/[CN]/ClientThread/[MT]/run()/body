{
  ClientConnection con=null;
  try {
    con=ClientConnectionPool.get(servers,port);
    long endTime=System.currentTimeMillis() + (1000l * this.duration);
    Random rand=new Random();
    while (endTime > System.currentTimeMillis()) {
      if (rand.nextDouble() < getPutRatio) {
        try {
          VoltTable pairData=con.execute("Get",processor.generateRandomKeyForRetrieval()).getResults()[0];
          if (pairData.getRowCount() == 0)           GetStoreResults.incrementAndGet(1);
 else {
            final PayloadProcessor.Pair pair=processor.retrieveFromStore(pairData.fetchRow(0).getString(0),pairData.fetchRow(0).getVarbinary(1));
            GetStoreResults.incrementAndGet(0);
            GetCompressionResults.addAndGet(0,pair.getStoreValueLength());
            GetCompressionResults.addAndGet(1,pair.getRawValueLength());
          }
        }
 catch (        Exception x) {
          GetStoreResults.incrementAndGet(1);
        }
      }
 else {
        final PayloadProcessor.Pair pair=processor.generateForStore();
        try {
          con.execute("Put",pair.Key,pair.getStoreValue());
          PutStoreResults.incrementAndGet(0);
        }
 catch (        Exception x) {
          PutStoreResults.incrementAndGet(1);
        }
 finally {
          PutCompressionResults.addAndGet(0,pair.getStoreValueLength());
          PutCompressionResults.addAndGet(1,pair.getRawValueLength());
        }
      }
    }
  }
 catch (  Exception x) {
    System.err.println("Exception: " + x);
    x.printStackTrace();
  }
 finally {
    try {
      con.close();
    }
 catch (    Exception x) {
    }
  }
}
