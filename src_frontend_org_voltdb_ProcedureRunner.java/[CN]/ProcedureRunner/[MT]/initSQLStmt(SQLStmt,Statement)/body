{
  int fragCount=catStmt.getFragments().size();
  for (  PlanFragment frag : catStmt.getFragments()) {
    byte[] planHash=Encoder.hexDecode(frag.getPlanhash());
    byte[] plan=Encoder.decodeBase64AndDecompressToBytes(frag.getPlannodetree());
    long id=ActivePlanRepository.loadOrAddRefPlanFragment(planHash,plan,catStmt.getSqltext());
    boolean transactional=frag.getNontransactional() == false;
    SQLStmt.Frag stmtFrag=new SQLStmt.Frag(id,planHash,transactional);
    if (fragCount == 1 || frag.getHasdependencies()) {
      stmt.aggregator=stmtFrag;
    }
 else {
      stmt.collector=stmtFrag;
    }
  }
  stmt.isReadOnly=catStmt.getReadonly();
  stmt.isReplicatedTableDML=catStmt.getReplicatedtabledml();
  stmt.site=m_site;
  int numStatementParamJavaTypes=catStmt.getParameters().size();
  stmt.statementParamJavaTypes=new byte[numStatementParamJavaTypes];
  for (  StmtParameter param : catStmt.getParameters()) {
    stmt.statementParamJavaTypes[param.getIndex()]=(byte)param.getJavatype();
  }
}
