{
  if (m_catProc.getSinglepartition()) {
    StoredProcedureInvocation invocation=txnState.getInvocation();
    int parameterType;
    Object parameterAtIndex;
    if (m_isSysProc && invocation.getProcName().startsWith("@AdHoc")) {
      parameterAtIndex=invocation.getParameterAtIndex(0);
      parameterType=((Byte)invocation.getParameterAtIndex(1)).intValue();
    }
 else     if (!m_isSysProc) {
      parameterType=m_catProc.getPartitioncolumn().getType();
      int partitionparameter=m_catProc.getPartitionparameter();
      parameterAtIndex=invocation.getParameterAtIndex(partitionparameter);
    }
 else {
      return true;
    }
    try {
      int partition=TheHashinator.getPartitionForParameter(parameterType,parameterAtIndex);
      if (partition == m_site.getCorrespondingPartitionId()) {
        return true;
      }
 else {
        if (log.isTraceEnabled()) {
          log.trace("Txn " + txnState.getInvocation().getProcName() + " will be restarted");
        }
      }
    }
 catch (    Exception e) {
      log.warn("Unable to check partitioning of transaction " + txnState.spHandle,e);
    }
    return false;
  }
 else {
    return true;
  }
}
