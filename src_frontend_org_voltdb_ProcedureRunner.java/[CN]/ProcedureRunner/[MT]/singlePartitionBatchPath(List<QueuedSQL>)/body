{
  assert(batch.size() > 0);
  if (m_batchHasAdhoc) {
    for (    QueuedSQL qs : batch) {
      if (qs.stmt.plan != null) {
        long fragId=m_site.loadPlanFragment(qs.stmt.plan.getAggregatorFragment());
        assert(fragId != 0);
        qs.stmt.fragGUIDs[0]=fragId;
      }
    }
  }
  int i=0;
  for (  final QueuedSQL qs : batch) {
    assert(qs.stmt.fragGUIDs.length == 1);
    m_fragIdArray[i]=qs.stmt.fragGUIDs[0];
    m_paramSetArray[i]=qs.params;
    i++;
  }
  return m_site.executePlanFragments(batch.size(),m_fragIdArray,null,m_paramSetArray,m_txnState.txnId,m_catProc.getReadonly());
}
