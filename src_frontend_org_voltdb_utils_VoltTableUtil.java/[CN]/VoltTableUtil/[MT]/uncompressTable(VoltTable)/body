{
  if (!vt.advanceRow()) {
    throw new RuntimeException("Table does not contain a row to decompress");
  }
  if (vt.getColumnCount() != 1) {
    throw new RuntimeException("Table should only contain one column");
  }
  if (!vt.getColumnName(0).isEmpty()) {
    throw new RuntimeException("Table column name should be empty");
  }
  if (vt.getColumnType(0) != VoltType.VARBINARY) {
    throw new RuntimeException("Table column type is not varbinary");
  }
  byte compressedTableBytes[]=vt.getVarbinary(0);
  try {
    return PrivateVoltTableFactory.createVoltTableFromBuffer(ByteBuffer.wrap(org.xerial.snappy.Snappy.uncompress(compressedTableBytes)),false);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
