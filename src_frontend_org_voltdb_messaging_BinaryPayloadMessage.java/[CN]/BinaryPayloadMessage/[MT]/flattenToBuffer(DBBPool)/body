{
  int msgsize=m_metadata.length + 6;
  if (m_payload != null) {
    msgsize+=m_payload.length;
  }
  if (m_buffer == null) {
    m_container=pool.acquire(msgsize + 1 + HEADER_SIZE);
    m_buffer=m_container.b;
  }
  setBufferSize(msgsize + 1,pool);
  m_buffer.position(HEADER_SIZE);
  m_buffer.put(BINARY_PAYLOAD_ID);
  m_buffer.putShort((short)m_metadata.length);
  m_buffer.put(m_metadata);
  if (m_payload == null) {
    m_buffer.putInt(-1);
  }
 else {
    m_buffer.putInt(m_payload.length);
    m_buffer.put(m_payload);
  }
}
