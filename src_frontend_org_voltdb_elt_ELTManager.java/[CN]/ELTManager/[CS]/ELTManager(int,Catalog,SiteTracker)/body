{
  final Cluster cluster=catalog.getClusters().get("cluster");
  final Database db=cluster.getDatabases().get("database");
  final Connector conn=db.getConnectors().get("0");
  if (conn == null) {
    return;
  }
  if (conn.getEnabled() == false) {
    eltLog.info("Export is disabled by user configuration.");
    return;
  }
  final String elloader=conn.getLoaderclass();
  try {
    eltLog.info("Creating connector " + elloader);
    ELTDataProcessor newProcessor=null;
    final Class<?> loaderClass=Class.forName(elloader);
    newProcessor=(ELTDataProcessor)loaderClass.newInstance();
    newProcessor.addLogger(eltLog);
    Iterator<ConnectorTableInfo> tableInfoIt=conn.getTableinfo().iterator();
    while (tableInfoIt.hasNext()) {
      ConnectorTableInfo next=tableInfoIt.next();
      Table table=next.getTable();
      addDataSources(newProcessor,table,myHostId,siteTracker);
    }
    newProcessor.readyForData();
    m_processors.add(newProcessor);
  }
 catch (  final ClassNotFoundException e) {
    eltLog.l7dlog(Level.ERROR,LogKeys.elt_ELTManager_NoLoaderExtensions.name(),e);
    throw new ELTManager.SetupException(e.getMessage());
  }
catch (  final Throwable e) {
    throw new ELTManager.SetupException(e.getMessage());
  }
}
