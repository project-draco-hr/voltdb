{
  m_catalog=catalog;
  final Cluster cluster=m_catalog.getClusters().get("cluster");
  final Database db=cluster.getDatabases().get("database");
  final Connector conn=db.getConnectors().get("0");
  if (conn == null) {
    return;
  }
  if (conn.getEnabled() == false) {
    eltLog.info("Export is disabled by user configuration.");
    return;
  }
  ConnectorDestinationInfo dest=conn.getDestinfo().get("0");
  if (dest == null) {
    assert(false);
    eltLog.info("Export is disabled - no specified destination");
    return;
  }
  String hostStr=dest.getIpaddr();
  final String elloader=conn.getLoaderclass();
  String elusername=dest.getUsername();
  String elpassword=dest.getPassword();
  final CatalogMap<Table> tables=cluster.getDatabases().get("database").getTables();
  try {
    eltLog.info("Attempting to load connector " + elloader + " for user "+ elusername+ " password "+ elpassword);
    final Class<?> loaderClass=Class.forName(elloader);
    m_loader=(ELTDataProcessor)loaderClass.newInstance();
    m_loader.addLogger(eltLog);
    eltLog.info("Adding host " + hostStr + " port "+ "5433");
    m_loader.addHost(hostStr,"5433","database",elusername,elpassword);
    for (    final Table table : tables) {
      m_loader.addTable("database",table.getTypeName(),table.getRelativeIndex());
    }
    m_loader.readyForData();
  }
 catch (  final ClassNotFoundException e) {
    eltLog.l7dlog(Level.ERROR,LogKeys.elt_ELTManager_NoLoaderExtensions.name(),e);
    throw new ELTManager.SetupException(e.getMessage());
  }
catch (  final Throwable e) {
    throw new ELTManager.SetupException(e.getMessage());
  }
}
