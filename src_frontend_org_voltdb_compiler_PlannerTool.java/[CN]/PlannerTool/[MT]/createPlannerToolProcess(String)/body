{
  assert(serializedCatalog != null);
  String classpath=System.getProperty("java.class.path");
  assert(classpath != null);
  ArrayList<String> cmd=new ArrayList<String>();
  try {
    cmd.add(org.voltdb.utils.MiscUtils.getJavaPath());
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  cmd.add("-cp");
  cmd.add(classpath);
  cmd.add("-Xmx256m");
  cmd.add(PlannerTool.class.getName());
  ProcessBuilder pb=new ProcessBuilder(cmd);
  pb.redirectErrorStream(true);
  Process process=null;
  try {
    process=pb.start();
  }
 catch (  IOException e) {
    hostLog.error("Failed to start out of process planner, AdHoc SQL will not work",e);
  }
  OutputStreamWriter in=new OutputStreamWriter(process.getOutputStream());
  String encodedCatalog=Encoder.compressAndBase64Encode(serializedCatalog);
  try {
    in.write(encodedCatalog + "\n");
    in.flush();
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
  return new PlannerTool(process,in);
}
