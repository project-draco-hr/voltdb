{
  TrivialCostModel costModel=new TrivialCostModel();
  DatabaseEstimates estimates=new DatabaseEstimates();
  QueryPlanner planner=new QueryPlanner(sql,"PlannerTool","PlannerToolProc",m_cluster,m_database,partitioning,m_hsql,estimates,true,AD_HOC_JOINED_TABLE_LIMIT,costModel,null,null,DeterminismMode.FASTER);
  CompiledPlan plan=null;
  try {
    planner.parse();
    plan=planner.plan();
    assert(plan != null);
  }
 catch (  Exception e) {
    throw new RuntimeException("Error compiling query: " + e.toString(),e);
  }
  if (plan == null) {
    throw new RuntimeException("Null plan received in PlannerTool.planSql");
  }
  return plan;
}
