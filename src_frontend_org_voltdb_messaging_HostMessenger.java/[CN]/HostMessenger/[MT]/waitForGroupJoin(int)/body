{
  if (!m_initialized) {
    try {
      m_joiner.join(timeout);
      if (!m_joiner.getSuccess()) {
        String errMsg;
        if (timeout == 0) {
          errMsg="The joiner thread was not successful";
        }
 else {
          errMsg="Timed out waiting for other nodes to connect. It is safe to retry rejoin.";
        }
        VoltDB.crashLocalVoltDB(errMsg,false,null);
      }
      if (m_joiner.isAlive()) {
        VoltDB.crashLocalVoltDB("SockeJoiner is alive after join call.",true,null);
      }
    }
 catch (    InterruptedException e) {
      VoltDB.crashLocalVoltDB("SockeJoiner was interrupted.",false,e);
    }
    m_localHostId=m_joiner.getLocalHostId();
    Map<Integer,SocketChannel> sockets=m_joiner.getHostsAndSockets();
    for (    Entry<Integer,SocketChannel> entry : sockets.entrySet()) {
      Integer hostId=entry.getKey();
      SocketChannel socket=entry.getValue();
      try {
        socket.socket().setSendBufferSize(1024 * 1024 * 2);
        socket.socket().setReceiveBufferSize(1024 * 1024 * 2);
      }
 catch (      SocketException e) {
        e.printStackTrace();
      }
      ForeignHost fhost=null;
      try {
        fhost=new ForeignHost(this,hostId,socket);
      }
 catch (      java.io.IOException e) {
        e.printStackTrace();
      }
      m_foreignHosts[hostId]=fhost;
    }
    m_initialized=true;
  }
  HashSet<Integer> downHosts=new HashSet<Integer>();
  for (int ii=0; ii < (m_foreignHosts.length - 1); ii++) {
    if (m_foreignHosts[ii] == null && ii != m_localHostId) {
      downHosts.add(ii);
    }
  }
  return new Object[]{m_joiner.m_timestamp,m_joiner.m_addr,downHosts};
}
