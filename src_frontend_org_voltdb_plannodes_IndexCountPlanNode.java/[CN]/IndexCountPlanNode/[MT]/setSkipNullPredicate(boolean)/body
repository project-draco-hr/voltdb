{
  int nextKeyIndex=-1;
  if (isReverseScan) {
    if (m_searchkeyExpressions.size() < m_endkeyExpressions.size()) {
      assert(m_endType == IndexLookupType.LT || m_endType == IndexLookupType.LTE);
      assert(m_endkeyExpressions.size() - m_searchkeyExpressions.size() == 1);
      nextKeyIndex=m_searchkeyExpressions.size();
    }
  }
 else {
    if (m_searchkeyExpressions.size() >= m_endkeyExpressions.size()) {
      if (m_lookupType == IndexLookupType.GT || m_lookupType == IndexLookupType.GTE) {
        assert(m_searchkeyExpressions.size() > 0);
        nextKeyIndex=m_searchkeyExpressions.size() - 1;
      }
    }
  }
  if (nextKeyIndex < 0) {
    return;
  }
  List<AbstractExpression> exprs=new ArrayList<AbstractExpression>();
  String exprsjson=m_catalogIndex.getExpressionsjson();
  List<AbstractExpression> indexedExprs=null;
  if (exprsjson.isEmpty()) {
    indexedExprs=new ArrayList<AbstractExpression>();
    List<ColumnRef> indexedColRefs=CatalogUtil.getSortedCatalogItems(m_catalogIndex.getColumns(),"index");
    for (int i=0; i <= nextKeyIndex; i++) {
      ColumnRef colRef=indexedColRefs.get(i);
      Column col=colRef.getColumn();
      TupleValueExpression tve=new TupleValueExpression(m_targetTableName,m_targetTableAlias,col.getTypeName(),col.getTypeName());
      tve.setValueType(VoltType.get((byte)col.getType()));
      tve.setValueSize(col.getSize());
      tve.resolveForTable((Table)m_catalogIndex.getParent());
      indexedExprs.add(tve);
    }
  }
 else {
    try {
      List<AbstractExpression> tmpList=AbstractExpression.fromJSONArrayString(exprsjson);
      indexedExprs=new ArrayList<AbstractExpression>();
      for (      AbstractExpression expr : tmpList) {
        indexedExprs.add(expr.replaceTVEsWithAlias(m_tableScan));
      }
    }
 catch (    JSONException e) {
      e.printStackTrace();
      assert(false);
    }
  }
  AbstractExpression expr;
  for (int i=0; i < nextKeyIndex; i++) {
    AbstractExpression idxExpr=indexedExprs.get(i);
    expr=new ComparisonExpression(ExpressionType.COMPARE_EQUAL,idxExpr,(AbstractExpression)m_searchkeyExpressions.get(i).clone());
    exprs.add(expr);
  }
  AbstractExpression nullExpr=indexedExprs.get(nextKeyIndex);
  expr=new OperatorExpression(ExpressionType.OPERATOR_IS_NULL,nullExpr,null);
  exprs.add(expr);
  m_skip_null_predicate=ExpressionUtil.combine(exprs);
  m_skip_null_predicate.finalizeValueTypes();
}
