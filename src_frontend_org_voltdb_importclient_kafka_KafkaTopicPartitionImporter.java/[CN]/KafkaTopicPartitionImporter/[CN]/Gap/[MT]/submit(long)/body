{
  if (s == -1L && offset >= 0) {
    lag[idx(offset)]=c=s=offset;
  }
  long startTime=EstTime.currentTimeMillis();
  while (EstTime.currentTimeMillis() - startTime < gapTrackerCheckMaxTimeMs) {
    long check=Math.max(offset,s) - c;
    if (check >= lag.length) {
      try {
        wait();
      }
 catch (      InterruptedException e) {
        rateLimitedLog(Level.WARN,e,"Gap tracker observe large lag %d for" + m_topicAndPartition + " but failed to wait",check);
      }
    }
  }
  if (offset > s) {
    s=offset;
  }
}
