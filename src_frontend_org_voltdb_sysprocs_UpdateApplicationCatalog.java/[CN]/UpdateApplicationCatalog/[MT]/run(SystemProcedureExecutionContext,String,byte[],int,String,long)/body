{
  ZooKeeper zk=VoltDB.instance().getHostMessenger().getZK();
  ByteBuffer versionAndBytes=ByteBuffer.allocate(20 + catalogBytes.length);
  versionAndBytes.putInt(expectedCatalogVersion + 1);
  versionAndBytes.putLong(getVoltPrivateRealTransactionIdDontUseMe());
  versionAndBytes.putLong(getUniqueId());
  versionAndBytes.put(catalogBytes);
  zk.setData(VoltZK.catalogbytes,versionAndBytes.array(),-1,new ZKUtil.StatCallback(),null);
  versionAndBytes=null;
  zk.setData(VoltZK.deploymentBytes,deploymentString.getBytes("UTF-8"),-1,new ZKUtil.StatCallback(),null);
  performCatalogUpdateWork(catalogDiffCommands,expectedCatalogVersion,deploymentCRC);
  VoltTable result=new VoltTable(VoltSystemProcedure.STATUS_SCHEMA);
  result.addRow(VoltSystemProcedure.STATUS_OK);
  return (new VoltTable[]{result});
}
