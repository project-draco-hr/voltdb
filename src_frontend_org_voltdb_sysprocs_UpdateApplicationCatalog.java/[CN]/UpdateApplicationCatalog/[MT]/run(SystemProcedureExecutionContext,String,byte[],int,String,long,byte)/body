{
  ZooKeeper zk=VoltDB.instance().getHostMessenger().getZK();
  CatalogUtil.setCatalogToZK(zk,expectedCatalogVersion + 1,getVoltPrivateRealTransactionIdDontUseMe(),getUniqueId(),catalogBytes);
  if (deploymentString != null) {
    zk.setData(VoltZK.deploymentBytes,deploymentString.getBytes("UTF-8"),-1,new ZKUtil.StatCallback(),null);
  }
  performCatalogUpdateWork(catalogDiffCommands,expectedCatalogVersion,deploymentCRC,requiresSnapshotIsolation);
  VoltTable result=new VoltTable(VoltSystemProcedure.STATUS_SCHEMA);
  result.addRow(VoltSystemProcedure.STATUS_OK);
  return (new VoltTable[]{result});
}
