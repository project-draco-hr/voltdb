{
  CatalogContext oldContext=VoltDB.instance().getCatalogContext();
  CommandLog commandLog=oldContext.cluster.getLogconfig().get("log");
  String commands=Encoder.decodeBase64AndDecompress(catalogDiffCommands);
  CatalogContext context=VoltDB.instance().catalogUpdate(commands,catalogURL,expectedCatalogVersion,getTransactionId(),deploymentCRC);
  ctx.getExecutionSite().updateCatalog(commands,context);
  if (commandLog != null && commandLog.getEnabled()) {
    ZooKeeper zk=VoltDB.instance().getZK();
    try {
      zk.create("/request_truncation_snapshot",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    }
 catch (    NodeExistsException e) {
    }
catch (    Exception e) {
      hostLog.fatal("Requesting a truncation snapshot via ZK should always succeed",e);
      VoltDB.crashVoltDB();
    }
  }
  VoltTable result=new VoltTable(VoltSystemProcedure.STATUS_SCHEMA);
  result.addRow(VoltSystemProcedure.STATUS_OK);
  return (new VoltTable[]{result});
}
