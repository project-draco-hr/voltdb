{
  m_siteId=mailbox.getHSId();
  hostLog.l7dlog(Level.TRACE,LogKeys.host_ExecutionSite_Initializing.name(),new Object[]{String.valueOf(m_siteId)},null);
  m_context=voltdb.getCatalogContext();
  final int partitionId=m_context.siteTracker.getPartitionForSite(m_siteId);
  String txnlog_name=ExecutionSite.class.getName() + "." + m_siteId;
  m_txnlog=new VoltLogger(txnlog_name);
  m_recovering=recovering;
  for (  Integer failedHostId : failedHostIds) {
    m_knownFailedSites.addAll(m_context.siteTracker.getAllSitesForHost(failedHostId));
  }
  m_handledFailedSites.addAll(m_knownFailedSites);
  VoltDB.instance().getFaultDistributor().registerFaultHandler(NodeFailureFault.NODE_FAILURE_EXECUTION_SITE,m_faultHandler,FaultType.NODE_FAILURE);
  File overflowDir=new File(VoltDB.instance().getCatalogContext().cluster.getVoltroot(),"wan_overflow");
  m_partitionDRGateway=PartitionDRGateway.getInstance(partitionId,m_recovering,replicationActive,overflowDir);
  if (voltdb.getBackendTargetType() == BackendTarget.NONE) {
    ee=new MockExecutionEngine();
    hsql=null;
  }
 else   if (voltdb.getBackendTargetType() == BackendTarget.HSQLDB_BACKEND) {
    hsql=initializeHSQLBackend();
    ee=new MockExecutionEngine();
  }
 else {
    if (serializedCatalog == null) {
      serializedCatalog=voltdb.getCatalogContext().catalog.serialize();
    }
    hsql=null;
    ee=initializeEE(voltdb.getBackendTargetType(),serializedCatalog,txnId);
  }
  m_systemProcedureContext=new SystemProcedureContext();
  m_mailbox=mailbox;
  m_transactionQueue=(transactionQueue != null) ? transactionQueue : initializeTransactionQueue(m_siteId);
  loadProcedures(voltdb.getBackendTargetType());
  int snapshotPriority=6;
  if (m_context.cluster.getDeployment().get("deployment") != null) {
    snapshotPriority=m_context.cluster.getDeployment().get("deployment").getSystemsettings().get("systemsettings").getSnapshotpriority();
  }
  m_snapshotter=new SnapshotSiteProcessor(new Runnable(){
    @Override public void run(){
      m_mailbox.deliver(new PotentialSnapshotWorkMessage());
    }
  }
,snapshotPriority);
  final StatsAgent statsAgent=VoltDB.instance().getStatsAgent();
  m_starvationTracker=new StarvationTracker(getCorrespondingSiteId());
  statsAgent.registerStatsSource(SysProcSelector.STARVATION,Integer.parseInt(getCorrespondingCatalogSite().getTypeName()),m_starvationTracker);
  m_tableStats=new TableStats(getCorrespondingSiteId());
  statsAgent.registerStatsSource(SysProcSelector.TABLE,Integer.parseInt(getCorrespondingCatalogSite().getTypeName()),m_tableStats);
  m_indexStats=new IndexStats(getCorrespondingSiteId());
  statsAgent.registerStatsSource(SysProcSelector.INDEX,Integer.parseInt(getCorrespondingCatalogSite().getTypeName()),m_indexStats);
}
