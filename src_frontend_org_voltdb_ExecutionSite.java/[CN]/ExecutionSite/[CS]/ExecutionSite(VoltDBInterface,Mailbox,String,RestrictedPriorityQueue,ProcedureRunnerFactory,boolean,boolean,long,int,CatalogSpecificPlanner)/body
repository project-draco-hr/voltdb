{
  m_siteId=mailbox.getHSId();
  hostLog.l7dlog(Level.TRACE,LogKeys.host_ExecutionSite_Initializing.name(),new Object[]{String.valueOf(m_siteId)},null);
  m_context=voltdb.getCatalogContext();
  m_tracker=VoltDB.instance().getSiteTracker();
  final int partitionId=m_tracker.getPartitionForSite(m_siteId);
  String txnlog_name=ExecutionSite.class.getName() + "." + m_siteId;
  m_txnlog=new VoltLogger(txnlog_name);
  m_rejoining=recovering;
  VoltDB.instance().getFaultDistributor().registerFaultHandler(SiteFailureFault.SITE_FAILURE_EXECUTION_SITE,m_faultHandler,FaultType.SITE_FAILURE);
  File overflowDir=new File(VoltDB.instance().getCatalogContext().cluster.getVoltroot(),"dr_overflow");
  m_partitionDRGateway=PartitionDRGateway.getInstance(partitionId,replicationActive,overflowDir);
  if (voltdb.getBackendTargetType() == BackendTarget.NONE) {
    ee=new MockExecutionEngine();
    hsql=null;
  }
 else   if (voltdb.getBackendTargetType() == BackendTarget.HSQLDB_BACKEND) {
    hsql=HsqlBackend.initializeHSQLBackend(m_siteId,m_context);
    ee=new MockExecutionEngine();
  }
 else {
    if (serializedCatalog == null) {
      serializedCatalog=voltdb.getCatalogContext().catalog.serialize();
    }
    hsql=null;
    ee=initializeEE(voltdb.getBackendTargetType(),serializedCatalog,txnId,configuredNumberOfPartitions);
  }
  m_systemProcedureContext=new SystemProcedureContext();
  m_mailbox=mailbox;
  m_transactionQueue=(transactionQueue != null) ? transactionQueue : initializeTransactionQueue(m_siteId);
  if (runnerFactory != null) {
    runnerFactory.configure(this,m_systemProcedureContext);
  }
  m_loadedProcedures=new LoadedProcedureSet(this,runnerFactory,getSiteId(),siteIndex,m_tracker.m_numberOfPartitions);
  m_loadedProcedures.loadProcedures(m_context,voltdb.getBackendTargetType(),csp);
  int snapshotPriority=6;
  if (m_context.cluster.getDeployment().get("deployment") != null) {
    snapshotPriority=m_context.cluster.getDeployment().get("deployment").getSystemsettings().get("systemsettings").getSnapshotpriority();
  }
  m_snapshotter=new SnapshotSiteProcessor(new Runnable(){
    @Override public void run(){
      m_mailbox.deliver(new PotentialSnapshotWorkMessage());
    }
  }
,snapshotPriority);
  final StatsAgent statsAgent=VoltDB.instance().getStatsAgent();
  m_starvationTracker=new StarvationTracker(getCorrespondingSiteId());
  statsAgent.registerStatsSource(SysProcSelector.STARVATION,m_siteId,m_starvationTracker);
  m_tableStats=new TableStats(getCorrespondingSiteId());
  statsAgent.registerStatsSource(SysProcSelector.TABLE,m_siteId,m_tableStats);
  m_indexStats=new IndexStats(getCorrespondingSiteId());
  statsAgent.registerStatsSource(SysProcSelector.INDEX,m_siteId,m_indexStats);
}
