{
  if (!txnState.isReadOnly) {
    assert(latestUndoToken != kInvalidUndoToken);
    assert(txnBeginUndoToken != kInvalidUndoToken);
    assert(latestUndoToken >= txnBeginUndoToken);
    if (latestUndoToken > txnBeginUndoToken) {
      ee.releaseUndoToken(latestUndoToken);
    }
    txnBeginUndoToken=kInvalidUndoToken;
    batchBeginUndoToken=kInvalidUndoToken;
  }
  if (txnState.txnId > lastCommittedTxnId) {
    lastCommittedTxnId=txnState.txnId;
    if (!txnState.isSinglePartition()) {
      lastCommittedMultiPartTxnId=txnState.txnId;
    }
  }
}
