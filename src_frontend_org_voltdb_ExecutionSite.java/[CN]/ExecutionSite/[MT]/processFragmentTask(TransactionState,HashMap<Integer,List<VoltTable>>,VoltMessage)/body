{
  ParameterSet params=null;
  final FragmentTaskMessage ftask=(FragmentTaskMessage)task;
  assert(ftask.getFragmentCount() == 1);
  final long fragmentId=ftask.getFragmentId(0);
  final int outputDepId=ftask.getOutputDepId(0);
  final FragmentResponseMessage currentFragResponse=new FragmentResponseMessage(ftask,getSiteId());
  final ByteBuffer paramData=ftask.getParameterDataForFragment(0);
  if (paramData != null) {
    final FastDeserializer fds=new FastDeserializer(paramData);
    try {
      params=fds.readObject(ParameterSet.class);
    }
 catch (    final IOException e) {
      hostLog.l7dlog(Level.FATAL,LogKeys.host_ExecutionSite_FailedDeserializingParamsForFragmentTask.name(),e);
      VoltDB.crashVoltDB();
    }
  }
 else {
    params=new ParameterSet();
  }
  if (ftask.isSysProcTask()) {
    return processSysprocFragmentTask(txnState,dependencies,fragmentId,currentFragResponse,params);
  }
 else {
    ProcedureProfiler.startStatementCounter(fragmentId);
    if (dependencies != null) {
      ee.stashWorkUnitDependencies(dependencies);
    }
    final int inputDepId=ftask.getOnlyInputDepId(0);
    currentFragResponse.setStatus(FragmentResponseMessage.SUCCESS,null);
    try {
      final DependencyPair dep=ee.executePlanFragment(fragmentId,outputDepId,inputDepId,params,txnState.txnId,lastCommittedTxnId,txnState.isReadOnly() ? Long.MAX_VALUE : getNextUndoToken());
      sendDependency(currentFragResponse,dep.depId,dep.dependency);
    }
 catch (    final EEException e) {
      hostLog.l7dlog(Level.TRACE,LogKeys.host_ExecutionSite_ExceptionExecutingPF.name(),new Object[]{fragmentId},e);
      currentFragResponse.setStatus(FragmentResponseMessage.UNEXPECTED_ERROR,e);
    }
catch (    final SQLException e) {
      hostLog.l7dlog(Level.TRACE,LogKeys.host_ExecutionSite_ExceptionExecutingPF.name(),new Object[]{fragmentId},e);
      currentFragResponse.setStatus(FragmentResponseMessage.UNEXPECTED_ERROR,e);
    }
    ProcedureProfiler.stopStatementCounter();
    return currentFragResponse;
  }
}
