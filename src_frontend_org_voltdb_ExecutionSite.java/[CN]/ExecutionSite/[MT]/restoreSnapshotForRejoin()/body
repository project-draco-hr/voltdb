{
  boolean doneWork=false;
  Pair<Integer,ByteBuffer> rejoinWork=m_rejoinProcessor.poll();
  if (rejoinWork != null) {
    int tableId=rejoinWork.getFirst();
    ByteBuffer buffer=rejoinWork.getSecond();
    m_recoveryLog.info("Got a snapshot block for table " + tableId + " "+ buffer.remaining());
    VoltTable table=PrivateVoltTableFactory.createVoltTableFromBuffer(buffer.duplicate(),true);
    loadTable(m_rejoinSnapshotTxnId,tableId,table);
    doneWork=true;
  }
 else   if (m_rejoinProcessor.isEOF()) {
    m_recoveryLog.info("New rejoin snapshot transfer is finished");
    m_rejoinProcessor.close();
    m_rejoinProcessor=null;
    if (m_rejoinCoordinatorHSId != -1) {
      RejoinMessage msg=new RejoinMessage(getSiteId(),RejoinMessage.Type.SNAPSHOT_FINISHED);
      try {
        m_mailbox.send(m_rejoinCoordinatorHSId,msg);
      }
 catch (      MessagingException e) {
        VoltDB.crashLocalVoltDB("Unable to send message to rejoin " + "coordinator",true,e);
      }
    }
  }
  return doneWork;
}
