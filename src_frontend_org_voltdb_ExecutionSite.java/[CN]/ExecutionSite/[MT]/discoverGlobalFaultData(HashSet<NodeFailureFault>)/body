{
  HashSet<Integer> failedHostIds=new HashSet<Integer>();
  for (  NodeFailureFault fault : failedHosts) {
    failedHostIds.add(fault.getHostId());
  }
  m_knownFailedHosts.addAll(failedHostIds);
  m_context=VoltDB.instance().getCatalogContext();
  int expectedResponses=discoverGlobalFaultData_send();
  long[] commit_and_safe=discoverGlobalFaultData_rcv(expectedResponses);
  if (commit_and_safe == null) {
    return;
  }
  HashSet<Integer> newFailedHostIds=new HashSet<Integer>(failedHostIds);
  newFailedHostIds.removeAll(m_handledFailedHosts);
  handleNodeFault(newFailedHostIds,commit_and_safe[0],commit_and_safe[1]);
  m_handledFailedHosts.addAll(failedHostIds);
  for (  NodeFailureFault fault : failedHosts) {
    if (newFailedHostIds.contains(fault.getHostId())) {
      VoltDB.instance().getFaultDistributor().reportFaultHandled(m_faultHandler,fault);
    }
  }
}
