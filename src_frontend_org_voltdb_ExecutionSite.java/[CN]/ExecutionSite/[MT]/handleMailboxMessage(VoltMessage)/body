{
  if (message instanceof MembershipNotice) {
    MembershipNotice mn=(MembershipNotice)message;
    assertTxnIdOrdering(mn);
    if (mn.isHeartBeat()) {
      m_transactionQueue.gotTransaction(mn.getInitiatorSiteId(),mn.getTxnId(),true);
      return;
    }
 else     if (!(mn instanceof FragmentTask)) {
      m_transactionQueue.gotTransaction(mn.getInitiatorSiteId(),mn.getTxnId(),false);
    }
    TransactionState ts=m_transactionsById.get(mn.getTxnId());
    if (ts == null) {
      if (mn.isSinglePartition()) {
        ts=new SinglePartitionTxnState(m_mailbox,this,mn);
      }
 else {
        ts=new MultiPartitionParticipantTxnState(m_mailbox,this,mn);
      }
      m_transactionQueue.add(ts);
      m_transactionsById.put(ts.txnId,ts);
    }
    if (message instanceof FragmentTask) {
      ts.createLocalFragmentWork((FragmentTask)message,false);
    }
  }
 else   if (message instanceof FragmentResponse) {
    FragmentResponse response=(FragmentResponse)message;
    TransactionState txnState=m_transactionsById.get(response.getTxnId());
    if (txnState != null) {
      assert(txnState instanceof MultiPartitionParticipantTxnState);
      txnState.processRemoteWorkResponse(response);
    }
  }
 else   if (message instanceof DebugMessage) {
    DebugMessage dmsg=(DebugMessage)message;
    if (dmsg.shouldDump)     DumpManager.putDump(m_dumpId,m_currentDumpTimestamp,true,getDumpContents());
  }
 else   if (message instanceof ExecutionSiteNodeFailureMessage) {
    handleNodeFault(((ExecutionSiteNodeFailureMessage)message).m_failedHostId);
  }
 else {
    hostLog.l7dlog(Level.FATAL,LogKeys.org_voltdb_dtxn_SimpleDtxnConnection_UnkownMessageClass.name(),new Object[]{message.getClass().getName()},null);
    VoltDB.crashVoltDB();
  }
}
