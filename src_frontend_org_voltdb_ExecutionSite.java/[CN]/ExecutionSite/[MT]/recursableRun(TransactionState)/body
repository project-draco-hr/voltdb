{
  do {
    if (currentTxnState.doWork()) {
      completeTransaction(currentTxnState.isReadOnly);
      TransactionState ts=m_transactionsById.remove(currentTxnState.txnId);
      assert(ts != null);
      return null;
    }
 else     if (currentTxnState.shouldResumeProcedure()) {
      Map<Integer,List<VoltTable>> retval=currentTxnState.getPreviousStackFrameDropDependendencies();
      assert(retval != null);
      return retval;
    }
 else {
      VoltMessage message=m_mailbox.recvBlocking(5);
      tick();
      if (message != null) {
        handleMailboxMessage(message);
      }
    }
  }
 while (true);
}
