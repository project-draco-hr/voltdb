{
synchronized (m_stupidSnapshotContainer) {
    m_snapshotTargetTerminators=new ArrayList<Thread>();
    while (m_snapshotTableTasks != null) {
      doSnapshotWork();
      if (m_snapshotTableTasks != null) {
        m_stupidSnapshotContainer.wait();
      }
    }
    for (    Thread t : m_snapshotTargetTerminators) {
      t.join();
    }
    m_snapshotTargetTerminators=null;
  }
}
