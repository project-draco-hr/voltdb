{
  int hostId=CoreUtils.getHostIdFromHSId(rm.m_sourceHSId);
  Type type=rm.getType();
  if (type == RejoinMessage.Type.FAILURE) {
    VoltDB.crashLocalVoltDB("Unable to rejoin the cluster. " + "Please see the logs on host " + hostId + " for more detail.",false,null);
  }
 else   if (type == RejoinMessage.Type.INITIATION) {
    initiateRejoin(rm.m_sourceHSId);
  }
 else   if (type == RejoinMessage.Type.REQUEST) {
    RejoinMessage rejoinResponse=initiateRejoinSnapshot(rm);
    if (rejoinResponse != null) {
      try {
        m_mailbox.send(rm.m_sourceHSId,rejoinResponse);
      }
 catch (      MessagingException e) {
        throw new RuntimeException(e);
      }
    }
  }
 else   if (type == RejoinMessage.Type.REQUEST_RESPONSE) {
    m_rejoinSnapshotTxnId=rm.txnId();
    m_recoveryLog.info("Heard rejoin initiation response from " + CoreUtils.hsIdToString(rm.m_sourceHSId) + ", snapshot txnId is"+ m_rejoinSnapshotTxnId);
    if (m_rejoinTaskLog != null) {
      m_rejoinTaskLog.setEarliestTxnId(m_rejoinSnapshotTxnId);
    }
  }
 else {
    VoltDB.crashLocalVoltDB("Unknown rejoin message type " + type,false,null);
  }
}
