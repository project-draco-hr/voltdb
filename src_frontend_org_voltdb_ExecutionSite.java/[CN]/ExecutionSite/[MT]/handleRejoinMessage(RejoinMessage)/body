{
  Type type=rm.getType();
  if (type == RejoinMessage.Type.INITIATION) {
    initiateRejoin(rm.m_sourceHSId);
  }
 else   if (type == RejoinMessage.Type.REQUEST_RESPONSE) {
    m_rejoinSnapshotTxnId=rm.getSnapshotTxnId();
    if (m_rejoinTaskLog != null) {
      m_rejoinTaskLog.setEarliestTxnId(m_rejoinSnapshotTxnId);
    }
    m_rejoinSnapshotProcessor.startCountDown();
    VoltDB.instance().getSnapshotCompletionMonitor().addInterest(m_snapshotCompletionHandler);
  }
 else {
    VoltDB.crashLocalVoltDB("Unknown rejoin message type " + type,false,null);
  }
}
