{
  String name="ExecutionSite: ";
  name+=CoreUtils.hsIdToString(getSiteId());
  Thread.currentThread().setName(name);
  try {
    while (m_shouldContinue) {
      if (m_recovering && !m_haveRecoveryPermit) {
        Long safeTxnId=m_transactionQueue.safeToRecover();
        if (safeTxnId != null && m_recoveryPermit.tryAcquire()) {
          m_haveRecoveryPermit=true;
          m_recoveryStartTime=System.currentTimeMillis();
          if (!VoltDB.instance().getConfig().m_newRejoin) {
            m_recoveryProcessor=RecoverySiteProcessorDestination.createProcessor(m_context.database,m_tracker,ee,m_mailbox,m_siteId,m_onRecoveryCompletion,m_recoveryMessageHandler);
          }
        }
      }
      if (m_rejoinInitResponse != null) {
        m_recoveryLog.info("Sending rejoin initiation response to " + CoreUtils.hsIdToString(m_rejoinInitResponse.getFirst()));
        try {
          m_mailbox.send(m_rejoinInitResponse.getFirst(),m_rejoinInitResponse.getSecond());
        }
 catch (        MessagingException e) {
          throw new RuntimeException(e);
        }
        m_rejoinInitResponse=null;
      }
      TransactionState currentTxnState=(TransactionState)m_transactionQueue.poll();
      m_currentTransactionState=currentTxnState;
      if (currentTxnState == null) {
        VoltMessage message=m_mailbox.recv();
        if (message == null) {
          Object hadWork=m_snapshotter.doSnapshotWork(ee,EstTime.currentTimeMillis() - lastCommittedTxnTime > 5);
          if (hadWork != null) {
            continue;
          }
 else {
            m_starvationTracker.beginStarvation();
            message=m_mailbox.recvBlocking(5);
            m_starvationTracker.endStarvation();
          }
        }
        tick();
        if (message != null) {
          handleMailboxMessage(message);
        }
 else {
          m_snapshotter.doSnapshotWork(ee,EstTime.currentTimeMillis() - lastCommittedTxnTime > 5);
          doRejoinWork();
        }
      }
      if (currentTxnState != null) {
        if (m_recoveryProcessor != null) {
          m_recoveryProcessor.doRecoveryWork(currentTxnState.txnId);
        }
        recursableRun(currentTxnState);
      }
 else       if (m_recoveryProcessor != null) {
        Long foo=m_transactionQueue.safeToRecover();
        if (foo != null) {
          m_recoveryProcessor.doRecoveryWork(foo);
        }
      }
    }
  }
 catch (  final RuntimeException e) {
    hostLog.l7dlog(Level.ERROR,LogKeys.host_ExecutionSite_RuntimeException.name(),e);
    throw e;
  }
  shutdown();
}
