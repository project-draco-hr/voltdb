{
  boolean doneWork=false;
  if (m_rejoinTaskLog == null) {
    return doneWork;
  }
  TransactionState ts=null;
  try {
    TransactionInfoBaseMessage msg=m_rejoinTaskLog.getNextMessage();
    if (msg != null) {
      if (msg.isSinglePartition()) {
        ts=new SinglePartitionTxnState(m_mailbox,this,msg,RejoinState.REPLAYING);
      }
 else {
        ts=new MultiPartitionParticipantTxnState(m_mailbox,this,msg,RejoinState.REPLAYING);
      }
    }
  }
 catch (  IOException e) {
    m_recoveryLog.error("Failed to replay logged transactions: " + e.getMessage());
  }
  if (ts != null) {
    recursableRun(ts);
    doneWork=true;
    m_recoveryLog.trace("Replayed " + ts.getNotice().getTxnId());
    m_executedTaskCount++;
  }
 else {
    boolean rejoinCompleted=false;
    try {
      if (m_rejoinTaskLog.isEmpty() && m_rejoinSnapshotFinished) {
        rejoinCompleted=true;
      }
    }
 catch (    IOException e) {
      m_recoveryLog.error("Failed to determine if the task log is empty: " + e.getMessage());
    }
    if (rejoinCompleted) {
      try {
        m_rejoinTaskLog.close();
      }
 catch (      IOException e) {
        m_recoveryLog.error("Failed to close the task log:" + e.getMessage());
      }
      m_onRejoinCompletion.run();
    }
  }
  return doneWork;
}
