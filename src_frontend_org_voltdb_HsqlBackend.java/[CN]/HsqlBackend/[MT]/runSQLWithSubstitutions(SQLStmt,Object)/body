{
  StringBuilder sqlOut=new StringBuilder(stmt.getText().length() * 2);
  CatalogMap<StmtParameter> sparamsMap=stmt.catStmt.getParameters();
  List<StmtParameter> sparams=CatalogUtil.getSortedCatalogItems(sparamsMap,"index");
  assert(sparams != null);
  int lastIndex=0;
  String sql=stmt.getText();
  for (int i=0; i < args.length; i++) {
    int nextIndex=sql.indexOf('?',lastIndex);
    if (nextIndex == -1)     throw new RuntimeException("SQL Statement has more arguments than params.");
    sqlOut.append(sql,lastIndex,nextIndex);
    lastIndex=nextIndex + 1;
    StmtParameter stmtParam=sparams.get(i);
    assert(stmtParam != null);
    VoltType type=VoltType.get((byte)stmtParam.getJavatype());
    if (args[i] == null) {
      sqlOut.append("NULL");
    }
 else     if (args[i] instanceof TimestampType) {
      if (type != VoltType.TIMESTAMP)       throw new RuntimeException("Inserting date into mismatched column type in HSQL.");
      TimestampType d=(TimestampType)args[i];
      Timestamp t=new Timestamp(d.getTime() * 1000);
      sqlOut.append('\'').append(t.toString()).append('\'');
    }
 else     if (args[i] instanceof byte[]) {
      if (type != VoltType.STRING)       throw new RuntimeException("Inserting string (bytes) into mismatched column type in HSQL.");
      sqlOut.append(sqlEscape(new String((byte[])args[i])));
    }
 else     if (args[i] instanceof String) {
      if (type != VoltType.STRING)       throw new RuntimeException("Inserting string into mismatched column type in HSQL.");
      sqlOut.append(sqlEscape((String)args[i]));
    }
 else {
      if (type == VoltType.TIMESTAMP) {
        long t=Long.parseLong(args[i].toString());
        TimestampType d=new TimestampType(t);
        Timestamp ts=new Timestamp(d.getTime() * 1000);
        sqlOut.append('\'').append(ts.toString()).append('\'');
      }
 else       sqlOut.append(args[i].toString());
    }
  }
  sqlOut.append(sql,lastIndex,sql.length());
  return runDML(sqlOut.toString());
}
