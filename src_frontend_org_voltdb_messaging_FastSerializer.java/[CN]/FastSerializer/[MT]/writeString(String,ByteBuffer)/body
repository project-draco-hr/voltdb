{
  final int MAX_LENGTH=BinaryInputArchive.MAX_BUFFER_SIZE;
  final int NULL_STRING_INDICATOR=-1;
  if (string == null) {
    buffer.putInt(NULL_STRING_INDICATOR);
    return;
  }
  int len=0;
  byte[] strbytes={};
  try {
    strbytes=string.getBytes("UTF-8");
    len=strbytes.length;
  }
 catch (  UnsupportedEncodingException e) {
    throw new RuntimeException(e);
  }
  if (len > MAX_LENGTH) {
    throw new IOException("String exceeds maximum length of " + MAX_LENGTH + " bytes.");
  }
  buffer.putInt(len);
  buffer.put(strbytes);
}
