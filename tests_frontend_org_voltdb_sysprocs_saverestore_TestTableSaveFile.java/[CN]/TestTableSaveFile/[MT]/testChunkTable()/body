{
  Pair<VoltTable,File> generated=generateTestTable(100000);
  VoltTable table=generated.getFirst();
  File f=generated.getSecond();
  FileInputStream fis=new FileInputStream(f);
  TableSaveFile savefile=new TableSaveFile(fis.getChannel(),3,null);
  int expectedPartitionId=0;
  VoltTable test_table=null;
  VoltTable reaggregate_table=null;
  while (savefile.hasMoreChunks()) {
    final BBContainer c=savefile.getNextChunk();
    TableSaveFile.Container cont=(TableSaveFile.Container)c;
    assertEquals(expectedPartitionId,cont.partitionId);
    expectedPartitionId++;
    try {
      test_table=PrivateVoltTableFactory.createVoltTableFromBuffer(c.b,false);
      if (reaggregate_table == null) {
        reaggregate_table=test_table.clone(10000);
      }
      while (test_table.advanceRow()) {
        reaggregate_table.add(test_table);
      }
    }
  finally {
      c.discard();
    }
  }
  assertEquals(table,reaggregate_table);
}
