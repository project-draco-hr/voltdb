{
  SnapshotDaemon daemon=getBasicDaemon();
  Thread.sleep(60);
  long handle=m_initiator.clientData;
  m_initiator.clear();
  daemon.processClientResponse(getSuccessfulScanOneResult(),handle).get();
  Thread.sleep(60);
  assertNull(m_initiator.procedureName);
  daemon=getBasicDaemon();
  Thread.sleep(60);
  handle=m_initiator.clientData;
  daemon.processClientResponse(getSuccessfulScanThreeResults(),handle).get();
  assertNotNull(m_initiator.procedureName);
  assertTrue("@SnapshotDelete".equals(m_initiator.procedureName));
  String path=((String[])m_initiator.params[0])[0];
  String nonce=((String[])m_initiator.params[1])[0];
  assertTrue("/tmp".equals(path));
  assertTrue("woobie_2".equals(nonce));
  handle=m_initiator.clientData;
  m_initiator.clear();
  Thread.sleep(60);
  assertNull(m_initiator.procedureName);
  daemon.processClientResponse(getFailureResponse(),handle).get();
  assertNull(m_initiator.procedureName);
  assertEquals(daemon.getState(),SnapshotDaemon.State.FAILURE);
  daemon=getBasicDaemon();
  Thread.sleep(60);
  handle=m_initiator.clientData;
  daemon.processClientResponse(getSuccessfulScanThreeResults(),handle).get();
  daemon.processClientResponse(getErrMsgResponse(),1);
  Thread.sleep(60);
  assertEquals(daemon.getState(),SnapshotDaemon.State.WAITING);
}
