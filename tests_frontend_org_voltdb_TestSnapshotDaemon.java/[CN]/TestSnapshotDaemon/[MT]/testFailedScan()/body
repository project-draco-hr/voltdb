{
  SnapshotDaemon daemon=getBasicDaemon();
  Pair<String,Object[]> work=daemon.processPeriodicWork(0);
  assertTrue("@SnapshotScan".equals(work.getFirst()));
  assertEquals(1,work.getSecond().length);
  assertTrue("/tmp".equals(work.getSecond()[0]));
  assertNull(daemon.processPeriodicWork(1));
  daemon.processClientResponse(getFailureResponse());
  assertNull(daemon.processPeriodicWork(2));
  assertNull(daemon.processClientResponse(null));
  daemon=getBasicDaemon();
  work=daemon.processPeriodicWork(0);
  daemon.processClientResponse(getErrMsgResponse());
  assertEquals(SnapshotDaemon.State.FAILURE,daemon.getState());
}
