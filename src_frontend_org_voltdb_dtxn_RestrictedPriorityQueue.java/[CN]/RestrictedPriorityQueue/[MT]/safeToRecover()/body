{
  boolean safe=true;
  long maxFirstSafeTxnId=Long.MIN_VALUE;
  for (  LastInitiatorData data : m_initiatorData.values()) {
    final long firstSafeTxnId=data.m_firstSafeTxnId;
    if (firstSafeTxnId == DtxnConstants.DUMMY_LAST_SEEN_TXN_ID) {
      safe=false;
    }
    maxFirstSafeTxnId=Math.max(maxFirstSafeTxnId,firstSafeTxnId);
  }
  if (!safe) {
    return null;
  }
  OrderableTransaction next=peek();
  if (next == null) {
    if (m_state == QueueState.BLOCKED_EMPTY) {
      return m_newestCandidateTransaction;
    }
 else     if (m_state == QueueState.BLOCKED_SAFETY) {
      return null;
    }
 else     if (m_state == QueueState.BLOCKED_ORDERING) {
      return null;
    }
    m_joinLog.error("Unexpected RPQ state " + m_state + " when attempting to start recovery at "+ " the source site. Consider killing the recovering node and trying again");
    return null;
  }
 else   if (next.txnId >= maxFirstSafeTxnId) {
    return next.txnId;
  }
 else {
    return null;
  }
}
