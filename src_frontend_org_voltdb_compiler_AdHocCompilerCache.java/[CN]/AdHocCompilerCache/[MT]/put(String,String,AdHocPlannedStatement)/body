{
  assert(sql != null);
  assert(parsedToken != null);
  assert(planIn != null);
  AdHocPlannedStatement plan=planIn;
  assert(new String(plan.sql,VoltDB.UTF8ENCODING).equals(sql));
  CorePlan core=m_coreCache.get(parsedToken);
  if (core == null) {
    core=plan.core;
    m_coreCache.put(parsedToken,core);
    ++m_planInsertions;
  }
 else {
    assert(core.equals(plan.core));
    if (plan.core != core) {
      plan=new AdHocPlannedStatement(plan.sql,core,plan.extractedParamValues,plan.partitionParam);
    }
  }
  AdHocPlannedStatement cachedPlan=m_literalCache.get(sql);
  if (cachedPlan == null) {
    m_literalCache.put(sql,plan);
    ++m_literalInsertions;
  }
 else {
    assert(cachedPlan.equals(plan));
  }
}
