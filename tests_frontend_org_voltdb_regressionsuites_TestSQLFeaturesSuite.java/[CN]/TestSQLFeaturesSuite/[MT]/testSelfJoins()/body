{
  Client client=getClient();
  try {
    client.callProcedure("InsertNewOrder",1L,3L,1L);
    VoltTable[] results=client.callProcedure("SelfJoinTest",1L).getResults();
    assertEquals(results.length,1);
    VoltTable table=results[0];
    assertTrue(table.getRowCount() == 1);
    VoltTableRow row=table.fetchRow(0);
    assertEquals(row.getLong("NO_D_ID"),3);
  }
 catch (  ProcCallException e) {
    e.printStackTrace();
    fail();
  }
catch (  IOException e) {
    e.printStackTrace();
    fail();
  }
}
