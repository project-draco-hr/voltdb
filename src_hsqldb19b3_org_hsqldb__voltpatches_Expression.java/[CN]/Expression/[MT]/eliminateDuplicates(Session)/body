{
  List<Expression> subExprList=new ArrayList<Expression>();
  extractAndSubExpressions(this,subExprList);
  HashSet<String> uniqueIds=new HashSet<String>();
  Iterator<Expression> it=subExprList.iterator();
  while (it.hasNext()) {
    Expression expr=it.next();
    String id=expr.getUniqueId(session);
    if (uniqueIds.contains(id)) {
      it.remove();
    }
 else {
      uniqueIds.add(id);
    }
  }
  if (!subExprList.isEmpty()) {
    Iterator<Expression> itExpr=subExprList.iterator();
    Expression finalExpr=itExpr.next();
    while (itExpr.hasNext()) {
      finalExpr=new ExpressionLogical(OpTypes.AND,finalExpr,itExpr.next());
    }
    return finalExpr;
  }
  return this;
}
