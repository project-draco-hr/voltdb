{
  if (message.getType() == RejoinMessage.Type.INITIATION) {
    m_coordinatorHsId=message.m_sourceHSId;
    String snapshotNonce=message.getSnapshotNonce();
    SnapshotCompletionAction interest=new SnapshotCompletionAction(snapshotNonce);
    interest.register();
    m_taskQueue.offer(this);
    JOINLOG.info("P" + m_partitionId + " received initiation");
  }
 else   if (message.getType() == RejoinMessage.Type.SNAPSHOT_DATA) {
    if (JOINLOG.isTraceEnabled()) {
      JOINLOG.trace("P" + m_partitionId + " received snapshot data block");
    }
    m_snapshotData.offer(Pair.of(message.getTableId(),message.getTableBlock()));
  }
}
