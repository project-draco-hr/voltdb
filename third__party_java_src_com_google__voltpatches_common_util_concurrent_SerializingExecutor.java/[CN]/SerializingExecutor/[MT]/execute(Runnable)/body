{
  Preconditions.checkNotNull(r,"'r' must not be null.");
  boolean scheduleTaskRunner=false;
synchronized (internalLock) {
    waitQueue.add(r);
    if (!isThreadScheduled) {
      isThreadScheduled=true;
      scheduleTaskRunner=true;
    }
  }
  if (scheduleTaskRunner) {
    boolean threw=true;
    try {
      executor.execute(taskRunner);
      threw=false;
    }
  finally {
      if (threw) {
synchronized (internalLock) {
          isThreadScheduled=false;
        }
      }
    }
  }
}
