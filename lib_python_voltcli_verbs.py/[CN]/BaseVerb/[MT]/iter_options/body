def iter_options(self, required_only=False):
    if self.cli_spec.options:
        self._check_options()
        for o in self.cli_spec.options:
            if ((not required_only) or (o.required and (getattr(opts, o.kwargs['dest']) is None))):
                yield o
