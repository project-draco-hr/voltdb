{
  this.dataDir=new File(dataDir,version + VERSION);
  this.snapDir=new File(snapDir,version + VERSION);
  if (!this.dataDir.exists()) {
    if (!this.dataDir.mkdirs()) {
      throw new IOException("Unable to create data directory " + this.dataDir);
    }
  }
  if (!this.snapDir.exists()) {
    if (!this.snapDir.mkdirs()) {
      throw new IOException("Unable to create snap directory " + this.snapDir);
    }
  }
  txnLog=new FileTxnLog(this.dataDir);
  snapLog=new FileSnap(this.snapDir);
}
