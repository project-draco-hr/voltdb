{
  snapLog.deserialize(dt,sessions);
  FileTxnLog txnLog=new FileTxnLog(dataDir);
  TxnIterator itr=txnLog.read(dt.lastProcessedZxid + 1);
  long highestZxid=dt.lastProcessedZxid;
  TxnHeader hdr;
  while (true) {
    hdr=itr.getHeader();
    if (hdr == null) {
      return dt.lastProcessedZxid;
    }
    if (hdr.getZxid() < highestZxid && highestZxid != 0) {
      LOG.error(highestZxid + "(higestZxid) > " + hdr.getZxid()+ "(next log) for type "+ hdr.getType());
    }
 else {
      highestZxid=hdr.getZxid();
    }
    processTransaction(hdr,dt,sessions,itr.getTxn());
    if (!itr.next())     break;
  }
  return highestZxid;
}
