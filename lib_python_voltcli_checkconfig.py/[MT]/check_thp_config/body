def check_thp_config():
    thp_filenames = glob.glob('/sys/kernel/mm/*transparent_hugepage/enabled')
    thp_filenames += glob.glob('/sys/kernel/mm/*transparent_hugepage/defrag')
    for filename in thp_filenames:
        with file(filename) as f:
            if ('[always]' in f.read()):
                return "The kernel is configured to always use transparent huge pages. This is not a supported configuration for running VoltDB. To disable this feature, please run the following:\nfor f in /sys/kernel/mm/*transparent_hugepage/enabled; do\n    if test -f $f; then echo never > $f; fi\ndone\nfor f in /sys/kernel/mm/*transparent_hugepage/defrag; do\n    if test -f $f; then echo never > $f; fi\ndone\nAs root, you may add these options to your /etc/rc.local file. It is acceptable to replace 'never' with 'madvise' in the above commands to allow applications to opt into using transparent huge pages."
