{
  involvedPartitions=Sets.newHashSet();
  List<IndexSnapshotRequestConfig.PartitionRanges> pRanges=new ArrayList<IndexSnapshotRequestConfig.PartitionRanges>();
  for (  int pid : pidToHSId.keySet()) {
    if (involvedPartitionCount-- == 0) {
      break;
    }
    Map<Long,Long> ranges=new TreeMap<Long,Long>();
    long rangeStart=pid * 100l;
    for (int i=0; i < 5; i++) {
      ranges.put(rangeStart,rangeStart + 5);
      rangeStart+=10;
    }
    pRanges.add(new IndexSnapshotRequestConfig.PartitionRanges(pid,ranges));
    involvedPartitions.add(pid);
  }
  IndexSnapshotRequestConfig config=new IndexSnapshotRequestConfig(tables,pRanges);
  JSONStringer stringer=new JSONStringer();
  stringer.object();
  config.toJSONString(stringer);
  stringer.endObject();
  return new JSONObject(stringer.toString());
}
