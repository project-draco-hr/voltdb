{
  boolean visibleFromOutputFuture=false;
  boolean firstTimeSeeingThisException=true;
  if (allMustSucceed) {
    visibleFromOutputFuture=super.setException(throwable);
synchronized (seenExceptionsLock) {
      if (seenExceptions == null) {
        seenExceptions=Sets.newHashSet();
      }
      firstTimeSeeingThisException=seenExceptions.add(throwable);
    }
  }
  if (throwable instanceof Error || (allMustSucceed && !visibleFromOutputFuture && firstTimeSeeingThisException)) {
    logger.log(Level.SEVERE,"input future failed.",throwable);
  }
}
