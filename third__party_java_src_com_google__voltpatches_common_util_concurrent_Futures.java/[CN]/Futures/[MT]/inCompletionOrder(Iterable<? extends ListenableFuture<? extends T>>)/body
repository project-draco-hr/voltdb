{
  final ConcurrentLinkedQueue<AsyncSettableFuture<T>> delegates=Queues.newConcurrentLinkedQueue();
  ImmutableList.Builder<ListenableFuture<T>> listBuilder=ImmutableList.builder();
  SerializingExecutor executor=new SerializingExecutor(MoreExecutors.sameThreadExecutor());
  for (  final ListenableFuture<? extends T> future : futures) {
    AsyncSettableFuture<T> delegate=AsyncSettableFuture.create();
    delegates.add(delegate);
    future.addListener(new Runnable(){
      @Override public void run(){
        delegates.remove().setFuture(future);
      }
    }
,executor);
    listBuilder.add(delegate);
  }
  return listBuilder.build();
}
