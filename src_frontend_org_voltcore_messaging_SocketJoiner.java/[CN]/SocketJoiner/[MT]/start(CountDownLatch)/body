{
  boolean retval=false;
  try {
    m_listenerSocket=ServerSocketChannel.open();
    m_listenerSocket.socket().bind(m_coordIp);
    m_listenerSocket.socket().setPerformancePreferences(0,2,1);
    m_internalPort=m_coordIp.getPort();
    m_internalInterface=m_coordIp.getAddress().getHostAddress();
  }
 catch (  IOException e) {
    if (m_listenerSocket != null) {
      try {
        m_listenerSocket.close();
        m_listenerSocket=null;
      }
 catch (      IOException ex) {
        new VoltLogger(SocketJoiner.class.getName()).l7dlog(Level.FATAL,null,ex);
      }
    }
  }
  if (m_listenerSocket != null) {
    retval=true;
    if (m_hostLog != null)     m_hostLog.info("Connecting to VoltDB cluster as the leader...");
    m_es.submit(new Callable<Object>(){
      @Override public Object call() throws Exception {
        externalInitBarrier.await();
        return null;
      }
    }
);
  }
 else {
    if (m_hostLog != null) {
      m_hostLog.info("Connecting to the VoltDB cluster leader " + m_coordIp + ":"+ m_internalPort);
    }
    connectToPrimary();
  }
  m_es.submit(new Runnable(){
    @Override public void run(){
      try {
        runPrimary();
      }
 catch (      InterruptedException e) {
      }
catch (      Throwable e) {
        org.voltdb.VoltDB.crashLocalVoltDB("Error in socket joiner run loop",false,e);
      }
    }
  }
);
  return retval;
}
