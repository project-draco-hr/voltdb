{
  m_isActive=true;
  m_frequency=schedule.getFrequencyvalue();
  m_retain=schedule.getRetain();
  m_path=schedule.getPath();
  m_prefix=schedule.getPrefix();
  m_prefixAndSeparator=m_prefix + "_";
  final String frequencyUnitString=schedule.getFrequencyunit().toLowerCase();
  assert(frequencyUnitString.length() == 1);
  final char frequencyUnit=frequencyUnitString.charAt(0);
switch (frequencyUnit) {
case 's':
    m_frequencyUnit=TimeUnit.SECONDS;
  break;
case 'm':
m_frequencyUnit=TimeUnit.MINUTES;
break;
case 'h':
m_frequencyUnit=TimeUnit.HOURS;
break;
default :
throw new RuntimeException("Frequency unit " + frequencyUnitString + ""+ " in snapshot schedule is not one of d,m,h");
}
m_frequencyInMillis=TimeUnit.MILLISECONDS.convert(m_frequency,m_frequencyUnit);
m_nextSnapshotTime=System.currentTimeMillis() + m_frequencyInMillis;
}
