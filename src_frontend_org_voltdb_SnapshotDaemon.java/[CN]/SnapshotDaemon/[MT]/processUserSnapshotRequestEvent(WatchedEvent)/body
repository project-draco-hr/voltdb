{
  if (event.getType() == EventType.NodeCreated) {
    byte data[]=m_zk.getData(event.getPath(),false,null);
    String jsonString=new String(data,"UTF-8");
    final JSONObject jsObj=new JSONObject(jsonString);
    final String requestId=jsObj.getString("requestId");
    jsObj.remove("requestId");
    final long handle=m_nextCallbackHandle++;
    m_procedureCallbacks.put(handle,new ProcedureCallback(){
      @Override public void clientCallback(      ClientResponse clientResponse) throws Exception {
        if (clientResponse.getStatus() != ClientResponse.SUCCESS) {
          hostLog.error(clientResponse.getStatusString());
          FastSerializer fs=new FastSerializer();
          fs.writeObject((ClientResponseImpl)clientResponse);
          m_zk.create("/user_snapshot_response_" + requestId,fs.getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
          userSnapshotRequestExistenceCheck();
        }
        if (isSnapshotInProgressResponse(clientResponse)) {
          scheduleSnapshotForLater(jsObj.toString(4),requestId,true);
        }
 else {
          FastSerializer fs=new FastSerializer();
          fs.writeObject((ClientResponseImpl)clientResponse);
          m_zk.create("/user_snapshot_response_" + requestId,fs.getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
          userSnapshotRequestExistenceCheck();
        }
      }
    }
);
    m_initiator.initiateSnapshotDaemonWork("@SnapshotSave",handle,new Object[]{jsObj.toString(4)});
    return;
  }
}
