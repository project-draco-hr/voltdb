{
  if (m_snapshots.size() <= m_retain) {
    m_state=State.WAITING;
  }
 else {
    m_lastSysprocInvocation=System.currentTimeMillis();
    m_state=State.DELETING;
    final int numberToDelete=m_snapshots.size() - m_retain;
    String pathsToDelete[]=new String[numberToDelete];
    String noncesToDelete[]=new String[numberToDelete];
    for (int ii=0; ii < numberToDelete; ii++) {
      final Snapshot s=m_snapshots.poll();
      pathsToDelete[ii]=s.path;
      noncesToDelete[ii]=s.nonce;
      hostLog.info("Snapshot daemon deleting " + s.nonce);
    }
    Object params[]=new Object[]{pathsToDelete,noncesToDelete};
    return Pair.of("@SnapshotDelete",params);
  }
  return null;
}
