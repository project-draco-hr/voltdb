{
  Client client=getClient();
  loadSomeData(client,0,10);
  client.drain();
  assertTrue(callbackSuccess);
  String newCatalogURL=Configuration.getPathToCatalogForTest("catalogupdate-cluster-addindex.jar");
  String deploymentURL=Configuration.getPathToCatalogForTest("catalogupdate-cluster-addindex.xml");
  VoltTable[] results=client.updateApplicationCatalog(new File(newCatalogURL),new File(deploymentURL)).getResults();
  assertTrue(results.length == 1);
  ClientResponse callProcedure=client.callProcedure("@AdHoc","insert into NEW_ORDER values (-1, -1, -1);");
  assertTrue(callProcedure.getResults().length == 1);
  assertTrue(callProcedure.getStatus() == ClientResponse.SUCCESS);
  callProcedure=client.callProcedure("@AdHoc","select * from NEW_ORDER where NO_O_ID = 5;");
  VoltTable result=callProcedure.getResults()[0];
  result.advanceRow();
  assertEquals(5,result.getLong("NO_O_ID"));
  loadSomeData(client,20,10);
  client.drain();
  assertTrue(callbackSuccess);
  newCatalogURL=Configuration.getPathToCatalogForTest("catalogupdate-cluster-base.jar");
  deploymentURL=Configuration.getPathToCatalogForTest("catalogupdate-cluster-base.xml");
  results=client.updateApplicationCatalog(new File(newCatalogURL),new File(deploymentURL)).getResults();
  assertTrue(results.length == 1);
  callProcedure=client.callProcedure("@AdHoc","select * from NEW_ORDER where NO_O_ID = 5;");
  result=callProcedure.getResults()[0];
  result.advanceRow();
  assertEquals(5,result.getLong("NO_O_ID"));
  loadSomeData(client,30,10);
  client.drain();
  assertTrue(callbackSuccess);
}
