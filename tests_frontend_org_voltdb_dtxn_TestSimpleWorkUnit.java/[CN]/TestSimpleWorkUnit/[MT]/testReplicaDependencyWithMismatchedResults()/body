{
  VoltTable.ColumnInfo[] cols2={new VoltTable.ColumnInfo("age",VoltType.INTEGER)};
  VoltTable t3=new VoltTable(cols2,1);
  t3.addRow(11);
  setUpSites(2,2,1);
  int multi_dep=5 | DtxnConstants.MULTIPARTITION_DEPENDENCY;
  WorkUnit w=new WorkUnit(m_voltdb.getSiteTracker(),work,new int[]{4,multi_dep},0L,new long[]{1,2,3},false,false);
  assertFalse(w.allDependenciesSatisfied());
  assertEquals(w.getDependency(4).size(),0);
  assertEquals(w.getDependency(5).size(),0);
  w.putDependency(4,0,t1,st);
  assertFalse(w.allDependenciesSatisfied());
  w.putDependency(multi_dep,0,t2,st);
  assertFalse(w.allDependenciesSatisfied());
  boolean threw=false;
  try {
    w.putDependency(multi_dep,1,t3,st);
  }
 catch (  RuntimeException e) {
    threw=true;
  }
  assertTrue(threw);
}
