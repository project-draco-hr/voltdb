{
  try {
    BufferedReader in=new BufferedReader(new InputStreamReader(m_clientSocket.getInputStream()));
    while (shouldRun()) {
      String line=in.readLine();
      if (line == null)       continue;
      CSVInvocation invocation=new CSVInvocation(m_procedure,line,m_config.getSeparator());
      if (!callProcedure(invocation)) {
        rateLimitedLog(Level.ERROR,null,"Socket importer insertion failed");
      }
    }
  }
 catch (  IOException ioe) {
    error("IO exception reading from client socket connection in socket importer",ioe);
  }
  try {
    m_clientSocket.close();
    info("Client Closed.",null);
  }
 catch (  IOException e) {
    warn("Error closing socket importer connection",e);
  }
}
