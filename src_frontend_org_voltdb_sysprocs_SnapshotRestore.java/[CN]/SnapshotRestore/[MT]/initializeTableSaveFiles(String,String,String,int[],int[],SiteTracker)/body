{
  if (!m_initializedTableSaveFileNames.add(tableName)) {
    return;
  }
  HashSet<Integer> relevantPartitionSet=new HashSet<Integer>();
  for (  int part_id : relevantPartitionIds) {
    relevantPartitionSet.add(part_id);
  }
  for (  int originalHostId : originalHostIds) {
    final File f=getSaveFileForPartitionedTable(filePath,fileNonce,tableName,originalHostId);
    TableSaveFile savefile=getTableSaveFile(f,st.getLocalSites().length * 4,relevantPartitionSet.toArray(new Integer[relevantPartitionSet.size()]));
    m_saveFiles.offer(savefile);
    for (    int part_id : savefile.getPartitionIds()) {
      relevantPartitionSet.remove(part_id);
    }
    if (relevantPartitionSet.isEmpty()) {
      break;
    }
    assert(m_saveFiles.peekLast().getCompleted());
  }
}
