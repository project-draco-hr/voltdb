{
  IOBuffers buffers=m_buffers.get();
  ByteBuffer input=buffers.input;
  ByteBuffer output=buffers.output;
  if (input.capacity() < bytes.length) {
    DBBPool.cleanByteBuffer(input);
    input=ByteBuffer.allocateDirect(Math.max(input.capacity() * 2,bytes.length));
    buffers=new IOBuffers(input,output);
    m_buffers.set(buffers);
  }
  input.clear();
  input.put(bytes);
  input.flip();
  final int uncompressedLength=Snappy.uncompressedLength(input);
  if (output.capacity() < uncompressedLength) {
    DBBPool.cleanByteBuffer(output);
    output=ByteBuffer.allocateDirect(Math.max(output.capacity() * 2,uncompressedLength));
    buffers=new IOBuffers(input,output);
    m_buffers.set(buffers);
  }
  output.clear();
  final int actualUncompressedLength=Snappy.uncompress(input,output);
  assert(uncompressedLength == actualUncompressedLength);
  byte result[]=new byte[actualUncompressedLength];
  output.get(result);
  return result;
}
