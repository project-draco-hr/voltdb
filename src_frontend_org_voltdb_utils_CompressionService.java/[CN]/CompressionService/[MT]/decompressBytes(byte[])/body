{
  IOBuffers buffers=m_buffers.get();
  BBContainer input=buffers.input;
  BBContainer output=buffers.output;
  final int inputCapacity=input.b().capacity();
  if (inputCapacity < bytes.length) {
    input.discard();
    input=DBBPool.allocateDirect(Math.max(inputCapacity * 2,bytes.length));
    buffers=new IOBuffers(input,output);
    m_buffers.set(buffers);
  }
  input.b().clear();
  input.b().put(bytes);
  input.b().flip();
  final int uncompressedLength=Snappy.uncompressedLength(input.b());
  final int outputCapacity=output.b().capacity();
  if (outputCapacity < uncompressedLength) {
    output.discard();
    output=DBBPool.allocateDirect(Math.max(outputCapacity * 2,uncompressedLength));
    buffers=new IOBuffers(input,output);
    m_buffers.set(buffers);
  }
  output.b().clear();
  final int actualUncompressedLength=Snappy.uncompress(input.b(),output.b());
  assert(uncompressedLength == actualUncompressedLength);
  byte result[]=new byte[actualUncompressedLength];
  output.b().get(result);
  return result;
}
