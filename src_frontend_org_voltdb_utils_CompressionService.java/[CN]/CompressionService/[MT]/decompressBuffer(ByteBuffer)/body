{
  assert(compressed.isDirect());
  IOBuffers buffers=m_buffers.get();
  ByteBuffer input=buffers.input;
  ByteBuffer output=buffers.output;
  final int uncompressedLength=Snappy.uncompressedLength(input);
  if (output.capacity() < uncompressedLength) {
    output=ByteBuffer.allocateDirect(Math.max(output.capacity() * 2,uncompressedLength));
    buffers=new IOBuffers(input,output);
    m_buffers.set(buffers);
  }
  output.clear();
  final int actualUncompressedLength=Snappy.uncompress(input,output);
  assert(uncompressedLength == actualUncompressedLength);
  byte result[]=new byte[actualUncompressedLength];
  output.get(result);
  return result;
}
