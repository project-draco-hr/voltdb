{
  ExportProtoMessage m1, m2;
  m1=new ExportProtoMessage(1,2);
  ByteBuffer b=ByteBuffer.allocate(100);
  b.putInt(100);
  b.putInt(200);
  b.flip();
  m1.pollResponse(1000,b);
  ByteBuffer bm1=m1.toBuffer();
  FastDeserializer fdsm1=new FastDeserializer(bm1);
  assertEquals(m1.serializableBytes(),fdsm1.readInt());
  m2=ExportProtoMessage.readExternal(fdsm1);
  assertTrue(m2.isPollResponse());
  assertMsgType(m2,ExportProtoMessage.kPollResponse);
  assertEquals(1000,m2.getAckOffset());
  assertEquals(100,m2.getData().getInt());
  assertEquals(200,m2.getData().getInt());
  assertEquals(1,m2.getPartitionId());
  assertEquals(2,m2.getTableId());
}
