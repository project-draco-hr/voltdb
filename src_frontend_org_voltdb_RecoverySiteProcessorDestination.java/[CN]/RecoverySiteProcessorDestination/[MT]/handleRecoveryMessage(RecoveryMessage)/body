{
  assert(message.type() == RecoveryMessageType.ScanTuples || message.type() == RecoveryMessageType.Complete);
  if (!m_recoveryBegan) {
    m_buffered.add(message);
    return;
  }
  if (message.type() == RecoveryMessageType.ScanTuples) {
    byte data[]=message.getMessageData();
    m_bytesReceived+=data.length;
    m_engine.processRecoveryMessage(data);
    recoveryLog.trace("Received tuple data at site " + m_siteId + " for table "+ m_tables.get(message.tableId()).m_name);
  }
 else   if (message.type() == RecoveryMessageType.Complete) {
    RecoveryTable table=m_tables.remove(message.tableId());
    recoveryLog.info("Received completion message at site " + m_siteId + " for table "+ table.m_name);
  }
 else {
    System.out.println(message.type());
    VoltDB.crashVoltDB();
  }
  int sourceSite=message.sourceSite();
  RecoveryMessage ack=new RecoveryMessage(message,m_siteId);
  try {
    m_mailbox.send(sourceSite,0,ack);
  }
 catch (  MessagingException e) {
    throw new RuntimeException(e);
  }
}
