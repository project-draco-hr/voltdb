{
  assert(message.type() == RecoveryMessageType.ScanTuples || message.type() == RecoveryMessageType.Complete);
  if (message.type() == RecoveryMessageType.ScanTuples) {
    m_engine.processRecoveryMessage(message.getMessageData());
    int sourceSite=message.sourceSite();
    RecoveryMessage ack=new RecoveryMessage(message,m_siteId);
    try {
      m_mailbox.send(sourceSite,0,ack);
    }
 catch (    MessagingException e) {
      throw new RuntimeException(e);
    }
  }
 else   if (message.type() == RecoveryMessageType.Complete) {
    m_tables.remove(message.tableId());
    if (m_tables.isEmpty()) {
      m_onCompletion.run();
    }
  }
}
