{
  BufferedReader script=null;
  try {
    script=new BufferedReader(new FileReader(filePath));
  }
 catch (  FileNotFoundException e) {
    System.err.println("Script file '" + filePath + "' could not be found.");
    stopOrContinue(e);
    return null;
  }
  try {
    StringBuilder query=new StringBuilder();
    String line;
    while ((line=script.readLine()) != null) {
      if (RecallToken.matcher(line).matches() || ExitToken.matcher(line).matches() || GoToken.matcher(line).matches()) {
        continue;
      }
      Matcher fileMatcher=FileToken.matcher(line);
      if (fileMatcher.matches()) {
        line=readScriptFile(fileMatcher.group(1));
        if (m_returningToPromptAfterError) {
          return null;
        }
      }
      query.append(line);
      query.append("\n");
    }
    return query.toString().trim();
  }
 catch (  Exception x) {
    stopOrContinue(x);
    return null;
  }
 finally {
    if (script != null) {
      try {
        script.close();
      }
 catch (      IOException e) {
      }
    }
  }
}
