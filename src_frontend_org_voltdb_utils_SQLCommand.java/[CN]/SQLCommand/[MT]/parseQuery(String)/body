{
  if (query == null) {
    return null;
  }
  query=ParserStringKeywords.matcher(query).replaceAll(" $1 #SQL_PARSER_STRING_KEYWORD#$2 ");
  query=SingleLineComments.matcher(query).replaceAll("");
  query=EscapedSingleQuote.matcher(query).replaceAll("#(SQL_PARSER_ESCAPE_SINGLE_QUOTE)");
  Matcher stringFragmentMatcher=Extract.matcher(query);
  ArrayList<String> stringFragments=new ArrayList<String>();
  int i=0;
  while (stringFragmentMatcher.find()) {
    stringFragments.add(stringFragmentMatcher.group());
    query=stringFragmentMatcher.replaceFirst("#(SQL_PARSER_STRING_FRAGMENT#" + i + ")");
    stringFragmentMatcher=Extract.matcher(query);
    i++;
  }
  query=SetOp.matcher(query).replaceAll("$1$2$3$4SQL_PARSER_SAME_SELECT");
  query=Subquery.matcher(query).replaceAll("$1$2$3SQL_PARSER_SAME_SELECT");
  query=CreateView.matcher(query).replaceAll("$1$2SQL_PARSER_SAME_CREATEVIEW");
  query=CreateProcedureSelect.matcher(query).replaceAll("$1$2SQL_PARSER_SAME_CREATESELECT");
  query=CreateProcedureInsert.matcher(query).replaceAll("$1$2SQL_PARSER_SAME_CREATEINSERT");
  query=CreateProcedureUpdate.matcher(query).replaceAll("$1$2SQL_PARSER_SAME_CREATEUPDATE");
  query=CreateProcedureDelete.matcher(query).replaceAll("$1$2SQL_PARSER_SAME_CREATEDELETE");
  query=InsertIntoSelect.matcher(query).replaceAll("$1SQL_PARSER_SAME_INSERTINTOSELECT");
  query=AlterTableAlter.matcher(query).replaceAll("$1SQL_PARSER_SAME_ALTERTABLEALTER");
  query=AlterTableDrop.matcher(query).replaceAll("$1SQL_PARSER_SAME_ALTERTABLEDROP");
  query=AutoSplit.matcher(query).replaceAll(";$2$4 ");
  query=query.replaceAll("SQL_PARSER_SAME_SELECT","select");
  query=query.replaceAll("SQL_PARSER_SAME_CREATEVIEW","select");
  query=query.replaceAll("SQL_PARSER_SAME_CREATESELECT","select");
  query=query.replaceAll("SQL_PARSER_SAME_CREATEINSERT","insert");
  query=query.replaceAll("SQL_PARSER_SAME_CREATEUPDATE","update");
  query=query.replaceAll("SQL_PARSER_SAME_CREATEDELETE","delete");
  query=query.replaceAll("SQL_PARSER_SAME_INSERTINTOSELECT","select");
  query=query.replaceAll("SQL_PARSER_SAME_ALTERTABLEALTER","alter");
  query=query.replaceAll("SQL_PARSER_SAME_ALTERTABLEDROP","drop");
  String[] sqlFragments=query.split("\\s*;+\\s*");
  ArrayList<String> queries=new ArrayList<String>();
  for (  String fragment : sqlFragments) {
    fragment=fragment.trim();
    if (fragment.isEmpty()) {
      continue;
    }
    if (fragment.indexOf("#(SQL_PARSER_STRING_FRAGMENT#") > -1) {
      int k=0;
      for (      String strFrag : stringFragments) {
        fragment=fragment.replace("#(SQL_PARSER_STRING_FRAGMENT#" + k + ")",strFrag);
        k++;
      }
    }
    fragment=fragment.replace("#(SQL_PARSER_ESCAPE_SINGLE_QUOTE)","''");
    fragment=fragment.replace("#SQL_PARSER_STRING_KEYWORD#","");
    queries.add(fragment);
  }
  return queries;
}
