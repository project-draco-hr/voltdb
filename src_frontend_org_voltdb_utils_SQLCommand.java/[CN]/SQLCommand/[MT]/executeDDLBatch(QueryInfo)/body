{
  try {
    if (!SQLParser.batchBeginsWithDDLKeyword(queryInfo.getQuery().toString())) {
      throw new Exception("Error: This batch begins with a non-DDL statement.  " + "Currently batching is only supported for DDL.");
    }
    ClientResponse response=VoltDB.callProcedure("@AdHoc",queryInfo.getQuery().toString());
    if (response.getStatus() != ClientResponse.SUCCESS) {
      throw new Exception("Execution Error: " + response.getStatusString());
    }
    assert(response.getResults().length == 1);
    System.out.println("Batch command succeeded.");
  }
 catch (  ProcCallException ex) {
    String fixedMessage=patchErrorMessageWithFile(queryInfo,ex.getMessage());
    stopOrContinue(new Exception(fixedMessage));
  }
catch (  Exception ex) {
    stopOrContinue(ex);
  }
}
