{
  if (response.getStatus() != ClientResponse.SUCCESS)   throw new Exception("Execution Error: " + response.getStatusString());
  if (OutputFormat.equals("fixed")) {
    for (    VoltTable t : response.getResults()) {
      if (isUpdateResult(t)) {
        if (OutputShowMetadata)         System.out.printf("\n\n(%d row(s) affected)\n",t.fetchRow(0).getLong(0));
        continue;
      }
      System.out.println(t.toFormattedString());
      if (OutputShowMetadata)       System.out.printf("\n\n(%d row(s) affected)\n",t.getRowCount());
    }
  }
 else {
    String separator=OutputFormat.equals("csv") ? "," : "\t";
    for (    VoltTable t : response.getResults()) {
      if (isUpdateResult(t)) {
        if (OutputShowMetadata)         System.out.printf("\n\n(%d row(s) affected)\n",t.fetchRow(0).getLong(0));
        continue;
      }
      int columnCount=t.getColumnCount();
      if (OutputShowMetadata) {
        for (int i=0; i < columnCount; i++) {
          if (i > 0)           System.out.print(separator);
          System.out.print(t.getColumnName(i));
        }
        System.out.print("\n");
      }
      t.resetRowPosition();
      while (t.advanceRow()) {
        for (int i=0; i < columnCount; i++) {
          if (i > 0)           System.out.print(separator);
          Object v=t.get(i,t.getColumnType(i));
          if (t.wasNull())           v="NULL";
 else           if (t.getColumnType(i) == VoltType.VARBINARY)           v=byteArrayToHexString((byte[])v);
 else           v=v.toString();
          System.out.print(v);
        }
        System.out.print("\n");
      }
      if (OutputShowMetadata)       System.out.printf("\n\n(%d row(s) affected)\n",t.getRowCount());
    }
  }
}
