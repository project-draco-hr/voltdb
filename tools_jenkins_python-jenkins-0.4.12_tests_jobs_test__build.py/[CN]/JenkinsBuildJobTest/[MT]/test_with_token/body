@patch.object(jenkins.Jenkins, 'jenkins_open')
def test_with_token(self, jenkins_mock):
    jenkins_mock.side_effect = [{'foo': 'bar', }]
    build_info = self.j.build_job(u'TestJob', token='some_token')
    self.assertEqual(jenkins_mock.call_args[0][0].get_full_url(), self.make_url('job/TestJob/build?token=some_token'))
    self.assertEqual(build_info, {'foo': 'bar', })
    self._check_requests(jenkins_mock.call_args_list)
