{
  try {
    long endTime=System.currentTimeMillis() + (1000l * this.duration);
    Random rand=new Random();
    while (endTime > System.currentTimeMillis()) {
      if (rand.nextDouble() < getPutRatio) {
        try {
          String key=processor.generateRandomKeyForRetrieval();
          VoltCacheResult result=cache.get(key);
          if (result.Data.size() == 0)           GetStoreResults.incrementAndGet(1);
 else {
            final PayloadProcessor.Pair pair=processor.retrieveFromStore(key,result.Data.get(key).Value);
            GetStoreResults.incrementAndGet(0);
            GetCompressionResults.addAndGet(0,pair.getStoreValueLength());
            GetCompressionResults.addAndGet(1,pair.getRawValueLength());
          }
        }
 catch (        Exception x) {
          GetStoreResults.incrementAndGet(1);
        }
      }
 else {
        final PayloadProcessor.Pair pair=processor.generateForStore();
        try {
          cache.set(pair.Key,0,0,pair.getStoreValue(),false);
          PutStoreResults.incrementAndGet(0);
        }
 catch (        Exception x) {
          PutStoreResults.incrementAndGet(1);
        }
 finally {
          PutCompressionResults.addAndGet(0,pair.getStoreValueLength());
          PutCompressionResults.addAndGet(1,pair.getRawValueLength());
        }
      }
    }
  }
 catch (  Exception x) {
    System.err.println("Exception: " + x);
    x.printStackTrace();
  }
}
