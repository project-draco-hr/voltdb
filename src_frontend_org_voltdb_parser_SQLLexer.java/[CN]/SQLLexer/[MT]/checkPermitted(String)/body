{
  for (  CheckedPattern cp : BLACKLISTS) {
    CheckedPattern.Result result=cp.check(sql);
    if (result.matcher != null) {
      return new CheckPermittedResult(true,true,String.format("Statement: %s, failed blacklist: %s",sql,result.explanation));
    }
  }
  boolean hadWLMatch=false;
  for (  CheckedPattern cp : WHITELISTS) {
    if (cp.matches(sql)) {
      hadWLMatch=true;
      break;
    }
  }
  if (!hadWLMatch) {
    return new CheckPermittedResult(true,false,String.format("Statement: %s, failed to match any whitelist",sql));
  }
  return new CheckPermittedResult(false,false,null);
}
