{
  int submitCount=0;
  if (m_resubmitInvocation.peek() != null) {
    ArrayList<TopicPartitionInvocationCallback> pendingQueue=new ArrayList<TopicPartitionInvocationCallback>();
    String msg="Bounced pending transaction queue is: " + m_resubmitInvocation.size() + " Resubmitting... ";
    m_resubmitInvocation.drainTo(pendingQueue,(int)ImportClientResponseAdapter.MAX_PENDING_TRANSACTIONS_PER_PARTITION - 1);
    info(msg + pendingQueue.size());
    for (    TopicPartitionInvocationCallback cb : pendingQueue) {
      final Invocation invocation=cb.getInvocation();
      if (!callProcedure(cb,invocation)) {
        if (isDebugEnabled()) {
          debug("Failed to process Invocation possibly bad data: " + invocation);
        }
      }
      submitCount++;
    }
  }
  return submitCount;
}
