{
  try {
    if (m_seenOffset.size() >= m_perTopicPendingLimit) {
      long commit=m_seenOffset.last();
      if (commitOffset(commit)) {
        debug("Committed offset " + commit + " for "+ m_topicAndPartition);
        m_currentOffset.set(commit);
      }
synchronized (m_seenOffset) {
        m_seenOffset.clear();
      }
      info("Seen offset commit list is too big. Size " + m_perTopicPendingLimit + " Commiting highest offset and clean.");
      return;
    }
    long commit;
synchronized (m_seenOffset) {
      if (!m_seenOffset.isEmpty()) {
        m_seenOffset.add(currentNext);
        commit=m_seenOffset.first();
        while (m_seenOffset.contains(++commit)) {
          m_seenOffset.remove(commit);
        }
      }
 else {
        commit=currentNext;
      }
    }
    if (commitOffset(commit)) {
      if (isDebugEnabled()) {
        debug("Committed offset " + commit + " for "+ m_topicAndPartition);
      }
      m_committedOffset.set(commit);
    }
  }
 catch (  Exception ex) {
    error(ex,"Failed to commit and save offset %d",currentNext);
  }
}
