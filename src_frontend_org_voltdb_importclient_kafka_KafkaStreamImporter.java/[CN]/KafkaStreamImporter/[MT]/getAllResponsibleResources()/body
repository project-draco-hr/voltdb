{
  SimpleConsumer simpleConsumer=null;
  Set<URI> availableResources=new TreeSet<URI>();
  try {
    simpleConsumer=new SimpleConsumer(m_brokerList.get(0).getHost(),m_brokerList.get(0).getPort(),m_consumerSocketTimeout,m_fetchSize,CLIENT_ID);
    availableResources=buildTopicLeaderMetadata(simpleConsumer);
  }
 catch (  Exception ex) {
    VoltDB.crashLocalVoltDB("Failed to get available resources for kafka importer",true,ex);
  }
 finally {
    closeConsumer(simpleConsumer);
  }
  return availableResources;
}
