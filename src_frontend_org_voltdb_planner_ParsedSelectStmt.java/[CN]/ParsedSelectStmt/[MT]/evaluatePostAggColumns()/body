{
  HashMap<AbstractExpression,Integer> aggTableIndexMap=new HashMap<AbstractExpression,Integer>();
  HashMap<AbstractExpression,String> exprToAliasMap=new HashMap<AbstractExpression,String>();
  for (int i=0; i < aggResultColumns.size(); i++) {
    ParsedColInfo col=aggResultColumns.get(i);
    aggTableIndexMap.put(col.expression,i);
    exprToAliasMap.put(col.expression,col.alias);
  }
  NodeSchema agg_schema=new NodeSchema();
  for (  ParsedColInfo col : displayColumns) {
    SchemaColumn schema_col=null;
    if (col.expression.hasAnySubexpressionOfClass(AggregateExpression.class)) {
      AbstractExpression expr=col.expression.replaceWithTVE(aggTableIndexMap,exprToAliasMap);
      schema_col=new SchemaColumn("VOLT_TEMP_TABLE","",col.alias,expr);
    }
 else {
      schema_col=new SchemaColumn(col.tableName,col.columnName,col.alias,col.expression);
    }
    agg_schema.addColumn(schema_col);
  }
  return agg_schema;
}
