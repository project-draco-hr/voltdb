{
  ByteBuffer msg=createMsg("@AdHoc","select * from a");
  ClientResponseImpl resp=m_ci.handleRead(msg,m_handler,null);
  assertNull(resp);
  ArgumentCaptor<LocalObjectMessage> captor=ArgumentCaptor.forClass(LocalObjectMessage.class);
  verify(m_messenger).send(eq(32L),captor.capture());
  assertTrue(captor.getValue().payload instanceof AdHocPlannerWork);
  assertTrue(captor.getValue().payload.toString().contains("partition param: null"));
  reset(m_messenger);
  msg=createMsg("@AdHoc","select * from a where i = 3",3);
  resp=m_ci.handleRead(msg,m_handler,null);
  assertNull(resp);
  verify(m_messenger).send(eq(32L),captor.capture());
  assertTrue(captor.getValue().payload instanceof AdHocPlannerWork);
  assertTrue(captor.getValue().payload.toString().contains("partition param: 3"));
}
