{
  if (columns == null) {
    throw new NullPointerException(String.format("columns to write should not be null on line %d",lineNumber));
  }
 else   if (columns.length == 0) {
    throw new IllegalArgumentException(String.format("columns to write should not be empty on line %d",lineNumber));
  }
  for (int i=0; i < columns.length; i++) {
    columnNumber=i + 1;
    if (i > 0) {
      writer.write(preference.getDelimiterChar());
    }
    final String csvElement=columns[i];
    if (csvElement != null) {
      writer.write(escapeString(csvElement));
    }
  }
  writer.write(preference.getEndOfLineSymbols());
}
