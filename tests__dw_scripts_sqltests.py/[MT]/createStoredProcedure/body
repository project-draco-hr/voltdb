def createStoredProcedure(sqlfile, classname):
    f = open(sqlfile)
    statements = []
    stmt = getNextStatement(f)
    while (stmt != None):
        statements.append(stmt)
        stmt = getNextStatement(f)
    print '/* This procedure generated by sqltests.py using ', sqlfile, '*/'
    print 'package com.volt.sqltest;'
    print 'import com.volt.*'
    print '\n/* DDL SECTION */\n'
    for s in statements:
        s.printDDLStatements('')
    print '\n/* PROCEDURE SECTION */\n'
    print '@ProcInfo('
    print '\tpartitionInfo = "T.C1: 0",'
    print '\talwaysSingleSite = true'
    print ')'
    print 'public class ', classname, '{'
    print '\tHZTable result_table = null;'
    print '\tlong result_long = 0L;'
    for s in statements:
        s.printSQLStmts('\t')
    print '\tpublic static HZTable[] run() throws HZ.AbortException {'
    for s in statements:
        s.printQueryExecutions('\t')
        print ''
    print '\t}'
    print '}'
