{
  List<byte[]> addresses=new ArrayList<byte[]>();
  List<byte[]> loopbackInterfaces=new ArrayList<byte[]>();
  List<InetAddress> loopbackAddresses=new ArrayList<InetAddress>();
  Enumeration<NetworkInterface> interfaces=NetworkInterface.getNetworkInterfaces();
  while (interfaces.hasMoreElements()) {
    NetworkInterface intf=interfaces.nextElement();
    if (!intf.isUp()) {
      continue;
    }
    Enumeration<InetAddress> addressesEnum=intf.getInetAddresses();
    while (addressesEnum.hasMoreElements()) {
      InetAddress address=addressesEnum.nextElement();
      if (intf.isLoopback()) {
        loopbackAddresses.add(address);
        loopbackInterfaces.add(address.getAddress());
      }
 else {
        addresses.add(address.getAddress());
      }
    }
  }
  addresses.addAll(loopbackInterfaces);
  return addresses;
}
