{
  Vector<AbstractPlanNode> execute_list=new Vector<AbstractPlanNode>();
  Map<AbstractPlanNode,Integer> child_cnts=new HashMap<AbstractPlanNode,Integer>();
  for (  AbstractPlanNode node : m_planNodes) {
    int num_of_children=node.getChildCount();
    if (num_of_children == 0) {
      execute_list.add(node);
    }
 else {
      child_cnts.put(node,num_of_children);
    }
  }
  m_list.clear();
  while (!execute_list.isEmpty()) {
    AbstractPlanNode node=execute_list.remove(0);
    m_list.add(node);
    for (int i=0; i < node.getParentCount(); i++) {
      AbstractPlanNode parent=node.getParent(i);
      int remaining=child_cnts.get(parent) - 1;
      child_cnts.put(parent,remaining);
      if (remaining == 0) {
        execute_list.add(parent);
      }
    }
  }
  if (m_list.size() != m_planNodes.size()) {
    throw new Exception("ERROR: The execution list has '" + m_list.size() + "' PlanNodes but our original tree has '"+ m_planNodes.size()+ "' PlanNode entries");
  }
  return;
}
