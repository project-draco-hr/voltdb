{
  final HashMap<String,long[]> retval=new HashMap<String,long[]>();
  long totalRead=0;
  long totalMessagesRead=0;
  long totalWritten=0;
  long totalMessagesWritten=0;
synchronized (m_ports) {
    for (    VoltPort p : m_ports) {
      final long read=p.readStream().getBytesRead();
      final long writeInfo[]=p.writeStream().getBytesAndMessagesWritten();
      final long messagesRead=p.getMessagesRead();
      totalRead+=read;
      totalMessagesRead+=messagesRead;
      totalWritten+=writeInfo[0];
      totalMessagesWritten+=writeInfo[1];
      retval.put(p.m_remoteHost,new long[]{read,messagesRead,writeInfo[0],writeInfo[1]});
    }
  }
  retval.put("GLOBAL",new long[]{totalRead,totalMessagesRead,totalWritten,totalMessagesWritten});
  return retval;
}
