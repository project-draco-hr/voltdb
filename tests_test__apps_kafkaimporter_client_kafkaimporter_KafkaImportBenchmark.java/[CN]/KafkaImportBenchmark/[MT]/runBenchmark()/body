{
  log.info(HORIZONTAL_RULE);
  log.info("Setup & Initialization");
  log.info(HORIZONTAL_RULE);
  log.info(HORIZONTAL_RULE);
  log.info("Starting Benchmark");
  log.info(HORIZONTAL_RULE);
  SecureRandom rnd=new SecureRandom();
  rnd.setSeed(System.identityHashCode(Thread.currentThread()));
  long icnt=0;
  try {
    log.info("Warming up...");
    final long warmupEndTime=System.currentTimeMillis() + (1000l * config.warmup);
    while (warmupEndTime > System.currentTimeMillis()) {
      long value=System.currentTimeMillis();
      long key=icnt;
      exportProc.insertExport(key,value);
      icnt++;
    }
    benchmarkStartTS=System.currentTimeMillis();
    schedulePeriodicStats();
    log.info("Starting data checker...");
    checkTimer=matchChecks.checkTimer(5000,client);
    log.info("Running benchmark...");
    final long benchmarkEndTime=System.currentTimeMillis() + (1000l * config.duration);
    while (benchmarkEndTime > System.currentTimeMillis()) {
      long value=System.currentTimeMillis();
      long key=icnt;
      exportProc.insertExport(key,value);
      icnt++;
    }
    exportMon.waitForStreamedAllocatedMemoryZero();
    importMon.waitForStreamedAllocatedMemoryZero();
    exportProc.insertFinal(-1,-1);
    log.info("Done waiting for import & export tables");
  }
  finally {
    log.info("Cancel periodic stats");
    statsTimer.cancel();
    finalInsertCount.addAndGet(icnt);
  }
}
