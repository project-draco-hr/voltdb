{
  client.callProcedure("InsertR1",1,1,1);
  client.callProcedure("InsertR1",1,1,1);
  client.callProcedure("InsertR1",2,2,2);
  client.callProcedure("InsertR1",3,3,3);
  client.callProcedure("InsertR2",1,3);
  client.callProcedure("InsertR2",3,4);
  VoltTable result=client.callProcedure("@AdHoc","SELECT * FROM R1 JOIN R2 ON R1.A = R2.A;").getResults()[0];
  assertEquals(3,result.getRowCount());
  result=client.callProcedure("@AdHoc","SELECT * FROM R1 JOIN R2 USING(A);").getResults()[0];
  assertEquals(3,result.getRowCount());
  client.callProcedure("InsertP1",1,1);
  client.callProcedure("InsertP1",1,1);
  client.callProcedure("InsertP1",2,2);
  client.callProcedure("InsertP1",3,3);
  result=client.callProcedure("@AdHoc","SELECT * FROM P1 JOIN R2 ON P1.A = R2.A;").getResults()[0];
  assertEquals(3,result.getRowCount());
}
