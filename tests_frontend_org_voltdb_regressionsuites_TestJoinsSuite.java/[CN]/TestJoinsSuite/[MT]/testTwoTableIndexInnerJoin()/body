{
  Client client=this.getClient();
  client.callProcedure("InsertR3",1,1);
  client.callProcedure("InsertR3",1,1);
  client.callProcedure("InsertR3",2,2);
  client.callProcedure("InsertR3",3,3);
  client.callProcedure("InsertR2",1,3);
  client.callProcedure("InsertR2",3,4);
  VoltTable result=client.callProcedure("@AdHoc","SELECT * FROM R3 JOIN R2 ON R3.A = R2.A;").getResults()[0];
  assertEquals(3,result.getRowCount());
  client.callProcedure("InsertP3",1,1);
  client.callProcedure("InsertP3",2,2);
  client.callProcedure("InsertP3",3,3);
  result=client.callProcedure("@AdHoc","SELECT * FROM P3 JOIN R2 ON P3.A = R2.A;").getResults()[0];
  assertEquals(2,result.getRowCount());
}
