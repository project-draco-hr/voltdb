{
  assert(startDrId <= endDrId && startDrId > m_lastAckedDrId);
  assert(m_map.size() == 0 || m_map.lastEntry().getValue() < startDrId);
  m_lastSpUniqueId=Math.max(m_lastSpUniqueId,spUniqueId);
  m_lastMpUniqueId=Math.max(m_lastMpUniqueId,mpUniqueId);
  Map.Entry<Long,Long> prevEntry=m_map.lowerEntry(startDrId);
  if (prevEntry != null && prevEntry.getValue() + 1 == startDrId) {
    m_map.put(prevEntry.getKey(),endDrId);
  }
 else {
    m_map.put(startDrId,endDrId);
  }
}
