{
  assert(newTruncationPoint >= m_lastAckedDrId);
  Map.Entry<Long,Long> firstEntry=m_map.firstEntry();
  while (firstEntry != null && firstEntry.getKey() <= newTruncationPoint) {
    m_map.remove(firstEntry.getKey());
    if (firstEntry.getValue() > newTruncationPoint) {
      m_map.put(newTruncationPoint + 1,firstEntry.getValue());
      break;
    }
    firstEntry=m_map.firstEntry();
  }
  m_lastAckedDrId=newTruncationPoint;
}
