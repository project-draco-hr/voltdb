{
  if (!m_spnegoEnabled || forDelegate == null || forDelegate.isEmpty()) {
    return null;
  }
  ImmutableSet.Builder<Principal> sbld=ImmutableSet.builder();
  Subject svc=getAuthSystem().getLoginContext().getSubject();
  sbld.addAll(svc.getPrincipals()).add(new DelegatePrincipal(forDelegate,System.identityHashCode(getAuthSystem())));
  return new Subject(true,sbld.build(),svc.getPublicCredentials(),svc.getPrivateCredentials());
}
