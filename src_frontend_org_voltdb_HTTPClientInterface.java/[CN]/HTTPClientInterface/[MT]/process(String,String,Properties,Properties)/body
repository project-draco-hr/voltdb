{
  String msg;
  Client client=null;
  try {
    if (m_connections == null) {
      int port=VoltDB.instance().getConfig().m_port;
      m_connections=new AuthenticatedConnectionCache(10,"localhost",port);
    }
    String username=parms.getProperty("User");
    String password=parms.getProperty("Password");
    String procName=parms.getProperty("Procedure");
    String params=parms.getProperty("Parameters");
    byte[] hashedPassword=null;
    if (password != null) {
      if (password.length() != 40) {
        throw new Exception("Password must be a 40-byte hex-encoded SHA-1 hash (20 bytes unencoded).");
      }
      try {
        hashedPassword=Encoder.hexDecode(password);
      }
 catch (      Exception e) {
        throw new Exception("Password must be a 40-byte hex-encoded SHA-1 hash (20 bytes unencoded).");
      }
    }
    assert((hashedPassword == null) || (hashedPassword.length == 20));
    client=m_connections.getClient(username,hashedPassword);
    SyncCallback scb=new SyncCallback();
    boolean success;
    if (params != null) {
      ParameterSet paramSet=ParameterSet.fromJSONString(params);
      success=client.callProcedure(scb,procName,paramSet.toArray());
    }
 else {
      success=client.callProcedure(scb,procName);
    }
    if (!success) {
      throw new Exception("Server is not accepting work at this time.");
    }
    scb.waitForResponse();
    ClientResponseImpl rimpl=(ClientResponseImpl)scb.getResponse();
    msg=rimpl.toJSONString();
  }
 catch (  Exception e) {
    msg=e.getMessage();
    ClientResponseImpl rimpl=new ClientResponseImpl(ClientResponse.UNEXPECTED_FAILURE,new VoltTable[0],msg);
    msg=rimpl.toJSONString();
  }
 finally {
    if (client != null) {
      assert(m_connections != null);
      m_connections.releaseClient(client);
    }
  }
  return msg;
}
