{
  TreeMap<Object,Long> sortedCounts=new TreeMap<Object,Long>(new ObjectMapValueComparator(counts));
  sortedCounts.putAll(counts);
  final File tempFile;
  try {
    tempFile=new File(file.getName().substring(0,file.getName().length() - 4));
    final FileWriter fw=new FileWriter(tempFile);
    BufferedWriter bw=new BufferedWriter(fw);
    PrintWriter pwr=new PrintWriter(bw);
    int ii=0;
    for (    Map.Entry<Object,Long> e : sortedCounts.entrySet()) {
      pwr.append('\n');
      pwr.append(Integer.toString(ii++)).append(' ').append(e.getValue().toString());
    }
    pwr.flush();
    pwr.close();
  }
 catch (  IOException e1) {
    throw new RuntimeException(e1);
  }
  try {
    String args[]=new String[]{"/bin/sh","-c","/usr/bin/graph -T png --bitmap-size 1024x768 -L \"# invocations/client\" " + "-Y \"# invocations\" -X \"client\" " + "-w .8 -h.8 -u .1 "+ "-r .15 -f.03 " + tempFile.getAbsolutePath() + " > "+ file.getName()};
    ProcessBuilder pb=new ProcessBuilder(args);
    pb.redirectErrorStream(true);
    final Process p=pb.start();
    Thread t=new Thread(){
      @Override public void run(){
        BufferedReader reader=new BufferedReader(new InputStreamReader(p.getInputStream()));
        try {
          while (true) {
            final String line=reader.readLine();
            if (line == null) {
              try {
                p.waitFor();
              }
 catch (              InterruptedException e) {
                e.printStackTrace();
              }
              return;
            }
            System.err.println(line);
          }
        }
 catch (        IOException e) {
        }
      }
    }
;
    t.start();
    return t;
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
  return null;
}
