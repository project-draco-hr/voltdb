{
  MockVoltDB mockVoltDB=new MockVoltDB();
  VoltDB.ignoreCrash=true;
  VoltDB.replaceVoltDBInstanceForTest(mockVoltDB);
  VoltDB.Configuration config=new VoltDB.Configuration();
  mockVoltDB.setConfig(config);
  SocketJoiner joiner=new SocketJoiner(ConnectionUtil.getLocalAddress(),1,0,0,null);
  joiner.start();
  joiner.join();
  assertFalse(VoltDB.wasCrashCalled);
  config.m_internalInterface=ConnectionUtil.getLocalAddress().getHostAddress();
  mockVoltDB.setConfig(config);
  joiner=new SocketJoiner(ConnectionUtil.getLocalAddress(),1,0,0,null);
  joiner.start();
  joiner.join();
  assertFalse(VoltDB.wasCrashCalled);
  config.m_internalInterface=ConnectionUtil.getLocalAddress().getHostName();
  mockVoltDB.setConfig(config);
  joiner=new SocketJoiner(ConnectionUtil.getLocalAddress(),1,0,0,null);
  joiner.start();
  joiner.join();
  assertFalse(VoltDB.wasCrashCalled);
  config.m_internalInterface="255.255.255.255";
  mockVoltDB.setConfig(config);
  joiner=new SocketJoiner(ConnectionUtil.getLocalAddress(),1,0,0,null);
  joiner.start();
  joiner.join();
  assertTrue(VoltDB.wasCrashCalled);
  mockVoltDB.shutdown(null);
}
