{
  String msg="";
  int columnCnt=0;
  VoltTable procInfo=null;
  Vector<Integer> strColIndex=new Vector<Integer>();
  try {
    procInfo=client.callProcedure("@SystemCatalog","PROCEDURECOLUMNS").getResults()[0];
    while (procInfo.advanceRow()) {
      if (insertProcedure.matches((String)procInfo.get("PROCEDURE_NAME",VoltType.STRING))) {
        if (procInfo.get("TYPE_NAME",VoltType.STRING).toString().matches("VARCHAR"))         strColIndex.add(Integer.parseInt(procInfo.get("ORDINAL_POSITION",VoltType.INTEGER).toString()) - 1);
        columnCnt++;
      }
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  if (linefragement.length == 0) {
    msg="checkLineFormat Error: blank line";
    return msg;
  }
  if (linefragement.length != columnCnt) {
    msg="checkLineFormat Error: # of attributes do not match, # of attributes needed: " + columnCnt;
    return msg;
  }
 else   if (config.trimwhitespace) {
    for (int i=0; i < linefragement.length; i++) {
      if (!strColIndex.contains(i) && linefragement[i] != null)       linefragement[i]=((String)linefragement[i]).replaceAll("\\s+","");
    }
  }
  return null;
}
