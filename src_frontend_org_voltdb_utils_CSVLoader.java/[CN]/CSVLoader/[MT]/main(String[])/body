{
  if (args.length != 2) {
    System.exit(1);
  }
  final String filename=args[0];
  final String insertProcedure=args[1];
  try {
    final CSVReader reader=new CSVReader(new FileReader(filename));
    final ProcedureCallback cb=new MyCallback();
    final Client client=ClientFactory.createClient();
    client.createConnection("localhost");
    String line[]=null;
    while ((line=reader.readNext()) != null) {
      boolean queued=false;
      while (queued == false) {
        queued=client.callProcedure(cb,insertProcedure,(Object[])line);
        if (!queued) {
          Thread.sleep(10);
        }
      }
    }
    reader.close();
    client.drain();
    client.close();
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  System.out.println("Inserted " + count.get() + " rows");
}
