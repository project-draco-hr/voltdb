{
  if (config.file.equals(""))   standin=true;
  if (!config.table.equals("")) {
    insertProcedure=config.table.toUpperCase() + ".insert";
  }
 else {
    insertProcedure=config.procedure;
  }
  if (!config.reportdir.endsWith("/"))   config.reportdir+="/";
  try {
    File dir=new File(config.reportdir);
    if (!dir.exists()) {
      dir.mkdirs();
    }
  }
 catch (  Exception x) {
    m_log.error(x.getMessage(),x);
    System.exit(-1);
  }
  String myinsert=insertProcedure;
  myinsert=myinsert.replaceAll("\\.","_");
  pathInvalidrowfile=config.reportdir + "csvloader_" + myinsert+ "_"+ "invalidrows.csv";
  pathLogfile=config.reportdir + "csvloader_" + myinsert+ "_"+ "log.log";
  pathReportfile=config.reportdir + "csvloader_" + myinsert+ "_"+ "report.log";
  try {
    out_invaliderowfile=new BufferedWriter(new FileWriter(pathInvalidrowfile));
    out_logfile=new BufferedWriter(new FileWriter(pathLogfile));
    out_reportfile=new BufferedWriter(new FileWriter(pathReportfile));
  }
 catch (  IOException e) {
    m_log.error(e.getMessage());
    System.exit(-1);
  }
  String[] serverlist=config.servers.split(",");
  ClientConfig c_config=new ClientConfig(config.user,config.password);
  c_config.setProcedureCallTimeout(0);
  Client csvClient=null;
  try {
    csvClient=CSVLoader.getClient(c_config,serverlist,config.port);
  }
 catch (  Exception e) {
    m_log.error("Error to connect to the servers:" + config.servers);
    close_cleanup();
    System.exit(-1);
  }
  assert(csvClient != null);
  try {
    columnCnt=0;
    VoltTable procInfo=null;
    isProcExist=false;
    try {
      procInfo=csvClient.callProcedure("@SystemCatalog","PROCEDURECOLUMNS").getResults()[0];
      while (procInfo.advanceRow()) {
        if (insertProcedure.matches((String)procInfo.get("PROCEDURE_NAME",VoltType.STRING))) {
          columnCnt++;
          isProcExist=true;
          String typeStr=(String)procInfo.get("TYPE_NAME",VoltType.STRING);
          typeList.add(VoltType.typeFromString(typeStr));
        }
      }
    }
 catch (    Exception e) {
      m_log.error(e.getMessage(),e);
      close_cleanup();
      System.exit(-1);
    }
    if (isProcExist == false) {
      m_log.error("No matching insert procedure available");
      close_cleanup();
      System.exit(-1);
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  csvClient.close();
}
