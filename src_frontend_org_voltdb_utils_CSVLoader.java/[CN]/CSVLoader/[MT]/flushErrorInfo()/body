{
  int bulkflush=300;
  try {
    long linect=0;
    for (    Map.Entry<Long,String[]> irow : m_errorInfo.entrySet()) {
      String info[]=irow.getValue();
      if (info.length != 2) {
        System.out.println("internal error, information is not enough");
      }
      linect++;
      out_invaliderowfile.write(info[0] + "\n");
      String message="Invalid input on line " + irow.getKey() + ". "+ info[1];
      m_log.error(message);
      out_logfile.write(message + "\n  Content: " + info[0]+ "\n");
      if (linect % bulkflush == 0) {
        out_invaliderowfile.flush();
        out_logfile.flush();
      }
    }
    out_invaliderowfile.flush();
    out_logfile.flush();
    m_errorCount+=linect;
    m_errorInfo.clear();
  }
 catch (  FileNotFoundException e) {
    m_log.error("CSV report directory '" + config.reportdir + "' does not exist.");
  }
catch (  Exception x) {
    m_log.error(x.getMessage());
  }
}
