{
  System.out.println("All the invalid row numbers are:" + errorMsg.keySet());
  String line="";
  String invaliderowsfile=config.reportDir + "invalidrows.csv";
  String logfile=config.reportDir + "csvLoaderLogMessage.log";
  String reportfile=config.reportDir + "csvLoaderReport.log";
  int bulkflush=100;
  try {
    BufferedReader csvfile=new BufferedReader(new FileReader(config.inputfile));
    BufferedWriter out_invaliderowfile=new BufferedWriter(new FileWriter(invaliderowsfile));
    BufferedWriter out_logfile=new BufferedWriter(new FileWriter(logfile));
    BufferedWriter out_reportfile=new BufferedWriter(new FileWriter(reportfile));
    long linect=0;
    for (    Long irow : errorMsg.keySet()) {
      while ((line=csvfile.readLine()) != null) {
        if (++linect == irow) {
          String message="invalid line " + irow + ":  "+ line+ "\n";
          System.err.print(message);
          out_invaliderowfile.write(line + "\n");
          out_logfile.write(message + errorMsg.get(irow).toString() + "\n");
          break;
        }
      }
      if (linect % bulkflush == 0) {
        out_invaliderowfile.flush();
        out_logfile.flush();
      }
    }
    out_reportfile.write("Number of failed tuples:" + errorMsg.size() + "\n");
    out_reportfile.write("Number of loaded tuples:" + (outCount.get() - errorMsg.size()) + "\n");
    out_invaliderowfile.flush();
    out_logfile.flush();
    out_reportfile.flush();
    out_invaliderowfile.close();
    out_logfile.close();
    out_reportfile.close();
  }
 catch (  FileNotFoundException e) {
    System.err.println("CSV file '" + config.inputfile + "' could not be found.");
  }
catch (  Exception x) {
    System.err.println(x.getMessage());
  }
}
