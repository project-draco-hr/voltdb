import os, sys, re
prunelist = ('hsqldb19b3', 'hsqldb', 'proj_gen', 'jni_md.h', 'jni.h', 'org_voltdb_jni_ExecutionEngine.h', 'org_voltdb_utils_DBBPool.h', 'org_voltdb_utils_DBBPool_DBBContainer.h', 'org_voltdb_utils_ThreadUtils.h', 'xml2', 'simplejson', 'projectfile', 'xml', 'CSVReader.java')
testLicenses = ['approved_licenses/mit_x11_hstore_and_voltdb.txt', 'approved_licenses/mit_x11_evanjones_and_voltdb.txt', 'approved_licenses/mit_x11_michaelmccanna_and_voltdb.txt', 'approved_licenses/mit_x11_voltdb.txt']
srcLicenses = ['approved_licenses/gpl3_hstore_and_voltdb.txt', 'approved_licenses/gpl3_evanjones_and_voltdb.txt', 'approved_licenses/gpl3_nanohttpd_and_voltdb.txt', 'approved_licenses/gpl3_base64_and_voltdb.txt', 'approved_licenses/gpl3_voltdb.txt']
testLicensesPy = ['approved_licenses/mit_x11_voltdb_python.txt']
srcLicensesPy = ['approved_licenses/gpl3_voltdb_python.txt']
errcount = 0
errcount += processAllFiles('../src', tuple([readFile(f) for f in srcLicenses]), tuple([readFile(f) for f in srcLicensesPy]))
errcount += processAllFiles('../tests', tuple([readFile(f) for f in testLicenses]), tuple([readFile(f) for f in testLicensesPy]))
errcount += processAllFiles('../examples', tuple([readFile(f) for f in testLicenses]), tuple([readFile(f) for f in testLicensesPy]))
if (errcount == 0):
    print 'SUCCESS. Found 0 license text errors, 0 files containing tabs or trailing whitespace.'
else:
    print ('FAILURE. Found %d license text or whitespace errors.' % errcount)
for arg in sys.argv[1:]:
    if (arg != '${voltpro}'):
        print ('Checking additional repository: ' + arg)
        proLicenses = [(('../' + arg) + '/tools/approved_licenses/license.txt')]
        proLicensesPy = [(('../' + arg) + '/tools/approved_licenses/license_python.txt')]
        errcount = 0
        errcount += processAllFiles((('../' + arg) + '/src/'), tuple([readFile(f) for f in proLicenses]), tuple([readFile(f) for f in proLicensesPy]))
        errcount += processAllFiles((('../' + arg) + '/tests/'), tuple([readFile(f) for f in proLicenses]), tuple([readFile(f) for f in proLicensesPy]))
        if (errcount == 0):
            print 'SUCCESS. Found 0 license text errors, 0 files containing tabs or trailing whitespace.'
        else:
            print ('FAILURE (%s). Found %d license text or whitespace errors.' % (arg, errcount))
sys.exit(errcount)
