{
  final String procedureName=message.getStoredProcedureName();
  if (message.isSinglePartition()) {
    final SpProcedureTask task=new SpProcedureTask(this,this.m_loadedProcs.procs.get(procedureName),m_txnId.incrementAndGet(),message);
    m_scheduler.offer(task);
  }
 else {
    final MpProcedureTask task=new MpProcedureTask(this,this.m_loadedProcs.procs.get(procedureName),m_txnId.incrementAndGet(),message,m_primaryPartitions);
    m_scheduler.offer(task);
  }
}
