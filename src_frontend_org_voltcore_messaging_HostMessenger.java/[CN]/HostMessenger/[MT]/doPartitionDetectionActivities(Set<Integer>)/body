{
  Preconditions.checkState(!m_partitionDetected,"Partition detection triggered twice.");
  Set<Integer> previousHosts=getLiveHostIds();
  Set<Integer> currentHosts=new HashSet<>(previousHosts);
  currentHosts.removeAll(failedHostIds);
  Preconditions.checkState(previousHosts.contains(m_localHostId));
  Preconditions.checkState(currentHosts.contains(m_localHostId));
  boolean partitionDetected=makePPDDecision(previousHosts,currentHosts);
  if (partitionDetected) {
    if (m_partitionDetectionEnabled.get()) {
      m_tmLog.fatal("PARTITION DETECTION: This process will kill itself to ensure against split-brains.");
      m_tmLog.warn("If command logging or periodic snapshots are enabled, the will be in the " + "voltdb root folder for this node and may be used for recovery if needed.");
      m_partitionDetected=true;
      VoltDB.crashGlobalVoltDB("This process will kill itself to ensure against split-brains. " + "There may be additional info in the full logs.",false,null);
    }
 else {
      m_tmLog.error("PARTITION DETECTION: This process will continue running only because " + "Partition Detection has been disabled for this cluster. It is possible that " + "the previous cluster has split into multiple viable clusters with diverging "+ "data. There may be additional info in the full logs.");
    }
  }
}
