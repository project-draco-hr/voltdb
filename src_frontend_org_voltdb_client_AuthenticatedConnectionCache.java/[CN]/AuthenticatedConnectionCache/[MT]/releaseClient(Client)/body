{
  ClientImpl ci=(ClientImpl)client;
  if (ci.getUsername().length() == 0) {
    return;
  }
  StringBuilder userNameBuilder=new StringBuilder(ci.getUsername());
  if (FluentIterable.from(ci.getConnectedHostList()).allMatch(onAdminPort)) {
    userNameBuilder.append(ADMIN_SUFFIX);
  }
  Connection conn=m_connections.get(userNameBuilder.toString());
  if (conn == null) {
    throw new RuntimeException("Released client not in pool.");
  }
  conn.refCount--;
  attemptToShrinkPoolIfNeeded();
}
