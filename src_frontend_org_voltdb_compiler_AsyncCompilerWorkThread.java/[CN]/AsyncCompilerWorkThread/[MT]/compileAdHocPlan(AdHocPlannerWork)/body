{
  AdHocPlannedStmt plannedStmt=new AdHocPlannedStmt();
  plannedStmt.clientHandle=work.clientHandle;
  plannedStmt.connectionId=work.connectionId;
  plannedStmt.hostname=work.hostname;
  plannedStmt.clientData=work.clientData;
  PlannerTool.Result result=m_ptool.planSql(work.sql);
  plannedStmt.aggregatorFragment=result.onePlan;
  plannedStmt.collectorFragment=result.allPlan;
  plannedStmt.isReplicatedTableDML=result.replicatedDML;
  plannedStmt.sql=work.sql;
  plannedStmt.errorMsg=result.errors;
  return plannedStmt;
}
