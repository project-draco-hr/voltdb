{
  JoinNode root=null;
  for (  JoinNode leafNode : tableNodes) {
    JoinNode node=null;
    if (leafNode.getNodeType() == JoinNode.NodeType.LEAF) {
      node=new TableLeafNode(leafNode.m_id,leafNode.m_tableAliasIndex,null,null);
    }
 else     if (leafNode.getNodeType() == JoinNode.NodeType.SUBQUERY) {
      node=new SubqueryLeafNode(leafNode.m_id,leafNode.m_tableAliasIndex,null,null);
    }
 else {
      assert(false);
    }
    if (root == null) {
      root=node;
    }
 else {
      root=new BranchNode(-node.m_id,JoinType.INNER,root,node);
    }
  }
  return root;
}
