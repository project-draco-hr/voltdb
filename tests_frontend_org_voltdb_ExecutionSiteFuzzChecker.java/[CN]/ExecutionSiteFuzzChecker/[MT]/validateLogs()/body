{
  boolean valid=false;
  boolean done=false;
  sortBlocked();
  while (!done) {
    while (!m_unblockedSets.isEmpty()) {
      System.out.println("UNBLOCKED SETS: " + m_unblockedSets);
      processReplicaSetUntilBlockedOrDone(m_unblockedSets.iterator().next());
    }
    if (m_blockedSets.isEmpty()) {
      System.out.println("DONE!");
      done=true;
    }
 else {
      System.out.println("BLOCKED SETS: " + m_blockedSets);
      processMultiPartitionTransaction();
    }
  }
  return valid;
}
