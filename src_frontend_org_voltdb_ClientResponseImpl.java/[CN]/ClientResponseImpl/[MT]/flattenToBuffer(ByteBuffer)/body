{
  assert setProperly;
  buf.put((byte)0);
  buf.putLong(clientHandle);
  byte presentFields=0;
  if (appStatusString != null) {
    presentFields|=1 << 7;
  }
  if (m_exception != null) {
    presentFields|=1 << 6;
  }
  if (statusString != null) {
    presentFields|=1 << 5;
  }
  buf.put(presentFields);
  buf.put(status);
  if (statusString != null) {
    FastSerializer.writeString(encodedStatusString,buf);
  }
  buf.put(appStatus);
  if (appStatusString != null) {
    FastSerializer.writeString(encodedAppStatusString,buf);
  }
  buf.putInt(clusterRoundTripTime);
  if (m_exception != null) {
    final ByteBuffer b=ByteBuffer.allocate(m_exception.getSerializedSize());
    m_exception.serializeToBuffer(b);
    buf.put(b.array());
  }
  FastSerializer.writeArray(results,buf);
}
