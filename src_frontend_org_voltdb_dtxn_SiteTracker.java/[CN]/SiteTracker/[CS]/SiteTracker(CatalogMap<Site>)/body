{
  for (  Site site : clusterSites) {
    if (site.getIsexec() == false)     continue;
    int siteId=Integer.parseInt(site.getTypeName());
    int partitionId=Integer.parseInt(site.getPartition().getTypeName());
    m_sitesToPartitions.put(siteId,partitionId);
    if (!m_partitionsToSites.containsKey(partitionId)) {
      m_partitionsToSites.put(partitionId,new ArrayList<Integer>());
    }
    m_partitionsToSites.get(partitionId).add(siteId);
  }
  m_siteCount=m_sitesToPartitions.size();
  assert((m_siteCount % m_partitionsToSites.size()) == 0);
  m_tempOldSitesScratch=new int[m_siteCount];
  for (  int siteId : m_sitesToPartitions.keySet()) {
    m_lastHeartbeatTime.put(siteId,-1L);
  }
}
