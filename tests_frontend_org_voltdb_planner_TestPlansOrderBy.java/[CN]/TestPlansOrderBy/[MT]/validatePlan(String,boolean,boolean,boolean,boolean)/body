{
  AbstractPlanNode pn=compile(sql);
  System.out.println(pn.getChild(0).toExplainPlanString());
  assertEquals(expectIndexScan,pn.hasAnyNodeOfType(PlanNodeType.INDEXSCAN));
  assertEquals(expectSeqScan,pn.hasAnyNodeOfType(PlanNodeType.SEQSCAN));
  assertEquals(expectOrderBy,pn.hasAnyNodeOfType(PlanNodeType.ORDERBY));
  assertEquals(expectHashAggregate,pn.hasAnyNodeOfType(PlanNodeType.HASHAGGREGATE));
}
