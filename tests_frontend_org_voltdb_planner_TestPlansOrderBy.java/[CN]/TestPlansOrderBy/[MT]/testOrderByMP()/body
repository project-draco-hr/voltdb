{
{
    List<AbstractPlanNode> frags=compileToFragments("select P_D1 from P order by P_D1");
    assertEquals(2,frags.size());
    AbstractPlanNode pn=frags.get(0).getChild(0).getChild(0);
    assertEquals(PlanNodeType.RECEIVE,pn.getPlanNodeType());
    ReceivePlanNode rpn=(ReceivePlanNode)pn;
    assertEquals(true,rpn.getNeedMerge());
    assertNotNull(rpn.getInlinePlanNode(PlanNodeType.ORDERBY));
  }
{
    List<AbstractPlanNode> frags=compileToFragments("select P_D0 from P order by P_D0");
    assertEquals(2,frags.size());
    AbstractPlanNode pn=frags.get(0).getChild(0).getChild(0);
    assertEquals(PlanNodeType.ORDERBY,pn.getPlanNodeType());
  }
}
