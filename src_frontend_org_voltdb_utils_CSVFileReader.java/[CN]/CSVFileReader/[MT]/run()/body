{
  List<String> lineList;
  while ((m_config.limitrows-- > 0)) {
    if (m_errHandler.hasReachedLimit()) {
      break;
    }
    try {
      if (m_listReader.getLineNumber() == 0) {
        m_totalLineCount.set(m_config.skip);
      }
 else {
        m_totalLineCount.set(m_listReader.getLineNumber());
      }
      long st=System.nanoTime();
      lineList=m_listReader.read();
      long end=System.nanoTime();
      m_parsingTime+=(end - st);
      if (lineList == null) {
        if (m_totalLineCount.get() > m_listReader.getLineNumber()) {
          m_totalLineCount.set(m_listReader.getLineNumber());
        }
        break;
      }
      m_totalRowCount.incrementAndGet();
      if (lineList.size() == 0) {
        continue;
      }
      String[] lineValues=lineList.toArray(new String[0]);
      String lineCheckResult;
      if ((lineCheckResult=checkparams_trimspace(lineValues)) != null) {
        final CSVLineWithMetaData metaData=new CSVLineWithMetaData(m_listReader.getUntokenizedRow(),m_totalLineCount.get() + 1);
        if (m_errHandler.handle(metaData,lineCheckResult)) {
          break;
        }
        continue;
      }
      CSVLineWithMetaData lineData=new CSVLineWithMetaData(m_listReader.getUntokenizedRow(),m_listReader.getLineNumber());
      m_loader.insertRow(lineData,lineValues);
    }
 catch (    SuperCsvException e) {
      final CSVLineWithMetaData metaData=new CSVLineWithMetaData(m_listReader.getUntokenizedRow(),m_totalLineCount.get() + 1);
      if (m_errHandler.handle(metaData,e.getMessage())) {
        break;
      }
    }
catch (    IOException ex) {
      m_log.error("Failed to read CSV line from file: " + ex);
      break;
    }
catch (    InterruptedException e) {
      m_log.error("CSVLoader interrupted: " + e);
      break;
    }
  }
  try {
    m_log.debug("Waiting for CSVDataLoader to finish.");
    m_loader.close();
    m_log.debug("CSVDataLoader Done.");
  }
 catch (  Exception ex) {
    m_log.warn("Stopped processing because of connection error. " + "A report will be generated with what we processed so far. Error: " + ex);
  }
}
