{
  voltQueueSQL(truncate);
  voltQueueSQL(count);
  VoltTable[] results=voltExecuteSQL(true);
  VoltTable data=results[1];
  VoltTableRow row=data.fetchRow(0);
  row=data.fetchRow(0);
  if (row.getLong(0) != 0) {
    throw new VoltAbortException("after truncate count not zero");
  }
  if (shouldRollback != 0) {
    throw new VoltAbortException("EXPECTED ROLLBACK");
  }
  return results;
}
