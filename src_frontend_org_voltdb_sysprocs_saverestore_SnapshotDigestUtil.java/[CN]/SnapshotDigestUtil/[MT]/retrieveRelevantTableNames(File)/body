{
  final FileInputStream fis=new FileInputStream(f);
  try {
    final BufferedInputStream bis=new BufferedInputStream(fis);
    ByteBuffer crcBuffer=ByteBuffer.allocate(4);
    if (4 != bis.read(crcBuffer.array())) {
      throw new EOFException("EOF while attempting to read CRC from snapshot digest");
    }
    final int crc=crcBuffer.getInt();
    final InputStreamReader isr=new InputStreamReader(bis,"UTF-8");
    CharArrayWriter caw=new CharArrayWriter();
    while (true) {
      int nextChar=isr.read();
      if (nextChar == -1) {
        throw new EOFException("EOF while reading snapshot digest");
      }
      if (nextChar == '\n') {
        break;
      }
      caw.write(nextChar);
    }
    String tableList=caw.toString();
    byte tableListBytes[]=tableList.getBytes("UTF-8");
    CRC32 tableListCRC=new CRC32();
    tableListCRC.update(tableListBytes);
    tableListCRC.update("\n".getBytes("UTF-8"));
    final int calculatedValue=(int)tableListCRC.getValue();
    if (crc != calculatedValue) {
      throw new IOException("CRC of snapshot digest did not match digest contents");
    }
    String tableNames[]=tableList.split(",");
    return java.util.Arrays.asList(tableNames);
  }
  finally {
    try {
      if (fis != null) {
        fis.close();
      }
    }
 catch (    IOException e) {
    }
  }
}
