{
  ByteArrayInputStream bais=new ByteArrayInputStream(m_recoverySnapshot);
  try {
    InflaterInputStream iis=new InflaterInputStream(bais);
    DataInputStream dis=new DataInputStream(iis);
    BinaryInputArchive bia=new BinaryInputArchive(dis);
    m_server.getZKDatabase().deserializeSnapshot(bia);
    m_server.createSessionTracker();
  }
 catch (  Exception e) {
    m_recoveryLog.fatal("Error loading agreement database",e);
    VoltDB.crashVoltDB();
  }
  m_recoverySnapshot=null;
  m_recoveryStage=RecoveryStage.RECOVERED;
  m_recovering=false;
  m_recoverBeforeTxn=null;
  m_recoveryComplete.countDown();
  VoltDB.instance().onAgreementSiteRecoveryCompletion();
  m_agreementLog.info("Loaded ZK snapshot");
}
