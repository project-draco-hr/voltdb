{
  VoltTable digestScanResults=request.aggregateTables[0];
  VoltTable scanResults=request.aggregateTables[2];
  Map<String,Snapshot> aggregates=new HashMap<String,Snapshot>();
  while (scanResults.advanceRow()) {
    if (scanResults.getString("RESULT").equals("SUCCESS") && scanResults.getString("READABLE").equals("TRUE") && scanResults.getString("COMPLETED").equals("TRUE")) {
      hashToSnapshot(scanResults,aggregates);
    }
  }
  while (digestScanResults.advanceRow()) {
    if (digestScanResults.getString("RESULT").equals("SUCCESS")) {
      hashDigestToSnapshot(digestScanResults,aggregates);
    }
  }
  VoltTable clientResults=constructClientResultsTable();
  for (  Snapshot s : aggregates.values()) {
    clientResults.addRow(s.asRow());
  }
  request.aggregateTables[0]=clientResults;
}
