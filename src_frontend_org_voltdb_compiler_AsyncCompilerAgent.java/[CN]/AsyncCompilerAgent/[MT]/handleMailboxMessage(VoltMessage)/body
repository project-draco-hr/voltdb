{
  final LocalObjectMessage wrapper=(LocalObjectMessage)message;
  if (wrapper.payload instanceof AdHocPlannerWork) {
    final AdHocPlannerWork w=(AdHocPlannerWork)(wrapper.payload);
    final AsyncCompilerResult result=compileAdHocPlan(w);
    w.completionHandler.onCompletion(result);
  }
 else   if (wrapper.payload instanceof CatalogChangeWork) {
    final CatalogChangeWork w=(CatalogChangeWork)(wrapper.payload);
    final AsyncCompilerResult result=m_helper.prepareApplicationCatalogDiff(w);
    if (result.errorMsg != null) {
      hostLog.info("A request to update the application catalog and/or deployment settings has been rejected. More info returned to client.");
    }
    if (result instanceof CatalogChangeResult) {
      CatalogChangeResult ccr=(CatalogChangeResult)result;
      if (ccr.upgradedFromVersion != null) {
        hostLog.info(String.format("In order to update the application catalog it was " + "automatically upgraded from version %s.",ccr.upgradedFromVersion));
      }
    }
    w.completionHandler.onCompletion(result);
  }
 else {
    hostLog.warn("Unexpected message received by AsyncCompilerAgent.  " + "Please contact VoltDB support with this message and the contents: " + message.toString());
  }
}
