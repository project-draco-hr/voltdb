def testTable(self):
    type = FastSerializer.VOLTTYPE_VOLTTABLE
    table = VoltTable(self.fs)
    table.columns.append(VoltColumn(type=FastSerializer.VOLTTYPE_TINYINT, name='id'))
    table.columns.append(VoltColumn(type=FastSerializer.VOLTTYPE_BIGINT, name='bigint'))
    table.columns.append(VoltColumn(type=FastSerializer.VOLTTYPE_STRING, name='name'))
    table.columns.append(VoltColumn(type=FastSerializer.VOLTTYPE_TIMESTAMP, name='date'))
    table.columns.append(VoltColumn(type=FastSerializer.VOLTTYPE_DECIMAL, name='money'))
    table.tuples.append([self.byteArray[1], self.int64Array[2], self.stringArray[0], self.dateArray[2], self.decimalArray[0]])
    table.tuples.append([self.byteArray[2], self.int64Array[1], self.stringArray[2], self.dateArray[1], self.decimalArray[1]])
    table.tuples.append([self.byteArray[0], self.int64Array[0], self.stringArray[1], self.dateArray[0], self.decimalArray[2]])
    self.fs.writeByte(type)
    table.writeToSerializer()
    self.fs.prependLength()
    self.fs.flush()
    self.fs.bufferForRead()
    self.assertEqual(self.fs.readByte(), type)
    result = VoltTable(self.fs)
    result.readFromSerializer()
    self.assertEqual(result, table)
