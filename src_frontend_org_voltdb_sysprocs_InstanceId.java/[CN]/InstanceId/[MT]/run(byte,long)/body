{
  final ColumnInfo resultSchema[]=new ColumnInfo[]{new ColumnInfo("RESULT",VoltType.STRING),new ColumnInfo("ERR_MSG",VoltType.STRING),new ColumnInfo("INSTANCE_ID",VoltType.BIGINT)};
  final VoltTable result=new VoltTable(resultSchema);
  if (instanceId < 0 && op == 1) {
    result.addRow("FAILURE","InstanceId must be greater than 0",m_instanceId);
    return new VoltTable[]{result};
  }
  if (op == 0 || op == 1) {
    VoltTable instanceIds=retrieveInstanceId();
    while (instanceIds.advanceRow()) {
      final Long mInstanceId=instanceIds.getLong(0);
      if (!mInstanceId.equals(m_instanceId)) {
        result.addRow("FAILURE","Cluster instanceId is inconsistent, coordinators is " + m_instanceId + " but found a node with "+ mInstanceId,m_instanceId);
      }
    }
    if (result.getRowCount() > 0) {
      return new VoltTable[]{result};
    }
    if (op == 1) {
      setInstanceId(instanceId);
      result.addRow("SUCCESS","",m_instanceId);
    }
 else {
      result.addRow("SUCCESS","",m_instanceId);
    }
  }
 else {
    result.addRow("FAILURE","Op was not 1 or 0",m_instanceId);
  }
  return new VoltTable[]{result};
}
