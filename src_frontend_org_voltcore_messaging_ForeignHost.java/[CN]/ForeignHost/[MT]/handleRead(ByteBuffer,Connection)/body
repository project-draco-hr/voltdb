{
  long recvDests[]=null;
  final long sourceHSId=in.getLong();
  final int destCount=in.getInt();
  if (destCount == -1) {
    if (VoltDB.instance().getMode() == OperationMode.SHUTTINGDOWN) {
      return;
    }
    byte messageBytes[]=new byte[in.getInt()];
    in.get(messageBytes);
    String message=new String(messageBytes,"UTF-8");
    message=String.format("Fatal error from id,hostname(%d,%s): %s",m_hostId,hostnameAndIPAndPort(),message);
    if (in.remaining() > 0) {
      int targetHostId=in.getInt();
      if (targetHostId != -1) {
        int hid=VoltDB.instance().getHostMessenger().getHostId();
        if (hid == targetHostId) {
          hostLog.debug("Poision Pill with target Host Id: " + targetHostId);
          VoltDB.instance().halt();
        }
 else {
          hostLog.warn("Poision Pill with wrong target Host Id will be ignored. hostId: " + targetHostId);
        }
        return;
      }
    }
    org.voltdb.VoltDB.crashLocalVoltDB(message,false,null);
  }
  recvDests=new long[destCount];
  for (int i=0; i < destCount; i++) {
    recvDests[i]=in.getLong();
  }
  final VoltMessage message=m_hostMessenger.getMessageFactory().createMessageFromBuffer(in,sourceHSId);
  if (message instanceof SiteFailureMessage && !(message instanceof SiteFailureForwardMessage)) {
    SiteFailureMessage sfm=(SiteFailureMessage)message;
    for (    FaultMessage fm : sfm.asFaultMessages()) {
      m_hostMessenger.relayForeignHostFailed(fm);
    }
  }
  for (int i=0; i < destCount; i++) {
    deliverMessage(recvDests[i],message);
  }
  m_lastMessageMillis.lazySet(EstTime.currentTimeMillis());
}
