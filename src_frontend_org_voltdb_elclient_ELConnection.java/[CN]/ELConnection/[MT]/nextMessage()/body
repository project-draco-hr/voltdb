{
  FastDeserializer fds;
  final ByteBuffer lengthBuffer=ByteBuffer.allocate(4);
  int bytes_read=0;
  do {
    bytes_read=m_socket.read(lengthBuffer);
  }
 while (lengthBuffer.hasRemaining() && bytes_read != 0);
  if (bytes_read == 0) {
    if (lengthBuffer.position() != 0) {
      System.out.println("Can't handle partial length read: " + lengthBuffer.position());
      System.exit(1);
    }
    return null;
  }
  lengthBuffer.flip();
  int length=lengthBuffer.getInt();
  ByteBuffer messageBuf=ByteBuffer.allocate(length);
  do {
    m_socket.read(messageBuf);
  }
 while (messageBuf.remaining() > 0);
  messageBuf.flip();
  fds=new FastDeserializer(messageBuf);
  ELTProtoMessage m=ELTProtoMessage.readExternal(fds);
  return m;
}
