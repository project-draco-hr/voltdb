{
  voltQueueSQL(scanmax);
  voltQueueSQL(truncate);
  voltQueueSQL(scanmax);
  voltQueueSQL(count);
  voltQueueSQL(scancount);
  VoltTable[] results=voltExecuteSQL(true);
  if (results[0].getRowCount() != 1) {
    throw new VoltAbortException("row count for max not one");
  }
  if (results[2].getRowCount() != 1) {
    throw new VoltAbortException("row count for max not one");
  }
  VoltTable data=results[3];
  VoltTableRow row=data.fetchRow(0);
  long optCount=row.getLong(0);
  if (optCount != 0) {
    throw new VoltAbortException("after truncate (opt) count not zero");
  }
  data=results[4];
  row=data.fetchRow(0);
  long scanCount=row.getLong(0);
  if (scanCount != 0) {
    throw new VoltAbortException("after truncate (scan) count not zero");
  }
  if (shouldRollback != 0) {
    throw new VoltAbortException("EXPECTED ROLLBACK");
  }
  return results;
}
