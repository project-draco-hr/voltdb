{
  try {
    System.out.println("Test initialization");
    connect(config.servers);
  }
 catch (  InterruptedException e) {
    System.err.println("Error connecting to VoltDB");
    e.printStackTrace();
    System.exit(1);
  }
  Thread thread=new Thread(new ExportThread());
  thread.start();
  System.out.println("Warming up...");
  Thread.sleep(1000l * config.warmup);
  warmupComplete.set(true);
  benchmarkStartTS=System.currentTimeMillis();
  fullStatsContext.fetchAndResetBaseline();
  periodicStatsContext.fetchAndResetBaseline();
  schedulePeriodicStats();
  System.out.println("\nRunning benchmark...");
  Thread.sleep(1000l * config.duration);
  benchmarkComplete.set(true);
  timer.cancel();
  client.drain();
  System.out.println("Client flushed; waiting for export to finish");
  boolean success=false;
  try {
    success=waitForStreamedAllocatedMemoryZero();
  }
 catch (  Exception e) {
    System.err.println("Error while waiting for export: ");
    e.printStackTrace();
  }
  benchmarkEndTS=System.currentTimeMillis();
  System.out.println("Finished benchmark (test by count)");
  printResults(benchmarkEndTS - benchmarkStartTS);
  client.close();
  if (!success) {
    System.exit(1);
  }
}
