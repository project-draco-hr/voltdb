{
  this.config=config;
  ClientConfig clientConfig=new ClientConfig();
  clientConfig.setReconnectOnConnectionLoss(true);
  clientConfig.setClientAffinity(true);
  client=ClientFactory.createClient(clientConfig);
  fullStatsContext=client.createStatsContext();
  periodicStatsContext=client.createStatsContext();
  if (config.csvfile != null && !config.csvfile.trim().isEmpty()) {
    csvlogger=new CsvLogger(config.csvfile);
  }
}
