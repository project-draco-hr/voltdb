{
  System.out.print(HORIZONTAL_RULE);
  System.out.println(" Setup & Initialization");
  System.out.println(HORIZONTAL_RULE);
  connect(config.servers);
  System.out.print(HORIZONTAL_RULE);
  System.out.println("Starting Benchmark");
  System.out.println(HORIZONTAL_RULE);
  benchmarkActive=true;
  if (config.warmup > 0) {
    System.out.println("Warming up...");
    for (int i=0; i < config.warmup; i++) {
      client.callProcedure(new NullCallback(),"ids_insert",i,i,i);
      client.callProcedure(new NullCallback(),"idsWithMatView_insert",i,i,i);
    }
    client.drain();
    for (int i=0; i < config.warmup; i++) {
      client.callProcedure(new NullCallback(),"ids_delete",i);
      client.callProcedure(new NullCallback(),"idsWithMatView_delete",i);
    }
    client.drain();
  }
  int grp=1;
  FileWriter fw=null;
  if ((config.statsfile != null) && (config.statsfile.length() != 0)) {
    fw=new FileWriter(config.statsfile);
  }
  fullStatsContext.fetchAndResetBaseline();
  periodicStatsContext.fetchAndResetBaseline();
  benchmarkStartTS=System.currentTimeMillis();
  schedulePeriodicStats();
  System.out.println("\nRunning benchmark...\n");
  System.out.println("\n\nInserting into table w/ materialized view...\n");
  if (config.group > 0) {
    for (int i=0; i < config.txn; i++) {
      client.callProcedure(new NullCallback(),"idsWithMatView_insert",i,grp,i);
      if (grp == config.group) {
        grp=1;
      }
 else {
        grp++;
      }
    }
  }
 else {
    for (int i=0; i < config.txn; i++) {
      client.callProcedure(new NullCallback(),"idsWithMatView_insert",i,i,i);
    }
  }
  timer.cancel();
  client.drain();
  grp=2;
  if ((config.statsfile == null) || (config.statsfile.length() == 0)) {
    printResults("idsWithMatView_insert");
  }
 else {
    printResults("idsWithMatView_insert",fw,"Insert w MV");
  }
  System.out.print(HORIZONTAL_RULE);
  benchmarkStartTS=System.currentTimeMillis();
  schedulePeriodicStats();
  System.out.println("\n\nUpdating grouping column in table w/ materialized view...\n");
  if (config.group > 0) {
    for (int i=0; i < config.txn; i++) {
      client.callProcedure(new NullCallback(),"idsWithMatView_group_id_update",grp,i);
      if (grp == (config.group + 1)) {
        grp=2;
      }
 else {
        grp++;
      }
    }
  }
 else {
    for (int i=0; i < config.txn; i++) {
      client.callProcedure(new NullCallback(),"idsWithMatView_group_id_update",(i + 1),i);
    }
  }
  timer.cancel();
  client.drain();
  grp=1;
  if ((config.statsfile == null) || (config.statsfile.length() == 0)) {
    printResults("idsWithMatView_group_id_update");
  }
 else {
    printResults("idsWithMatView_group_id_update",fw,"Update Group w MV");
  }
  System.out.print(HORIZONTAL_RULE);
  benchmarkStartTS=System.currentTimeMillis();
  schedulePeriodicStats();
  System.out.println("\n\nUpdating aggregated column in table w/ materialized view...\n");
  for (int i=0; i < config.txn; i++) {
    client.callProcedure(new NullCallback(),"idsWithMatView_value_update",(i + 1),i);
  }
  timer.cancel();
  client.drain();
  if ((config.statsfile == null) || (config.statsfile.length() == 0)) {
    printResults("idsWithMatView_value_update");
  }
 else {
    printResults("idsWithMatView_value_update",fw,"Update Aggregate w MV");
  }
  System.out.print(HORIZONTAL_RULE);
  benchmarkStartTS=System.currentTimeMillis();
  schedulePeriodicStats();
  System.out.println("\n\nDeleting from table w/ materialized view...\n");
  for (int i=0; i < config.txn; i++) {
    client.callProcedure(new NullCallback(),"idsWithMatView_delete",i);
  }
  timer.cancel();
  client.drain();
  if ((config.statsfile == null) || (config.statsfile.length() == 0)) {
    printResults("idsWithMatView_delete");
  }
 else {
    printResults("idsWithMatView_delete",fw,"Delete w MV");
  }
  System.out.print(HORIZONTAL_RULE);
  benchmarkStartTS=System.currentTimeMillis();
  schedulePeriodicStats();
  System.out.println("\n\nInserting into table w/o materialized view...\n");
  if (config.group > 0) {
    for (int i=0; i < config.txn; i++) {
      client.callProcedure(new NullCallback(),"ids_insert",i,grp,i);
      if (grp == config.group) {
        grp=1;
      }
 else {
        grp++;
      }
    }
  }
 else {
    for (int i=0; i < config.txn; i++) {
      client.callProcedure(new NullCallback(),"ids_insert",i,i,i);
    }
  }
  timer.cancel();
  client.drain();
  grp=2;
  if ((config.statsfile == null) || (config.statsfile.length() == 0)) {
    printResults("ids_insert");
  }
 else {
    printResults("ids_insert",fw,"Insert wo MV");
  }
  System.out.print(HORIZONTAL_RULE);
  benchmarkStartTS=System.currentTimeMillis();
  schedulePeriodicStats();
  System.out.println("\n\nUpdating grouping column in table w/o materialized view...\n");
  if (config.group > 0) {
    for (int i=0; i < config.txn; i++) {
      client.callProcedure(new NullCallback(),"ids_group_id_update",grp,i);
      if (grp == (config.group + 1)) {
        grp=2;
      }
 else {
        grp++;
      }
    }
  }
 else {
    for (int i=0; i < config.txn; i++) {
      client.callProcedure(new NullCallback(),"ids_group_id_update",(i + 1),i);
    }
  }
  timer.cancel();
  client.drain();
  if ((config.statsfile == null) || (config.statsfile.length() == 0)) {
    printResults("ids_group_id_update");
  }
 else {
    printResults("ids_group_id_update",fw,"Update Group wo MV");
  }
  System.out.print(HORIZONTAL_RULE);
  benchmarkStartTS=System.currentTimeMillis();
  schedulePeriodicStats();
  System.out.println("\n\nUpdating aggregated column in table w/o materialized view...\n");
  for (int i=0; i < config.txn; i++) {
    client.callProcedure(new NullCallback(),"ids_value_update",(i + 1),i);
  }
  timer.cancel();
  client.drain();
  if ((config.statsfile == null) || (config.statsfile.length() == 0)) {
    printResults("ids_value_update");
  }
 else {
    printResults("ids_value_update",fw,"Update Aggregate wo MV");
  }
  System.out.print(HORIZONTAL_RULE);
  benchmarkStartTS=System.currentTimeMillis();
  schedulePeriodicStats();
  System.out.println("\n\nDeleting from table w/o materialized view...\n");
  for (int i=0; i < config.txn; i++) {
    client.callProcedure(new NullCallback(),"ids_delete",i);
  }
  timer.cancel();
  client.drain();
  if ((config.statsfile == null) || (config.statsfile.length() == 0)) {
    printResults("ids_delete");
  }
 else {
    printResults("ids_delete",fw,"Delete wo MV");
    fw.close();
  }
  benchmarkActive=false;
  client.close();
}
