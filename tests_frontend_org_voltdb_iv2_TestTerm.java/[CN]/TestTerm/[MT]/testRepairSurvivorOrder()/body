{
  InitiatorMailbox mailbox=mock(InitiatorMailbox.class);
  InOrder inOrder=inOrder(mailbox);
  Term term=new Term(null,0,0L,mailbox);
  Term.ReplicaRepairStruct r3=new Term.ReplicaRepairStruct();
  r3.m_maxSpHandleSeen=2L;
  term.m_replicaRepairStructs.put(3L,r3);
  long spHandles[]=new long[]{0L,1L,2L,3L,4L,5L};
  Iv2RepairLogResponseMessage msgs[]=new Iv2RepairLogResponseMessage[6];
  for (int i=1; i < spHandles.length; ++i) {
    msgs[i]=makeResponse(spHandles[i]);
    term.m_repairLogUnion.add(msgs[i]);
  }
  term.repairSurvivors();
  inOrder.verify(mailbox).repairReplicaWith(3L,msgs[3]);
  inOrder.verify(mailbox).repairReplicaWith(3L,msgs[4]);
  inOrder.verify(mailbox).repairReplicaWith(3L,msgs[5]);
  verify(mailbox,times(3)).repairReplicaWith(anyLong(),any(Iv2RepairLogResponseMessage.class));
}
