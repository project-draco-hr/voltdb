{
  if (m_hasCalculatedOffsets == true)   return;
  m_offsets[0]=m_position;
  for (int i=1; i < getColumnCount(); i++) {
    final VoltType type=getColumnType(i - 1);
    if (type == VoltType.STRING) {
      final short strlen=m_buffer.getShort(m_offsets[i - 1]);
      if (strlen == VoltTable.NULL_STRING_INDICATOR)       m_offsets[i]=m_offsets[i - 1] + STRING_LEN_SIZE;
 else       if (strlen < 0)       throw new RuntimeException("Invalid object length for column: " + i);
 else       m_offsets[i]=m_offsets[i - 1] + strlen + STRING_LEN_SIZE;
    }
 else {
      m_offsets[i]=m_offsets[i - 1] + type.getLengthInBytesForFixedTypes();
    }
  }
  m_hasCalculatedOffsets=true;
}
