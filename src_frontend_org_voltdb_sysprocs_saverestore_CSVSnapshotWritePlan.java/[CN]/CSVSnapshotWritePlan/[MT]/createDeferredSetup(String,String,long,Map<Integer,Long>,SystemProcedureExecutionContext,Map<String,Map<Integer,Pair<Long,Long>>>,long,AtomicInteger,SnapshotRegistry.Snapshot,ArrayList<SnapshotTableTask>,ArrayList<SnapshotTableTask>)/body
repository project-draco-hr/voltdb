{
  return new Callable<Boolean>(){
    @Override public Boolean call() throws Exception {
      NativeSnapshotWritePlan.createFileBasedCompletionTasks(file_path,file_nonce,txnId,partitionTransactionIds,context,exportSequenceNumbers,null,timestamp,context.getNumberOfPartitions());
      for (      SnapshotTableTask task : replicatedSnapshotTasks) {
        final SnapshotDataTarget target=createDataTargetForTable(file_path,file_nonce,context.getHostId(),numTables,snapshotRecord,task.m_table);
        task.setTarget(target);
      }
      for (      SnapshotTableTask task : partitionedSnapshotTasks) {
        final SnapshotDataTarget target=createDataTargetForTable(file_path,file_nonce,context.getHostId(),numTables,snapshotRecord,task.m_table);
        task.setTarget(target);
      }
      return true;
    }
  }
;
}
