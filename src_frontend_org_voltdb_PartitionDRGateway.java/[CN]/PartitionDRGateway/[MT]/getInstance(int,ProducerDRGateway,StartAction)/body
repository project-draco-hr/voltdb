{
  final VoltDBInterface vdb=VoltDB.instance();
  LicenseApi api=vdb.getLicenseApi();
  final boolean licensedToDR=api.isDrReplicationAllowed();
  PartitionDRGateway pdrg=null;
  if (licensedToDR && producerGateway != null) {
    pdrg=tryToLoadProVersion();
  }
  if (pdrg == null) {
    pdrg=new PartitionDRGateway();
  }
  try {
    pdrg.init(partitionId,producerGateway,startAction);
  }
 catch (  IOException e) {
    VoltDB.crashLocalVoltDB(e.getMessage(),false,e);
  }
  m_partitionDRGateways.put(partitionId,pdrg);
  return pdrg;
}
