{
  PartitionDRGateway pdrg=null;
  RealVoltDB rvdb=(RealVoltDB)VoltDB.instance();
  if (rvdb.m_startMode == OperationMode.PRIMARY) {
    try {
      Class<?> pdrgiClass=Class.forName("org.voltdb.dr.PartitionDRGatewayImpl");
      Object obj=pdrgiClass.newInstance();
      pdrg=(PartitionDRGateway)obj;
    }
 catch (    Exception e) {
      VoltDB.crashLocalVoltDB("Configured as primary cluster but unable to load DR code",false,null);
    }
  }
  if (pdrg == null) {
    pdrg=new PartitionDRGateway();
  }
  try {
    pdrg.init(partitionId,rejoiningAtStartup,overflowDir);
  }
 catch (  IOException e) {
    VoltDB.crashLocalVoltDB(e.getMessage(),false,e);
  }
  return pdrg;
}
