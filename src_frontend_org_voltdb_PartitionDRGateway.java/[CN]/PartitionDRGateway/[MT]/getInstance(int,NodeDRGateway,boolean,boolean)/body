{
  final VoltDBInterface vdb=VoltDB.instance();
  LicenseApi api=vdb.getLicenseApi();
  final boolean licensedToDR=api.isDrReplicationAllowed();
  PartitionDRGateway pdrg=null;
  if (licensedToDR && nodeGateway != null) {
    pdrg=tryToLoadProVersion(iv2Enabled);
  }
  if (pdrg == null) {
    pdrg=new PartitionDRGateway(iv2Enabled);
  }
  try {
    pdrg.init(partitionId,nodeGateway,isRejoin);
  }
 catch (  IOException e) {
    VoltDB.crashLocalVoltDB(e.getMessage(),false,e);
  }
  return pdrg;
}
