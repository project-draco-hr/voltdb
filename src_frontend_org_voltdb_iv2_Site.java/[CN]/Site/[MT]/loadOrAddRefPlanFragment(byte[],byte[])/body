{
  Sha1Wrapper key=new Sha1Wrapper(planHash);
  FragInfo frag=null;
synchronized (FragInfo.class) {
    frag=m_plansByHash.get(key);
    if (frag != null) {
      frag.refCount++;
      return frag.fragId;
    }
 else {
      frag=new FragInfo();
      frag.hash=key;
      frag.plan=plan;
      frag.refCount=1;
      frag.fragId=m_nextFragId++;
      m_plansByHash.put(key,frag);
      m_plansById.put(frag.fragId,frag);
      return frag.fragId;
    }
  }
}
