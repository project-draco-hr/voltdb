{
  for (int i=1; global_replay_mpTxn != null || i < 10; ++i) {
    if (m_rejoinTaskLog.isEmpty()) {
      assert(global_replay_mpTxn == null);
      return;
    }
    TransactionInfoBaseMessage tibm=m_rejoinTaskLog.getNextMessage();
    if (tibm == null) {
      rejoinLog.debug("Site " + m_siteId + ": rejoin log unavailable. Async fetch.");
      return;
    }
 else     if (tibm instanceof Iv2InitiateTaskMessage) {
      Iv2InitiateTaskMessage m=(Iv2InitiateTaskMessage)tibm;
      SpProcedureTask t=new SpProcedureTask(m_initiatorMailbox,m.getStoredProcedureName(),null,m,null);
      t.runFromTaskLog(this);
    }
 else     if (tibm instanceof FragmentTaskMessage) {
      FragmentTaskMessage m=(FragmentTaskMessage)tibm;
      rejoinLog.debug("Replaying frag: " + m);
      global_replay_mpTxn=new ParticipantTransactionState(m.getTxnId(),m);
      FragmentTask t=new FragmentTask(m_initiatorMailbox,m,global_replay_mpTxn);
      t.runFromTaskLog(this);
    }
 else     if (tibm instanceof CompleteTransactionMessage) {
      CompleteTransactionMessage m=(CompleteTransactionMessage)tibm;
      rejoinLog.debug("Replaying complete msg: " + m);
      CompleteTransactionTask t=new CompleteTransactionTask(global_replay_mpTxn,null,m,null);
      t.runFromTaskLog(this);
      global_replay_mpTxn=null;
    }
 else {
      VoltDB.crashLocalVoltDB("Can not replay message type " + tibm + " during live rejoin. Unexpected error.",false,null);
    }
  }
}
