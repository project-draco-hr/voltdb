{
  if (m_rejoinState != kStateReplayingRejoin) {
    return;
  }
  for (int i=0; i < 10; ++i) {
    if (m_rejoinTaskLog.isEmpty()) {
      break;
    }
    TransactionInfoBaseMessage tibm=m_rejoinTaskLog.getNextMessage();
    if (tibm == null) {
      break;
    }
    if (filter(tibm)) {
      continue;
    }
    if (tibm instanceof Iv2InitiateTaskMessage) {
      Iv2InitiateTaskMessage m=(Iv2InitiateTaskMessage)tibm;
      SpProcedureTask t=new SpProcedureTask(m_initiatorMailbox,m.getStoredProcedureName(),null,m,null);
      t.runFromTaskLog(this);
    }
 else     if (tibm instanceof FragmentTaskMessage) {
      FragmentTaskMessage m=(FragmentTaskMessage)tibm;
      if (global_replay_mpTxn == null) {
        global_replay_mpTxn=new ParticipantTransactionState(m.getTxnId(),m);
      }
 else       if (global_replay_mpTxn.txnId != m.getTxnId()) {
        VoltDB.crashLocalVoltDB("Started a MP transaction during replay before completing " + " open transaction.",false,null);
      }
      FragmentTask t=new FragmentTask(m_initiatorMailbox,m,global_replay_mpTxn);
      t.runFromTaskLog(this);
    }
 else     if (tibm instanceof CompleteTransactionMessage) {
      if (global_replay_mpTxn != null) {
        CompleteTransactionMessage m=(CompleteTransactionMessage)tibm;
        CompleteTransactionTask t=new CompleteTransactionTask(global_replay_mpTxn,null,m,null);
        if (!m.isRestart()) {
          global_replay_mpTxn=null;
        }
        t.runFromTaskLog(this);
      }
    }
 else {
      VoltDB.crashLocalVoltDB("Can not replay message type " + tibm + " during live rejoin. Unexpected error.",false,null);
    }
  }
  if (m_rejoinTaskLog.isEmpty() && global_replay_mpTxn == null) {
    setReplayRejoinComplete();
  }
}
