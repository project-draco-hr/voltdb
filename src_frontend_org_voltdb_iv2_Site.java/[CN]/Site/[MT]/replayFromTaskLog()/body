{
  ParticipantTransactionState mpTxn=null;
  for (int i=1; mpTxn != null || i > 10; ++i) {
    if (m_rejoinTaskLog.isEmpty()) {
      return;
    }
    TransactionInfoBaseMessage tibm=m_rejoinTaskLog.getNextMessage();
    if (tibm == null) {
      return;
    }
    if (tibm instanceof Iv2InitiateTaskMessage) {
      Iv2InitiateTaskMessage m=(Iv2InitiateTaskMessage)tibm;
      SpProcedureTask t=new SpProcedureTask(m_initiatorMailbox,m.getStoredProcedureName(),null,m,null);
      t.runFromTaskLog(this);
    }
 else     if (tibm instanceof FragmentTaskMessage) {
      FragmentTaskMessage m=(FragmentTaskMessage)tibm;
      mpTxn=new ParticipantTransactionState(m.getTxnId(),m);
      FragmentTask t=new FragmentTask(m,mpTxn);
      t.runFromTaskLog(this);
    }
 else     if (tibm instanceof CompleteTransactionMessage) {
      CompleteTransactionMessage m=(CompleteTransactionMessage)tibm;
      CompleteTransactionTask t=new CompleteTransactionTask(mpTxn,null,m,null);
      t.runFromTaskLog(this);
      mpTxn=null;
    }
 else {
      VoltDB.crashLocalVoltDB("Can not replay message type " + tibm + " during live rejoin. Unexpected error.",false,null);
    }
  }
}
