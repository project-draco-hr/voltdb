{
  final AtomicBoolean promotionResult=new AtomicBoolean(true);
  final InitiatorMailbox mailbox=mock(InitiatorMailbox.class);
  final SpPromoteAlgo term=new SpPromoteAlgo(null,mailbox,"Test"){
    @Override void prepareForFaultRecovery(){
    }
  }
;
  Thread promotionThread=new Thread(){
    @Override public void run(){
      try {
        promotionResult.set(term.start().get().getFirst());
      }
 catch (      Exception e) {
        System.out.println("Promotion thread threw: " + e);
        throw new RuntimeException(e);
      }
    }
  }
;
  promotionThread.start();
  term.cancel();
  promotionThread.join();
  assertFalse(promotionResult.get());
}
