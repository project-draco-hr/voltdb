{
  ArrayList<Node> notFullList=new ArrayList<Node>();
  for (  Node n : nodes) {
    if (n.partitionCount() < sitesPerNode) {
      notFullList.add(n);
    }
  }
  Node leastConnectedNode=null;
  for (  Node n : notFullList) {
    if (leastConnectedNode == null) {
      leastConnectedNode=n;
      continue;
    }
    if (n.m_replicationConnections.size() <= leastConnectedNode.m_replicationConnections.size()) {
      int sumA=0;
      for (      Set<Partition> replicas : n.m_replicationConnections.values()) {
        sumA+=replicas.size();
      }
      int sumB=0;
      for (      Set<Partition> replicas : leastConnectedNode.m_replicationConnections.values()) {
        sumB+=replicas.size();
      }
      if (sumA < sumB) {
        leastConnectedNode=n;
      }
    }
  }
  return leastConnectedNode;
}
