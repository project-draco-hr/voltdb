{
  ClusterConfig config=new ClusterConfig(topo);
  int partition=config.getPartitionCount();
  int kfactor=config.getReplicationFactor();
  int partitionsToAdd=config.getSitesPerHost();
  if (hostIds.size() != kfactor + 1) {
    VoltDB.crashLocalVoltDB("Only adding " + (kfactor + 1) + " nodes at a time is "+ "supported, currently trying to add "+ hostIds.size(),false,null);
  }
  topo.put("hostcount",config.getHostCount() + hostIds.size());
  JSONArray partitions=topo.getJSONArray("partitions");
  for (int i=0; i < partitionsToAdd; i++) {
    JSONStringer newPart=new JSONStringer();
    newPart.object();
    newPart.key("partition_id").value(partition++);
    int index=i % hostIds.size();
    int master=hostIds.get(index);
    newPart.key("master").value(master);
    newPart.key("replicas").array();
    for (    int host : hostIds) {
      newPart.value(host);
    }
    newPart.endArray();
    newPart.endObject();
    partitions.put(new JSONObject(newPart.toString()));
  }
}
