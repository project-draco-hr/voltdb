{
  int hostCount=getHostCount();
  int partitionCount=getPartitionCount();
  int sitesPerHost=getSitesPerHost();
  if (hostCount != hostIds.size()) {
    throw new RuntimeException("Provided " + hostIds.size() + " host ids when host count is "+ hostCount);
  }
  boolean useFallbackStrategy=Boolean.valueOf(System.getenv("VOLT_REPLICA_FALLBACK"));
  if (sitesPerHost * hostCount % partitionCount > 0 || partitionCount < hostCount) {
    hostLog.warn("Unable to use optimal replica placement strategy with this configuration. " + " Falling back to a less optimal strategy that may result in worse performance. " + " Try using an even number of sites per host.");
    useFallbackStrategy=true;
  }
  JSONObject topo=null;
  if (useFallbackStrategy) {
    topo=fallbackPlacementStrategy(hostIds,hostCount,partitionCount,sitesPerHost);
  }
 else {
    try {
      topo=newPlacementStrategy(hostIds,hostCount,partitionCount,sitesPerHost);
    }
 catch (    Exception e) {
      hostLog.error("Unable to use optimal replica placement strategy. " + "Falling back to a less optimal strategy that may result in worse performance");
      topo=fallbackPlacementStrategy(hostIds,hostCount,partitionCount,sitesPerHost);
    }
  }
  hostLog.info("TOPO: " + topo.toString(2));
  return topo;
}
