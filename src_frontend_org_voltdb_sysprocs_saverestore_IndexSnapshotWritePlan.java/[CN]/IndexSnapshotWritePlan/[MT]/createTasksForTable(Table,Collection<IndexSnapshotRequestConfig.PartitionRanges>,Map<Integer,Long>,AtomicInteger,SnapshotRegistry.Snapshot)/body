{
  final DevNullSnapshotTarget dataTarget=new DevNullSnapshotTarget();
  final Runnable onClose=new TargetStatsClosure(dataTarget,table.getTypeName(),numTables,snapshotRecord);
  dataTarget.setOnCloseHandler(onClose);
  for (  IndexSnapshotRequestConfig.PartitionRanges partitionRange : partitionRanges) {
    Long localHSId=pidToLocalHSIDs.get(partitionRange.partitionId);
    if (localHSId != null) {
      final SnapshotTableTask task=new SnapshotTableTask(table,dataTarget,new SnapshotDataFilter[0],createPredicateForTable(table,partitionRange),false);
      m_targets.add(dataTarget);
      placeTask(task,Arrays.asList(localHSId));
    }
  }
}
