{
  SNAP_LOG.info("Creating tasks for table " + table.getTypeName() + " id "+ table.getId());
  if (pidToLocalHSIDs.isEmpty()) {
    return;
  }
  final DevNullSnapshotTarget dataTarget=new DevNullSnapshotTarget();
  final Runnable onClose=new TargetStatsClosure(dataTarget,table.getTypeName(),numTables,snapshotRecord);
  dataTarget.setOnCloseHandler(onClose);
  m_targets.add(dataTarget);
  for (  IndexSnapshotRequestConfig.PartitionRanges partitionRange : partitionRanges) {
    SNAP_LOG.info("Checking to see if we should create a task for partition " + partitionRange.partitionId + " ranges "+ partitionRange.ranges.size());
    Long localHSId=pidToLocalHSIDs.get(partitionRange.partitionId);
    if (localHSId != null) {
      SNAP_LOG.info("Creating task for partition for partition " + partitionRange.partitionId);
      final SnapshotTableTask task=new SnapshotTableTask(table,new SnapshotDataFilter[0],createIndexExpressionForTable(table,partitionRange.ranges),false);
      task.setTarget(dataTarget);
      placeTask(task,Arrays.asList(localHSId));
    }
  }
}
