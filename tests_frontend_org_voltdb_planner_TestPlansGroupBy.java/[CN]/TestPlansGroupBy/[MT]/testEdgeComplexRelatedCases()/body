{
  pns=compileToFragments("select PKEY+A1 from T1 Order by PKEY+A1");
  AbstractPlanNode p=pns.get(0).getChild(0);
  assertTrue(p instanceof ProjectionPlanNode);
  assertTrue(p.getChild(0) instanceof OrderByPlanNode);
  assertTrue(p.getChild(0).getChild(0) instanceof ReceivePlanNode);
  p=pns.get(1).getChild(0);
  assertTrue(p instanceof AbstractScanPlanNode);
  pns=compileToFragments("SELECT count(*)  FROM P1 order by PKEY");
  checkHasComplexAgg(pns);
  pns=compileToFragments("SELECT A1, count(*) as tag FROM P1 group by A1 order by tag, A1 limit 1");
  p=pns.get(0).getChild(0);
  assertTrue(p instanceof LimitPlanNode);
  assertTrue(p.getChild(0) instanceof ProjectionPlanNode);
  assertTrue(p.getChild(0).getChild(0) instanceof OrderByPlanNode);
  assertTrue(p.getChild(0).getChild(0).getChild(0) instanceof AggregatePlanNode);
  p=pns.get(1).getChild(0);
  assertTrue(p instanceof AggregatePlanNode);
  assertTrue(p.getChild(0) instanceof AbstractScanPlanNode);
}
