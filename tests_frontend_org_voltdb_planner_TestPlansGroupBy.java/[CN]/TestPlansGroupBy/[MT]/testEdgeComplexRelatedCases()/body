{
  List<AbstractPlanNode> pns;
  pns=compileToFragments("select PKEY+A1 from T1 Order by PKEY+A1");
  AbstractPlanNode p=pns.get(0).getChild(0);
  assertTrue(p instanceof ProjectionPlanNode);
  assertTrue(p.getChild(0) instanceof OrderByPlanNode);
  assertTrue(p.getChild(0).getChild(0) instanceof ReceivePlanNode);
  p=pns.get(1).getChild(0);
  assertTrue(p instanceof AbstractScanPlanNode);
  pns=compileToFragments("SELECT count(*)  FROM P1 order by PKEY");
  p=pns.get(0).getChild(0);
  assertTrue(p instanceof AggregatePlanNode);
  assertTrue(p.getChild(0) instanceof ReceivePlanNode);
  p=pns.get(1).getChild(0);
  assertTrue(p instanceof AbstractScanPlanNode);
  pns=compileToFragments("SELECT A1, count(*) as tag FROM P1 group by A1 order by tag, A1 limit 1");
  p=pns.get(0).getChild(0);
  assertTrue(p instanceof ProjectionPlanNode);
  p=p.getChild(0);
  assertTrue(p instanceof OrderByPlanNode);
  assertNotNull(p.getInlinePlanNode(PlanNodeType.LIMIT));
  assertTrue(p.getChild(0) instanceof AggregatePlanNode);
  p=pns.get(1).getChild(0);
  assertTrue(p instanceof AbstractScanPlanNode);
  assertNotNull(p.getInlinePlanNode(PlanNodeType.HASHAGGREGATE));
  pns=compileToFragments("SELECT F_D1, count(*) as tag FROM RF group by F_D1 order by tag");
  p=pns.get(0).getChild(0);
  assertTrue(p instanceof ProjectionPlanNode);
  p=p.getChild(0);
  assertTrue(p instanceof OrderByPlanNode);
  p=p.getChild(0);
  assertTrue(p instanceof IndexScanPlanNode);
  assertNotNull(p.getInlinePlanNode(PlanNodeType.AGGREGATE));
  pns=compileToFragments("SELECT F_D1, count(*) FROM RF group by F_D1 order by 2");
  p=pns.get(0).getChild(0);
  assertTrue(p instanceof ProjectionPlanNode);
  p=p.getChild(0);
  assertTrue(p instanceof OrderByPlanNode);
  p=p.getChild(0);
  assertTrue(p instanceof IndexScanPlanNode);
  assertNotNull(p.getInlinePlanNode(PlanNodeType.AGGREGATE));
}
