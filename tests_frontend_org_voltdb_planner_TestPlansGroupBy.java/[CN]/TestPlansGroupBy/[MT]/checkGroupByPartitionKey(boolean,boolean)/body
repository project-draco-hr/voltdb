{
  AbstractPlanNode p;
  AggregatePlanNode aggNode;
  p=pns.get(0).getChild(0);
  if (topAgg) {
    assertTrue(p instanceof AggregatePlanNode);
    if (having) {
      aggNode=(AggregatePlanNode)p;
      assertNotNull(aggNode.getPostPredicate());
    }
  }
 else {
    assertTrue(p instanceof ProjectionPlanNode);
  }
  assertTrue(p.getChild(0) instanceof ReceivePlanNode);
  p=pns.get(1).getChild(0);
  assertTrue(p instanceof AbstractScanPlanNode);
  assertNotNull(p.getInlinePlanNode(PlanNodeType.HASHAGGREGATE));
  if (having && !topAgg) {
    aggNode=(AggregatePlanNode)p.getInlinePlanNode(PlanNodeType.HASHAGGREGATE);
    assertNotNull(aggNode.getPostPredicate());
  }
}
