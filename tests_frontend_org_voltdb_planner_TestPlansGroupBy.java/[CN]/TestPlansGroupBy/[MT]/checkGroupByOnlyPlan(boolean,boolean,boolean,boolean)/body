{
  AbstractPlanNode apn=pns.get(0).getChild(0);
  if (twoFragments) {
    assertTrue(apn.getPlanNodeType() == PlanNodeType.HASHAGGREGATE);
    apn=pns.get(1).getChild(0);
  }
  if (aggInline) {
    assertTrue(apn.getPlanNodeType() == (isIndexScan ? PlanNodeType.INDEXSCAN : PlanNodeType.SEQSCAN));
    if (isHashAggregator) {
      assertNotNull(apn.getInlinePlanNode(PlanNodeType.HASHAGGREGATE));
    }
 else {
      assertNotNull(apn.getInlinePlanNode(PlanNodeType.AGGREGATE));
    }
  }
 else {
    assertTrue(apn.getPlanNodeType() == (isHashAggregator ? PlanNodeType.HASHAGGREGATE : PlanNodeType.AGGREGATE));
    assertTrue(apn.getChild(0).getPlanNodeType() == (isIndexScan ? PlanNodeType.INDEXSCAN : PlanNodeType.SEQSCAN));
  }
}
