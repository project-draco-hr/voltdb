{
  if (aggFilters != null) {
    for (int i=0; i < aggFilters.length; i++) {
      aggFilters[i]=aggFilters[i].toLowerCase();
    }
  }
  if (scanFilters != null) {
    for (int i=0; i < scanFilters.length; i++) {
      scanFilters[i]=scanFilters[i].toLowerCase();
    }
  }
  AbstractPlanNode p=pns.get(0);
  List<AbstractPlanNode> nodes=p.findAllNodesOfType(PlanNodeType.RECEIVE);
  assertEquals(1,nodes.size());
  p=nodes.get(0);
  assertTrue(p instanceof ReceivePlanNode);
  assertTrue(p.getParent(0) instanceof HashAggregatePlanNode);
  HashAggregatePlanNode reAggNode=(HashAggregatePlanNode)p.getParent(0);
  String reAggNodeStr=reAggNode.toExplainPlanString().toLowerCase();
  if (aggFilters != null) {
    for (    String aggFilter : aggFilters) {
      assertTrue(reAggNodeStr.contains(aggFilter));
    }
  }
 else {
    assertNull(reAggNode.getPostPredicate());
  }
  if (scanFilters != null) {
    for (    String scanFilter : scanFilters) {
      assertFalse(reAggNodeStr.contains(scanFilter));
    }
  }
  p=pns.get(1);
  assert(p.getScanNodeList().size() == 1);
  p=p.getScanNodeList().get(0);
  String scanNodeStr=p.toExplainPlanString().toLowerCase();
  if (scanFilters != null) {
    for (    String scanFilter : scanFilters) {
      assertTrue(scanNodeStr.contains(scanFilter));
    }
  }
  if (aggFilters != null) {
    for (    String aggFilter : aggFilters) {
      assertFalse(scanNodeStr.contains(aggFilter));
    }
  }
}
