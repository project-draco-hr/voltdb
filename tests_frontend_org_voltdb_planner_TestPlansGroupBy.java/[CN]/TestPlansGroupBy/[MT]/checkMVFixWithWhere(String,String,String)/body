{
  pns=compileToFragments(sql);
  for (  AbstractPlanNode apn : pns) {
    System.out.println(apn.toExplainPlanString());
  }
  if (aggFilter != null) {
    aggFilter=aggFilter.toLowerCase();
  }
  if (scanFilter != null) {
    scanFilter=scanFilter.toLowerCase();
  }
  AbstractPlanNode p=pns.get(0);
  while (p instanceof ReceivePlanNode == false) {
    p=p.getChild(0);
  }
  assertTrue(p.getParent(0) instanceof HashAggregatePlanNode);
  String reAggNodeStr=p.getParent(0).toExplainPlanString().toLowerCase();
  if (aggFilter != null) {
    assertTrue(reAggNodeStr.contains(aggFilter));
  }
  if (scanFilter != null) {
    assertFalse(reAggNodeStr.contains(scanFilter));
  }
  p=pns.get(1);
  assert(p.getScanNodeList().size() == 1);
  p=p.getScanNodeList().get(0);
  String scanNodeStr=p.toExplainPlanString().toLowerCase();
  if (scanFilter != null) {
    assertTrue(scanNodeStr.contains(scanFilter));
  }
  if (aggFilter != null) {
    assertFalse(scanNodeStr.contains(aggFilter));
  }
}
