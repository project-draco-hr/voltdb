{
  if (aggFilter != null) {
    aggFilter=aggFilter.toLowerCase();
  }
  if (scanFilter != null) {
    scanFilter=scanFilter.toLowerCase();
  }
  AbstractPlanNode p=pns.get(0);
  List<AbstractPlanNode> nodes=p.findAllNodesOfType(PlanNodeType.RECEIVE);
  assertEquals(1,nodes.size());
  p=nodes.get(0);
  assertTrue(p instanceof ReceivePlanNode);
  assertTrue(p.getParent(0) instanceof HashAggregatePlanNode);
  String reAggNodeStr=p.getParent(0).toExplainPlanString().toLowerCase();
  if (aggFilter != null) {
    assertTrue(reAggNodeStr.contains(aggFilter));
  }
  if (scanFilter != null) {
    assertFalse(reAggNodeStr.contains(scanFilter));
  }
  p=pns.get(1);
  assert(p.getScanNodeList().size() == 1);
  p=p.getScanNodeList().get(0);
  String scanNodeStr=p.toExplainPlanString().toLowerCase();
  if (scanFilter != null) {
    assertTrue(scanNodeStr.contains(scanFilter));
  }
  if (aggFilter != null) {
    assertFalse(scanNodeStr.contains(aggFilter));
  }
}
