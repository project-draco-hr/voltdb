{
  pns=compileToFragments("SELECT AVG(A1) FROM P1");
  checkHasComplexAgg(pns);
  AbstractPlanNode p=pns.get(0).getChild(0);
  assertTrue(p instanceof ProjectionPlanNode);
  assertTrue(p.getChild(0) instanceof AggregatePlanNode);
  p=pns.get(1).getChild(0);
  assertTrue(p instanceof AggregatePlanNode);
  assertTrue(p.getChild(0) instanceof AbstractScanPlanNode);
  pns=compileToFragments("SELECT A1, AVG(PKEY) FROM P1 GROUP BY A1");
  checkHasComplexAgg(pns);
  p=pns.get(0).getChild(0);
  assertTrue(p instanceof ProjectionPlanNode);
  assertTrue(p.getChild(0) instanceof AggregatePlanNode);
  p=pns.get(1).getChild(0);
  assertTrue(p instanceof AggregatePlanNode);
  assertTrue(p.getChild(0) instanceof AbstractScanPlanNode);
  pns=compileToFragments("SELECT A1, AVG(PKEY)+1 FROM P1 GROUP BY A1");
  checkHasComplexAgg(pns);
  p=pns.get(0).getChild(0);
  assertTrue(p instanceof ProjectionPlanNode);
  assertTrue(p.getChild(0) instanceof AggregatePlanNode);
  p=pns.get(1).getChild(0);
  assertTrue(p instanceof AggregatePlanNode);
  assertTrue(p.getChild(0) instanceof AbstractScanPlanNode);
}
