{
  AbstractPlanNode p=pns.get(0).getChild(0);
  if (optimized) {
    assertTrue(p instanceof ProjectionPlanNode);
    assertTrue(p.getChild(0) instanceof AggregatePlanNode);
    p=pns.get(1).getChild(0);
    if (inlined) {
      assertTrue(p instanceof AbstractScanPlanNode);
      assertNotNull(p.getInlinePlanNode(PlanNodeType.AGGREGATE));
    }
 else {
      assertTrue(p instanceof AggregatePlanNode);
      assertTrue(p.getChild(0) instanceof AbstractScanPlanNode);
    }
  }
 else {
    assertTrue(pns.size() == 1);
    if (inlined) {
      assertTrue(p instanceof AbstractScanPlanNode);
      assertNotNull(p.getInlinePlanNode(PlanNodeType.AGGREGATE));
    }
 else {
      assertTrue(p instanceof AggregatePlanNode);
      assertTrue(p.getChild(0) instanceof AbstractScanPlanNode);
    }
  }
}
