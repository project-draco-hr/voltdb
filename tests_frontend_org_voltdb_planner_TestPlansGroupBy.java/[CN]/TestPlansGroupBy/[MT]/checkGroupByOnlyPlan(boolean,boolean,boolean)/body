{
  AbstractPlanNode apn=pns.get(0).getChild(0);
  if (twoFragments) {
    assertEquals(apn.getPlanNodeType(),PlanNodeType.HASHAGGREGATE);
    apn=pns.get(1).getChild(0);
  }
  assertTrue(apn.getPlanNodeType() == (isIndexScan ? PlanNodeType.INDEXSCAN : PlanNodeType.SEQSCAN));
  if (isHashAggregator) {
    assertNotNull(apn.getInlinePlanNode(PlanNodeType.HASHAGGREGATE));
  }
 else {
    assertNotNull(apn.getInlinePlanNode(PlanNodeType.AGGREGATE));
  }
}
