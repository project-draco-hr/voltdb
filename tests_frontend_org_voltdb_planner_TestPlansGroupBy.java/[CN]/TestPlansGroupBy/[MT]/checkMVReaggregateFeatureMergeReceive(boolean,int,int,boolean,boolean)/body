{
  assertTrue(pns.size() == 2);
  AbstractPlanNode p=pns.get(0);
  assertTrue(p instanceof SendPlanNode);
  p=p.getChild(0);
  if (p instanceof ProjectionPlanNode) {
    p=p.getChild(0);
  }
  AbstractPlanNode receiveNode=(p instanceof ProjectionPlanNode) ? p.getChild(0) : p;
  assertNotNull(receiveNode);
  AggregatePlanNode reAggNode=null;
  if (needFix) {
    reAggNode=AggregatePlanNode.getInlineAggregationNode(receiveNode);
    assertNotNull(reAggNode);
    assertEquals(numGroupbyOfReaggNode,reAggNode.getGroupByExpressionsSize());
    assertEquals(numAggsOfReaggNode,reAggNode.getAggregateTypesSize());
  }
  p=pns.get(1);
  assertTrue(p instanceof SendPlanNode);
  p=p.getChild(0);
  assertTrue(p instanceof AbstractScanPlanNode);
}
