{
  Integer clientIndex=m_clientIndexes.get(partId);
  if (clientIndex == null) {
    clientIndex=0;
    m_clientIndexes.put(partId,clientIndex);
  }
  File[] clientFiles=m_clientFiles.get(partId);
  if (clientFiles == null) {
    clientFiles=new File[0];
    m_clientFiles.put(partId,clientFiles);
  }
  if (clientIndex == clientFiles.length) {
    for (    File f : clientFiles) {
      f.delete();
    }
    if (Boolean.TRUE.equals(m_clientComplete.get(partId)))     return null;
    clientFiles=checkForMoreClientFiles(partId);
    if (clientFiles.length == 0)     return null;
    clientIndex=0;
  }
  File clientFile=clientFiles[clientIndex];
  System.out.println("INFO clientlog: Opening client file: " + clientFile.getName() + " for partition id "+ partId);
  if (clientFile.getName().endsWith("-last")) {
    m_clientComplete.put(partId,true);
  }
  BufferedReader reader=new BufferedReader(new InputStreamReader(new FileInputStream(clientFile)));
  m_clientIndexes.put(partId,clientIndex + 1);
  return reader;
}
