{
  String sql;
  sql="SELECT distinct A3, B3 from T3 HAVING COUNT(*) > 3";
  failToCompile(sql,"expression not in aggregate or GROUP BY columns: PUBLIC.T3.A3");
  sql="SELECT distinct A3, B3, C3 from T3 group by A3, B3";
  failToCompile(sql,"expression not in aggregate or GROUP BY columns: PUBLIC.T3.C3");
  sql="SELECT distinct A3 from T3 group by A3, B3, C3";
  compileToFragments(sql);
  String errorMsg="invalid ORDER BY expression";
  sql="SELECT distinct B3 from T3 order by A3";
  failToCompile(sql,errorMsg);
  sql="SELECT distinct A3, B3 from T3 order by C3";
  failToCompile(sql,errorMsg);
  sql="SELECT distinct A3 from T3 group by A3, B3, C3 ORDER BY B3";
  failToCompile(sql,errorMsg);
  sql="select PKEY, max(B1) FROM P1 group by PKEY order by C1";
  failToCompile(sql,errorMsg);
  sql="select max(B1) FROM P1 group by PKEY order by C1";
  failToCompile(sql,errorMsg);
  sql="select DISTINCT C1, max(B1) FROM P1 group by PKEY order by C1";
  compileToFragments(sql);
  sql="select DISTINCT C1, max(B1) FROM P1 group by PKEY order by ABS(C1)";
  compileToFragments(sql);
  sql="select DISTINCT PKEY, max(B3) FROM T3 group by PKEY, A3 order by C3";
  failToCompile(sql,errorMsg);
  sql="select distinct max(B3) FROM T3 group by PKEY, A3 order by C3";
  failToCompile(sql,errorMsg);
  sql="select distinct C3, max(B3) FROM T3 group by PKEY, A3 order by C3";
  compileToFragments(sql);
  sql="select distinct max(B3) FROM T3 group by PKEY, A3 order by A3";
  failToCompile(sql,errorMsg);
  sql="select max(B3) FROM T3 group by PKEY, A3 order by A3";
  compileToFragments(sql);
}
