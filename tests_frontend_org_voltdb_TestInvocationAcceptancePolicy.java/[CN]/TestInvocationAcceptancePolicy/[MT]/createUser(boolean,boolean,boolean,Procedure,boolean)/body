{
  AuthSystem.AuthUser user=mock(AuthSystem.AuthUser.class);
  when(user.hasGroupWithSysProcPermission()).thenReturn(sysproc);
  when(user.hasAdhocPermission()).thenReturn(adhoc);
  when(user.hasGroupWithDefaultProcPermission()).thenReturn(crud);
  when(user.hasGroupWithDefaultProcReadPermission()).thenReturn(readonly);
  if (userProc != null) {
    when(user.hasUserDefinedProcedurePermission(userProc)).thenReturn(true);
  }
  return user;
}
