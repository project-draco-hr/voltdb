{
  AuthSystem.AuthUser user=mock(AuthSystem.AuthUser.class);
  when(user.hasAdhocPermission()).thenReturn(adhoc);
  when(user.hasDefaultProcPermission()).thenReturn(crud);
  when(user.hasDefaultProcReadPermission()).thenReturn(readonly);
  if (userProc != null) {
    when(user.hasPermission(userProc)).thenReturn(true);
  }
  when(user.hasSystemProcPermission()).thenReturn(sysproc);
  return user;
}
