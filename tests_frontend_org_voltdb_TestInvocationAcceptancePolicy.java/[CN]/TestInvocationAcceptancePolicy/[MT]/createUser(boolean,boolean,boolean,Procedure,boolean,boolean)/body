{
  AuthSystem.AuthUser user=mock(AuthSystem.AuthUser.class);
  when(user.hasPermission(Permission.ADMIN)).thenReturn(sysproc);
  when(user.hasPermission(Permission.ADHOC,Permission.ADMIN)).thenReturn(adhoc);
  when(user.hasPermission(Permission.DEFAULTPROC)).thenReturn(crud);
  when(user.hasPermission(Permission.DEFAULTPROCREAD)).thenReturn(readonly);
  if (userProc != null) {
    if (allprocs) {
      when(user.hasUserDefinedProcedurePermission(userProc)).thenReturn(allprocs);
    }
    when(user.hasUserDefinedProcedurePermission(userProc)).thenReturn(true);
  }
  return user;
}
