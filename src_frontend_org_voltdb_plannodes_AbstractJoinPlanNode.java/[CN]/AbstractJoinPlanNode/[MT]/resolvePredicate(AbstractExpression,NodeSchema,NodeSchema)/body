{
  List<TupleValueExpression> predicate_tves=ExpressionUtil.getTupleValueExpressions(expression);
  for (  TupleValueExpression tve : predicate_tves) {
    int index=tve.resolveColumnIndexesUsingSchema(outer_schema);
    int tableIdx=0;
    if (index == -1) {
      index=tve.resolveColumnIndexesUsingSchema(inner_schema);
      if (index == -1) {
        throw new RuntimeException("Unable to resolve column index for join TVE: " + tve.toString());
      }
      tableIdx=1;
    }
    tve.setColumnIndex(index);
    tve.setTableIndex(tableIdx);
  }
}
