{
  m_hostCount=1;
  String voltroot=newVoltRoot(null);
  buildCatalog(m_hostCount,8,0,voltroot,false,true);
  ServerThread server=new ServerThread(context.pathToCatalogJar,deploymentPath,BackendTarget.NATIVE_EE_JNI);
  server.start();
  server.waitForInitialization();
  snapshot();
  server.shutdown();
  buildCatalog(m_hostCount,8,0,voltroot,true,true);
  HashSet<String> procs=new HashSet<String>();
  procs.add("@SnapshotRestore");
  MockInitiator initiator=new MockInitiator(procs);
  RestoreAgent restoreAgent=new RestoreAgent(context,initiator,getClient(0),snapshotMonitor,this,0,START_ACTION.START);
  restoreAgent.restore();
  while (!m_done) {
    try {
      Thread.sleep(200);
    }
 catch (    InterruptedException e) {
    }
  }
  Long count=initiator.getProcCounts().get("@SnapshotRestore");
  assertEquals(new Long(1),count);
}
