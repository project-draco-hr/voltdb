{
  long start=System.currentTimeMillis();
  boolean passed=false;
  VoltTable stats=null;
  while (System.currentTimeMillis() - start < 60000) {
    stats=client.callProcedure("@Statistics","table",(byte)0).getResults()[0];
    boolean passedThisTime=true;
    while (stats.advanceRow()) {
      if (stats.getString("TABLE_NAME").equals("NO_NULLS")) {
        if (stats.getLong("PARTITION_ID") == 0) {
          if (14 != stats.getLong("TUPLE_COUNT"))           passedThisTime=false;
          if (mem1 != stats.getLong("TUPLE_ALLOCATED_MEMORY"))           passedThisTime=false;
        }
 else         if (stats.getLong("PARTITION_ID") == 1) {
          if (13 != stats.getLong("TUPLE_COUNT"))           passedThisTime=false;
          if (mem2 != stats.getLong("TUPLE_ALLOCATED_MEMORY"))           passedThisTime=false;
        }
 else         if (stats.getLong("PARTITION_ID") == 2) {
          if (13 != stats.getLong("TUPLE_COUNT"))           passedThisTime=false;
          if (mem3 != stats.getLong("TUPLE_ALLOCATED_MEMORY"))           passedThisTime=false;
        }
 else {
          fail();
        }
      }
    }
    if (passedThisTime) {
      passed=true;
      break;
    }
    Thread.sleep(1);
  }
  if (!passed)   System.out.println(stats);
  assertTrue(passed);
}
