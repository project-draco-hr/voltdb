{
  ClusterConfig config=new ClusterConfig(1,6,0);
  JSONObject topo=config.getTopology(Arrays.asList(0));
  assertEquals(1,topo.getInt("hostcount"));
  assertEquals(6,topo.getInt("sites_per_host"));
  assertEquals(0,topo.getInt("kfactor"));
  assertEquals(6,topo.getJSONArray("partitions").length());
  ClusterConfig.addHosts(Arrays.asList(1),topo);
  assertEquals(2,topo.getInt("hostcount"));
  assertEquals(0,topo.getInt("kfactor"));
  assertEquals(12,topo.getJSONArray("partitions").length());
  JSONArray parts=topo.getJSONArray("partitions");
  int newPartCount=0;
  for (int i=6; i < parts.length(); i++) {
    JSONObject part=parts.getJSONObject(i);
    assertEquals(i,part.getInt("partition_id"));
    assertEquals(1,part.getInt("master"));
    assertEquals(1,part.getJSONArray("replicas").length());
    assertEquals(1,part.getJSONArray("replicas").get(0));
    newPartCount++;
  }
  assertEquals(6,newPartCount);
}
