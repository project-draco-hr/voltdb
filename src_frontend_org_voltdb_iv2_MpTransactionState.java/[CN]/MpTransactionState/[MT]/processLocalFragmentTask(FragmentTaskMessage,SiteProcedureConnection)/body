{
  Map<Integer,List<VoltTable>> depResults=new HashMap<Integer,List<VoltTable>>();
  for (int frag=0; frag < ftask.getFragmentCount(); frag++) {
    final long fragmentId=ftask.getFragmentId(frag);
    final int outputDepId=ftask.getOutputDepId(frag);
    ParameterSet params=ftask.getParameterSetForFragment(frag);
    if (ftask.isSysProcTask()) {
      final DependencyPair dep=siteConnection.executePlanFragment(this,m_remoteDepTables,fragmentId,params);
      List<VoltTable> tables=depResults.get(outputDepId);
      if (tables == null) {
        tables=new ArrayList<VoltTable>();
        depResults.put(outputDepId,tables);
      }
      tables.add(dep.dependency);
      System.out.printf("SYSPROCFRAG LOCAL: outputDepId(%d) depId(%d) table(%s)\n",outputDepId,dep.depId,dep.dependency);
      return depResults;
    }
 else {
      final int inputDepId=ftask.getOnlyInputDepId(frag);
      final VoltTable dependency=siteConnection.executePlanFragment(fragmentId,inputDepId,params,txnId,isReadOnly());
      List<VoltTable> tables=depResults.get(outputDepId);
      if (tables == null) {
        tables=new ArrayList<VoltTable>();
        depResults.put(outputDepId,tables);
      }
      tables.add(dependency);
    }
  }
  return depResults;
}
