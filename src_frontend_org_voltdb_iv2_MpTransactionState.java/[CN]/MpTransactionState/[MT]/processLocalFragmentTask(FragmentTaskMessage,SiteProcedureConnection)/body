{
  Map<Integer,List<VoltTable>> depResults=new HashMap<Integer,List<VoltTable>>();
  for (int frag=0; frag < ftask.getFragmentCount(); frag++) {
    final long fragmentId=ftask.getFragmentId(frag);
    final int outputDepId=ftask.getOutputDepId(frag);
    ParameterSet params=null;
    final ByteBuffer paramData=ftask.getParameterDataForFragment(frag);
    if (paramData != null) {
      final FastDeserializer fds=new FastDeserializer(paramData);
      try {
        params=fds.readObject(ParameterSet.class);
      }
 catch (      final IOException e) {
        hostLog.l7dlog(Level.FATAL,LogKeys.host_ExecutionSite_FailedDeserializingParamsForFragmentTask.name(),e);
        VoltDB.crashLocalVoltDB(e.getMessage(),true,e);
      }
    }
 else {
      params=new ParameterSet();
    }
    if (ftask.isSysProcTask()) {
      throw new RuntimeException("IV2: Sysprocs not yet supported");
    }
 else {
      final int inputDepId=ftask.getOnlyInputDepId(frag);
      final VoltTable dependency=siteConnection.executePlanFragment(fragmentId,inputDepId,params,txnId,isReadOnly());
      List<VoltTable> tables=depResults.get(outputDepId);
      if (tables == null) {
        tables=new ArrayList<VoltTable>();
        depResults.put(outputDepId,tables);
      }
      tables.add(dependency);
    }
  }
  return depResults;
}
