{
  if (m_remoteWork != null) {
    m_remoteDeps=createTrackedDependenciesFromTask(m_remoteWork,m_useHSIds);
    Map<Integer,List<VoltTable>> local_frag=processLocalFragmentTask(m_remoteWork,siteConnection);
    for (    Entry<Integer,List<VoltTable>> dep : local_frag.entrySet()) {
      trackDependency(m_localHSId,dep.getKey(),dep.getValue().get(0));
    }
    boolean doneWithRemoteDeps=false;
    while (!doneWithRemoteDeps) {
      FragmentResponseMessage msg=m_newDeps.poll();
      doneWithRemoteDeps=handleReceivedFragResponse(msg);
    }
  }
  siteConnection.stashWorkUnitDependencies(m_remoteDepTables);
  Map<Integer,List<VoltTable>> results=processLocalFragmentTask(m_localWork,siteConnection);
  return results;
}
