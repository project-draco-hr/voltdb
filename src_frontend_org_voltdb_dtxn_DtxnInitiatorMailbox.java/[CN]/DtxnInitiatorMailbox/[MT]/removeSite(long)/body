{
  ArrayList<Long> txnIdsToRemove=new ArrayList<Long>();
  for (  InFlightTxnState state : m_pendingTxns.values()) {
    if (!state.siteIsCoordinator(siteId))     continue;
    ClientResponseImpl toSend=state.addFailedOrRecoveringResponse(siteId);
    if (toSend != null) {
      enqueueResponse(toSend,state);
    }
    if (state.hasAllResponses()) {
      txnIdsToRemove.add(state.txnId);
      m_initiator.reduceBackpressure(state.messageSize);
      if (!state.hasSentResponse()) {
        assert(false);
      }
    }
  }
  for (  long txnId : txnIdsToRemove) {
    m_pendingTxns.remove(txnId);
  }
}
