{
  HashSet<Long> survivorSet=new HashSet<Long>(m_hsIds);
  survivorSet.removeAll(m_pendingFailedSites);
  long survivors[]=com.google.common.primitives.Longs.toArray(survivorSet);
  m_recoveryLog.info("Agreement, Sending fault data " + CoreUtils.hsIdCollectionToString(m_pendingFailedSites) + " to "+ CoreUtils.hsIdCollectionToString(survivorSet)+ " survivors");
  for (  Long site : m_pendingFailedSites) {
    Long txnId=m_txnQueue.getNewestSafeTransactionForInitiator(site);
    FailureSiteUpdateMessage srcmsg=new FailureSiteUpdateMessage(m_pendingFailedSites,site,txnId != null ? txnId : Long.MIN_VALUE,site);
    m_mailbox.send(survivors,srcmsg);
  }
  m_recoveryLog.info("Agreement, Sent fault data. Expecting " + (survivors.length * m_pendingFailedSites.size()) + " responses.");
  return (survivors.length * m_pendingFailedSites.size());
}
