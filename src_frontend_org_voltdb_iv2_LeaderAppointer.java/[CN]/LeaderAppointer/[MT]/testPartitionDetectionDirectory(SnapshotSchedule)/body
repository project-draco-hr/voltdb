{
  if (m_partitionDetectionEnabled) {
    File partitionPath=new File(schedule.getPath());
    if (!partitionPath.exists()) {
      tmLog.error("Directory " + partitionPath + " for partition detection snapshots does not exist");
      return false;
    }
    if (!partitionPath.isDirectory()) {
      tmLog.error("Directory " + partitionPath + " for partition detection snapshots is not a directory");
      return false;
    }
    File partitionPathFile=new File(partitionPath,Long.toString(System.currentTimeMillis()));
    try {
      partitionPathFile.createNewFile();
      partitionPathFile.delete();
    }
 catch (    IOException e) {
      tmLog.error("Could not create a test file in " + partitionPath + " for partition detection snapshots");
      e.printStackTrace();
      return false;
    }
    return true;
  }
 else {
    return true;
  }
}
