{
  boolean retval=true;
  List<String> partitionDirs=null;
  try {
    partitionDirs=m_zk.getChildren(VoltZK.leaders_initiators,null);
  }
 catch (  Exception e) {
    VoltDB.crashLocalVoltDB("Unable to read partitions from ZK",true,e);
  }
  for (  String partitionDir : partitionDirs) {
    int pid=LeaderElector.getPartitionFromElectionDir(partitionDir);
    String dir=ZKUtil.joinZKPath(VoltZK.leaders_initiators,partitionDir);
    try {
      byte[] partitionState=m_zk.getData(dir,null,null);
      boolean isInitializing=false;
      if (partitionState != null && partitionState.length == 1) {
        isInitializing=partitionState[0] == LeaderElector.INITIALIZING;
      }
      List<String> replicas=m_zk.getChildren(dir,null,null);
      if (!isInitializing && replicas.isEmpty()) {
        tmLog.fatal("K-Safety violation: No replicas found for partition: " + pid);
        retval=false;
      }
    }
 catch (    Exception e) {
      VoltDB.crashLocalVoltDB("Unable to read replicas in ZK dir: " + dir,true,e);
    }
  }
  return retval;
}
