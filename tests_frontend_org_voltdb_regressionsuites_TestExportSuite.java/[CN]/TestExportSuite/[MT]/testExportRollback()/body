{
  final Client client=getClient();
  final double rollbackPerc=0.15;
  long seed=(long)Math.random();
  System.out.println("TestExportRollback seed " + seed);
  java.util.Random r=new java.util.Random(seed);
  final Object[] rowdata=TestSQLTypesSuite.m_midValues;
  for (int pkey=0; pkey < 175000; pkey++) {
    if ((pkey % 1000) == 0) {
      System.out.println("Rollback test added " + pkey + " rows");
    }
    final Object[] params=convertValsToParams("ALLOW_NULLS",pkey,rowdata);
    double random=r.nextDouble();
    if (random <= rollbackPerc) {
      boolean done;
      do {
        done=client.callProcedure(new RollbackCallback(),"RollbackInsert",params);
        if (done == false) {
          client.backpressureBarrier();
        }
      }
 while (!done);
    }
 else {
      m_tester.addRow(m_tester.m_generationsSeen.last(),"ALLOW_NULLS",pkey,convertValsToRow(pkey,'I',rowdata));
      boolean done;
      do {
        done=client.callProcedure(new NullCallback(),"Insert",params);
        if (done == false) {
          client.backpressureBarrier();
        }
      }
 while (!done);
    }
  }
  client.drain();
  quiesceAndVerify(client,m_tester);
}
