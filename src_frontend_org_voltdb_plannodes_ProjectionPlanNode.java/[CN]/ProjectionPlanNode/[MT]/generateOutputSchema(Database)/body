{
  assert(m_children.size() == 1);
  m_children.get(0).generateOutputSchema(db);
  NodeSchema new_schema=new NodeSchema();
  for (  SchemaColumn col : m_outputSchema.getColumns()) {
    if (col.getExpression().getExpressionType() == ExpressionType.AGGREGATE_SUM || col.getExpression().getExpressionType() == ExpressionType.AGGREGATE_COUNT || col.getExpression().getExpressionType() == ExpressionType.AGGREGATE_COUNT_STAR || col.getExpression().getExpressionType() == ExpressionType.AGGREGATE_MIN || col.getExpression().getExpressionType() == ExpressionType.AGGREGATE_MAX || col.getExpression().getExpressionType() == ExpressionType.AGGREGATE_AVG) {
      NodeSchema input_schema=m_children.get(0).getOutputSchema();
      SchemaColumn agg_col=input_schema.find(col.getTableName(),col.getColumnName(),col.getColumnAlias());
      if (agg_col == null) {
        throw new RuntimeException("Unable to find matching " + "input column for projection: " + col.toString());
      }
      new_schema.addColumn(col.copyAndReplaceWithTVE());
    }
 else {
      new_schema.addColumn(col.clone());
    }
  }
  m_outputSchema=new_schema;
  m_hasSignificantOutputSchema=true;
  return;
}
