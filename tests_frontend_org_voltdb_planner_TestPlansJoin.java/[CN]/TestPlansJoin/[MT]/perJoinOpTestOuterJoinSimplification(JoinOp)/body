{
  AbstractPlanNode pn, n;
  AbstractExpression ex;
  pn=compile("SELECT * FROM R1 LEFT JOIN R2 ON R1.C " + joinOp + " R2.C WHERE R2.C IS NOT NULL");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertEquals(((NestLoopPlanNode)n).getJoinType(),JoinType.INNER);
  pn=compile("SELECT * FROM R1 LEFT JOIN R2 ON R1.C " + joinOp + " R2.C WHERE R2.C > 0");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertEquals(((NestLoopPlanNode)n).getJoinType(),JoinType.INNER);
  pn=compile("SELECT * FROM R1 RIGHT JOIN R2 ON R1.C " + joinOp + " R2.C WHERE R1.C > 0");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertEquals(((NestLoopPlanNode)n).getJoinType(),JoinType.INNER);
  pn=compile("SELECT * FROM R1 LEFT JOIN R3 ON R1.C " + joinOp + " R3.C WHERE R3.A > 0");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertEquals(((NestLoopPlanNode)n).getJoinType(),JoinType.INNER);
  pn=compile("SELECT * FROM R1 LEFT JOIN R3 ON R1.C " + joinOp + " R3.A WHERE R3.A > 0");
  n=pn.getChild(0).getChild(0);
  if (joinOp == JoinOp.EQUAL) {
    assertTrue(n instanceof NestLoopIndexPlanNode);
    assertEquals(((NestLoopIndexPlanNode)n).getJoinType(),JoinType.INNER);
  }
  pn=compile("SELECT * FROM R1 LEFT JOIN R2 ON R1.C " + joinOp + " R2.C WHERE ABS(R2.C) <  10");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertEquals(((NestLoopPlanNode)n).getJoinType(),JoinType.INNER);
  pn=compile("SELECT * FROM R1 RIGHT JOIN R2 ON R1.C " + joinOp + " R2.C WHERE ABS(R1.C) <  10");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertEquals(((NestLoopPlanNode)n).getJoinType(),JoinType.INNER);
  pn=compile("SELECT * FROM R1 LEFT JOIN R2 ON R1.C " + joinOp + " R2.C WHERE ABS(R1.C) <  10");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertEquals(((NestLoopPlanNode)n).getJoinType(),JoinType.LEFT);
  pn=compile("SELECT * FROM R1 RIGHT JOIN R2 ON R1.C " + joinOp + " R2.C WHERE ABS(R2.C) <  10");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertEquals(((NestLoopPlanNode)n).getJoinType(),JoinType.LEFT);
  pn=compile("SELECT * FROM R1 LEFT JOIN R2 ON R1.C " + joinOp + " R2.C WHERE ABS(R2.C) <  10 AND R1.C = 3");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertEquals(((NestLoopPlanNode)n).getJoinType(),JoinType.INNER);
  pn=compile("SELECT * FROM R1 LEFT JOIN R2 ON R1.C " + joinOp + " R2.C WHERE ABS(R2.C) <  10 OR R2.C IS NOT NULL");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertEquals(((NestLoopPlanNode)n).getJoinType(),JoinType.INNER);
  pn=compile("SELECT * FROM R1 LEFT JOIN R2 ON R1.C " + joinOp + " R2.C WHERE ABS(R1.C) <  10 AND R1.C > 3");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertEquals(((NestLoopPlanNode)n).getJoinType(),JoinType.LEFT);
  pn=compile("SELECT * FROM R1 LEFT JOIN R2 ON R1.C " + joinOp + " R2.C WHERE ABS(R1.C) <  10 OR R2.C IS NOT NULL");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertEquals(((NestLoopPlanNode)n).getJoinType(),JoinType.LEFT);
  pn=compile("SELECT R2.A, R1.* FROM R1 LEFT OUTER JOIN R2 ON R2.A " + joinOp + " R1.A WHERE R2.A > 3");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertEquals(((NestLoopPlanNode)n).getJoinType(),JoinType.INNER);
  ex=((NestLoopPlanNode)n).getWherePredicate();
  assertEquals(ex,null);
  pn=compile("SELECT R2.A, R1.* FROM R1 LEFT OUTER JOIN R2 ON R2.A " + joinOp + " R1.A WHERE R2.A IS NULL");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertEquals(((NestLoopPlanNode)n).getJoinType(),JoinType.LEFT);
  ex=((NestLoopPlanNode)n).getWherePredicate();
  assertEquals(ex instanceof OperatorExpression,true);
  pn=compile("SELECT b.A, a.* FROM R1 a LEFT OUTER JOIN R4 b ON b.A = a.A AND b.C = a.C AND a.D = b.D WHERE b.A IS NULL");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopIndexPlanNode);
  assertEquals(((NestLoopIndexPlanNode)n).getJoinType(),JoinType.LEFT);
  ex=((NestLoopIndexPlanNode)n).getWherePredicate();
  assertEquals(ex instanceof OperatorExpression,true);
  pn=compile("SELECT b.A, a.* FROM R1 a LEFT OUTER JOIN R4 b ON b.A = a.A AND b.C = a.C AND a.D = b.D WHERE b.B + b.A IS NULL");
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopIndexPlanNode);
  assertEquals(((NestLoopIndexPlanNode)n).getJoinType(),JoinType.LEFT);
  ex=((NestLoopIndexPlanNode)n).getWherePredicate();
  assertEquals(ex instanceof OperatorExpression,true);
  assertEquals(ex.getLeft() instanceof OperatorExpression,true);
  pn=compile("SELECT a.* FROM R1 a LEFT OUTER JOIN R5 b ON b.A = a.A WHERE b.A IS NULL");
  n=pn.getChild(0).getChild(0);
  assertEquals(((NestLoopIndexPlanNode)n).getJoinType(),JoinType.LEFT);
  ex=((NestLoopIndexPlanNode)n).getWherePredicate();
  assertEquals(ex instanceof OperatorExpression,true);
}
