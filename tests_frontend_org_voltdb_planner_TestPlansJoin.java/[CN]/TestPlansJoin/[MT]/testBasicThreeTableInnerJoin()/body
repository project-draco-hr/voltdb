{
  AbstractPlanNode pn=compile("select * FROM R1 JOIN R2 ON R1.C = R2.C JOIN R3 ON R3.C = R2.C",0,false,null);
  AbstractPlanNode n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertTrue(n.getChild(0) instanceof SeqScanPlanNode);
  assertTrue(n.getChild(1) instanceof NestLoopPlanNode);
  assertTrue(pn.getOutputSchema().getColumns().size() == 7);
  pn=compile("select R1.C, R2.C R3.C FROM R1 INNER JOIN R2 ON R1.C = R2.C INNER JOIN R3 ON R3.C = R2.C",0,false,null);
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertTrue(n.getChild(0) instanceof SeqScanPlanNode);
  assertTrue(n.getChild(1) instanceof NestLoopPlanNode);
  pn=compile("select C FROM R1 INNER JOIN R2 USING (C) INNER JOIN R3 USING(C)",0,false,null);
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertTrue(n.getChild(0) instanceof SeqScanPlanNode);
  assertTrue(n.getChild(1) instanceof NestLoopPlanNode);
  assertTrue(pn.getOutputSchema().getColumns().size() == 1);
  pn=compile("select C FROM R1 INNER JOIN R2 USING (C), R3 WHERE R1.A = R3.A",0,false,null);
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof NestLoopPlanNode);
  assertTrue(n.getChild(0) instanceof SeqScanPlanNode);
  assertTrue(n.getChild(1) instanceof NestLoopIndexPlanNode);
  assertTrue(pn.getOutputSchema().getColumns().size() == 1);
  try {
    List<AbstractPlanNode> pnl=aide.compile("select C, R3.C FROM R1 INNER JOIN R2 USING (C) INNER JOIN R3 ON R1.C = R3.C",0,false,null);
    fail();
  }
 catch (  PlanningErrorException ex) {
    System.out.println(ex.getMessage());
  }
}
