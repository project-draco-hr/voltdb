{
  AbstractPlanNode pn=compile("select * FROM R1 JOIN P2 ON R1.C = P2.A",0,false,null);
  AbstractPlanNode n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof ReceivePlanNode);
  pn=compile("select * FROM P1 JOIN P2 USING(A)",0,false,null);
  n=pn.getChild(0).getChild(0);
  assertTrue(n instanceof ReceivePlanNode);
  try {
    List<AbstractPlanNode> pnl=aide.compile("select * FROM P1 JOIN P2 ON P1.C = P2.E",0,false,null);
    assert(pnl != null);
    fail();
  }
 catch (  PlanningErrorException ex) {
    assertTrue("Join or union of multiple partitioned tables has insufficient join criteria.".equals(ex.getMessage()));
  }
}
