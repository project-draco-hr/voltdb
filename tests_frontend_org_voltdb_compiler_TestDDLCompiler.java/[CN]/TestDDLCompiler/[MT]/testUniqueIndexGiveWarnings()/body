{
  File jarOut=new File("checkCompilerWarnings.jar");
  jarOut.deleteOnExit();
  final String simpleProject="<?xml version=\"1.0\"?>\n" + "<project><database><schemas>" + "<schema path='%s' />"+ "</schemas></database></project>";
  String schema0="create table t0 (id bigint not null, name varchar(32) not null, age integer,  primary key (id));\n" + "CREATE UNIQUE INDEX user_index0 ON t0 (name) ;";
  String schema1="create table t0 (id bigint not null, name varchar(32) not null, age integer);\n" + "PARTITION TABLE t0 ON COLUMN id;\n" + "CREATE UNIQUE INDEX user_index1 ON t0 (id) ;";
  String schema2="create table t0 (id bigint not null, name varchar(32) not null, age integer,  primary key (id));\n" + "PARTITION TABLE t0 ON COLUMN id;\n" + "CREATE UNIQUE INDEX user_index2 ON t0 (id) ;";
  String schema3="create table t0 (id bigint not null, name varchar(32) not null, age integer,  primary key (id));\n" + "PARTITION TABLE t0 ON COLUMN id;\n" + "CREATE UNIQUE INDEX user_index3 ON t0 (id, age) ;";
  String schema4="create table t0 (id bigint not null, name varchar(32) not null, age integer,  primary key (id));\n" + "PARTITION TABLE t0 ON COLUMN id;\n" + "CREATE UNIQUE INDEX user_index4 ON t0 (id, abs(age)) ;";
  String schema6="create table t0 (id bigint not null, name varchar(32) not null, age integer,  primary key (id));\n" + "PARTITION TABLE t0 ON COLUMN name;\n" + "CREATE UNIQUE INDEX user_index6 ON t0 (name) ;";
  String schema7="create table t0 (id bigint not null, name varchar(32) not null, age integer);\n" + "PARTITION TABLE t0 ON COLUMN id;\n" + "CREATE UNIQUE INDEX user_index7 ON t0 (name) ;";
  String schema8="create table t0 (id bigint not null, name varchar(32), age integer,  primary key (id));\n" + "PARTITION TABLE t0 ON COLUMN id;\n" + "CREATE UNIQUE INDEX user_index8 ON t0 (name) ;";
  String schema9="create table t0 (id bigint not null, name varchar(32), age integer,  primary key (id));\n" + "PARTITION TABLE t0 ON COLUMN id;\n" + "CREATE UNIQUE INDEX user_index9 ON t0 (abs(age)) ;";
  String schema10="create table t0 (id bigint not null, name varchar(32) not null, age integer,  primary key (id));\n" + "PARTITION TABLE t0 ON COLUMN name;\n" + "CREATE UNIQUE INDEX user_index10 ON t0 (substr(name, 1, 2 )) ;";
  String schema12="create table t0 (id bigint not null, name varchar(32) not null, age integer,  primary key (id));\n" + "PARTITION TABLE t0 ON COLUMN name;\n" + "CREATE UNIQUE INDEX user_index12 ON t0 (age) ;";
  String[] schemas={schema0,schema1,schema2,schema3,schema4,schema6,schema7,schema8,schema9,schema10,schema12};
  int[] expected={0,0,0,0,0,1,1,1,1,2,2};
  for (int i=0; i < schemas.length; i++) {
    String schema=schemas[i];
    File schemaFile=VoltProjectBuilder.writeStringToTempFile(schema);
    String schemaPath=schemaFile.getPath();
    File projectFile=VoltProjectBuilder.writeStringToTempFile(String.format(simpleProject,schemaPath));
    String projectPath=projectFile.getPath();
    VoltCompiler compiler=new VoltCompiler();
    boolean success=compiler.compileWithProjectXML(projectPath,jarOut.getPath());
    assertTrue(success);
    int foundWarnings=0;
    for (    VoltCompiler.Feedback f : compiler.m_warnings) {
      if (f.message.toLowerCase().contains("does not include the partitioning column")) {
        foundWarnings++;
      }
    }
    assertEquals(expected[i],foundWarnings);
    jarOut.delete();
  }
}
