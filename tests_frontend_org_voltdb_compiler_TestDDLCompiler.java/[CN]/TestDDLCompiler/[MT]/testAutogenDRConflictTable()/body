{
  File jarOut=new File("setDatabaseConfig.jar");
  jarOut.deleteOnExit();
  VoltCompiler compiler=new VoltCompiler();
  File schemaFile=VoltProjectBuilder.writeStringToTempFile("SET " + DatabaseConfiguration.DR_MODE_NAME + "="+ DatabaseConfiguration.ACTIVE_ACTIVE+ ";\n"+ "CREATE TABLE T (D1 INTEGER NOT NULL, D2 INTEGER, D3 VARCHAR(32), VAL1 INTEGER, VAL2 INTEGER, VAL3 INTEGER, PRIMARY KEY (D1), LIMIT PARTITION ROWS 1000);\n"+ "DR TABLE T;\n"+ "PARTITION TABLE T ON COLUMN D1;\n");
  String schemaPath=schemaFile.getPath();
  try {
    assertTrue(compiler.compileFromDDL(jarOut.getPath(),schemaPath));
    Table t=compiler.getCatalogDatabase().getTables().get(CatalogUtil.DR_CONFLICTS_TABLE_PREFIX + "T");
    assertNotNull(t);
    assertNotNull(t.getColumns().get("VOLTDB_AUTOGEN_TABLE_NAME"));
    assertNotNull(t.getColumns().get("VOLTDB_AUTOGEN_CLUSTER_ID"));
    assertNotNull(t.getColumns().get("VOLTDB_AUTOGEN_TIMESTAMP"));
    assertNotNull(t.getColumns().get("VOLTDB_AUTOGEN_OPERATION_TYPE"));
    assertNotNull(t.getColumns().get("D1"));
    assertNotNull(t.getColumns().get("D2"));
    assertNotNull(t.getColumns().get("D3"));
    assertNotNull(t.getColumns().get("VAL1"));
    assertNotNull(t.getColumns().get("VAL2"));
    assertNotNull(t.getColumns().get("VAL3"));
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
  jarOut.delete();
}
