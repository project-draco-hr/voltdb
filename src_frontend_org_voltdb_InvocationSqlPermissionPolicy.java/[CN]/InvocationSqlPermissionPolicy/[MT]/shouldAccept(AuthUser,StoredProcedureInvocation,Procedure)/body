{
  if (proc.getSystemproc() && invocation.procName.startsWith("@AdHoc_RW")) {
    if (user.hasPermission(Permission.SQL)) {
      return PolicyResult.ALLOW;
    }
    return PolicyResult.DENY;
  }
  if (proc.getSystemproc() && invocation.procName.startsWith("@AdHoc") && !invocation.procName.startsWith("@AdHoc_RW")) {
    if (user.hasPermission(Permission.SQLREAD) || user.hasPermission(Permission.SQL)) {
      return PolicyResult.ALLOW;
    }
    return PolicyResult.DENY;
  }
  return PolicyResult.NOT_APPLICABLE;
}
