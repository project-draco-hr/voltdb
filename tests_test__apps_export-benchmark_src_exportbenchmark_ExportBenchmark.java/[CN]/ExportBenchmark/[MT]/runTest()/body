{
  System.out.println("Test initialization");
  VoltBulkLoader bulkLoader=null;
  try {
    client.createConnection("localhost");
    bulkLoader=client.getNewBulkLoader("valuesToExport",50,new ExportBenchmarkCallback());
  }
 catch (  Exception e) {
    System.err.printf("Connection to VoltDB failed\n" + e.getMessage());
    System.exit(1);
  }
  System.out.println("Initialization complete");
  long startTime=System.nanoTime();
  try {
    System.out.println("Inserting objects");
    Object rowHandle=null;
    for (int i=0; i < 1000000; i++) {
      bulkLoader.insertRow(rowHandle,i,42);
    }
    bulkLoader.drain();
    System.out.println("Object insertion complete");
  }
 catch (  Exception e) {
    System.err.println("Couldn't insert into VoltDB\n" + e.getMessage());
    System.exit(1);
  }
  try {
    while (true) {
      VoltTable results=client.callProcedure("@Statistics","TABLE",0).getResults()[0];
      results.advanceRow();
      if (results.getLong("TUPLE_COUNT") == 1000000) {
        break;
      }
      Thread.sleep(100);
    }
  }
 catch (  Exception e) {
    System.err.println("Unable to analyze export table");
    System.err.println(e.getMessage());
    System.exit(1);
  }
  long estimatedTime=System.nanoTime() - startTime;
  System.out.println("Export time elapsed (ms) for 1,000,000 objects: " + estimatedTime / 1000000);
}
