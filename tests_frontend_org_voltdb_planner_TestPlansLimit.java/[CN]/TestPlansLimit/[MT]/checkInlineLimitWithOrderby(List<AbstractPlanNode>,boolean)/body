{
  AbstractPlanNode p;
  p=pns.get(0).getChild(0);
  assertTrue(p instanceof ProjectionPlanNode);
  p=p.getChild(0);
  boolean mergereceive=false;
  if (p instanceof ReceivePlanNode) {
    assertTrue(((ReceivePlanNode)p).isMergeReceive());
    assertNotNull(p.getInlinePlanNode(PlanNodeType.ORDERBY));
    mergereceive=true;
  }
 else {
    assertTrue(p instanceof OrderByPlanNode);
  }
  if (mergereceive) {
    AbstractPlanNode aggr=AggregatePlanNode.getInlineAggregationNode(p);
    if (aggr != null) {
      assertNotNull(aggr.getInlinePlanNode(PlanNodeType.LIMIT));
    }
  }
 else {
    assertNotNull(p.getInlinePlanNode(PlanNodeType.LIMIT));
  }
  if (pushdown) {
    assertEquals(2,pns.size());
    p=pns.get(1).getChild(0);
    assertTrue(p instanceof OrderByPlanNode);
    assertNotNull(p.getInlinePlanNode(PlanNodeType.LIMIT));
  }
 else   if (pns.size() == 2) {
    p=pns.get(1).getChild(0);
    assertFalse(p.toExplainPlanString().toLowerCase().contains("limit"));
  }
}
