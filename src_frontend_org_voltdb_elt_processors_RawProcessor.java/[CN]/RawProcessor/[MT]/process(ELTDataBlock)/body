{
  if (block.isStopMessage()) {
    m_logger.info("Received stop message. Stopping processor.");
    while (m_connection.writeStream().isEmpty() == false) {
    }
    VoltDB.instance().getNetwork().unregisterChannel(m_connection);
    return true;
  }
 else {
    m_logger.debug("Sending block (" + block.m_data.b.remaining() + " bytes) to write stream.");
    return m_connection.writeStream().enqueue(new BlockSerializer(m_logger,block));
  }
}
