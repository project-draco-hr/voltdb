{
  if (isHSQL())   return;
  Client client=getClient();
  VoltTable vt;
  vt=client.callProcedure("CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,1,0,"important",17000).getResults()[0];
  assertTablesAreEqual("Insert 1 ",new Object[][]{{1}},vt);
  vt=client.callProcedure("CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,2,0,"important",17000).getResults()[0];
  assertTablesAreEqual("Insert 2 ",new Object[][]{{1}},vt);
  vt=client.callProcedure("CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,3,0,"important",17000).getResults()[0];
  assertTablesAreEqual("Insert 3 ",new Object[][]{{1}},vt);
  verifyProcFails(client,"exceeds table maximum row count 3","CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,4,0,"important",17000);
  ClientResponse cr=client.callProcedure("@AdHoc","ALTER TABLE CAPPED3_LIMIT_EXEC_COMPLEX " + "ADD LIMIT PARTITION ROWS 3 " + "EXECUTE (DELETE FROM CAPPED3_LIMIT_EXEC_COMPLEX WHERE WAGE = 37)");
  assertEquals(ClientResponse.SUCCESS,cr.getStatus());
  vt=client.callProcedure("CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,4,0,"important",17000).getResults()[0];
  assertTablesAreEqual("Insert 4 ",new Object[][]{{1}},vt);
  vt=client.callProcedure("CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,5,0,"important",17000).getResults()[0];
  assertTablesAreEqual("Insert 5 ",new Object[][]{{1}},vt);
  vt=client.callProcedure("CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,6,0,"important",17000).getResults()[0];
  assertTablesAreEqual("Insert 6 ",new Object[][]{{1}},vt);
  cr=client.callProcedure("@AdHoc","ALTER TABLE CAPPED3_LIMIT_EXEC_COMPLEX " + "ADD LIMIT PARTITION ROWS 3");
  assertEquals(ClientResponse.SUCCESS,cr.getStatus());
  vt=client.callProcedure("@AdHoc","select count(*) from capped3_limit_exec_complex").getResults()[0];
  assertTablesAreEqual("count check ",new Object[][]{{3}},vt);
  verifyProcFails(client,"exceeds table maximum row count 3","CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,7,0,"important",17000);
  cr=client.callProcedure("@AdHoc","ALTER TABLE CAPPED3_LIMIT_EXEC_COMPLEX " + "DROP LIMIT PARTITION ROWS");
  assertEquals(ClientResponse.SUCCESS,cr.getStatus());
  vt=client.callProcedure("CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,7,0,"important",17000).getResults()[0];
  assertTablesAreEqual("Insert 7 ",new Object[][]{{1}},vt);
  cr=client.callProcedure("@AdHoc","ALTER TABLE CAPPED3_LIMIT_EXEC_COMPLEX " + "ADD LIMIT PARTITION ROWS 3 " + "EXECUTE (DELETE FROM CAPPED3_LIMIT_EXEC_COMPLEX WHERE DEPT IN (4, 7))");
  assertEquals(ClientResponse.SUCCESS,cr.getStatus());
  vt=client.callProcedure("CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,8,0,"important",17000).getResults()[0];
  assertTablesAreEqual("Insert 8 ",new Object[][]{{1}},vt);
  vt=client.callProcedure("@AdHoc","select dept from capped3_limit_exec_complex order by dept asc").getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{5,6,8});
}
