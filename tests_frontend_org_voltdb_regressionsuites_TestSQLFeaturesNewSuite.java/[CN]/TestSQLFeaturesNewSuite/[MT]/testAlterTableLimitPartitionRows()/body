{
  if (isHSQL())   return;
  Client client=getClient();
  VoltTable vt;
  vt=client.callProcedure("CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,1,0,"important",17000).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{1});
  vt=client.callProcedure("CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,2,0,"important",17000).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{1});
  vt=client.callProcedure("CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,3,0,"important",17000).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{1});
  verifyProcFails(client,"exceeds table maximum row count 3","CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,4,0,"important",17000);
  ClientResponse cr=client.callProcedure("@AdHoc","ALTER TABLE CAPPED3_LIMIT_EXEC_COMPLEX " + "ADD LIMIT PARTITION ROWS 3 " + "EXECUTE (DELETE FROM CAPPED3_LIMIT_EXEC_COMPLEX WHERE WAGE = 37)");
  assertEquals(ClientResponse.SUCCESS,cr.getStatus());
  vt=client.callProcedure("CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,4,0,"important",17000).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{1});
  vt=client.callProcedure("CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,5,0,"important",17000).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{1});
  vt=client.callProcedure("CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,6,0,"important",17000).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{1});
  cr=client.callProcedure("@AdHoc","ALTER TABLE CAPPED3_LIMIT_EXEC_COMPLEX " + "ADD LIMIT PARTITION ROWS 3");
  assertEquals(ClientResponse.SUCCESS,cr.getStatus());
  vt=client.callProcedure("@AdHoc","select count(*) from capped3_limit_exec_complex").getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{3});
  verifyProcFails(client,"exceeds table maximum row count 3","CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,7,0,"important",17000);
  cr=client.callProcedure("@AdHoc","ALTER TABLE CAPPED3_LIMIT_EXEC_COMPLEX " + "DROP LIMIT PARTITION ROWS");
  assertEquals(ClientResponse.SUCCESS,cr.getStatus());
  vt=client.callProcedure("CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,7,0,"important",17000).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{1});
  cr=client.callProcedure("@AdHoc","ALTER TABLE CAPPED3_LIMIT_EXEC_COMPLEX " + "ADD LIMIT PARTITION ROWS 3 " + "EXECUTE (DELETE FROM CAPPED3_LIMIT_EXEC_COMPLEX WHERE DEPT IN (4, 7))");
  assertEquals(ClientResponse.SUCCESS,cr.getStatus());
  vt=client.callProcedure("CAPPED3_LIMIT_EXEC_COMPLEX.insert",37,8,0,"important",17000).getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{1});
  vt=client.callProcedure("@AdHoc","select dept from capped3_limit_exec_complex order by dept asc").getResults()[0];
  validateTableOfScalarLongs(vt,new long[]{5,6,8});
}
