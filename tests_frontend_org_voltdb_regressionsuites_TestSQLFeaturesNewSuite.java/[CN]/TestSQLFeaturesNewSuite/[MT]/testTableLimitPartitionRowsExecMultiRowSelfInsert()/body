{
  if (isHSQL())   return;
  Client client=getClient();
  client.callProcedure("CAPPED3_LIMIT_ROWS_EXEC.insert",1,10,20);
  client.callProcedure("CAPPED3_LIMIT_ROWS_EXEC.insert",1,20,40);
  client.callProcedure("CAPPED3_LIMIT_ROWS_EXEC.insert",1,30,60);
  String stmt="INSERT INTO CAPPED3_LIMIT_ROWS_EXEC " + "SELECT purge_me, wage + 1, dept from CAPPED3_LIMIT_ROWS_EXEC WHERE WAGE = 20";
  verifyStmtFails(client,stmt,"Since the table being insert into has a row limit " + "trigger, the SELECT output must be ordered.");
  stmt+=" ORDER BY purge_me, wage, dept";
  validateTableOfScalarLongs(client,stmt,new long[]{1});
  String selectAll="SELECT * FROM CAPPED3_LIMIT_ROWS_EXEC ORDER BY WAGE";
  VoltTable vt=client.callProcedure("@AdHoc",selectAll).getResults()[0];
  validateTableOfLongs(vt,new long[][]{{1,21,40}});
  client.callProcedure("CAPPED3_LIMIT_ROWS_EXEC.insert",1,40,80);
  client.callProcedure("CAPPED3_LIMIT_ROWS_EXEC.insert",1,50,100);
  validateTableOfScalarLongs(client,"UPSERT INTO CAPPED3_LIMIT_ROWS_EXEC " + "SELECT purge_me, wage + 10, ((wage + 10) * 2) + 5 from CAPPED3_LIMIT_ROWS_EXEC " + "ORDER BY 1, 2, 3",new long[]{3});
  vt=client.callProcedure("@AdHoc",selectAll).getResults()[0];
  validateTableOfLongs(vt,new long[][]{{1,31,67},{1,50,105},{1,60,125}});
}
