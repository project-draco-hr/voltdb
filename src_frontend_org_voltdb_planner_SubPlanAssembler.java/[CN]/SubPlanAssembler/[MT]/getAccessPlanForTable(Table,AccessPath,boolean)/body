{
  assert(table != null);
  assert(path != null);
  AbstractScanPlanNode scanNode=null;
  if (path.index == null) {
    scanNode=getScanAccessPlanForTable(table,path.otherExprs);
  }
 else {
    scanNode=getIndexAccessPlanForTable(table,path);
  }
  if (m_parsedStmt.scanColumns != null) {
    scanNode.setScanColumns(m_parsedStmt.scanColumns.get(table.getTypeName()));
  }
  scanNode.generateOutputSchema(m_db);
  AbstractPlanNode rootNode=scanNode;
  if (tableRequiresDistributedScan(table) && needDistributedScan) {
    rootNode=addSendReceivePair(scanNode);
  }
  return rootNode;
}
