{
  Index index=path.index;
  IndexScanPlanNode scanNode=new IndexScanPlanNode();
  for (  AbstractExpression expr : path.indexExprs) {
    AbstractExpression expr2=TupleValueExpression.getOtherTableExpression(expr,table);
    assert(expr2 != null);
    scanNode.addSearchKeyExpression(expr2);
  }
  scanNode.setCatalogIndex(index);
  scanNode.setKeyIterate(path.keyIterate);
  scanNode.setLookupType(path.lookupType);
  scanNode.setBindings(path.bindings);
  scanNode.setSortDirection(path.sortDirection);
  scanNode.setTargetTableName(table.getTypeName());
  scanNode.setTargetTableAlias(table.getTypeName());
  scanNode.setTargetIndexName(index.getTypeName());
  if (path.sortDirection != SortDirectionType.DESC) {
    List<AbstractExpression> predicate=new ArrayList<AbstractExpression>();
    predicate.addAll(path.indexExprs);
    predicate.addAll(path.otherExprs);
    scanNode.setPredicate(ExpressionUtil.combine(predicate));
    scanNode.setEndExpression(ExpressionUtil.combine(path.endExprs));
  }
 else {
    List<AbstractExpression> predicate=new ArrayList<AbstractExpression>();
    predicate.addAll(path.indexExprs);
    predicate.addAll(path.endExprs);
    predicate.addAll(path.otherExprs);
    scanNode.setPredicate(ExpressionUtil.combine(predicate));
  }
  return scanNode;
}
