{
  List<AbstractExpression> filtersToCover=new ArrayList<AbstractExpression>();
  filtersToCover.addAll(exprs);
  String exprsjson=index.getExpressionsjson();
  List<AbstractExpression> indexedExprs=null;
  List<ColumnRef> indexedColRefs=null;
  int[] indexedColIds=null;
  int keyComponentCount;
  if (exprsjson.isEmpty()) {
    indexedColRefs=CatalogUtil.getSortedCatalogItems(index.getColumns(),"index");
    keyComponentCount=indexedColRefs.size();
    indexedColIds=new int[keyComponentCount];
    int ii=0;
    for (    ColumnRef cr : indexedColRefs) {
      indexedColIds[ii++]=cr.getColumn().getIndex();
    }
  }
 else {
    try {
      indexedExprs=AbstractExpression.fromJSONArrayString(exprsjson,null);
      keyComponentCount=indexedExprs.size();
    }
 catch (    JSONException e) {
      e.printStackTrace();
      assert(false);
      return null;
    }
  }
  AccessPath retval=new AccessPath();
  retval.use=IndexUseType.COVERING_UNIQUE_EQUALITY;
  retval.index=index;
  int orderSpoilers[]=new int[keyComponentCount];
  List<AbstractExpression> bindingsForOrder=new ArrayList<AbstractExpression>();
  int nSpoilers=determineIndexOrdering(table,keyComponentCount,indexedExprs,indexedColRefs,retval,orderSpoilers,bindingsForOrder);
  int coveredCount=0;
  int nRecoveredSpoilers=0;
  AbstractExpression coveringExpr=null;
  int coveringColId=-1;
  IndexableExpression inListExpr=null;
  for (; coveredCount < keyComponentCount; ++coveredCount) {
    if (indexedExprs == null) {
      coveringColId=indexedColIds[coveredCount];
    }
 else {
      coveringExpr=indexedExprs.get(coveredCount);
    }
    boolean allowIndexedJoinFilters=(inListExpr == null);
    IndexableExpression eqExpr=getIndexableExpressionFromFilters(ExpressionType.COMPARE_EQUAL,ExpressionType.COMPARE_EQUAL,coveringExpr,coveringColId,table,filtersToCover,allowIndexedJoinFilters,EXCLUDE_FROM_POST_FILTERS);
    if (eqExpr == null) {
      if (inListExpr == null) {
        inListExpr=getIndexableExpressionFromFilters(ExpressionType.COMPARE_IN,ExpressionType.COMPARE_IN,coveringExpr,coveringColId,table,filtersToCover,false,EXCLUDE_FROM_POST_FILTERS);
        if (inListExpr != null) {
          for (          AbstractExpression comparator : retval.indexExprs) {
            AbstractExpression otherExpr=comparator.getRight();
            if (otherExpr.hasAnySubexpressionOfType(ExpressionType.VALUE_TUPLE)) {
              inListExpr=null;
              break;
            }
          }
          eqExpr=inListExpr;
        }
      }
      if (eqExpr == null) {
        break;
      }
    }
    AbstractExpression comparator=eqExpr.getFilter();
    retval.indexExprs.add(comparator);
    retval.bindings.addAll(eqExpr.getBindings());
    retval.endExprs.add(comparator);
    if (nRecoveredSpoilers < nSpoilers && orderSpoilers[nRecoveredSpoilers] == coveredCount) {
      if (eqExpr != inListExpr) {
        ++nRecoveredSpoilers;
      }
    }
  }
  if (coveredCount == keyComponentCount) {
    retval.otherExprs.addAll(filtersToCover);
    if (retval.sortDirection != SortDirectionType.INVALID) {
      retval.bindings.addAll(bindingsForOrder);
    }
    return retval;
  }
  if (!IndexType.isScannable(index.getType())) {
    return null;
  }
  if (nRecoveredSpoilers < nSpoilers) {
    assert(retval.sortDirection != SortDirectionType.INVALID);
    List<AbstractExpression> otherBindingsForOrder=recoverOrderSpoilers(orderSpoilers,nSpoilers,nRecoveredSpoilers,indexedExprs,indexedColIds,table,filtersToCover);
    if (otherBindingsForOrder == null) {
      retval.sortDirection=SortDirectionType.INVALID;
      bindingsForOrder.clear();
    }
 else {
      bindingsForOrder.addAll(otherBindingsForOrder);
    }
  }
  IndexableExpression startingBoundExpr=null;
  IndexableExpression endingBoundExpr=null;
  if (!filtersToCover.isEmpty()) {
    IndexableExpression doubleBoundExpr=getIndexableExpressionFromFilters(ExpressionType.COMPARE_LIKE,ExpressionType.COMPARE_LIKE,coveringExpr,coveringColId,table,filtersToCover,false,EXCLUDE_FROM_POST_FILTERS);
    if (doubleBoundExpr != null) {
      startingBoundExpr=doubleBoundExpr.extractStartFromPrefixLike();
      endingBoundExpr=doubleBoundExpr.extractEndFromPrefixLike();
    }
 else {
      boolean allowIndexedJoinFilters=(inListExpr == null);
      startingBoundExpr=getIndexableExpressionFromFilters(ExpressionType.COMPARE_GREATERTHAN,ExpressionType.COMPARE_GREATERTHANOREQUALTO,coveringExpr,coveringColId,table,filtersToCover,allowIndexedJoinFilters,EXCLUDE_FROM_POST_FILTERS);
      endingBoundExpr=getIndexableExpressionFromFilters(ExpressionType.COMPARE_LESSTHAN,ExpressionType.COMPARE_LESSTHANOREQUALTO,coveringExpr,coveringColId,table,filtersToCover,allowIndexedJoinFilters,EXCLUDE_FROM_POST_FILTERS);
    }
  }
  if (startingBoundExpr != null) {
    AbstractExpression comparator=startingBoundExpr.getFilter();
    retval.indexExprs.add(comparator);
    retval.bindings.addAll(startingBoundExpr.getBindings());
    if (comparator.getExpressionType() == ExpressionType.COMPARE_GREATERTHAN) {
      retval.lookupType=IndexLookupType.GT;
    }
 else {
      assert(comparator.getExpressionType() == ExpressionType.COMPARE_GREATERTHANOREQUALTO);
      retval.lookupType=IndexLookupType.GTE;
    }
    retval.use=IndexUseType.INDEX_SCAN;
  }
  if (endingBoundExpr != null) {
    AbstractExpression comparator=endingBoundExpr.getFilter();
    retval.use=IndexUseType.INDEX_SCAN;
    retval.bindings.addAll(endingBoundExpr.getBindings());
    if (startingBoundExpr != null) {
      retval.endExprs.add(comparator);
    }
 else {
      if (comparator.getExpressionType() == ExpressionType.COMPARE_LESSTHAN) {
        retval.lookupType=IndexLookupType.LT;
      }
 else       if (comparator.getExpressionType() == ExpressionType.COMPARE_LESSTHANOREQUALTO) {
        retval.lookupType=IndexLookupType.LTE;
      }
      if (retval.lookupType == IndexLookupType.EQ) {
        retval.lookupType=IndexLookupType.GTE;
        retval.endExprs.add(comparator);
      }
 else {
        retval.indexExprs.add(comparator);
        retval.otherExprs.add(comparator);
        AbstractExpression newComparator=new OperatorExpression(ExpressionType.OPERATOR_NOT,new OperatorExpression(ExpressionType.OPERATOR_IS_NULL),null);
        newComparator.getLeft().setLeft(comparator.getLeft());
        newComparator.finalizeValueTypes();
        retval.otherExprs.add(newComparator);
        retval.initialExpr.addAll(retval.indexExprs);
        retval.sortDirection=SortDirectionType.DESC;
      }
    }
  }
  if (retval.indexExprs.size() == 0 && retval.endExprs.size() == 0 && retval.sortDirection == SortDirectionType.INVALID) {
    return null;
  }
  if (retval.indexExprs.size() < keyComponentCount) {
    if (retval.use == IndexUseType.COVERING_UNIQUE_EQUALITY) {
      retval.use=IndexUseType.INDEX_SCAN;
      retval.lookupType=IndexLookupType.GTE;
    }
 else     if (retval.lookupType == IndexLookupType.GT) {
      AbstractExpression comparator=startingBoundExpr.getOriginalFilter();
      retval.otherExprs.add(comparator);
    }
  }
  retval.otherExprs.addAll(filtersToCover);
  if (retval.sortDirection != SortDirectionType.INVALID) {
    retval.bindings.addAll(bindingsForOrder);
  }
  return retval;
}
