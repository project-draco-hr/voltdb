{
  if (expr == null)   return null;
  if ((expr.getExpressionType() != ExpressionType.COMPARE_EQUAL) && (expr.getExpressionType() != ExpressionType.COMPARE_GREATERTHAN) && (expr.getExpressionType() != ExpressionType.COMPARE_GREATERTHANOREQUALTO)&& (expr.getExpressionType() != ExpressionType.COMPARE_LESSTHAN)&& (expr.getExpressionType() != ExpressionType.COMPARE_LESSTHANOREQUALTO)) {
    return null;
  }
  AbstractExpression indexableExpr=null;
  boolean indexableOnLeft=isIndexableFilterOperand(table,expr.getLeft());
  boolean indexableOnRight=isIndexableFilterOperand(table,expr.getRight());
  if (indexableOnLeft && indexableOnRight) {
    return null;
  }
  VoltType otherType=null;
  ComparisonExpression normalizedExpr=(ComparisonExpression)expr;
  if (indexableOnLeft) {
    if (isOperandDependentOnTable(table,expr.getRight())) {
      return null;
    }
    indexableExpr=expr.getLeft();
    otherType=expr.getRight().getValueType();
  }
 else {
    if (isOperandDependentOnTable(table,expr.getLeft())) {
      return null;
    }
    indexableExpr=expr.getRight();
    normalizedExpr=normalizedExpr.reverseOperator();
    otherType=expr.getLeft().getValueType();
  }
  VoltType keyType=indexableExpr.getValueType();
  if (!keyType.canExactlyRepresentAnyValueOf(otherType)) {
    return null;
  }
  return normalizedExpr;
}
