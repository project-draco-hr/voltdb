{
  HostMessenger messenger=(HostMessenger)VoltDB.instance().getMessenger();
  int hostId=messenger.getHostId();
  Object[] oparams=params.toArray();
  VoltTable depResult=null;
  if (fragmentId == SysProcFragmentId.PF_rejoinPrepare) {
    int rejoinHostId=(Integer)oparams[0];
    String rejoiningHostName=(String)oparams[1];
    int portToConnect=(Integer)oparams[2];
    depResult=phaseOnePrepare(hostId,rejoinHostId,rejoiningHostName,portToConnect,context.getExecutionSite().m_context.siteTracker.getAllLiveHosts());
    return new DependencyPair(DEP_rejoinAllNodeWork,depResult);
  }
 else   if (fragmentId == SysProcFragmentId.PF_rejoinCommit) {
    int rejoinHostId=(Integer)oparams[0];
    depResult=phaseThreeCommit(rejoinHostId,context);
    return new DependencyPair(DEP_rejoinAllNodeWork,depResult);
  }
 else   if (fragmentId == SysProcFragmentId.PF_rejoinRollback) {
    depResult=phaseThreeRollback(hostId);
    return new DependencyPair(DEP_rejoinAllNodeWork,depResult);
  }
 else   if (fragmentId == SysProcFragmentId.PF_rejoinAggregate) {
    depResult=aggregateResults(dependencies.get(DEP_rejoinAllNodeWork));
    return new DependencyPair(DEP_rejoinAggregate,depResult);
  }
 else {
    assert(false);
    return null;
  }
}
