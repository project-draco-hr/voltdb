{
  String type=stmtNode.attributes.get("uniontype");
  m_unionType=UnionType.valueOf(type);
  assert(stmtNode.children.size() == m_children.size());
  HashSet<Table> tableSet=new HashSet<Table>();
  int i=0;
  for (  VoltXMLElement selectSQL : stmtNode.children) {
    AbstractParsedStmt nextSelectStmt=m_children.get(i++);
    nextSelectStmt.parse(selectSQL,db);
    if (nextSelectStmt.scanColumns != null) {
      Set<String> tableNames=nextSelectStmt.scanColumns.keySet();
      HashSet<Table> nextTableSet=new HashSet<Table>();
      nextTableSet.addAll(nextSelectStmt.tableList);
      Iterator<Table> it=nextTableSet.iterator();
      while (it.hasNext()) {
        Table next=it.next();
        if (!tableNames.contains(next.getTypeName())) {
          it.remove();
        }
      }
      nextSelectStmt.tableList.clear();
      nextSelectStmt.tableList.addAll(nextTableSet);
      tableSet.addAll(nextTableSet);
    }
 else {
      throw new RuntimeException("Select * is not supported within the UNION statement");
    }
  }
  tableList.clear();
  tableList.addAll(tableSet);
}
