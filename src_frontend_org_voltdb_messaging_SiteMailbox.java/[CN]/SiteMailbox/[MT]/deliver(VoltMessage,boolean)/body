{
  assert(message != null);
  message.receivedFromSiteId=m_siteId;
  if (m_doLogging) {
    if (message instanceof InitiateTaskMessage) {
      InitiateTaskMessage msg=(InitiateTaskMessage)message;
      if (!msg.isReadOnly()) {
        m_log.log(msg);
      }
    }
 else     if (message instanceof HeartbeatMessage) {
      HeartbeatMessage msg=(HeartbeatMessage)message;
      m_log.logHeartbeat(msg.getTxnId());
    }
  }
  final Deque<VoltMessage> dq=m_messages.get(message.getSubject());
synchronized (this) {
    if (toFront) {
      dq.offerFirst(message);
    }
 else {
      dq.offer(message);
    }
    this.notify();
  }
}
