{
  return m_es.submit(new Runnable(){
    @Override public void run(){
      try {
        m_committedBuffers.truncateToTxnId(txnId,m_nullArrayLength);
        if (m_committedBuffers.isEmpty() && m_endOfStream) {
          try {
            if (m_pollFuture != null) {
              m_pollFuture.set(null);
              m_pollFuture=null;
            }
            if (m_onDrain != null) {
              m_onDrain.run();
            }
          }
  finally {
            m_onDrain=null;
          }
        }
      }
 catch (      IOException e) {
        VoltDB.crashLocalVoltDB("Error while trying to truncate export to txnid " + txnId,true,e);
      }
    }
  }
);
}
