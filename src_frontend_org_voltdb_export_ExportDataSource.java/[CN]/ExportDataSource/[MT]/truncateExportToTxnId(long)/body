{
  try {
synchronized (m_committedBuffers) {
      m_committedBuffers.truncateToTxnId(txnId,m_nullArrayLength);
      if (m_committedBuffers.isEmpty() && m_endOfStream) {
        try {
          m_onDrain.run();
        }
  finally {
          m_onDrain=null;
        }
      }
    }
  }
 catch (  IOException e) {
    exportLog.fatal(e);
    VoltDB.crashVoltDB();
  }
}
