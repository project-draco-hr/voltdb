{
  if (m_es.isShutdown()) {
    return Futures.immediateFuture(null);
  }
  return m_es.submit((new Runnable(){
    @Override public void run(){
      try {
        m_committedBuffers.truncateToTxnId(txnId,m_nullArrayLength);
        if (m_committedBuffers.isEmpty() && m_endOfStream) {
          if (m_pollFuture != null) {
            m_pollFuture.set(null);
            m_pollFuture=null;
          }
          if (m_onDrain != null) {
            m_onDrain.run();
          }
        }
      }
 catch (      Throwable t) {
        VoltDB.crashLocalVoltDB("Error while trying to truncate export to txnid " + txnId,true,t);
      }
    }
  }
));
}
