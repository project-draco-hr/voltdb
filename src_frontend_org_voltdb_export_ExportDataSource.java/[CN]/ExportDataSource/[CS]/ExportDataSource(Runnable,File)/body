{
  m_onDrain=onDrain;
  String overflowPath=adFile.getParent();
  FileInputStream fis=new FileInputStream(adFile);
  byte data[]=new byte[(int)adFile.length()];
  int read=fis.read(data);
  if (read != data.length) {
    throw new IOException("Failed to read ad file " + adFile);
  }
  FastDeserializer fds=new FastDeserializer(data);
  m_siteId=fds.readInt();
  m_database=fds.readString();
  m_partitionId=fds.readInt();
  m_signature=fds.readString();
  m_tableName=fds.readString();
  fds.readLong();
  int numColumns=fds.readInt();
  for (int ii=0; ii < numColumns; ++ii) {
    m_columnNames.add(fds.readString());
    m_columnTypes.add(fds.readInt());
  }
  String nonce=m_signature + "_" + m_siteId+ "_"+ m_partitionId;
  m_committedBuffers=new StreamBlockQueue(overflowPath,nonce);
}
