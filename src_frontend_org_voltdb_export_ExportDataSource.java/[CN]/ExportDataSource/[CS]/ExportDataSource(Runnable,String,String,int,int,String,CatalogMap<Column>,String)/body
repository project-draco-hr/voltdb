{
  m_onDrain=onDrain;
  m_database=db;
  m_tableName=tableName;
  String nonce=signature + "_" + siteId+ "_"+ partitionId;
  m_committedBuffers=new StreamBlockQueue(overflowPath,nonce);
  m_signature=signature;
  m_partitionId=partitionId;
  m_siteId=siteId;
  m_columnNames.add("VOLT_TRANSACTION_ID");
  m_columnTypes.add(((int)VoltType.BIGINT.getValue()));
  m_columnNames.add("VOLT_EXPORT_TIMESTAMP");
  m_columnTypes.add(((int)VoltType.BIGINT.getValue()));
  m_columnNames.add("VOLT_EXPORT_SEQUENCE_NUMBER");
  m_columnTypes.add(((int)VoltType.BIGINT.getValue()));
  m_columnNames.add("VOLT_PARTITION_ID");
  m_columnTypes.add(((int)VoltType.BIGINT.getValue()));
  m_columnNames.add("VOLT_SITE_ID");
  m_columnTypes.add(((int)VoltType.BIGINT.getValue()));
  m_columnNames.add("VOLT_EXPORT_OPERATION");
  m_columnTypes.add(((int)VoltType.TINYINT.getValue()));
  for (  Column c : CatalogUtil.getSortedCatalogItems(catalogMap,"index")) {
    m_columnNames.add(c.getName());
    m_columnTypes.add(c.getType());
  }
  File adFile=new VoltFile(overflowPath,nonce + ".ad");
  exportLog.info("Creating ad for " + nonce);
  assert(!adFile.exists());
  FastSerializer fs=new FastSerializer();
  fs.writeInt(m_siteId);
  fs.writeString(m_database);
  writeAdvertisementTo(fs);
  FileOutputStream fos=new FileOutputStream(adFile);
  fos.write(fs.getBytes());
  fos.getFD().sync();
  fos.close();
}
