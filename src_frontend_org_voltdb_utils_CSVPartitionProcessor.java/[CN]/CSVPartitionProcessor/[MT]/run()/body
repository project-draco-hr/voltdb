{
  VoltTable table=new VoltTable(colInfo);
  String procName=(isMP ? "@LoadMultipartitionTable" : "@LoadSinglepartitionTable");
  if (config.useSuppliedProcedure) {
    procName=insertProcedure;
  }
  Object partitionParam=null;
  if (!isMP) {
    partitionParam=TheHashinator.valueToBytes(m_partitionId);
  }
  FailedBatchProcessor failureProcessor=new FailedBatchProcessor(this,procName,tableName,partitionParam);
  failureProcessor.start();
  process(table,procName,partitionParam);
  m_partitionQueue.clear();
  try {
    csvClient.drain();
    failedQueue.put(endOfData);
    failureProcessor.join();
    csvClient.drain();
  }
 catch (  NoConnectionsException ex) {
    m_log.warn("Failed to Drain the client: ",ex);
  }
catch (  InterruptedException ex) {
    m_log.warn("Failed to Drain the client: ",ex);
  }
  CSVPartitionProcessor.processor_cdl.countDown();
  m_log.info("Done Processing partition: " + m_partitionId + " Processed: "+ m_partitionProcessedCount);
}
