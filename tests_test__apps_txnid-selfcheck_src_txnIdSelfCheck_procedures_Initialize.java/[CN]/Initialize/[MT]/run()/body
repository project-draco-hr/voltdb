{
  voltQueueSQL(checkStmt,EXPECT_ZERO_OR_ONE_ROW);
  VoltTable result=voltExecuteSQL()[0];
  if (result.getRowCount() != 0) {
    result.advanceRow();
    return result.getLong("rid");
  }
  long txnId=getTransactionId();
  long ts=getTransactionTime().getTime();
  voltQueueSQL(insertStmt,EXPECT_SCALAR_MATCH(1),txnId,ts,-1);
  voltExecuteSQL(true);
  return 0;
}
