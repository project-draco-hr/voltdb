{
  assert(message != null);
  final Queue<VoltMessage> dq=m_messages.get(message.getSubject());
  assert(dq != null);
synchronized (dq) {
    dq.offer(message);
    dq.notify();
  }
  message.receivedFromSiteId=m_siteId;
  if (MESSAGE_HISTORY_SIZE > 0) {
    if (message instanceof DebugMessage)     return;
 else     if (message instanceof MembershipNotice) {
      MembershipNotice mn=(MembershipNotice)message;
      if (mn.isHeartBeat()) synchronized (m_lastTenHeartbeats) {
        m_lastTenHeartbeats.addLast(message);
        if (m_lastTenHeartbeats.size() > MESSAGE_HISTORY_SIZE)         m_lastTenHeartbeats.pollFirst();
      }
 else synchronized (m_lastTenMembershipNotices) {
        m_lastTenMembershipNotices.addLast(message);
        if (m_lastTenMembershipNotices.size() > MESSAGE_HISTORY_SIZE)         m_lastTenMembershipNotices.pollFirst();
      }
    }
 else synchronized (m_lastTenReceivedMessages) {
      m_lastTenReceivedMessages.addLast(message);
      if (m_lastTenReceivedMessages.size() > MESSAGE_HISTORY_SIZE)       m_lastTenReceivedMessages.pollFirst();
    }
  }
}
