{
  mbox=mock(Mailbox.class);
  iv2masters=mock(MapCache.class);
  HashMap<String,JSONObject> fakecache=new HashMap<String,JSONObject>();
  fakecache.put("0",new JSONObject("{hsid:0}"));
  when(iv2masters.pointInTimeCache()).thenReturn(ImmutableMap.copyOf(fakecache));
  procs=mock(LoadedProcedureSet.class);
  runner=mock(ProcedureRunner.class);
  when(runner.isSystemProcedure()).thenReturn(false);
  when(procs.getProcByName(MockSPName)).thenReturn(runner);
  if (isMPI) {
    dut=new MpScheduler(iv2masters);
  }
 else {
    dut=new SpScheduler();
  }
  dut.setMailbox(mbox);
  dut.setProcedureSet(procs);
}
