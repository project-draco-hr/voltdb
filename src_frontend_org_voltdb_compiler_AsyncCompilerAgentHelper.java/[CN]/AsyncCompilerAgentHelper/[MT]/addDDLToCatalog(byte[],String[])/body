{
  VoltCompilerReader ddlReader=null;
  try {
    InMemoryJarfile jarfile=CatalogUtil.loadInMemoryJarFile(oldCatalogBytes);
    String oldDDL=new String(jarfile.get(VoltCompiler.AUTOGEN_DDL_FILE_NAME),Constants.UTF8ENCODING);
    StringBuilder sb=new StringBuilder();
    sb.append(oldDDL);
    sb.append("\n");
    for (    String stmt : adhocDDLStmts) {
      sb.append(stmt);
      sb.append(";\n");
    }
    compilerLog.debug("Adhoc-modified DDL:\n" + sb.toString());
    ddlReader=new VoltCompilerStringReader(VoltCompiler.AUTOGEN_DDL_FILE_NAME,sb.toString());
    ddlReader.putInJar(jarfile,VoltCompiler.AUTOGEN_DDL_FILE_NAME);
    VoltCompiler compiler=new VoltCompiler();
    boolean result=compiler.compileInMemoryJarfile(jarfile);
    if (result) {
      return jarfile.getFullJarBytes();
    }
  }
 catch (  IOException ioe) {
    m_errMsg=ioe.getMessage();
    return null;
  }
 finally {
    if (ddlReader != null) {
      try {
        ddlReader.close();
      }
 catch (      IOException ioe) {
      }
    }
  }
  return null;
}
