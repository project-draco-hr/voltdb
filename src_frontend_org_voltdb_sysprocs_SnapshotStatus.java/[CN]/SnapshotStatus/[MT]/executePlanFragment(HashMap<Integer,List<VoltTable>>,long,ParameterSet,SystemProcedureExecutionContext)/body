{
  final VoltTable results=constructFragmentResultsTable();
  if (fragmentId == SysProcFragmentId.PF_scanSnapshotRegistries) {
    TreeSet<Snapshot> snapshots=SnapshotRegistry.getSnapshotHistory();
    for (    final Snapshot s : snapshots) {
      s.iterateTables(new TableIterator(){
        @Override public void next(        Table t){
          results.addRow(context.getSite().getHost().getTypeName(),t.name,s.path,s.nonce,t.timeCreated,t.timeClosed,t.size);
        }
      }
);
    }
    return new DependencyPair(DEP_scanSnapshotRegistries,results);
  }
 else   if (fragmentId == SysProcFragmentId.PF_scanSnapshotRegistriesResults) {
    TRACE_LOG.trace("Aggregating Snapshot Status Scan  results");
    assert(dependencies.size() > 0);
    List<VoltTable> dep=dependencies.get(DEP_scanSnapshotRegistries);
    for (    VoltTable table : dep) {
      while (table.advanceRow()) {
        results.add(table);
      }
    }
    return new DependencyPair(DEP_scanSnapshotRegistriesResults,results);
  }
  assert(false);
  return null;
}
