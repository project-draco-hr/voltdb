{
  final ExportKafkaOnServerVerifier verifier=new ExportKafkaOnServerVerifier();
  try {
    Runtime.getRuntime().addShutdownHook(new Thread(){
      @Override public void run(){
        System.out.println("Shuttind Down...");
        verifier.stopConsumer();
      }
    }
);
    boolean skinny=verifier.verifySetup(args);
    if (skinny) {
      verifier.verifySkinny();
    }
 else {
      verifier.verifyFat();
    }
    System.out.println("Seen Rows: " + seenTxnIds.size() + " Expected: "+ expectedRows);
    if (seenTxnIds.size() != expectedRows) {
      System.out.println("ERROR: Exported row count does not match consumed rows.");
    }
  }
 catch (  IOException e) {
    e.printStackTrace(System.err);
    System.exit(-1);
  }
catch (  ValidationErr e) {
    System.err.println("Validation error: " + e.toString());
    System.exit(-1);
  }
  System.exit(0);
}
