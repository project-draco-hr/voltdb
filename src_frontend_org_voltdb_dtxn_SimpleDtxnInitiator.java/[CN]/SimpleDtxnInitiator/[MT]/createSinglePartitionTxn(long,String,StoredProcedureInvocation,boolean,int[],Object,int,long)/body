{
  long txnId=m_idManager.getNextUniqueTransactionId();
  ArrayList<Integer> site_ids;
  ArrayList<InFlightTxnState> txn_states=new ArrayList<InFlightTxnState>();
  if (partitions.length == 1) {
    site_ids=VoltDB.instance().getCatalogContext().siteTracker.getLiveSitesForPartition(partitions[0]);
  }
 else {
    site_ids=VoltDB.instance().getCatalogContext().siteTracker.getLiveSitesForEachPartitionAsList(partitions);
  }
  System.out.println("creating single p. txn for sites: " + site_ids + " for "+ invocation.getProcName());
  increaseBackpressure(messageSize);
  for (  int site_id : site_ids) {
    InFlightTxnState txn=new InFlightTxnState(txnId,site_id,null,isReadOnly,true,invocation.getShallowCopy(),clientData,messageSize,now,connectionId,connectionHostname);
    txn_states.add(txn);
    m_queue.addPendingTxn(txn);
  }
  for (  InFlightTxnState txn_state : txn_states) {
    sendTransactionToCoordinator(txn_state);
  }
}
