{
  ArrayList<Long> siteIds;
  if (partitions.length == 1) {
    siteIds=VoltDB.instance().getCatalogContext().siteTracker.getLiveSitesForPartition(partitions[0]);
  }
 else {
    siteIds=VoltDB.instance().getCatalogContext().siteTracker.getLiveSitesForEachPartitionAsList(partitions);
  }
  increaseBackpressure(messageSize);
  InFlightTxnState state=new InFlightTxnState(txnId,siteIds.get(0),null,null,isReadOnly,true,invocation.getShallowCopy(),clientData,messageSize,now,connectionId,connectionHostname,adminConnection);
  for (  long siteId : siteIds) {
    state.addCoordinator(siteId);
  }
  m_mailbox.addPendingTxn(state);
  for (  long coordId : state.outstandingCoordinators) {
    sendTransactionToCoordinator(state,coordId);
  }
}
