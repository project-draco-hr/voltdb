def format_schema(self):
    self._initialize()
    self.formatter.vcomment(('::: Generated by %s :::' % environment.command_name), ('Generated comments are prefixed by "%s"' % G.vcomment_prefix))
    for table_name in self.table_names:
        self.format_table(table_name)
        self.format_table_partitioning(table_name)
        self.format_table_indexes(table_name)
    return str(self.formatter)
