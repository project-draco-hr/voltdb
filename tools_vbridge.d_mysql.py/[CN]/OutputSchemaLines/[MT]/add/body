def add(self, needs_comma, *lines):
    if (needs_comma and (self.last_comma_line >= 0)):
        self.lines[self.last_comma_line] += ','
        self.last_comma_line = (-1)
    for line in lines:
        if isinstance(line, OutputSchemaLines):
            self.lines.extend(line.lines)
        else:
            self.lines.append(line)
    if needs_comma:
        self.last_comma_line = (len(self.lines) - 1)
