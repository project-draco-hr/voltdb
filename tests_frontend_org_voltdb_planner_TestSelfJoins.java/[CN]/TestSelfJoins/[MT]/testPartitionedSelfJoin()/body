{
  AbstractPlanNode pn=compile("select * FROM P1 A JOIN P1 B ON A.A = B.A");
  assertTrue(pn instanceof SendPlanNode);
  failToCompile("select * FROM P1 A JOIN P1 B ON A.C = B.A","Join of multiple partitioned tables has insufficient join criteria");
  failToCompile("select * FROM P1 A JOIN P1 B ON A.C = B.C","Join of multiple partitioned tables has insufficient join criteria");
}
