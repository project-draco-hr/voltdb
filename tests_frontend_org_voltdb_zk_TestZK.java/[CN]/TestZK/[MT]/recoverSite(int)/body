{
  HashSet<Integer> failedSites=new HashSet<Integer>();
  HashSet<Integer> agreementSiteIds=new HashSet<Integer>();
  int zz=0;
  for (  MockMailbox mailbox : m_mailboxes) {
    agreementSiteIds.add(zz);
    if (mailbox == null && zz != site) {
      failedSites.add(zz);
    }
    zz++;
  }
  m_mailboxes.set(site,new MockMailbox());
  m_faultDistributor.reportFaultCleared(new NodeFailureFault(site,new HashSet<Integer>(Arrays.asList(site)),Integer.toString(site)));
  m_faultDistributor.m_expectedHandler=site;
  m_agreementSites.set(site,new AgreementSite(site,agreementSiteIds,site,failedSites,m_mailboxes.get(site),new InetSocketAddress(2181 + site),m_faultDistributor,true));
  m_agreementSites.get(site).start();
  for (int ii=0; ii < m_agreementSites.size(); ii++) {
    if (ii == site) {
      continue;
    }
    m_agreementSites.get(ii).clearFault(site);
  }
}
