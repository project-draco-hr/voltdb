{
  loadData(true);
  Client client=this.getClient();
  ClientResponse cr=null;
  VoltTable vt;
  long[][] expected;
  for (  String tb : tbs) {
    cr=client.callProcedure("@AdHoc","SELECT abs(dept) as tag, count(wage), sum(id), avg(wage)  from " + tb + " GROUP BY abs(dept) ORDER BY tag ");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{1,3,6,20},{2,4,22,35}};
    validateTableOfLongs(vt,expected);
    cr=client.callProcedure("@AdHoc","SELECT abs(dept) as tag, count(wage), sum(id), avg(wage) from " + tb + " GROUP BY abs(dept) ORDER BY abs(dept) ");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{1,3,6,20},{2,4,22,35}};
    validateTableOfLongs(vt,expected);
    cr=client.callProcedure("@AdHoc","SELECT abs(dept-2) as tag, count(wage)+1, avg(wage)/2 from " + tb + " GROUP BY abs(dept-2) ORDER BY tag;");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{0,5,17},{1,4,10}};
    validateTableOfLongs(vt,expected);
    cr=client.callProcedure("@AdHoc","SELECT abs(dept-2) as tag, count(wage)+1, avg(wage)/2 from " + tb + " GROUP BY abs(dept-2) ORDER BY abs(dept-2);");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{0,5,17},{1,4,10}};
    validateTableOfLongs(vt,expected);
    cr=client.callProcedure("@AdHoc","SELECT abs(dept-2) as tag, wage, wage/2, count(*)*2, " + "sum(id)/count(id)+1 from " + tb + " GROUP BY abs(dept-2), wage ORDER BY tag, wage;");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{0,10,5,2,7},{0,40,20,4,6},{0,50,25,2,6},{1,10,5,2,2},{1,20,10,2,3},{1,30,15,2,4}};
    validateTableOfLongs(vt,expected);
    cr=client.callProcedure("@AdHoc","SELECT abs(dept-2) as tag, wage, wage/2, count(*)*2, " + "sum(id)/count(id)+1 from " + tb + " GROUP BY abs(dept-2), wage ORDER BY abs(dept-2), wage;");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{0,10,5,2,7},{0,40,20,4,6},{0,50,25,2,6},{1,10,5,2,2},{1,20,10,2,3},{1,30,15,2,4}};
    validateTableOfLongs(vt,expected);
    cr=client.callProcedure("@AdHoc","SELECT wage, wage/2, count(*)*2, sum(id)/count(id)+1 from " + tb + " GROUP BY abs(dept-2), wage ORDER BY abs(dept-2), wage;");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{10,5,2,7},{40,20,4,6},{50,25,2,6},{10,5,2,2},{20,10,2,3},{30,15,2,4}};
    validateTableOfLongs(vt,expected);
    cr=client.callProcedure("@AdHoc","SELECT id+dept, sum(wage)+1 from " + tb + " GROUP BY id+dept ORDER BY ABS(id+dept)");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{2,11},{3,21},{4,31},{6,41},{7,51},{8,11},{9,41}};
    validateTableOfLongs(vt,expected);
    cr=client.callProcedure("@AdHoc","SELECT id+dept, avg(wage) from " + tb + " GROUP BY id+dept ORDER BY ABS(id+dept)");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{2,10},{3,20},{4,30},{6,40},{7,50},{8,10},{9,40}};
    validateTableOfLongs(vt,expected);
    cr=client.callProcedure("@AdHoc","SELECT id+dept from " + tb + " GROUP BY id+dept ORDER BY ABS(id+dept)");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{2},{3},{4},{6},{7},{8},{9}};
    validateTableOfLongs(vt,expected);
    cr=client.callProcedure("@AdHoc","SELECT id+dept, wage from " + tb + " GROUP BY id+dept, wage ORDER BY ABS(id+dept), abs(wage)");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{2,10},{3,20},{4,30},{6,40},{7,50},{8,10},{9,40}};
    validateTableOfLongs(vt,expected);
    cr=client.callProcedure("@AdHoc","SELECT id+dept, avg(wage) as tag from " + tb + " GROUP BY id+dept ORDER BY ABS(tag), id+dept");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{2,10},{8,10},{3,20},{4,30},{6,40},{9,40},{7,50}};
    validateTableOfLongs(vt,expected);
    cr=client.callProcedure("@AdHoc","SELECT id+dept, avg(wage) as tag from " + tb + " GROUP BY id+dept ORDER BY ABS(avg(wage)), id+dept");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{2,10},{8,10},{3,20},{4,30},{6,40},{9,40},{7,50}};
    validateTableOfLongs(vt,expected);
    cr=client.callProcedure("@AdHoc","SELECT id+dept, avg(wage) as tag from " + tb + " GROUP BY id+dept ORDER BY ABS(avg(wage)) + 1, id+dept");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{2,10},{8,10},{3,20},{4,30},{6,40},{9,40},{7,50}};
    validateTableOfLongs(vt,expected);
    cr=client.callProcedure("@AdHoc","SELECT id+dept, avg(wage)+1 as tag from " + tb + " GROUP BY id+dept ORDER BY ABS(tag), id+dept");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{2,11},{8,11},{3,21},{4,31},{6,41},{9,41},{7,51}};
    validateTableOfLongs(vt,expected);
    cr=client.callProcedure("@AdHoc","SELECT id+dept, avg(wage)+1 as tag from " + tb + " GROUP BY id+dept ORDER BY ABS(avg(wage)+1), id+dept");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{2,11},{8,11},{3,21},{4,31},{6,41},{9,41},{7,51}};
    validateTableOfLongs(vt,expected);
    cr=client.callProcedure("@AdHoc","SELECT id+dept, avg(wage)+1 as tag from " + tb + " GROUP BY id+dept ORDER BY ABS(avg(wage)+1) + 1, id+dept");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{2,11},{8,11},{3,21},{4,31},{6,41},{9,41},{7,51}};
    validateTableOfLongs(vt,expected);
  }
}
