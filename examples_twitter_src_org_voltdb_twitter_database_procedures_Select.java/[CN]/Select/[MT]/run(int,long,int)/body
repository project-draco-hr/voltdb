{
  voltQueueSQL(SQL,maxAgeMicros);
  VoltTable table=voltExecuteSQL(true)[0];
  int rowCount=table.getRowCount();
  if (rowCount == 0) {
    return null;
  }
  List<HashTag> hashTags=new LinkedList<HashTag>();
  VoltTableRow row=table.fetchRow(0);
  for (int i=0; i < rowCount; i++) {
    hashTags.add(new HashTag(row.getString(0),(int)row.getLong(1),row.cloneRow()));
    row.advanceRow();
  }
  Collections.sort(hashTags);
  int columnCount=table.getColumnCount();
  String[] columnNames=new String[columnCount];
  VoltType[] columnTypes=new VoltType[columnCount];
  for (int i=0; i < columnNames.length; i++) {
    columnNames[i]=table.getColumnName(i);
    columnTypes[i]=table.getColumnType(i);
  }
  VoltTable.ColumnInfo[] columnInfo=new VoltTable.ColumnInfo[columnCount];
  for (int i=0; i < columnNames.length; i++) {
    columnInfo[i]=new VoltTable.ColumnInfo(columnNames[i],columnTypes[i]);
  }
  VoltTable tableWithLimit=new VoltTable(columnInfo);
  int hashTagsSize=hashTags.size();
  for (int i=0; i < limit && i < hashTagsSize; i++) {
    tableWithLimit.add(hashTags.get(i).getRow());
  }
  return new VoltTable[]{tableWithLimit};
}
