{
  m_builder=new VoltProjectBuilder();
  try {
    m_builder.addLiteralSchema(xopenDDL);
    AdHocQueryTester.setUpSchema(m_builder,pathToCatalog,pathToDeployment);
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail("Failed to set up schema");
  }
  m_cluster=new LocalCluster(pathToCatalog,siteCount,hostCount,kFactor,BackendTarget.NATIVE_EE_JNI,LocalCluster.FailureState.ALL_RUNNING,m_debug,false,enableIv2);
  boolean success=m_cluster.compile(m_builder);
  assert(success);
  try {
    MiscUtils.copyFile(m_builder.getPathToDeployment(),pathToDeployment);
  }
 catch (  Exception e) {
    fail(String.format("Failed to copy \"%s\" to \"%s\"",m_builder.getPathToDeployment(),pathToDeployment));
  }
  m_cluster.setHasLocalServer(true);
}
