{
  VoltDB.Configuration config=setUpSPDB();
  ServerThread localServer=new ServerThread(config);
  try {
    localServer.start();
    localServer.waitForInitialization();
    m_client=ClientFactory.createClient();
    m_client.createConnection("localhost");
    m_client.callProcedure("@AdHoc","insert into PARTED1 values ( 23, 2 )");
    VoltTable results[]=m_client.callProcedure("executeSQLSP",23,"select * from PARTED1").getResults();
    assertTrue(results[0].advanceRow());
    assertTrue(results[1].advanceRow());
    results=m_client.callProcedure("executeSQLMP",23,"       select * from PARTED1").getResults();
    assertTrue(results[0].advanceRow());
    assertTrue(results[1].advanceRow());
    boolean threw=false;
    try {
      m_client.callProcedure("executeSQLSP",24,"insert into parted1 values (24,5)");
    }
 catch (    ProcCallException e) {
      threw=true;
    }
    assertTrue(threw);
    threw=false;
    try {
      m_client.callProcedure("executeSQLMP",24,"insert into parted1 values (24,5)");
    }
 catch (    ProcCallException e) {
      threw=true;
    }
    assertTrue(threw);
  }
  finally {
    if (m_client != null)     m_client.close();
    m_client=null;
    if (localServer != null) {
      localServer.shutdown();
      localServer.join();
    }
    localServer=null;
    System.gc();
  }
}
