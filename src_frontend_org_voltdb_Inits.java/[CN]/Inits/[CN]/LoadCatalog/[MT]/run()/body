{
  try {
    m_rvdb.m_hasCatalog.await();
  }
 catch (  InterruptedException e1) {
    hostLog.fatal("System was interrupted while waiting for a catalog.");
    VoltDB.crashVoltDB();
  }
  if (m_config.m_pathToCatalog.startsWith("http")) {
    hostLog.info("Loading application catalog jarfile from " + m_config.m_pathToCatalog);
  }
 else {
    File f=new File(m_config.m_pathToCatalog);
    hostLog.info("Loading application catalog jarfile from " + f.getAbsolutePath());
  }
  m_rvdb.m_serializedCatalog=CatalogUtil.loadCatalogFromJar(m_config.m_pathToCatalog,hostLog);
  if ((m_rvdb.m_serializedCatalog == null) || (m_rvdb.m_serializedCatalog.length() == 0))   VoltDB.crashVoltDB();
  Catalog catalog=new Catalog();
  catalog.execute(m_rvdb.m_serializedCatalog);
  try {
    m_rvdb.m_depCRC=CatalogUtil.compileDeploymentAndGetCRC(catalog,m_deployment,true);
    if (m_rvdb.m_depCRC < 0)     System.exit(-1);
  }
 catch (  Exception e) {
    hostLog.fatal("Error parsing deployment file",e);
    System.exit(-1);
  }
  Cluster newCluster=catalog.getClusters().get("cluster");
  Cluster oldCluster=m_rvdb.m_catalogContext.cluster;
  for (  Site site : oldCluster.getSites()) {
    newCluster.getSites().get(site.getTypeName()).setIsup(site.getIsup());
  }
  long existingCatalogTxnId=m_rvdb.m_catalogContext.m_transactionId;
  int existingCatalogVersion=m_rvdb.m_messenger.getDiscoveredCatalogVersion();
  m_rvdb.m_serializedCatalog=catalog.serialize();
  m_rvdb.m_catalogContext=new CatalogContext(existingCatalogTxnId,catalog,m_config.m_pathToCatalog,m_rvdb.m_depCRC,existingCatalogVersion,-1);
}
