{
  m_rvdb.m_network=new VoltNetwork();
  String leaderAddress=m_deployment.getCluster().getLeader();
  int numberOfNodes=m_deployment.getCluster().getHostcount();
  long depCRC=CatalogUtil.getDeploymentCRC(m_config.m_pathToDeployment);
  if (!m_isRejoin) {
    InetAddress leader=null;
    try {
      leader=InetAddress.getByName(leaderAddress);
    }
 catch (    UnknownHostException ex) {
      hostLog.l7dlog(Level.FATAL,LogKeys.host_VoltDB_CouldNotRetrieveLeaderAddress.name(),new Object[]{leaderAddress},null);
      VoltDB.crashVoltDB();
    }
    if (numberOfNodes <= 0) {
      hostLog.l7dlog(Level.FATAL,LogKeys.host_VoltDB_InvalidHostCount.name(),new Object[]{numberOfNodes},null);
      VoltDB.crashVoltDB();
    }
    hostLog.l7dlog(Level.TRACE,LogKeys.host_VoltDB_CreatingVoltDB.name(),new Object[]{numberOfNodes,leader},null);
    hostLog.info(String.format("Beginning inter-node communication on port %d.",m_config.m_internalPort));
    m_rvdb.m_messenger=new HostMessenger(m_rvdb.m_network,leader,numberOfNodes,0,depCRC,hostLog);
    Object retval[]=m_rvdb.m_messenger.waitForGroupJoin();
    m_rvdb.m_instanceId=new Object[]{retval[0],retval[1]};
  }
 else {
    m_rvdb.m_downHosts.addAll(initializeForRejoin(m_config,numberOfNodes,depCRC));
  }
  m_rvdb.m_myHostId=m_rvdb.m_messenger.getHostId();
  m_rvdb.m_clusterMetadata.put(m_rvdb.m_myHostId,m_rvdb.m_localMetadata);
}
