{
  loadData();
  Client client=this.getClient();
  ClientResponse cr=null;
  VoltTable vt;
  long[][] expected;
  Exception ex=null;
  String[] tbs={"R1","P1"};
  for (  String tb : tbs) {
    cr=client.callProcedure("@AdHoc","SELECT dept, count(*), sum(wage) from " + tb + " GROUP BY dept ORDER BY sum(wage)");
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
    vt=cr.getResults()[0];
    expected=new long[][]{{1,3,60},{2,2,90}};
    compareTable(vt,expected);
    ex=null;
    try {
      cr=client.callProcedure("@AdHoc","SELECT dept, count(*) from " + tb + " GROUP BY dept ORDER BY sum(wage) DESC");
      assertEquals(ClientResponse.SUCCESS,cr.getStatus());
      vt=cr.getResults()[0];
      expected=new long[][]{{1,3},{2,2}};
      compareTable(vt,expected);
    }
 catch (    ProcCallException e) {
      ex=e;
    }
 finally {
      assertTrue(ex.getMessage().contains("invalid ORDER BY expression"));
    }
  }
}
