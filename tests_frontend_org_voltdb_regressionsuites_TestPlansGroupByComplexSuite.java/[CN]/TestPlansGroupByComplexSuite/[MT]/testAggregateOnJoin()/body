{
  Client client=this.getClient();
  ClientResponse cr;
  VoltTable vt;
  long[][] expected;
  for (  String tb : tbs) {
    cr=client.callProcedure("@AdHoc","delete from " + tb);
    assertEquals(ClientResponse.SUCCESS,cr.getStatus());
  }
  int numOfRecords=10 * 1000;
  String timeStamp="2013-06-18 02:00:00.123457";
  String[] myProcs={"R1.insert","P1.insert"};
  for (  String insertProc : myProcs) {
    for (int ii=1; ii <= numOfRecords; ii++) {
      cr=client.callProcedure(insertProc,ii,ii % 1000,ii % 2,timeStamp);
    }
  }
  cr=client.callProcedure("@AdHoc","SELECT sum(R1.wage) " + " from R1, P1 WHERE R1.id = P1.id ;");
  assertEquals(ClientResponse.SUCCESS,cr.getStatus());
  vt=cr.getResults()[0];
  expected=new long[][]{{4995000}};
  validateTableOfLongs(vt,expected);
  cr=client.callProcedure("@AdHoc","SELECT R1.dept, sum(R1.wage) " + " from R1, P1 WHERE R1.id = P1.id Group by R1.dept order by R1.dept;");
  assertEquals(ClientResponse.SUCCESS,cr.getStatus());
  vt=cr.getResults()[0];
  expected=new long[][]{{0,2495000},{1,2500000}};
  validateTableOfLongs(vt,expected);
}
