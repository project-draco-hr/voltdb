{
  MockInitiator initiator=new MockInitiator();
  ExecutorTxnIdSafetyState safetyState=new ExecutorTxnIdSafetyState(m_siteMap);
  DtxnInitiatorMailbox dim=new DtxnInitiatorMailbox(safetyState,m_mockMessenger);
  dim.setInitiator(initiator);
  dim.setHSId(INITIATOR_SITE_ID);
  m_testStream.reset();
  dim.addPendingTxn(createTxnState(0,new int[]{0,1},false,true));
  dim.deliver(createInitiateResponse(0,1,true,true,false,createResultSet("dude")));
synchronized (m_testStream) {
    SiteFailureFault site_failure=new SiteFailureFault(Arrays.asList(new Long[]{0L}));
    VoltDB.instance().getFaultDistributor().reportFault(site_failure);
    m_testStream.wait(10000);
  }
  Thread.sleep(100);
  assertTrue(m_testStream.gotResponse());
  assertEquals(1,initiator.m_reduceCount);
  assertEquals(MESSAGE_SIZE,initiator.m_reduceSize);
}
