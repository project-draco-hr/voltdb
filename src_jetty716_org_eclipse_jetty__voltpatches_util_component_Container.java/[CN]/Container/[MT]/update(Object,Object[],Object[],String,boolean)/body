{
  Object[] newChildren=null;
  if (children != null) {
    newChildren=new Object[children.length];
    for (int i=children.length; i-- > 0; ) {
      boolean new_child=true;
      if (oldChildren != null) {
        for (int j=oldChildren.length; j-- > 0; ) {
          if (children[i] != null && children[i].equals(oldChildren[j])) {
            oldChildren[j]=null;
            new_child=false;
          }
        }
      }
      if (new_child)       newChildren[i]=children[i];
    }
  }
  if (oldChildren != null) {
    for (int i=oldChildren.length; i-- > 0; ) {
      if (oldChildren[i] != null) {
        remove(parent,oldChildren[i],relationship);
        if (addRemove)         removeBean(oldChildren[i]);
      }
    }
  }
  if (newChildren != null) {
    for (int i=0; i < newChildren.length; i++)     if (newChildren[i] != null) {
      if (addRemove)       addBean(newChildren[i]);
      add(parent,newChildren[i],relationship);
    }
  }
}
