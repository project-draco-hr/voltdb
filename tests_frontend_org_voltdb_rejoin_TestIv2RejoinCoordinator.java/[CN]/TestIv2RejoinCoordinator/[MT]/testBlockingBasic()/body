{
  createCoordinator(false);
  m_coordinator.startJoin(null,null,null);
  List<Long> hsids=new ArrayList<Long>();
  hsids.add(1l);
  hsids.add(2l);
  RejoinMessage msg=new RejoinMessage(10000l,RejoinMessage.Type.INITIATION_COMMUNITY,"Rejoin_3");
  verifySent(hsids,msg);
  verify(m_volt,never()).onExecutionSiteRejoinCompletion(anyLong());
  msg=new RejoinMessage(1l,1001l,1002l);
  m_coordinator.deliver(msg);
  verifySnapshotRequest(false);
  msg=new RejoinMessage(2l,2001l,2002l);
  m_coordinator.deliver(msg);
  verifySnapshotRequest(true);
  msg=new RejoinMessage(1l,RejoinMessage.Type.SNAPSHOT_FINISHED);
  m_coordinator.deliver(msg);
  verify(m_volt,never()).onExecutionSiteRejoinCompletion(anyLong());
  RejoinMessage msg2=new RejoinMessage(2l,RejoinMessage.Type.SNAPSHOT_FINISHED);
  m_coordinator.deliver(msg2);
  RejoinMessage msg1=new RejoinMessage(1l,RejoinMessage.Type.REPLAY_FINISHED);
  m_coordinator.deliver(msg1);
  RejoinMessage msg3=new RejoinMessage(2l,RejoinMessage.Type.REPLAY_FINISHED);
  m_coordinator.deliver(msg3);
  verify(m_volt).onExecutionSiteRejoinCompletion(anyLong());
}
