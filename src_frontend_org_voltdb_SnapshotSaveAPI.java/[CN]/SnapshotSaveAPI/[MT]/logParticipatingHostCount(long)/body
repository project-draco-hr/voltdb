{
  ZooKeeper zk=VoltDB.instance().getHostMessenger().getZK();
  final String snapshotPath=VoltZK.completed_snapshots + "/" + txnId;
  Stat stat=new Stat();
  byte data[]=null;
  try {
    data=zk.getData(snapshotPath,false,stat);
  }
 catch (  Exception e) {
    VoltDB.crashLocalVoltDB("This ZK get should never fail",true,e);
  }
  if (data == null) {
    VoltDB.crashLocalVoltDB("Data should not be null if the node exists",false,null);
  }
  try {
    JSONObject jsonObj=new JSONObject(new String(data,"UTF-8"));
    if (jsonObj.getLong("txnId") != txnId) {
      VoltDB.crashLocalVoltDB("TxnId should match",false,null);
    }
    JSONArray hosts=jsonObj.getJSONArray("hosts");
    int hostCount=jsonObj.getInt("hostCount");
    jsonObj.put("hostCount",hostCount + hosts.length() + 1);
    zk.setData(snapshotPath,jsonObj.toString(4).getBytes("UTF-8"),stat.getVersion());
  }
 catch (  Exception e) {
    VoltDB.crashLocalVoltDB("This ZK call should never fail",true,e);
  }
}
