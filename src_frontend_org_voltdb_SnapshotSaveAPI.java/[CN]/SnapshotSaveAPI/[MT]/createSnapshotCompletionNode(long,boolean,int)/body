{
  if (hosts == 0) {
    VoltDB.crashGlobalVoltDB("Hosts must be greater than 0",true,null);
  }
  if (!(txnId > 0)) {
    VoltDB.crashGlobalVoltDB("Txnid must be greather than 0",true,null);
  }
  ByteBuffer buf=ByteBuffer.allocate(17);
  buf.putLong(txnId);
  buf.putInt(hosts);
  buf.putInt(0);
  buf.put(isTruncation ? 1 : (byte)0);
  ZKUtil.StringCallback cb=new ZKUtil.StringCallback();
  final String snapshotPath="/completed_snapshots/" + txnId;
  VoltDB.instance().getZK().create(snapshotPath,buf.array(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT,cb,null);
  try {
    cb.get();
  }
 catch (  KeeperException.NodeExistsException e) {
  }
catch (  Exception e) {
    HOST_LOG.fatal("Unexpected exception logging snapshot completion to ZK",e);
    VoltDB.crashVoltDB();
  }
}
