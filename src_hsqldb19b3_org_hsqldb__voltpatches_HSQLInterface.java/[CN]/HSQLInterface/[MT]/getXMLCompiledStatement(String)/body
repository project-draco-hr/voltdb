{
  Statement cs=null;
  sessionProxy.resetVoltNodeIds();
  try {
    cs=sessionProxy.compileStatement(sql);
  }
 catch (  HsqlException hex) {
switch (hex.getErrorCode()) {
case -ErrorCode.X_42581:
      throw new HSQLParseException("SQL Syntax error in \"" + sql + "\" "+ hex.getMessage());
default :
    throw new HSQLParseException(hex.getMessage());
}
}
catch (Throwable t) {
throw new HSQLParseException(t.getMessage());
}
Result result=Result.newPrepareResponse(cs);
if (result.hasError()) {
throw new HSQLParseException(result.getMainString());
}
VoltXMLElement xml=null;
xml=cs.voltGetStatementXML(sessionProxy);
if (m_logger.isDebugEnabled()) {
m_logger.debug(String.format("SQL: %s\n",sql));
;
m_logger.debug(String.format("HSQLDB:\n%s",(cs == null) ? "<NULL>" : cs.describe(sessionProxy)));
m_logger.debug(String.format("VOLTDB:\n%s",(xml == null) ? "<NULL>" : xml));
}
sessionProxy.sessionData.persistentStoreCollection.clearAllTables();
fixupInStatementExpressions(xml);
assert(xml != null);
return xml;
}
