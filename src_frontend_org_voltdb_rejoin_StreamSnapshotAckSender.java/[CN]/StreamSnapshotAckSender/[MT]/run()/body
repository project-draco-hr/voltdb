{
  while (true) {
    long hsId;
    long targetId;
    int blockIndex;
    try {
      Pair<Long,Pair<Long,Integer>> blockToAck=m_blockIndices.take();
      hsId=blockToAck.getFirst();
      targetId=blockToAck.getSecond().getFirst();
      blockIndex=blockToAck.getSecond().getSecond();
    }
 catch (    InterruptedException e1) {
      break;
    }
    if (blockIndex == -1) {
      rejoinLog.debug(m_blockIndices.size() + " acks remaining, " + "terminating ack sender");
      break;
    }
    RejoinDataAckMessage msg=new RejoinDataAckMessage(targetId,blockIndex);
    m_mb.send(hsId,msg);
  }
}
