{
  Context context=getServerReadyToReceiveNewNode();
  Client client=ClientFactory.createClient();
  client.createConnection("localhost",null,null);
  ServerSocketChannel listener=null;
  try {
    listener=ServerSocketChannel.open();
    listener.socket().bind(new InetSocketAddress(VoltDB.DEFAULT_INTERNAL_PORT + 1));
  }
 catch (  IOException e) {
    e.printStackTrace();
    System.exit(-1);
  }
  SyncCallback scb=new SyncCallback();
  boolean success=false;
  while (!success) {
    success=client.callProcedure(scb,"@Rejoin","localhost",VoltDB.DEFAULT_INTERNAL_PORT + 1);
    if (!success)     Thread.sleep(100);
  }
  SocketChannel socket=listener.accept();
  listener.close();
  DataOutputStream out=new DataOutputStream(new BufferedOutputStream(socket.socket().getOutputStream()));
  DataInputStream in=new DataInputStream(new BufferedInputStream(socket.socket().getInputStream()));
  int hostId=in.readInt();
  assertEquals(hostId,1);
  out.writeInt(4);
  out.flush();
  in.readLong();
  out.writeLong(1);
  out.writeInt(3);
  out.flush();
  scb.waitForResponse();
  @SuppressWarnings("unused") ClientResponse response=scb.getResponse();
  socket.close();
  context.localServer.shutdown();
  context.localServer.join();
  return false;
}
