{
  VoltProjectBuilder builder=getBuilderForTest();
  boolean success=builder.compile(Configuration.getPathToCatalogForTest("rejoin.jar"),1,1,0,"localhost");
  assertTrue(success);
  copyFile(builder.getPathToDeployment(),Configuration.getPathToCatalogForTest("rejoin.xml"));
  VoltDB.Configuration config=new VoltDB.Configuration();
  config.m_pathToCatalog=Configuration.getPathToCatalogForTest("rejoin.jar");
  config.m_pathToDeployment=Configuration.getPathToCatalogForTest("rejoin.xml");
  ServerThread localServer=new ServerThread(config);
  localServer.start();
  localServer.waitForInitialization();
  Client client=ClientFactory.createClient();
  client.createConnection("localhost");
  SyncCallback scb=new SyncCallback();
  success=false;
  while (!success) {
    success=client.callProcedure(scb,"@Rejoin","localhost",config.m_internalPort + 1);
    if (!success)     Thread.sleep(100);
  }
  scb.waitForResponse();
  ClientResponse response=scb.getResponse();
  assertTrue(response.getStatusString().contains("Unable to find down node"));
  client.close();
  localServer.shutdown();
  localServer.join();
}
