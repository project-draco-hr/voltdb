{
  assertEquals(targetId,msg.getTargetId());
  byte[] data=CompressionService.decompressBytes(msg.getData());
  assertEquals(type.ordinal(),data[StreamSnapshotBase.typeOffset]);
  if (type != StreamSnapshotMessageType.END && type != StreamSnapshotMessageType.FAILURE) {
    assertEquals(tableId,data[StreamSnapshotBase.tableIdOffset]);
    assertEquals(blockIndex,data[StreamSnapshotBase.blockIndexOffset]);
  }
}
