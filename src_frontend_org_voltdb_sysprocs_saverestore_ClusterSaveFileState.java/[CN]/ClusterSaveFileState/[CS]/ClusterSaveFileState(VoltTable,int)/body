{
  if (saveFileState.getRowCount() == 0) {
    String error="No savefile state to restore";
    throw new IOException(error);
  }
  VoltTableRow a_row=saveFileState.fetchRow(0);
  m_clusterName=a_row.getString("CLUSTER");
  m_databaseName=a_row.getString("DATABASE");
  m_allowExport=allowExport;
  m_tableStateMap=new HashMap<String,TableSaveFileState>();
  while (saveFileState.advanceRow()) {
    checkConsistency(saveFileState);
    String table_name=saveFileState.getString("TABLE");
    TableSaveFileState table_state=null;
    if (!(getSavedTableNames().contains(table_name))) {
      table_state=constructTableState(saveFileState);
      m_tableStateMap.put(table_name,table_state);
    }
    table_state=getTableState(table_name);
    table_state.addHostData(saveFileState);
  }
  for (  TableSaveFileState table_state : m_tableStateMap.values()) {
    if (!table_state.isConsistent()) {
      String error="Table: " + table_state.getTableName() + " has some inconsistency in the savefile state";
      throw new IOException(error);
    }
  }
}
