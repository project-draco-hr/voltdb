{
  if (m_isIV2Enabled) {
    final int thisHostId=CoreUtils.getHostIdFromHSId(m_mailbox.getHSId());
    ImmutableMap.Builder<Integer,Long> localReplicas=ImmutableMap.builder();
    for (    int partition : m_allPartitions) {
      for (      Long replica : m_cartographer.getReplicasForPartition(partition)) {
        if (CoreUtils.getHostIdFromHSId(replica) == thisHostId) {
          localReplicas.put(partition,replica);
        }
      }
    }
    m_localReplicas=localReplicas.build();
  }
  m_maxConnectionUpdater=VoltDB.instance().scheduleWork(new Runnable(){
    @Override public void run(){
      Integer limit=org.voltdb.utils.CLibrary.getOpenFileLimit();
      if (limit != null) {
        MAX_CONNECTIONS.set(limit - 300);
      }
    }
  }
,0,10,TimeUnit.MINUTES);
  m_acceptor.start();
  if (m_adminAcceptor != null) {
    m_adminAcceptor.start();
  }
  mayActivateSnapshotDaemon();
}
