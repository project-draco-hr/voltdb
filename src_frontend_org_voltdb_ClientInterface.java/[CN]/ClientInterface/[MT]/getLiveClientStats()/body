{
  Map<Long,Pair<String,long[]>> client_stats=new HashMap<Long,Pair<String,long[]>>();
  Map<Long,long[]> inflight_txn_stats;
  if (VoltDB.instance().isIV2Enabled()) {
    inflight_txn_stats=new HashMap<Long,long[]>();
    for (    Map.Entry<Long,Pair<ClientInterfaceHandleManager,? extends AdmissionControlGroup>> e : m_connectionSpecificStuff.entrySet()) {
      long values[]=new long[2];
      values[0]=e.getValue().getFirst().isAdmin ? 1 : 0;
      values[1]=e.getValue().getFirst().getOutstandingTxns();
      inflight_txn_stats.put(e.getKey(),values);
    }
  }
 else {
    inflight_txn_stats=m_initiator.getOutstandingTxnStats();
  }
  for (  Connection c : m_connections) {
    if (!client_stats.containsKey(c.connectionId())) {
      client_stats.put(c.connectionId(),new Pair<String,long[]>(c.getHostnameOrIP(),new long[]{0,c.readStream().dataAvailable(),c.writeStream().getOutstandingMessageCount(),0}));
    }
  }
  for (  Entry<Long,long[]> stat : inflight_txn_stats.entrySet()) {
    if (client_stats.containsKey(stat.getKey())) {
      client_stats.get(stat.getKey()).getSecond()[0]=stat.getValue()[0];
      client_stats.get(stat.getKey()).getSecond()[3]=stat.getValue()[1];
    }
  }
  return client_stats;
}
