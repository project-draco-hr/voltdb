{
  if (acceptsURL(url)) {
    try {
      Matcher m=Pattern.compile("^jdbc:voltdb://([^:]+):(\\d+)$",Pattern.CASE_INSENSITIVE).matcher(url);
      if (m.matches()) {
        String[] servers=m.group(1).split(",");
        int port=Integer.parseInt(m.group(2));
        String user="";
        String password="";
        boolean heavyweight=false;
        int maxoutstandingtxns=-1;
        for (Enumeration e=info.propertyNames(); e.hasMoreElements(); ) {
          String key=(String)e.nextElement();
          String value=info.getProperty(key);
          if (key.toLowerCase().equals("user"))           user=value;
 else           if (key.toLowerCase().equals("password"))           password=value;
 else           if (key.toLowerCase().equals("heavyweight"))           heavyweight=(value.toLowerCase().equals("true") || value.toLowerCase().equals("yes") || value.toLowerCase().equals("1"));
 else           if (key.toLowerCase().equals("maxoutstandingtxns"))           maxoutstandingtxns=Integer.parseInt(value);
        }
        final ClientConfig config=new ClientConfig(user,password);
        config.setHeavyweight(heavyweight);
        if (maxoutstandingtxns > 0)         config.setMaxOutstandingTxns(maxoutstandingtxns);
        final Client client=ClientFactory.createClient(config);
        for (        String server : servers)         if (server.trim().length() > 0)         client.createConnection(server.trim(),port);
        return new JDBC4Connection(client,user);
      }
    }
 catch (    Exception x) {
      throw SQLError.get(x,SQLError.CONNECTION_UNSUCCESSFUL);
    }
  }
  return null;
}
