{
  if (invocation.procName.startsWith("@AdHoc")) {
    if (!user.hasAdhocPermission()) {
      authLog.l7dlog(Level.INFO,LogKeys.auth_ClientInterface_LackingPermissionForAdhoc.name(),new String[]{user.m_name},null);
      return new ClientResponseImpl(ClientResponseImpl.UNEXPECTED_FAILURE,new VoltTable[0],"User does not have @AdHoc permission",invocation.clientHandle);
    }
  }
 else   if (proc.getSystemproc() && !user.hasSystemProcPermission()) {
    authLog.l7dlog(Level.INFO,LogKeys.auth_ClientInterface_LackingPermissionForSysproc.name(),new String[]{user.m_name,invocation.procName},null);
    return new ClientResponseImpl(ClientResponseImpl.UNEXPECTED_FAILURE,new VoltTable[0],"User " + user.m_name + " does not have sysproc permission",invocation.clientHandle);
  }
 else   if (!user.hasPermission(proc)) {
    authLog.l7dlog(Level.INFO,LogKeys.auth_ClientInterface_LackingPermissionForProcedure.name(),new String[]{user.m_name,invocation.procName},null);
    return new ClientResponseImpl(ClientResponseImpl.UNEXPECTED_FAILURE,new VoltTable[0],"User does not have permission to invoke " + invocation.procName,invocation.clientHandle);
  }
  return null;
}
