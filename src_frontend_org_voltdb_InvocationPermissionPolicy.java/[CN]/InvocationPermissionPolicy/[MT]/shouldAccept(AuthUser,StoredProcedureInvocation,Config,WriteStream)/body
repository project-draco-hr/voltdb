{
  if (invocation.procName.startsWith("@AdHoc")) {
    if (!user.hasAdhocPermission()) {
      final ClientResponseImpl errorResponse=new ClientResponseImpl(ClientResponseImpl.UNEXPECTED_FAILURE,new VoltTable[0],"User does not have @AdHoc permission",invocation.clientHandle);
      authLog.l7dlog(Level.INFO,LogKeys.auth_ClientInterface_LackingPermissionForAdhoc.name(),new String[]{user.m_name},null);
      s.enqueue(errorResponse);
      return false;
    }
  }
 else   if (!user.hasSystemProcPermission()) {
    authLog.l7dlog(Level.INFO,LogKeys.auth_ClientInterface_LackingPermissionForSysproc.name(),new String[]{user.m_name,invocation.procName},null);
    final ClientResponseImpl errorResponse=new ClientResponseImpl(ClientResponseImpl.UNEXPECTED_FAILURE,new VoltTable[0],"User " + user.m_name + " does not have sysproc permission",invocation.clientHandle);
    s.enqueue(errorResponse);
    return false;
  }
  return true;
}
