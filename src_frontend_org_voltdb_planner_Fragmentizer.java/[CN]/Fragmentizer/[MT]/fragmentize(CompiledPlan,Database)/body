{
  assert(plan != null);
  assert(plan.fragments != null);
  assert(plan.fragments.size() == 1);
  CompiledPlan.Fragment rootFragment=plan.fragments.get(0);
  rootFragment.planGraph.updateOutputColumns(db);
  recursiveFindFragment(rootFragment,rootFragment.planGraph,plan.fragments);
  return plan;
}
