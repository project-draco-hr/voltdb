{
  m_changedSQL=false;
  ArrayList<AbstractPlanNode> list1=oldpn.getScanNodeList();
  ArrayList<AbstractPlanNode> list2=newpn.getScanNodeList();
  int size1=list1.size();
  int size2=list2.size();
  int max=Math.max(size1,size2);
  int min=Math.min(size1,size2);
  Pair intPair=new Pair(0,0);
  Pair stringPair=new Pair("","");
  if (max == 0) {
    System.out.println("0 scan statement");
    return;
  }
  if (size1 != size2) {
    intPair.set(size1,size2);
    System.out.println("Leaf size diff : ");
    System.out.println(intPair);
    System.out.println("SQL statement might be changed");
    m_changedSQL=true;
    try {
      for (int i=0; i < min; i++) {
        JSONObject j1=new JSONObject(list1.get(i).toJSONString());
        JSONObject j2=new JSONObject(list2.get(i).toJSONString());
        String table1=j1.getString(AbstractScanPlanNode.Members.TARGET_TABLE_NAME.name());
        String table2=j2.getString(AbstractScanPlanNode.Members.TARGET_TABLE_NAME.name());
        String nodeType1=j1.getString(AbstractPlanNode.Members.PLAN_NODE_TYPE.name());
        String nodeType2=j2.getString(AbstractPlanNode.Members.PLAN_NODE_TYPE.name());
        if (!table1.equalsIgnoreCase(table2)) {
          stringPair.set(nodeType1 + " on " + table1,nodeType2 + " on " + table2);
          System.out.println("Table diff at leaf " + i + ":");
          System.out.println(stringPair);
        }
 else         if (!nodeType1.equalsIgnoreCase(nodeType2)) {
          stringPair.set(nodeType1 + " on " + table1,nodeType2 + " on " + table2);
          System.out.println("Scan diff at leaf " + i + " :");
          System.out.println(stringPair);
        }
 else         if (nodeType1.equalsIgnoreCase(PlanNodeType.INDEXSCAN.name())) {
          String index1=j1.getString(IndexScanPlanNode.Members.TARGET_INDEX_NAME.name());
          String index2=j2.getString(IndexScanPlanNode.Members.TARGET_INDEX_NAME.name());
          stringPair.set(index1,index2);
          if (!index1.equalsIgnoreCase(index2)) {
            System.out.println("Index diff at leaf " + i + " :");
            System.out.println(stringPair);
          }
 else           System.out.println("Same at leaf " + i);
        }
 else         System.out.println("Same at leaf " + i);
      }
      if (size2 < max) {
        for (int i=min; i < max; i++) {
          JSONObject j=new JSONObject(list1.get(i).toJSONString());
          String table=j.getString(AbstractScanPlanNode.Members.TARGET_TABLE_NAME.name());
          String nodeType=j.getString(AbstractPlanNode.Members.PLAN_NODE_TYPE.name());
          String index=null;
          if (nodeType.equalsIgnoreCase(PlanNodeType.INDEXSCAN.name())) {
            index=j.getString(IndexScanPlanNode.Members.TARGET_INDEX_NAME.name());
          }
          if (index != null) {
            stringPair.set(nodeType + " on " + table+ " using "+ index,"Empty");
            System.out.println("Diff at leaf " + i + " :");
            System.out.println(stringPair.toString());
          }
 else {
            stringPair.set(nodeType + " on " + table,"Empty");
            System.out.println("Diff at leaf " + i + ": ");
            System.out.println(stringPair.toString());
          }
        }
      }
 else       if (size1 < max) {
        for (int i=min; i < max; i++) {
          JSONObject j=new JSONObject(list2.get(i).toJSONString());
          String table=j.getString(AbstractScanPlanNode.Members.TARGET_TABLE_NAME.name());
          String nodeType=j.getString(AbstractPlanNode.Members.PLAN_NODE_TYPE.name());
          String index=null;
          if (nodeType.equalsIgnoreCase(PlanNodeType.INDEXSCAN.name())) {
            index=j.getString(IndexScanPlanNode.Members.TARGET_INDEX_NAME.name());
          }
          if (index != null) {
            stringPair.set("Empty",nodeType + " on " + table+ " using "+ index);
            System.out.println("Diff at leaf " + i + " :");
            System.out.println(stringPair.toString());
          }
 else {
            stringPair.set("Empty",nodeType + " on " + table);
            System.out.println("Diff at leaf " + i + ": ");
            System.out.println(stringPair.toString());
          }
        }
      }
    }
 catch (    JSONException e) {
      e.printStackTrace();
    }
  }
 else {
    System.out.println("same leaf size");
    try {
      if (max == 1) {
        System.out.println("Single leaf plan");
        JSONObject j1=new JSONObject(list1.get(0).toJSONString());
        JSONObject j2=new JSONObject(list2.get(0).toJSONString());
        String table1=j1.getString(AbstractScanPlanNode.Members.TARGET_TABLE_NAME.name());
        String table2=j2.getString(AbstractScanPlanNode.Members.TARGET_TABLE_NAME.name());
        String nodeType1=j1.getString(AbstractPlanNode.Members.PLAN_NODE_TYPE.name());
        String nodeType2=j2.getString(AbstractPlanNode.Members.PLAN_NODE_TYPE.name());
        if (!table1.equalsIgnoreCase(table2)) {
          stringPair.set(nodeType1 + " on " + table1,nodeType2 + " on " + table2);
          System.out.println("Diff table at leaf" + 0 + " :");
          System.out.println(stringPair);
        }
 else         if (!nodeType1.equalsIgnoreCase(nodeType2)) {
          stringPair.set(nodeType1 + " on " + table1,nodeType2 + " on " + table2);
          System.out.println("Diff scan at leaf " + 0 + " :");
          System.out.println(stringPair);
        }
 else         if (nodeType1.equalsIgnoreCase(PlanNodeType.INDEXSCAN.name())) {
          String index1=j1.getString(IndexScanPlanNode.Members.TARGET_INDEX_NAME.name());
          String index2=j2.getString(IndexScanPlanNode.Members.TARGET_INDEX_NAME.name());
          if (!index1.equalsIgnoreCase(index2)) {
            stringPair.set(nodeType1 + " on " + table1+ " using "+ index1,nodeType2 + " on " + table2+ " using "+ index2);
            System.out.println("Diff index at leaf" + 0 + ": ");
            System.out.println(stringPair);
          }
 else           System.out.println("Same at " + 0);
        }
 else         System.out.println("Same at " + 0);
      }
 else {
        System.out.println("Join query");
        for (int i=0; i < max; i++) {
          JSONObject j1=new JSONObject(list1.get(i).toJSONString());
          JSONObject j2=new JSONObject(list2.get(i).toJSONString());
          String table1=j1.getString(AbstractScanPlanNode.Members.TARGET_TABLE_NAME.name());
          String table2=j2.getString(AbstractScanPlanNode.Members.TARGET_TABLE_NAME.name());
          String nodeType1=j1.getString(AbstractPlanNode.Members.PLAN_NODE_TYPE.name());
          String nodeType2=j2.getString(AbstractPlanNode.Members.PLAN_NODE_TYPE.name());
          if (!table1.equalsIgnoreCase(table2)) {
            stringPair.set(nodeType1 + " on " + table1,nodeType2 + " on " + table2);
            System.out.println("Diff table at leaf " + i + " :");
            System.out.println(stringPair);
          }
 else           if (!nodeType1.equalsIgnoreCase(nodeType2)) {
            stringPair.set(nodeType1 + " on " + table1,nodeType2 + " on " + table2);
            System.out.println("Diff scan at leaf " + i + " :");
            System.out.println(stringPair);
          }
 else           if (nodeType1.equalsIgnoreCase(PlanNodeType.INDEXSCAN.name())) {
            String index1=j1.getString(IndexScanPlanNode.Members.TARGET_INDEX_NAME.name());
            String index2=j2.getString(IndexScanPlanNode.Members.TARGET_INDEX_NAME.name());
            if (!index1.equalsIgnoreCase(index2)) {
              stringPair.set(nodeType1 + " on " + table1+ " using "+ index1,nodeType2 + " on " + table2+ " using "+ index2);
              System.out.println("Diff index at leaf " + i + ": ");
              System.out.println(stringPair);
            }
 else {
              System.out.println("Same at leaf " + i);
            }
          }
 else           System.out.println("Same at leaf " + i);
        }
      }
    }
 catch (    JSONException e) {
      e.printStackTrace();
    }
  }
}
