{
  if (input == null)   return;
  setAndOffsetColumnIndexes(context,input.m_left,offset,tableName,outputColumns);
  setAndOffsetColumnIndexes(context,input.m_right,offset,tableName,outputColumns);
  if (input instanceof TupleValueExpression) {
    TupleValueExpression expr=(TupleValueExpression)input;
    if (expr.m_tableName.equals(tableName)) {
      expr.m_columnIndex+=offset;
    }
    final String exprTableName=expr.getTableName();
    final String columnName=expr.getColumnName();
    int ii=0;
    for (    Integer colGuid : outputColumns) {
      PlanColumn info=context.get(colGuid);
      if (info.originTableName().equals(exprTableName)) {
        if (info.displayName().equals(columnName)) {
          expr.setColumnIndex(ii);
          return;
        }
      }
      ii++;
    }
  }
}
