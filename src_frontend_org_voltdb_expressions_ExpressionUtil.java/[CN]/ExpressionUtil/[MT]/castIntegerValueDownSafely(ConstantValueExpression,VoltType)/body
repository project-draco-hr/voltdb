{
  if (expr.m_isNull) {
    expr.setValueType(integerType);
    expr.setValueSize(integerType.getLengthInBytesForFixedTypes());
    return;
  }
  long value=Long.parseLong(expr.getValue());
  if (integerType == VoltType.BIGINT) {
    if (value == VoltType.NULL_BIGINT)     throw new NumberFormatException("Constant value underflows BIGINT type.");
  }
  if (integerType == VoltType.INTEGER) {
    if ((value > Integer.MAX_VALUE) || (value <= VoltType.NULL_INTEGER))     throw new NumberFormatException("Constant value overflows/underflows INTEGER type.");
  }
  if (integerType == VoltType.SMALLINT) {
    if ((value > Short.MAX_VALUE) || (value <= VoltType.NULL_SMALLINT))     throw new NumberFormatException("Constant value overflows/underflows SMALLINT type.");
  }
  if (integerType == VoltType.TINYINT) {
    if ((value > Byte.MAX_VALUE) || (value <= VoltType.NULL_TINYINT))     throw new NumberFormatException("Constant value overflows/underflows TINYINT type.");
  }
  expr.setValueType(integerType);
  expr.setValueSize(integerType.getLengthInBytesForFixedTypes());
}
