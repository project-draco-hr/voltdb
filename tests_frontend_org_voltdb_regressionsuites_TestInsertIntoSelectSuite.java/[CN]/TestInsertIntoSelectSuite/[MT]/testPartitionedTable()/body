{
  final Client client=getClient();
  for (int i=0; i < 10; i++) {
    ClientResponse resp=client.callProcedure("P1.insert",i,Integer.toHexString(i));
    assertEquals(ClientResponse.SUCCESS,resp.getStatus());
    assertEquals(1,resp.getResults()[0].asScalarLong());
  }
  ClientResponse resp;
  resp=client.callProcedure("@AdHoc","insert into P2 (a1, a2) select 100+b1, a2 from P1 where b1 >= 6");
  assertEquals(ClientResponse.SUCCESS,resp.getStatus());
  VoltTable vt=resp.getResults()[0];
  assertTrue(vt.advanceRow());
  assertEquals(4,vt.getLong(0));
  resp=client.callProcedure("CountP1");
  assertEquals(ClientResponse.SUCCESS,resp.getStatus());
  assertEquals(10,resp.getResults()[0].asScalarLong());
  resp=client.callProcedure("CountP2");
  assertEquals(ClientResponse.SUCCESS,resp.getStatus());
  assertEquals(4,resp.getResults()[0].asScalarLong());
  resp=client.callProcedure("@AdHoc","select count(*) from P2 where a1 > 100");
  assertEquals(ClientResponse.SUCCESS,resp.getStatus());
  assertEquals(4,resp.getResults()[0].asScalarLong());
}
