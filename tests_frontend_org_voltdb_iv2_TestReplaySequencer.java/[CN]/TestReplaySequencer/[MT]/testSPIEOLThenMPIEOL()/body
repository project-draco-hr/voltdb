{
  ReplaySequencer dut=new ReplaySequencer();
  TransactionInfoBaseMessage init1=makeIv2InitTask(101L);
  TransactionInfoBaseMessage sentinel1=makeSentinel(1L);
  TransactionInfoBaseMessage init2=makeIv2InitTask(102L);
  TransactionInfoBaseMessage init3=makeIv2InitTask(103L);
  TransactionInfoBaseMessage sentinel2=makeSentinel(2L);
  TransactionInfoBaseMessage init4=makeIv2InitTask(104L);
  TransactionInfoBaseMessage init5=makeIv2InitTask(105L);
  assertFalse(dut.offer(101L,init1));
  assertNull(dut.poll());
  assertTrue(dut.offer(1L,sentinel1));
  assertNull(dut.poll());
  assertTrue(dut.offer(102L,init2));
  assertTrue(dut.offer(103L,init3));
  assertNull(dut.poll());
  assertTrue(dut.offer(2L,sentinel2));
  assertTrue(dut.offer(104L,init4));
  assertTrue(dut.offer(105L,init5));
  assertNull(dut.poll());
  assertTrue(dut.offer(0L,makeEOL(false)));
  assertNull(dut.poll());
  TransactionInfoBaseMessage frag1=makeFragment(1L);
  TransactionInfoBaseMessage complete1=makeCompleteTxn(1L);
  assertTrue(dut.offer(1L,frag1));
  assertEquals(frag1,dut.poll());
  assertEquals(init2,dut.poll());
  assertEquals(init3,dut.poll());
  assertNull(dut.poll());
  assertFalse(dut.offer(1L,complete1));
  assertNull(dut.poll());
  assertTrue(dut.offer(0L,makeEOL(true)));
  assertTrue(dut.isMPIEOLReached());
  assertEquals(init4,dut.poll());
  assertEquals(init5,dut.poll());
  assertNull(dut.poll());
}
