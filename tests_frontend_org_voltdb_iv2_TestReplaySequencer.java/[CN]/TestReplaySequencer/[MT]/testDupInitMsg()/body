{
  ReplaySequencer dut=new ReplaySequencer();
  TransactionInfoBaseMessage init1=makeIv2InitTask(1L);
  assertFalse(dut.offer(1L,init1));
  assertNotNull(dut.dedupe(1L,init1));
  assertTrue(dut.offer(1L,init1));
  assertNull(dut.poll());
  TransactionInfoBaseMessage sntl1=makeSentinel(2L);
  TransactionInfoBaseMessage init2=makeIv2InitTask(3L);
  assertTrue(dut.offer(2L,sntl1));
  assertTrue(dut.offer(3L,init2));
  assertNotNull(dut.dedupe(3L,init2));
  assertTrue(dut.offer(3L,init2));
  assertNull(dut.poll());
  TransactionInfoBaseMessage frag1=makeFragment(2L);
  assertTrue(dut.offer(2L,frag1));
  assertEquals(frag1,dut.poll());
  assertEquals(init2,dut.poll());
  assertNull(dut.poll());
  assertNotNull(dut.dedupe(1L,init1));
  assertTrue(dut.offer(1L,init1));
  assertNull(dut.poll());
}
