{
  ReplaySequencer dut=new ReplaySequencer();
  TransactionInfoBaseMessage sentinel1=makeSentinel(1L);
  TransactionInfoBaseMessage frag1=makeFragment(1L);
  TransactionInfoBaseMessage frag2=makeFragment(1L);
  TransactionInfoBaseMessage complete1=makeCompleteTxn(1L);
  assertTrue(dut.offer(1L,sentinel1));
  assertTrue(dut.offer(1L,frag1));
  assertEquals(frag1,dut.poll());
  assertNull(dut.poll());
  assertFalse(dut.offer(1L,frag2));
  assertFalse(dut.offer(1L,complete1));
  assertNull(dut.poll());
  assertTrue(dut.offer(1L,sentinel1));
  assertTrue(dut.offer(1L,frag1));
  assertEquals(frag1,dut.poll());
  assertNull(dut.poll());
  assertFalse(dut.offer(1L,frag2));
  assertFalse(dut.offer(1L,complete1));
  assertNull(dut.poll());
}
