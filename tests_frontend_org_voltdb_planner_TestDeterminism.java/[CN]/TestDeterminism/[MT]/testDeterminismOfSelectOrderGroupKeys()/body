{
  assertPlanDeterminism("select z, max(a)    from ttree group by z    order by z   ;",ORDERED);
  assertPlanDeterminism("select    max(a)    from ttree group by z    order by z   ;",ORDERED);
  assertPlanDeterminism("select z, max(a), b from ttree group by z, b order by z, b;",ORDERED);
  assertPlanDeterminism("select z, max(a)    from ttree group by z, b order by z, b;",ORDERED);
  assertPlanDeterminism("select    max(a)    from ttree group by z, b order by z, b;",ORDERED);
  assertPlanDeterminism("select z, max(a), b from ttree group by z, b order by z   ;",UNORDERED);
  assertPlanDeterminism("select z, max(a)    from ttree group by z, b order by z   ;",UNORDERED);
  assertPlanDeterminism("select    max(a)    from ttree group by z, b order by z   ;",UNORDERED);
  assertPlanDeterminism("select z, max(a), max(b) from ttree group by z order by z, max(b);",ORDERED);
  assertPlanDeterminism("select z, max(a), max(b) from ttree group by z order by z, 3;",ORDERED);
  assertPlanDeterminism("select    max(a), max(b) from ttree group by z order by z, max(b);",ORDERED);
  assertPlanDeterminism("select z, max(a), max(b) from ttree group by z order by max(b), z;",ORDERED);
  assertPlanDeterminism("select z, max(a), max(b) from ttree group by z order by max(b), z;",ORDERED);
}
