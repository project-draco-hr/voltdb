{
  assertPlanDeterminismNeedsOrdering("select z, max(a)    from ttree group by z   ","order by z   ");
  assertPlanDeterminismNeedsOrdering("select    max(a)    from ttree group by z   ","order by z   ","order by 1");
  assertPlanDeterminismNeedsOrdering("select z, max(a), b from ttree group by z, b","order by z, b");
  assertPlanDeterminismNeedsOrdering("select z, max(a)    from ttree group by z, b","order by z, b","order by 1, 2");
  assertPlanDeterminismNeedsOrdering("select    max(a)    from ttree group by z, b","order by z, b","order by 1");
  assertPlanDeterminismNeedsOrdering("select z, max(a)      , b from ttree group by z, b order by z   ",", b","order by 1, 3");
  assertPlanDeterminismNeedsOrdering("select z, max(a) max_a, b from ttree group by z, b order by z   ",", b","order by 1, 2");
  assertPlanDeterminismNeedsOrdering("select    max(a)    from ttree group by z, b order by z   ",", b","order by 1");
  assertPlanDeterminismNeedsOrdering("select z, max(a), max(b) from ttree group by z","order by z, max(b)","order by z, 3");
  assertPlanDeterminismNeedsOrdering("select z, max(a), max(b) from ttree group by z","order by z, 3     ","order by z, 3");
  assertPlanDeterminismNeedsOrdering("select    max(a), max(b) from ttree group by z","order by z, max(b)","order by 1, 2");
  assertPlanDeterminismNeedsOrdering("select z, max(a), max(b) from ttree group by z order by max(b)",", z","order by 3, 1");
  assertPlanDeterminismNeedsOrdering("select z, max(a), max(b) from ttree group by z","order by z, max(a)","order by 1, 3");
}
