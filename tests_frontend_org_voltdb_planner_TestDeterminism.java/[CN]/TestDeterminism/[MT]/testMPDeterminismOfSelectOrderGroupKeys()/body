{
  assertMPPlanDeterminismNeedsOrdering("select z, max(a)    from ptree group by z   ","order by z   ");
  assertMPPlanDeterminismNeedsOrdering("select    max(a)    from ptree group by z   ","order by z   ","order by 1");
  assertMPPlanDeterminismNeedsOrdering("select z, max(a), b from ptree group by z, b","order by z, b");
  assertMPPlanDeterminismNeedsOrdering("select z, max(a)    from ptree group by z, b","order by z, b","order by 1, 2");
  assertMPPlanDeterminismNeedsOrdering("select    max(a)    from ptree group by z, b","order by z, b","order by 1");
  assertMPPlanDeterminismNeedsOrdering("select z, max(a)      , b from ptree group by z, b order by z   ",", b","order by 1, 3");
  assertMPPlanDeterminismNeedsOrdering("select z, max(a) max_a, b from ptree group by z, b order by z   ",", b","order by 1, 2");
  assertMPPlanDeterminismNeedsOrdering("select    max(a)    from ptree group by z, b order by z   ",", b","order by 1");
  assertMPPlanDeterminismNeedsOrdering("select z, max(a), max(b) from ptree group by z","order by z, max(b)","order by z, 3");
  assertMPPlanDeterminismNeedsOrdering("select z, max(a), max(b) from ptree group by z","order by z, 3     ","order by z, 3");
  assertMPPlanDeterminismNeedsOrdering("select    max(a), max(b) from ptree group by z","order by z, max(b)","order by 1, 2");
  assertMPPlanDeterminismNeedsOrdering("select z, max(a), max(b) from ptree group by z order by max(b)",", z","order by 3, 1");
  assertMPPlanDeterminismNeedsOrdering("select z, max(a), max(b) from ptree group by z","order by z, max(a)","order by 1, 3");
}
