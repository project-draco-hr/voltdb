{
  String sql;
  String tryOrderBy;
  String tryPostSubOrderBy;
  sql="select z, max(a)    from ptree group by z   ";
  tryOrderBy="order by z   ";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy);
  sql="select    max(a)    from ptree group by z   ";
  tryOrderBy="order by z   ";
  tryPostSubOrderBy="order by 1";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy,tryPostSubOrderBy);
  sql="select z, max(a), b from ptree group by z, b";
  tryOrderBy="order by z, b";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy);
  sql="select z, max(a)    from ptree group by z, b";
  tryOrderBy="order by z, b";
  tryPostSubOrderBy="order by 1, 2";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy,tryPostSubOrderBy);
  sql="select    max(a)    from ptree group by z, b";
  tryOrderBy="order by z, b";
  tryPostSubOrderBy="order by 1";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy,tryPostSubOrderBy);
  sql="select z, max(a)      , b from ptree group by z, b order by z   ";
  tryOrderBy=", b";
  tryPostSubOrderBy="order by 1, 3";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy,tryPostSubOrderBy);
  sql="select z, max(a) max_a, b from ptree group by z, b order by z   ";
  tryOrderBy=", b";
  tryPostSubOrderBy="order by 1, 2";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy);
  sql="select    max(a)          from ptree group by z, b order by z   ";
  tryOrderBy=", b";
  tryPostSubOrderBy="order by 1";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy,tryPostSubOrderBy);
  sql="select z, max(a), max(b)  from ptree group by z";
  tryOrderBy="order by z, max(b)";
  tryPostSubOrderBy="order by z, 3";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy,tryPostSubOrderBy);
  sql="select z, max(a), max(b)  from ptree group by z";
  tryOrderBy="order by z, 3     ";
  tryPostSubOrderBy="order by z, 3";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy,tryPostSubOrderBy);
  sql="select    max(a), max(b)  from ptree group by z";
  tryOrderBy="order by z, max(b)";
  tryPostSubOrderBy="order by 1, 2";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy,tryPostSubOrderBy);
  sql="select z, max(a), max(b)  from ptree group by z order by max(b)";
  tryOrderBy=", z";
  tryPostSubOrderBy="order by 3, 1";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy,tryPostSubOrderBy);
  sql="select z, max(a), max(b)  from ptree group by z";
  tryOrderBy="order by z, max(a)";
  tryPostSubOrderBy="order by 1, 2";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy,tryPostSubOrderBy);
  sql="select z, max(a)          from ptree group by z";
  tryOrderBy="order by z, max(b)";
  tryPostSubOrderBy="order by 1";
  sql="select    max(a)          from ptree group by z";
  tryOrderBy="order by z, max(b)";
  tryPostSubOrderBy="order by 1";
}
