{
  assertMPPlanDeterminismNeedsOrdering("select X.a, X.z, Y.z from puniqcombo X, punique Y where X.a = Y.a","order by X.a, X.c, X.b, Y.a");
  assertMPPlanDeterminismNeedsOrdering("select X.a, X.z, Y.z from puniqcombo X, punique Y where X.a = Y.a","order by X.b, X.a, Y.a, X.c");
  assertMPPlanDeterminismNeedsOrdering("select X.a, X.z, Y.z from puniqcombo X, punique Y where X.a = Y.a","order by X.z, X.a, X.c, X.b, Y.a");
  assertMPPlanDeterminismNeedsOrdering("select X.a, X.z, Y.z, X.z + Y.z from puniqcombo X, punique Y where X.a = Y.a","order by 4, X.z, X.a, X.c, X.b, Y.a");
  assertMPPlanDeterminismNeedsOrdering("select X.a l, X.z m, Y.z n from ptree X, punique Y where X.a = Y.a order by X.a, X.c, X.b, Y.a",", X.z, Y.z","order by l, m, n");
  assertMPPlanDeterminismNeedsOrdering("select X.a l, X.z m, Y.z n from ptree X, punique Y where X.a = Y.a order by X.b, X.a, Y.a, X.c",", X.z, Y.z","order by l, m, n");
  assertMPPlanDeterminismNeedsOrdering("select X.a l, X.z m, Y.z n from ptree X, punique Y where X.a = Y.a order by X.z, X.a, X.c, X.b, Y.a",", X.z, Y.z","order by l, m, n");
  assertMPPlanDeterminismNeedsOrdering("select X.a, X.z, Y.z, X.z + Y.z from ptree X, punique Y where X.a = Y.a order by 4, X.z, X.a, X.c, X.b, Y.a",", Y.z","order by 1, 2, 3, 4");
  assertMPPlanNeedsSaferDeterminismCombo("select X.a, X.z, Y.z from puniqcombo X, punique Y where X.a = Y.a");
  assertMPPlanNeedsSaferDeterminismCombo("select X.a, X.z, Y.z from puniqcombo X, punique Y where X.a = Y.a order by X.a, X.b, Y.a");
  assertMPPlanNeedsSaferDeterminismCombo("select X.a, X.z, Y.z from puniqcombo X, punique Y where X.a = Y.a order by X.a, X.c + X.b, X.b, Y.a");
}
