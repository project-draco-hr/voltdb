{
  String sql;
  String tryOrderBy;
  String tryPostSubOrderBy;
  sql="select X.a, X.z, Y.z from puniqcombo X, punique Y where X.a = Y.a";
  tryOrderBy="order by X.a, X.c, X.b, Y.a";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy);
  sql="select X.a, X.z, Y.z from puniqcombo X, punique Y where X.a = Y.a";
  tryOrderBy="order by X.b, X.a, Y.a, X.c";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy);
  sql="select X.a, X.z, Y.z from puniqcombo X, punique Y where X.a = Y.a";
  tryOrderBy="order by X.z, X.a, X.c, X.b, Y.a";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy);
  sql="select X.a, X.z, Y.z, X.z + Y.z from puniqcombo X, punique Y where X.a = Y.a";
  tryOrderBy="order by 4, X.z, X.a, X.c, X.b, Y.a";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy);
  sql="select X.a l, X.z m, Y.z n from ptree X, punique Y where X.a = Y.a order by X.a, X.c, X.b, Y.a";
  tryOrderBy=", X.z, Y.z";
  tryPostSubOrderBy="order by l, m, n";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy,tryPostSubOrderBy);
  sql="select X.a l, X.z m, Y.z n from ptree X, punique Y where X.a = Y.a order by X.b, X.a, Y.a, X.c";
  tryOrderBy=", X.z, Y.z";
  tryPostSubOrderBy="order by l, m, n";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy,tryPostSubOrderBy);
  sql="select X.a l, X.z m, Y.z n from ptree X, punique Y where X.a = Y.a order by X.z, X.a, X.c, X.b, Y.a";
  tryOrderBy=", X.z, Y.z";
  tryPostSubOrderBy="order by l, m, n";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy,tryPostSubOrderBy);
  sql="select X.a, X.z, Y.z, X.z + Y.z from ptree X, punique Y where X.a = Y.a order by 4, X.z, X.a, X.c, X.b, Y.a";
  tryOrderBy=", Y.z";
  tryPostSubOrderBy="order by 1, 2, 3, 4";
  assertMPPlanDeterminismNeedsOrdering(sql,tryOrderBy,tryPostSubOrderBy);
  sql="select X.a, X.z, Y.z " + "from puniqcombo X, punique Y where X.a = Y.a";
  assertMPPlanNeedsSaferDeterminismCombo(sql);
  sql="select X.a, X.z, Y.z " + "from puniqcombo X, punique Y where X.a = Y.a " + "order by X.a, X.b, Y.a";
  assertMPPlanNeedsSaferDeterminismCombo(sql);
  sql="select X.a, X.z, Y.z " + "from puniqcombo X, punique Y where X.a = Y.a " + "order by X.a, X.c + X.b, X.b, Y.a";
  assertMPPlanNeedsSaferDeterminismCombo(sql);
}
