{
  m_hostId=hostId;
  m_initiator=null;
  m_snapshotMonitor=snapshotMonitor;
  m_callback=callback;
  m_action=action;
  m_zk=zk;
  m_clEnabled=VoltDB.instance().getConfig().m_isEnterprise ? clEnabled : false;
  m_clPath=clPath;
  m_clSnapshotPath=clSnapshotPath;
  m_snapshotPath=snapshotPath;
  m_allPartitions=allPartitions;
  m_liveHosts=liveHosts;
  m_voltdbrootPath=voltdbrootPath;
  m_restoreAdapter.setCallback(new SimpleClientResponseAdapter.Callback(){
    @Override public void handleResponse(    ClientResponse res){
      boolean failure=false;
      if (res.getStatus() != ClientResponse.SUCCESS) {
        failure=true;
      }
      VoltTable[] results=res.getResults();
      if (results == null || results.length != 1) {
        failure=true;
      }
      while (!failure && results[0].advanceRow()) {
        String resultStatus=results[0].getString("RESULT");
        if (!resultStatus.equalsIgnoreCase("success")) {
          failure=true;
        }
      }
      if (failure) {
        for (        VoltTable result : results) {
          LOG.fatal(result);
        }
        VoltDB.crashGlobalVoltDB("Failed to restore from snapshot: " + res.getStatusString(),false,null);
      }
 else {
        Thread networkHandoff=new Thread(){
          @Override public void run(){
            m_changeStateFunctor.run();
          }
        }
;
        networkHandoff.start();
      }
    }
  }
);
  initialize();
}
