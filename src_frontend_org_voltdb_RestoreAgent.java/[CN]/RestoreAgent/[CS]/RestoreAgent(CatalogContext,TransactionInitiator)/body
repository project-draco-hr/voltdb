{
  if (VoltDB.instance().getHostMessenger() == null) {
    m_hostId=null;
  }
 else {
    m_hostId=VoltDB.instance().getHostMessenger().getHostId();
  }
  m_context=context;
  m_initiator=initiator;
  m_zk=new ZooKeeper("ning",3000,this);
  zkBarrierNode=RESTORE_BARRIER + "/" + m_hostId;
  m_allPartitions=new int[m_context.numberOfPartitions];
  int i=0;
  for (  Partition p : m_context.cluster.getPartitions()) {
    m_allPartitions[i++]=Integer.parseInt(p.getTypeName());
  }
  initialize();
}
