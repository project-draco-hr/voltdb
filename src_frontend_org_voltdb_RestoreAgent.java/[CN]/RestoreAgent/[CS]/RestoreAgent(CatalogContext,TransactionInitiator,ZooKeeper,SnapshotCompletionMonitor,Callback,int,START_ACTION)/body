{
  m_hostId=hostId;
  m_context=context;
  m_initiator=initiator;
  m_snapshotMonitor=snapshotMonitor;
  m_callback=callback;
  m_action=action;
  m_zk=zk;
  zkBarrierNode=RESTORE_BARRIER + "/" + m_hostId;
  m_allPartitions=new int[m_context.numberOfPartitions];
  int i=0;
  for (  Partition p : m_context.cluster.getPartitions()) {
    m_allPartitions[i++]=Integer.parseInt(p.getTypeName());
  }
  initialize();
}
