{
  List<String> paths=new ArrayList<String>();
  paths.add(m_context.cluster.getLogconfig().get("log").getInternalsnapshotpath());
  if (m_context.cluster.getDatabases().get("database").getSnapshotschedule().get("default") != null) {
    paths.add(m_context.cluster.getDatabases().get("database").getSnapshotschedule().get("default").getPath());
  }
  if (m_context.cluster.getFaultsnapshots().get("CLUSTER_PARTITION") != null) {
    paths.add(m_context.cluster.getFaultsnapshots().get("CLUSTER_PARTITION").getPath());
  }
  TreeMap<Long,Snapshot> snapshots=new TreeMap<Long,Snapshot>();
  FileFilter filter=new SnapshotUtil.SnapshotFilter();
  for (  String path : paths) {
    SnapshotUtil.retrieveSnapshotFiles(new File(path),snapshots,filter,0,true);
  }
  return snapshots;
}
