{
  Comparator<Long> comparator=new Comparator<Long>(){
    @Override public int compare(    Long arg0,    Long arg1){
      return -arg0.compareTo(arg1);
    }
  }
;
  List<String> paths=new ArrayList<String>();
  paths.add(m_context.cluster.getLogconfig().get("log").getInternalsnapshotpath());
  paths.add(m_context.cluster.getDatabases().get("database").getSnapshotschedule().get("default").getPath());
  paths.add(m_context.cluster.getFaultsnapshots().get("CLUSTER_PARTITION").getPath());
  TreeMap<Long,Snapshot> snapshots=new TreeMap<Long,Snapshot>(comparator);
  FileFilter filter=new SnapshotUtil.SnapshotFilter();
  for (  String path : paths) {
    SnapshotUtil.retrieveSnapshotFiles(new File(path),snapshots,filter,0,true);
  }
  return snapshots;
}
