{
  if (!truncationSnapshot) {
    VoltDB.crashGlobalVoltDB("Failed to truncate command logs by snapshot",false,null);
  }
 else {
    m_truncationSnapshot=txnId;
    m_truncationSnapshotPerPartition=partitionTxnIds;
    m_replayAgent.returnAllSegments();
    changeState();
  }
  return new CountDownLatch(0);
}
