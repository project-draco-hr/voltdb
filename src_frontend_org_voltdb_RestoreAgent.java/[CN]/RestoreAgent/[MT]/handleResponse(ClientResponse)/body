{
  if (res.getStatus() != ClientResponse.SUCCESS) {
    if (m_state == State.RESTORE && res.getStatus() == ClientResponse.USER_ABORT) {
      LOG.info("No snapshot to restore from");
    }
 else {
      LOG.fatal("Failed to truncate command logs by snapshot: " + res.getStatusString());
      VoltDB.crashVoltDB();
    }
  }
 else {
    VoltTable[] results=res.getResults();
    if (results.length != 1) {
      LOG.fatal("Snapshot response doesn't contain any results");
      VoltDB.crashVoltDB();
    }
    while (results[0].advanceRow()) {
      String err=results[0].getString("ERR_MSG");
      if (!err.isEmpty()) {
        LOG.fatal(err);
        VoltDB.crashVoltDB();
      }
      String result=results[0].getString("RESULT");
      if (!result.equalsIgnoreCase("success")) {
        String host=results[0].getString("HOSTNAME");
        LOG.fatal(host + " failed: " + result);
        VoltDB.crashVoltDB();
      }
    }
  }
  changeState();
}
