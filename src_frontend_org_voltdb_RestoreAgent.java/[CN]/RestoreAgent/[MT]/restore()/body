{
  final long txnId=1l;
  if (VoltDB.instance().getHostMessenger() != null) {
    int lowestSite=m_context.siteTracker.getLowestLiveNonExecSiteId();
    int lowestHost=m_context.siteTracker.getHostForSite(lowestSite);
    if (VoltDB.instance().getHostMessenger().getHostId() == lowestHost) {
      String path=m_context.cluster.getLogconfig().get("log").getInternalsnapshotpath();
      initSnapshotWork(txnId,Pair.of("@SnapshotRestore",new Object[]{path,CL_NONCE}));
    }
 else {
      changeState();
    }
  }
  new Thread(new Runnable(){
    @Override public void run(){
      while (m_state == State.RESTORE) {
        m_initiator.sendHeartbeat(txnId + 1);
        try {
          Thread.sleep(500);
        }
 catch (        InterruptedException e) {
        }
      }
    }
  }
).start();
}
