{
  SnapshotInfo infoWithMinHostId=null;
  if (lastSnapshot != null) {
    Iterator<SnapshotInfo> i=lastSnapshot.iterator();
    while (i.hasNext()) {
      SnapshotInfo next=i.next();
      if (infoWithMinHostId == null || next.hostId < infoWithMinHostId.hostId) {
        infoWithMinHostId=next;
      }
    }
    assert(infoWithMinHostId != null);
    assert(infoWithMinHostId.hostId != -1);
    LOG.debug("Snapshot to restore: " + infoWithMinHostId.txnId);
  }
  return infoWithMinHostId;
}
