{
  if (m_state == State.RESTORE) {
    waitForSnapshotTxnId();
    exitRestore();
    m_replayAgent.replay();
    m_state=State.REPLAY;
  }
 else   if (m_state == State.REPLAY) {
    m_state=State.TRUNCATE;
  }
 else   if (m_state == State.TRUNCATE) {
    try {
      m_zk.close();
    }
 catch (    InterruptedException ignore) {
    }
    VoltDB.instance().onRestoreCompletion();
  }
}
