{
  if (fragmentId == SysProcFragmentId.PF_lastCommittedScan) {
    System.out.println("SYSPROC: LastCommitedTransaction PF1");
    VoltTable result=new VoltTable(new VoltTable.ColumnInfo("TxnId",VoltType.BIGINT));
    result.addRow(context.getLastCommittedTxnId());
    return new DependencyPair(DEP_lastCommittedScan,result);
  }
  if (fragmentId == SysProcFragmentId.PF_lastCommittedResults) {
    System.out.println("SYSPROC: LastCommittedTransaction PF2");
    long lastcommitted=-1;
    assert(dependencies.size() == 1);
    List<VoltTable> dep=dependencies.get(DEP_lastCommittedScan);
    int i=0;
    for (    VoltTable vt : dep) {
      long txnid=vt.asScalarLong();
      System.out.printf("SYSPROC: LastCommittedTransaction PF2 dep %d lctid %d\n",i++,txnid);
      lastcommitted=txnid;
    }
    assert(lastcommitted > -1);
    VoltTable result=new VoltTable(new VoltTable.ColumnInfo("TxnId",VoltType.BIGINT));
    result.addRow(lastcommitted);
    return new DependencyPair(DEP_lastCommittedResults,result);
  }
  assert(false);
  return null;
}
