{
  bytesAllocatedGlobally.getAndAdd(bufferSize);
  bytesAllocatedLocally+=bufferSize;
  try {
    final ByteBuffer buffer=ByteBuffer.allocateDirect(bufferSize);
    return buffer;
  }
 catch (  java.lang.OutOfMemoryError e) {
    m_logger.fatal("Total bytes allocated globally before OOM is " + bytesAllocatedGlobally.get(),e);
    VoltDB.crashVoltDB();
  }
  return null;
}
