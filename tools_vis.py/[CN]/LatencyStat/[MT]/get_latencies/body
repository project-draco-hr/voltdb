def get_latencies(self, start_time, count):
    res = []
    latencies = {}
    self.cursor.execute((self.INSTANCES % (start_time, count)))
    res = list(self.cursor.fetchall())
    for i in res:
        start_time = i['time']
        hosts = i['hosts']
        self.cursor.execute((self.LATENCY % start_time))
        latency = self.cursor.fetchone()
        i['time'] = datetime.date.fromtimestamp((start_time / 1000.0))
        i.update(latency)
        key = (i['time'], hosts)
        if (latency['latency'] == None):
            continue
        if ((key not in latencies) or (latency['latency'] < latencies[key]['latency'])):
            latencies[key] = i
    return latencies.values()
