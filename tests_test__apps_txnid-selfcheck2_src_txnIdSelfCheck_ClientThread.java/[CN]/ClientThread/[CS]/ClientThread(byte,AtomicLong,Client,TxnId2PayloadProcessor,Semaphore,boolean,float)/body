{
  setName("ClientThread(CID=" + String.valueOf(cid) + ")");
  setDaemon(true);
  m_type=Type.typeFromId(mpRatio,allowInProcAdhoc);
  m_cid=cid;
  m_client=client;
  m_processor=processor;
  m_txnsRun=txnsRun;
  m_permits=permits;
  String sql1=String.format("select * from partitioned where cid = %d order by rid desc limit 1",cid);
  String sql2=String.format("select * from replicated  where cid = %d order by rid desc limit 1",cid);
  String sql3=String.format("select count(*) FROM dimension WHERE cid = %d",cid);
  String sql4=String.format("insert into dimension (cid, desc) VALUES (%d, %d)",cid,cid);
  VoltTable t1;
  VoltTable t2;
  while (true) {
    try {
      t1=client.callProcedure("@AdHoc",sql1).getResults()[0];
      t2=client.callProcedure("@AdHoc",sql2).getResults()[0];
      if (client.callProcedure("@AdHoc",sql3).getResults()[0].fetchRow(0).getLong(0) == 0)       client.callProcedure("@AdHoc",sql4);
      break;
    }
 catch (    Exception e) {
      log.warn("ClientThread threw exception in initialization, will retry",e);
    }
  }
  long pNextRid=(t1.getRowCount() == 0) ? 1 : t1.fetchRow(0).getLong("rid") + 1;
  long rNextRid=(t2.getRowCount() == 0) ? 1 : t2.fetchRow(0).getLong("rid") + 1;
  m_nextRid=pNextRid > rNextRid ? pNextRid : rNextRid;
}
