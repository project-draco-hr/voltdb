{
  if (size == 0) {
    return emptyMap(comparator);
  }
  ImmutableList.Builder<K> keyBuilder=ImmutableList.builder();
  ImmutableList.Builder<V> valueBuilder=ImmutableList.builder();
  for (int i=0; i < size; i++) {
    Entry<K,V> entry=entries[i];
    keyBuilder.add(entry.getKey());
    valueBuilder.add(entry.getValue());
  }
  return new RegularImmutableSortedMap<K,V>(new RegularImmutableSortedSet<K>(keyBuilder.build(),comparator),valueBuilder.build());
}
