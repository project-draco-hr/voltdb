{
  String simpleSchema="create table blah (" + "ival bigint default 23 not null, " + "sval varchar(200) default 'foo', "+ "dateval timestamp, "+ "fval float, "+ "decval decimal, "+ "PRIMARY KEY(ival));";
  File schemaFile=VoltProjectBuilder.writeStringToTempFile(simpleSchema);
  String schemaPath=schemaFile.getPath();
  schemaPath=URLEncoder.encode(schemaPath,"UTF-8");
  VoltProjectBuilder builder=new VoltProjectBuilder();
  builder.addSchema(schemaPath);
  builder.addPartitionInfo("blah","ival");
  builder.addStmtProcedure("Insert","insert into blah values (?,?,?,?,?);");
  builder.addProcedures(CrazyBlahProc.class);
  boolean success=builder.compile("json.jar");
  assertTrue(success);
  VoltDB.Configuration config=new VoltDB.Configuration();
  config.m_httpAdminPort=8095;
  config.m_pathToCatalog="json.jar";
  ServerThread server=new ServerThread(config);
  server.start();
  server.waitForInitialization();
  ParameterSet pset=new ParameterSet();
  String responseJSON;
  Response response;
  pset.setParameters(1,"hello",new TimestampType(System.currentTimeMillis()),5.0,"5.0");
  responseJSON=callProcOverJSON("Insert",pset);
  System.out.println(responseJSON);
  response=responseFromJSON(responseJSON);
  assertEquals(null,response.exception);
  responseJSON=callProcOverJSON("Insert",pset);
  System.out.println(responseJSON);
  response=responseFromJSON(responseJSON);
  assertNotNull(response.exception);
  pset.setParameters(1,5,new double[]{1.5,6.0,4},new VoltTable(new VoltTable.ColumnInfo("foo",VoltType.BIGINT)),new BigDecimal[]{},new TimestampType(System.currentTimeMillis()));
  responseJSON=callProcOverJSON("CrazyBlahProc",pset);
  System.out.println(responseJSON);
  response=responseFromJSON(responseJSON);
  assertTrue(response.status == ClientResponse.SUCCESS);
  JSONObject jsonObj=new JSONObject(responseJSON);
  JSONArray results=jsonObj.getJSONArray("results");
  assertEquals(3,response.results.length);
  JSONObject table=results.getJSONObject(0);
  JSONArray data=table.getJSONArray("data");
  assertEquals(1,data.length());
  JSONArray row=data.getJSONArray(0);
  assertEquals(1,row.length());
  long value=row.getLong(0);
  assertEquals(1,value);
  pset.setParameters(1,VoltType.NULL_SMALLINT,new double[]{1.5,6.0,4},new VoltTable(new VoltTable.ColumnInfo("foo",VoltType.BIGINT)),new BigDecimal[]{},new TimestampType(System.currentTimeMillis()));
  responseJSON=callProcOverJSON("CrazyBlahProc",pset);
  System.out.println(responseJSON);
  response=responseFromJSON(responseJSON);
  assertFalse(response.status == ClientResponse.SUCCESS);
  pset.setParameters(1,Long.MAX_VALUE - 100,new double[]{1.5,6.0,4},new VoltTable(new VoltTable.ColumnInfo("foo",VoltType.BIGINT)),new BigDecimal[]{},new TimestampType(System.currentTimeMillis()));
  responseJSON=callProcOverJSON("CrazyBlahProc",pset);
  System.out.println(responseJSON);
  response=responseFromJSON(responseJSON);
  assertFalse(response.status == ClientResponse.SUCCESS);
  server.shutdown();
  server.join();
}
