{
  if (this instanceof TupleValueExpression) {
    TupleValueExpression tve=(TupleValueExpression)this;
    if (tve.m_tableName == null) {
      tve.m_tableName=tableScan.m_table.getTypeName();
    }
    if (tve.m_tableAlias == null) {
      tve.m_tableAlias=tableScan.m_tableAlias;
    }
    if (tve.m_columnName == null) {
      assert(tve.m_columnIndex >= 0);
      tve.m_columnName=tableScan.m_columnIndexToName.get(tve.m_columnIndex);
    }
    return this;
  }
  AbstractExpression lnode=null, rnode=null;
  ArrayList<AbstractExpression> newArgs=null;
  if (m_left != null) {
    lnode=m_left.replaceTVEsWithAlias(tableScan);
  }
  if (m_right != null) {
    rnode=m_right.replaceTVEsWithAlias(tableScan);
  }
  boolean changed=false;
  if (m_args != null) {
    newArgs=new ArrayList<AbstractExpression>();
    for (    AbstractExpression expr : m_args) {
      AbstractExpression ex=expr.replaceTVEsWithAlias(tableScan);
      newArgs.add(ex);
      if (ex != expr) {
        changed=true;
      }
    }
  }
  if (m_left != lnode || m_right != rnode || changed) {
    AbstractExpression resExpr=(AbstractExpression)this.clone();
    resExpr.setLeft(lnode);
    resExpr.setRight(rnode);
    resExpr.setArgs(newArgs);
    return resExpr;
  }
  return this;
}
