def sort(rows, sorted_cols):
    'Two steps:\n        1. find the subset of rows which have the same values in the ORDER BY\n        columns.\n        2. sort them on the rest of the columns.\n    '
    if (not sorted_cols):
        rows.sort(cmp=safecmp)
        return
    begin = 0
    prev = None
    unsorteds = (lambda row: project_unsorted(row, sorted_cols))
    for i in xrange(len(rows)):
        tmp = project_sorted(rows[i], sorted_cols)
        if (prev != tmp):
            if prev:
                rows[begin:i] = sorted(rows[begin:i], cmp=safecmp, key=unsorteds)
            prev = tmp
            begin = i
    rows[begin:] = sorted(rows[begin:], cmp=safecmp, key=unsorteds)
