def sort(l, sorted_cols):
    'Two steps:\n\n        1. find the subset of rows which have the same values in the ORDER BY\n        columns.\n        2. sort them on the rest of the columns.\n    '
    begin = 0
    end = 0
    prev = None
    key = (lambda x: extract_key(sorted_cols, x))
    for i in xrange(len(l)):
        if (not sorted_cols):
            l[:] = sorted(l, cmp=cmp, key=key)
            return
        tmp = filter_sorted(l[i], sorted_cols)
        if (prev != tmp):
            if (prev is not None):
                end = i
                l[begin:end] = sorted(l[begin:end], cmp=cmp, key=key)
            prev = tmp
            begin = i
    l[begin:] = sorted(l[begin:], cmp=cmp, key=key)
