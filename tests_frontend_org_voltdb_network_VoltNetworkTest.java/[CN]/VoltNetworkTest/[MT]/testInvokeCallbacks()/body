{
  MockSelector selector=new MockSelector();
  MockExecutorService executor=new MockExecutorService();
  VoltNetwork vn=new VoltNetwork(selector,executor);
  MockVoltPort vp=new MockVoltPort(vn,new MockInputHandler());
  MockSelectionKey selectionKey=new MockSelectionKey();
  selectionKey.interestOps(SelectionKey.OP_WRITE);
  selector.setFakeKey(selectionKey);
  vp.m_selectionKey=selectionKey;
  selectionKey.attach(vp);
  selectionKey.readyOps(SelectionKey.OP_WRITE);
  vn.invokeCallbacks(true);
  assertEquals(SelectionKey.OP_WRITE,vp.readyOps());
  vp.setInterests(SelectionKey.OP_ACCEPT,0);
  selectionKey.readyOps(SelectionKey.OP_ACCEPT);
  vn.installInterests();
  vn.invokeCallbacks(true);
  vn.shutdown();
  assertEquals(SelectionKey.OP_ACCEPT,vp.readyOps());
}
