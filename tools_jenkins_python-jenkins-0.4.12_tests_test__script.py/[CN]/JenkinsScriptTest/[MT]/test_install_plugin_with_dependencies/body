@patch.object(jenkins.Jenkins, 'jenkins_open')
@patch.object(jenkins.Jenkins, 'run_script')
def test_install_plugin_with_dependencies(self, run_script_mock, jenkins_mock):
    'Verify install plugins with dependencies\n        '
    j = jenkins.Jenkins(self.make_url(''), 'test', 'test')
    j.install_plugin('jabber')
    self.assertEqual(len(run_script_mock.call_args_list), 2)
    self.assertEqual(run_script_mock.call_args_list[0][0][0], 'Jenkins.instance.updateCenter.getPlugin("jabber").getNeededDependencies().each{it.deploy()};Jenkins.instance.updateCenter.getPlugin("jabber").deploy();')
    self.assertEqual(run_script_mock.call_args_list[1][0][0], 'Jenkins.instance.updateCenter.isRestartRequiredForCompletion()')
