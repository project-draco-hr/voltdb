{
  ListenableFuture writeFuture=null;
  prepareBuffers(outputBuffers);
  Pair<Long,int[]> serializeResult=context.tableStreamSerializeMore(m_tableId,m_type,outputBuffers);
  for (  int serializedBytes : serializeResult.getSecond()) {
    if (serializedBytes < 0) {
      VoltDB.crashLocalVoltDB("Failure while serialize data from a table for COW snapshot",false,null);
    }
  }
  if (serializeResult.getSecond()[0] > 0) {
    writeFuture=writeBlocksToTargets(outputBuffers,serializeResult.getSecond());
  }
 else {
    for (    DBBPool.BBContainer container : outputBuffers) {
      container.discard();
    }
  }
  return Pair.of(writeFuture,serializeResult.getFirst() > 0);
}
