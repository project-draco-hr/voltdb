{
  if (!tail.hasMoreEntries() && tail.m_discardCount == tail.getNumEntries()) {
    m_segments.pollLast();
    tail.closeAndDelete();
  }
  Long nextIndex=tail.m_index + 1;
  tail=new PBDSegment(nextIndex,new VoltFile(m_path,m_nonce + "." + nextIndex+ ".pbd"));
  tail.open(true);
  closeTailAndOffer(tail);
  return tail;
}
