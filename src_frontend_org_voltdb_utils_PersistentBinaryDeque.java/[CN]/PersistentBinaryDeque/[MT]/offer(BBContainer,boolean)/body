{
  assertions();
  if (m_closed) {
    throw new IOException("Closed");
  }
  PBDSegment tail=m_segments.peekLast();
  final boolean compress=object.b().isDirect() && allowCompression && (m_segments.size() > 1 || tail.sizeInBytes() > 1024 * 512);
  if (!tail.offer(object,compress)) {
    tail=addSegment(tail);
    final boolean success=tail.offer(object,compress);
    if (!success) {
      throw new IOException("Failed to offer object in PBD");
    }
  }
  incrementNumObjects();
  assertions();
}
