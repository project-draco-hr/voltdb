{
  assertions();
  if (m_closed) {
    throw new IOException("Closed");
  }
  for (  PBDSegment s : m_segments) {
    final boolean wasClosed=s.isClosed();
    try {
      if (wasClosed)       s.open(false);
      if (s.hasMoreEntries())       return false;
    }
  finally {
      if (wasClosed) {
        s.close();
      }
    }
  }
  return true;
}
