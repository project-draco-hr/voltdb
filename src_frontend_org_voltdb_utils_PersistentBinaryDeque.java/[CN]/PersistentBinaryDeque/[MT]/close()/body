{
  if (m_closed) {
    return;
  }
  if (!m_segments.peekLast().hasMoreEntries()) {
    m_segments.pollLast().closeAndDelete();
  }
  for (  PBDSegment segment : m_segments) {
    segment.close();
  }
  m_closed=true;
}
