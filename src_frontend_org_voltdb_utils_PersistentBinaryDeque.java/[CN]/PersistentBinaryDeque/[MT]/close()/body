{
  if (m_writeSegment == null) {
    throw new IOException("Closed");
  }
  if (m_writeSegment.getNumEntries() > 0) {
    m_finishedSegments.put(m_writeSegment.m_index,m_writeSegment);
  }
 else {
    m_writeSegment.closeAndDelete();
  }
  m_writeSegment=null;
  for (  DequeSegment segment : m_finishedSegments.values()) {
    segment.close();
  }
  m_closed=true;
}
