{
  m_path=path;
  m_nonce=nonce;
  path.listFiles(new FileFilter(){
    @Override public boolean accept(    File pathname){
      String name=pathname.getName();
      if (name.startsWith(nonce) && name.endsWith(".pbd")) {
        Long index=Long.valueOf(name.substring(nonce.length() + 1,name.length() - 4));
        m_finishedSegments.put(index,new DequeSegment(index,pathname));
      }
      return false;
    }
  }
);
  Long writeSegmentIndex=0L;
  try {
    m_currentPollSegmentIndex=m_finishedSegments.firstKey();
    writeSegmentIndex=m_finishedSegments.lastKey() + 1;
  }
 catch (  NoSuchElementException e) {
  }
  m_writeSegment=new DequeSegment(writeSegmentIndex,new File(m_path,m_nonce + "." + writeSegmentIndex+ ".pbd"));
  m_writeSegment.open();
}
