{
  System.out.println("testImportUpdateApplicationCatalog");
  Client client=getClient();
  while (!((ClientImpl)client).isHashinatorInitialized()) {
    Thread.sleep(1000);
    System.out.println("Waiting for hashinator to be initialized...");
  }
  CountDownLatch latch=new CountDownLatch(1);
  (new DataPusher("localhost",7001,100,latch)).start();
  latch.await();
  ClientResponse response=client.callProcedure("@AdHoc","select count(*) from importTable");
  assertEquals(ClientResponse.SUCCESS,response.getStatus());
  assertEquals(100,response.getResults()[0].asScalarLong());
  Thread.sleep(0,1);
  latch=new CountDownLatch(1);
  (new DataPusher("localhost",7001,100,latch)).start();
  latch.await();
  response=client.callProcedure("@AdHoc","select count(*) from importTable");
  assertEquals(ClientResponse.SUCCESS,response.getStatus());
  assertEquals(200,response.getResults()[0].asScalarLong());
  client.close();
}
