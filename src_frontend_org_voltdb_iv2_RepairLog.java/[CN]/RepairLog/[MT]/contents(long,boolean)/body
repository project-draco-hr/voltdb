{
  List<Item> items=new LinkedList<Item>();
  items.addAll(m_logMP);
  long maxSeenBinaryLogUniqueId=m_maxSeenMpBinaryLogUniqueId;
  long maxSeenBinaryLogDRId=m_maxSeenMpBinaryLogDRId;
  long maxSeenLocalDrUniqueId=m_maxSeenLocalMpUniqueId;
  if (!forMPI) {
    maxSeenBinaryLogUniqueId=m_maxSeenSpBinaryLogUniqueId;
    maxSeenBinaryLogDRId=m_maxSeenSpBinaryLogDRId;
    items.addAll(m_logSP);
    maxSeenLocalDrUniqueId=m_maxSeenLocalSpUniqueId;
  }
  Collections.sort(items,m_handleComparator);
  int ofTotal=items.size() + 1;
  tmLog.debug("Responding with " + ofTotal + " repair log parts.");
  List<Iv2RepairLogResponseMessage> responses=new LinkedList<Iv2RepairLogResponseMessage>();
  Iv2RepairLogResponseMessage hheader=new Iv2RepairLogResponseMessage(requestId,ofTotal,m_lastSpHandle,m_lastMpHandle,TheHashinator.getCurrentVersionedConfigCooked(),maxSeenLocalDrUniqueId,maxSeenBinaryLogDRId,maxSeenBinaryLogUniqueId);
  responses.add(hheader);
  int seq=responses.size();
  Iterator<Item> itemator=items.iterator();
  while (itemator.hasNext()) {
    Item item=itemator.next();
    Iv2RepairLogResponseMessage response=new Iv2RepairLogResponseMessage(requestId,seq++,ofTotal,item.getHandle(),item.getTxnId(),item.getMessage());
    responses.add(response);
  }
  return responses;
}
