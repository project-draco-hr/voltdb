{
  List<Item> items=new LinkedList<Item>();
  Iterator<Item> it=m_log.iterator();
  while (it.hasNext()) {
    Item i=it.next();
    if (!forMPI || i.isMP()) {
      items.add(i);
    }
  }
  int ofTotal=items.size() + 1;
  tmLog.info("Responding with " + ofTotal + " repair log parts.");
  List<Iv2RepairLogResponseMessage> responses=new LinkedList<Iv2RepairLogResponseMessage>();
  int seq=0;
  Iv2RepairLogResponseMessage header=new Iv2RepairLogResponseMessage(requestId,seq++,ofTotal,forMPI ? m_lastMpHandle : m_lastSpHandle,null);
  responses.add(header);
  Iterator<Item> itemator=items.iterator();
  while (itemator.hasNext()) {
    Item item=itemator.next();
    Iv2RepairLogResponseMessage response=new Iv2RepairLogResponseMessage(requestId,seq++,ofTotal,item.getHandle(),item.getMessage());
    responses.add(response);
  }
  return responses;
}
