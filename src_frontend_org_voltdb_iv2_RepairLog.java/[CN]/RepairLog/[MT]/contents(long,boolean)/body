{
  List<Item> items=new LinkedList<Item>();
  Iterator<Item> it=m_log.iterator();
  while (it.hasNext()) {
    Item i=it.next();
    if (!forMPI || i.isMP()) {
      items.add(i);
    }
  }
  int ofTotal=items.size() + 1;
  tmLog.debug("Responding with " + ofTotal + " repair log parts.");
  List<Iv2RepairLogResponseMessage> responses=new LinkedList<Iv2RepairLogResponseMessage>();
  Iv2RepairLogResponseMessage hheader=new Iv2RepairLogResponseMessage(requestId,ofTotal,m_lastSpHandle,m_lastMpHandle,TheHashinator.getCurrentVersionedConfig());
  responses.add(hheader);
  int seq=responses.size();
  Iterator<Item> itemator=items.iterator();
  while (itemator.hasNext()) {
    Item item=itemator.next();
    Iv2RepairLogResponseMessage response=new Iv2RepairLogResponseMessage(requestId,seq++,ofTotal,item.getHandle(),item.getTxnId(),item.getMessage());
    responses.add(response);
  }
  return responses;
}
