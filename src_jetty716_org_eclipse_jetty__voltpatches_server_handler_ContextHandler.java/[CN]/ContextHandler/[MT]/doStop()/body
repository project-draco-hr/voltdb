{
  _availability=__STOPPED;
  ClassLoader old_classloader=null;
  Thread current_thread=null;
  Context old_context=__context.get();
  __context.set(_scontext);
  try {
    if (_classLoader != null) {
      current_thread=Thread.currentThread();
      old_classloader=current_thread.getContextClassLoader();
      current_thread.setContextClassLoader(_classLoader);
    }
    super.doStop();
    if (_contextListeners != null) {
      ServletContextEvent event=new ServletContextEvent(_scontext);
      for (int i=LazyList.size(_contextListeners); i-- > 0; ) {
        ((ServletContextListener)LazyList.get(_contextListeners,i)).contextDestroyed(event);
      }
    }
    if (_errorHandler != null)     _errorHandler.stop();
    Enumeration e=_scontext.getAttributeNames();
    while (e.hasMoreElements()) {
      String name=(String)e.nextElement();
      checkManagedAttribute(name,null);
    }
  }
  finally {
    __context.set(old_context);
    if (_classLoader != null)     current_thread.setContextClassLoader(old_classloader);
  }
  _contextAttributes.clearAttributes();
}
