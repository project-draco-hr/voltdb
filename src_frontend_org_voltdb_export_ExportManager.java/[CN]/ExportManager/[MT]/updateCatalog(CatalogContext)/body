{
  final Cluster cluster=catalogContext.catalog.getClusters().get("cluster");
  final Database db=cluster.getDatabases().get("database");
  final Connector conn=db.getConnectors().get("0");
  if (conn == null) {
    m_loaderClass=null;
    return;
  }
  m_loaderClass=conn.getLoaderclass();
  File exportOverflowDirectory=new File(catalogContext.cluster.getExportoverflow());
  ExportGeneration newGeneration=null;
  try {
    newGeneration=new ExportGeneration(catalogContext.m_transactionId,m_onGenerationDrained,exportOverflowDirectory);
  }
 catch (  IOException e1) {
    VoltDB.crashLocalVoltDB(e1.getMessage(),true,e1);
  }
  newGeneration.initializeGenerationFromCatalog(catalogContext,conn,m_hostId,m_messenger);
  while (true) {
    TreeMap<Long,ExportGeneration> oldGenerations=m_generations.get();
    TreeMap<Long,ExportGeneration> generations=new TreeMap<Long,ExportGeneration>(oldGenerations);
    generations.put(catalogContext.m_transactionId,newGeneration);
    if (m_generations.compareAndSet(oldGenerations,generations)) {
      break;
    }
  }
}
