{
  TreeSet<File> generationDirectories=new TreeSet<File>();
  for (  File f : exportOverflowDirectory.listFiles()) {
    if (f.isDirectory()) {
      if (!f.canRead() || !f.canWrite() || !f.canExecute()) {
        throw new RuntimeException("Can't one of read/write/execute directory " + f);
      }
      generationDirectories.add(f);
    }
  }
  for (  File generationDirectory : generationDirectories) {
    ExportGeneration generation=new ExportGeneration(m_onGenerationDrained,generationDirectory);
    if (generation.initializeGenerationFromDisk(conn,m_messenger)) {
      m_generations.put(generation.m_timestamp,generation);
    }
 else {
      String list[]=generationDirectory.list();
      VoltFile.recursivelyDelete(generationDirectory);
      exportLog.warn("Invalid export generation in overflow directory " + generationDirectory + " this will be cleaned up. Number of files deleted: "+ (list != null ? list.length : 0));
    }
  }
}
