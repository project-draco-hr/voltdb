{
  SiteTracker siteTracker=catalogContext.siteTracker;
  ArrayList<Integer> sites=siteTracker.getLiveExecutionSitesForHost(hostId);
  long tmp=(long)(catalogContext.catalogVersion) << 32L;
  final long delegateId=tmp + table.getRelativeIndex();
  String overflowPath=catalogContext.cluster.getExportoverflow();
  for (  Integer site : sites) {
    Integer partition=siteTracker.getPartitionForSite(site);
    try {
      TreeMap<Long,ExportDataSource> dataSourcesForPartition=m_dataSourcesByPartition.get(partition);
      if (dataSourcesForPartition == null) {
        dataSourcesForPartition=new TreeMap<Long,ExportDataSource>();
        m_dataSourcesByPartition.put(partition,dataSourcesForPartition);
      }
      if (dataSourcesForPartition.containsKey(delegateId)) {
        continue;
      }
      ExportDataSource exportDataSource=new ExportDataSource("database",table.getTypeName(),partition,site,delegateId,table.getColumns(),overflowPath);
      dataSourcesForPartition.put(delegateId,exportDataSource);
      newProcessor.addDataSource(exportDataSource);
    }
 catch (    IOException e) {
      exportLog.fatal(e);
      VoltDB.crashVoltDB();
    }
  }
}
