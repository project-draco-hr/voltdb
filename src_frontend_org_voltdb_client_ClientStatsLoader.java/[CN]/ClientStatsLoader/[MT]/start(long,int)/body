{
  PreparedStatement instanceStmt=m_conn.prepareStatement(createInstanceStatement,PreparedStatement.RETURN_GENERATED_KEYS);
  insertConnectionStatsStmt=m_conn.prepareStatement(insertConnectionStatsStatement);
  insertProcedureStatsStmt=m_conn.prepareStatement(insertProcedureStatsStatement);
  instanceStmt.setLong(1,startTime);
  instanceStmt.setInt(2,leaderAddress);
  instanceStmt.setString(3,m_applicationName);
  if (m_subApplicationName != null) {
    instanceStmt.setString(4,m_subApplicationName);
  }
 else {
    instanceStmt.setNull(4,Types.VARCHAR);
  }
  instanceStmt.execute();
  ResultSet results=instanceStmt.getGeneratedKeys();
  while (results.next()) {
    m_instanceId=results.getInt(1);
  }
  results.close();
  instanceStmt.close();
  if (m_instanceId < 0) {
    throw new SQLException("Unable to generate an instance id to identify this client");
  }
  insertConnectionStatsStmt.setInt(1,m_instanceId);
  insertProcedureStatsStmt.setInt(1,m_instanceId);
  m_conn.commit();
  m_loadThread.start();
}
