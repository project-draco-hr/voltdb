{
  final int mypos=m_buffer.position();
  m_buffer.limit(mypos);
  m_buffer.position(0);
  long checksum=0;
  if (m_buffer.hasArray()) {
    final byte bytes[]=m_buffer.array();
    final int end=m_buffer.arrayOffset() + mypos;
    for (int ii=m_buffer.arrayOffset(); ii < end; ii++) {
      checksum+=bytes[ii];
    }
  }
 else {
    final int remaining=m_buffer.remaining();
    for (int ii=0; ii < remaining; ii++) {
      checksum+=m_buffer.get();
    }
  }
  m_buffer.limit(m_buffer.capacity());
  m_buffer.position(mypos);
  return checksum;
}
