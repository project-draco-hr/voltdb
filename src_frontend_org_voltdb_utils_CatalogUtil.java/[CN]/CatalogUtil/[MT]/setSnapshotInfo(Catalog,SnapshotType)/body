{
  Database db=catalog.getClusters().get("cluster").getDatabases().get("database");
  if (snapshotSettings != null) {
    SnapshotSchedule schedule=db.getSnapshotschedule().add("default");
    String frequency=snapshotSettings.getFrequency();
    if (!frequency.endsWith("s") && !frequency.endsWith("m") && !frequency.endsWith("h")) {
      hostLog.fatal("Snapshot frequency " + frequency + " needs to end with time unit specified"+ " that is one of [s, m, h] (seconds, minutes, hours)");
      VoltDB.crashVoltDB();
    }
    int frequencyInt=0;
    String frequencySubstring=frequency.substring(0,frequency.length() - 1);
    try {
      frequencyInt=Integer.parseInt(frequencySubstring);
    }
 catch (    Exception e) {
      hostLog.fatal("Frequency " + frequencySubstring + " is not an integer ");
      VoltDB.crashVoltDB();
    }
    String prefix=snapshotSettings.getPrefix();
    if (prefix == null || prefix.isEmpty()) {
      hostLog.fatal("Snapshot prefix " + prefix + " is not a valid prefix ");
      VoltDB.crashVoltDB();
    }
    if (prefix.contains("-") || prefix.contains(",")) {
      hostLog.fatal("Snapshot prefix " + prefix + " cannot include , or - ");
      VoltDB.crashVoltDB();
    }
    if (snapshotSettings.getRetain() == null) {
      hostLog.fatal("Snapshot retain value not provided");
      VoltDB.crashVoltDB();
    }
    int retain=snapshotSettings.getRetain().intValue();
    if (retain < 1) {
      hostLog.fatal("Snapshot retain value " + retain + " is not a valid value. Must be 1 or greater.");
      VoltDB.crashVoltDB();
    }
    schedule.setFrequencyunit(frequency.substring(frequency.length() - 1,frequency.length()));
    schedule.setFrequencyvalue(frequencyInt);
    schedule.setPrefix(prefix);
    schedule.setRetain(retain);
  }
}
