{
  long cardinality=table.getEstimatedtuplecount();
  if (cardinality <= 0) {
    cardinality=1000;
  }
  CatalogMap<Column> columnsMap=table.getColumns();
  List<Column> columns=new ArrayList<Column>(columnsMap.size());
  for (  Column column : columnsMap) {
    columns.add(column);
  }
  CatalogItemSizeBase csize=getColumnsSize(columns);
  boolean isView=table.getMaterializer() != null;
  TableSize tsize=new TableSize(table,isView,csize.widthMin,csize.widthMax,cardinality);
  CatalogMap<Index> indexes=table.getIndexes();
  for (  Index index : indexes) {
    CatalogMap<ColumnRef> columnRefsMap=index.getColumns();
    List<Column> indexColumns=new ArrayList<Column>(columnRefsMap.size());
    for (    ColumnRef columnRef : columnRefsMap) {
      indexColumns.add(columnRef.getColumn());
    }
    CatalogItemSizeBase isize=getColumnsSize(indexColumns);
    tsize.addIndex(index,isize.widthMin,isize.widthMax);
  }
  return tsize;
}
