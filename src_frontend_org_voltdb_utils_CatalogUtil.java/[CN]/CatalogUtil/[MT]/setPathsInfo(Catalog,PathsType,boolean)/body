{
  File voltDbRoot;
  final Cluster cluster=catalog.getClusters().get("cluster");
  if (paths == null || paths.getVoltdbroot() == null || paths.getVoltdbroot().getPath() == null) {
    voltDbRoot=new VoltFile("voltdbroot");
    if (!voltDbRoot.exists()) {
      hostLog.info("Creating voltdbroot directory: " + voltDbRoot.getAbsolutePath());
      if (!voltDbRoot.mkdir()) {
        hostLog.fatal("Failed to create voltdbroot directory \"" + voltDbRoot + "\"");
      }
    }
  }
 else {
    voltDbRoot=new VoltFile(paths.getVoltdbroot().getPath());
  }
  validateDirectory("volt root",voltDbRoot,crashOnFailedValidation);
  hostLog.info("Using \"" + voltDbRoot.getAbsolutePath() + "\" for voltdbroot directory.");
  File snapshotPath;
  if (paths == null || paths.getSnapshots() == null) {
    snapshotPath=new VoltFile(voltDbRoot,"snapshots");
    if (!snapshotPath.exists()) {
      if (!snapshotPath.mkdir()) {
        hostLog.fatal("Failed to create snapshot directory \"" + snapshotPath + "\"");
      }
    }
  }
 else {
    snapshotPath=new VoltFile(paths.getSnapshots().getPath());
  }
  validateDirectory("snapshot path",snapshotPath,crashOnFailedValidation);
  File ppdSnapshotPath;
  if (paths == null || paths.getPartitiondetectionsnapshot() == null) {
    ppdSnapshotPath=new VoltFile(voltDbRoot,"partition_detection_snapshot");
    if (!ppdSnapshotPath.exists()) {
      if (!ppdSnapshotPath.mkdir()) {
        hostLog.fatal("Failed to create partition detection snapshot directory \"" + ppdSnapshotPath + "\"");
      }
    }
  }
 else {
    ppdSnapshotPath=new VoltFile(paths.getPartitiondetectionsnapshot().getPath());
  }
  validateDirectory("partition detection snapshot path",ppdSnapshotPath,crashOnFailedValidation);
  File exportOverflowPath;
  if (paths == null || paths.getExportoverflow() == null) {
    exportOverflowPath=new VoltFile(voltDbRoot,"export_overflow");
    if (!exportOverflowPath.exists()) {
      if (!exportOverflowPath.mkdir()) {
        hostLog.fatal("Failed to create export overflow directory \"" + exportOverflowPath + "\"");
      }
    }
  }
 else {
    exportOverflowPath=new VoltFile(paths.getExportoverflow().getPath());
  }
  validateDirectory("export overflow",exportOverflowPath,crashOnFailedValidation);
  File commandLogPath;
  if (paths == null || paths.getCommandlog() == null) {
    commandLogPath=new VoltFile(voltDbRoot,"command_log");
    if (!commandLogPath.exists()) {
      if (!commandLogPath.mkdir()) {
        hostLog.fatal("Failed to create command log directory \"" + commandLogPath + "\"");
      }
    }
  }
 else {
    commandLogPath=new VoltFile(paths.getCommandlog().getPath());
  }
  validateDirectory("command log",commandLogPath,crashOnFailedValidation);
  File commandLogSnapshotPath;
  if (paths == null || paths.getCommandlogsnapshot() == null) {
    commandLogSnapshotPath=new VoltFile(voltDbRoot,"command_log_snapshot");
    if (!commandLogSnapshotPath.exists()) {
      if (!commandLogSnapshotPath.mkdir()) {
        hostLog.fatal("Failed to create command log snapshot directory \"" + commandLogSnapshotPath + "\"");
      }
    }
  }
 else {
    commandLogSnapshotPath=new VoltFile(paths.getCommandlogsnapshot().getPath());
  }
  validateDirectory("command log snapshot",commandLogSnapshotPath,crashOnFailedValidation);
  catalog.getClusters().get("cluster").setVoltroot(voltDbRoot.getPath());
  SnapshotSchedule schedule=cluster.getDatabases().get("database").getSnapshotschedule().get("default");
  if (schedule != null) {
    schedule.setPath(snapshotPath.getPath());
  }
  schedule=cluster.getFaultsnapshots().get("CLUSTER_PARTITION");
  if (schedule != null) {
    schedule.setPath(ppdSnapshotPath.getPath());
  }
  cluster.setExportoverflow(exportOverflowPath.getPath());
  final org.voltdb.catalog.CommandLog commandLogConfig=cluster.getLogconfig().add("log");
  commandLogConfig.setInternalsnapshotpath(commandLogSnapshotPath.getPath());
  commandLogConfig.setLogpath(commandLogPath.getPath());
}
