{
  int hostCount=cluster.getHostcount();
  int sitesPerHost=cluster.getSitesperhost();
  String leader=cluster.getLeader();
  int kFactor=cluster.getKfactor();
  ClusterConfig config=new ClusterConfig(hostCount,sitesPerHost,kFactor,leader);
  hostLog.l7dlog(Level.INFO,LogKeys.compiler_VoltCompiler_LeaderAndHostCountAndSitesPerHost.name(),new Object[]{config.getLeaderAddress(),config.getHostCount(),config.getSitesPerHost()},null);
  if (!config.validate()) {
    hostLog.error(config.getErrorMsg());
  }
 else {
    ClusterCompiler.compile(catalog,config);
    Cluster catCluster=catalog.getClusters().get("cluster");
    if (cluster.getPartitionDetection() != null && cluster.getPartitionDetection().isEnabled()) {
      catCluster.setNetworkpartition(true);
      CatalogMap<SnapshotSchedule> faultsnapshots=catCluster.getFaultsnapshots();
      SnapshotSchedule sched=faultsnapshots.add("CLUSTER_PARTITION");
      sched.setPrefix(cluster.getPartitionDetection().getSnapshot().getPrefix());
    }
 else {
      catCluster.setNetworkpartition(false);
    }
    if (cluster.getAdminMode() != null) {
      catCluster.setAdminenabled(true);
      catCluster.setAdminport(cluster.getAdminMode().getPort());
      catCluster.setAdminstartup(cluster.getAdminMode().isAdminstartup());
    }
 else {
      catCluster.setAdminenabled(false);
    }
    if (cluster.getHeartbeat() != null) {
      catCluster.setHeartbeattimeout(cluster.getHeartbeat().getTimeout());
    }
 else {
      catCluster.setHeartbeattimeout(10);
    }
  }
}
