{
  m_properties=(Properties)p.clone();
  m_procedure=(String)m_properties.get("procedure");
  if (m_procedure == null || m_procedure.trim().length() == 0) {
    throw new RuntimeException("Missing procedure.");
  }
  m_zookeeper=(String)m_properties.getProperty("zookeeper");
  if (m_zookeeper == null || m_zookeeper.trim().length() == 0) {
    throw new RuntimeException("Missing zookeeper.");
  }
  m_bootstrap=(String)m_properties.getProperty("bootstrap");
  if (m_bootstrap == null || m_bootstrap.trim().length() == 0) {
    throw new RuntimeException("Missing bootstrap.");
  }
  m_topic=(String)m_properties.getProperty("topic");
  if (m_topic == null || m_topic.trim().length() == 0) {
    throw new RuntimeException("Missing topic.");
  }
  String maxErrors=(String)m_properties.getProperty("maxErrors");
  if (maxErrors != null && maxErrors.trim().length() != 0) {
    m_maxErrors=Integer.parseInt(maxErrors);
  }
}
