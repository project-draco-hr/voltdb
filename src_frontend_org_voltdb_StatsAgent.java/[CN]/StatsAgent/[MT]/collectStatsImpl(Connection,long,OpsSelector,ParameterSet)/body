{
  JSONObject obj=new JSONObject();
  obj.put("selector","STATISTICS");
  String err=null;
  if (selector == OpsSelector.STATISTICS) {
    err=parseParamsForStatistics(params,obj);
  }
 else {
    err="StatsAgent received non-STATISTICS selector: " + selector.name();
  }
  if (err != null) {
    sendErrorResponse(c,ClientResponse.GRACEFUL_FAILURE,err,clientHandle);
    return;
  }
  String subselector=obj.getString("subselector");
  if (subselector.equalsIgnoreCase("TOPO")) {
    PendingStatsRequest psr=new PendingStatsRequest(selector,subselector,c,clientHandle,System.currentTimeMillis());
    collectTopoStats(psr);
    return;
  }
 else   if (subselector.equalsIgnoreCase("PARTITIONCOUNT")) {
    PendingStatsRequest psr=new PendingStatsRequest(selector,subselector,c,clientHandle,System.currentTimeMillis());
    collectPartitionCount(psr);
    return;
  }
  PendingStatsRequest psr=new PendingStatsRequest(selector,subselector,c,clientHandle,System.currentTimeMillis());
  distributeWork(psr,obj);
}
