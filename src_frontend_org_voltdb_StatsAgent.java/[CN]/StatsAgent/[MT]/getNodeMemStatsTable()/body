{
  VoltTable t=getEmptyNodeMemStatsTable();
  PartitionMemRow totals=new PartitionMemRow();
  for (  PartitionMemRow pmr : m_nodeMemStats.values()) {
    totals.tupleCount+=pmr.tupleCount;
    totals.tupleDataMem+=pmr.tupleDataMem;
    totals.tupleAllocatedMem+=pmr.tupleAllocatedMem;
    totals.indexMem+=pmr.indexMem;
    totals.stringMem+=pmr.indexMem;
  }
  int rss=0;
  int javaused=0;
  int javaunused=0;
  SystemStatsCollector.Datum d=SystemStatsCollector.getRecentSample();
  if (d != null) {
    rss=(int)(d.rss / 1024);
    javaused=(int)((d.javausedheapmem + d.javausedsysmem) / 1204);
    javaunused=(int)((d.javatotalheapmem + d.javatotalsysmem - javaused) / 1024);
  }
  t.addRow(rss,javaused,javaunused,totals.tupleDataMem,totals.tupleAllocatedMem,totals.indexMem,totals.stringMem,totals.tupleCount);
  return t;
}
